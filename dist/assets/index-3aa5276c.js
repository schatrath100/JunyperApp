function D8(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var wa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function _k(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var kk={exports:{}},tg={},Sk={exports:{}},Gt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gd=Symbol.for("react.element"),O8=Symbol.for("react.portal"),R8=Symbol.for("react.fragment"),M8=Symbol.for("react.strict_mode"),B8=Symbol.for("react.profiler"),U8=Symbol.for("react.provider"),z8=Symbol.for("react.context"),W8=Symbol.for("react.forward_ref"),H8=Symbol.for("react.suspense"),$8=Symbol.for("react.memo"),V8=Symbol.for("react.lazy"),S5=Symbol.iterator;function q8(e){return e===null||typeof e!="object"?null:(e=S5&&e[S5]||e["@@iterator"],typeof e=="function"?e:null)}var Ek={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nk=Object.assign,Ak={};function _0(e,t,r){this.props=e,this.context=t,this.refs=Ak,this.updater=r||Ek}_0.prototype.isReactComponent={};_0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ck(){}Ck.prototype=_0.prototype;function j2(e,t,r){this.props=e,this.context=t,this.refs=Ak,this.updater=r||Ek}var I2=j2.prototype=new Ck;I2.constructor=j2;Nk(I2,_0.prototype);I2.isPureReactComponent=!0;var E5=Array.isArray,Tk=Object.prototype.hasOwnProperty,D2={current:null},Pk={key:!0,ref:!0,__self:!0,__source:!0};function Fk(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)Tk.call(t,n)&&!Pk.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Gd,type:e,key:i,ref:s,props:a,_owner:D2.current}}function G8(e,t){return{$$typeof:Gd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function O2(e){return typeof e=="object"&&e!==null&&e.$$typeof===Gd}function X8(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var N5=/\/+/g;function Fm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?X8(""+e.key):t.toString(36)}function V1(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Gd:case O8:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+Fm(s,0):n,E5(a)?(r="",e!=null&&(r=e.replace(N5,"$&/")+"/"),V1(a,t,r,"",function(c){return c})):a!=null&&(O2(a)&&(a=G8(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(N5,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",E5(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+Fm(i,o);s+=V1(i,t,r,l,a)}else if(l=q8(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+Fm(i,o++),s+=V1(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function n1(e,t,r){if(e==null)return e;var n=[],a=0;return V1(e,n,"","",function(i){return t.call(r,i,a++)}),n}function K8(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ka={current:null},q1={transition:null},Y8={ReactCurrentDispatcher:ka,ReactCurrentBatchConfig:q1,ReactCurrentOwner:D2};function Lk(){throw Error("act(...) is not supported in production builds of React.")}Gt.Children={map:n1,forEach:function(e,t,r){n1(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return n1(e,function(){t++}),t},toArray:function(e){return n1(e,function(t){return t})||[]},only:function(e){if(!O2(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Gt.Component=_0;Gt.Fragment=R8;Gt.Profiler=B8;Gt.PureComponent=j2;Gt.StrictMode=M8;Gt.Suspense=H8;Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y8;Gt.act=Lk;Gt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Nk({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=D2.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Tk.call(t,l)&&!Pk.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Gd,type:e.type,key:a,ref:i,props:n,_owner:s}};Gt.createContext=function(e){return e={$$typeof:z8,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:U8,_context:e},e.Consumer=e};Gt.createElement=Fk;Gt.createFactory=function(e){var t=Fk.bind(null,e);return t.type=e,t};Gt.createRef=function(){return{current:null}};Gt.forwardRef=function(e){return{$$typeof:W8,render:e}};Gt.isValidElement=O2;Gt.lazy=function(e){return{$$typeof:V8,_payload:{_status:-1,_result:e},_init:K8}};Gt.memo=function(e,t){return{$$typeof:$8,type:e,compare:t===void 0?null:t}};Gt.startTransition=function(e){var t=q1.transition;q1.transition={};try{e()}finally{q1.transition=t}};Gt.unstable_act=Lk;Gt.useCallback=function(e,t){return ka.current.useCallback(e,t)};Gt.useContext=function(e){return ka.current.useContext(e)};Gt.useDebugValue=function(){};Gt.useDeferredValue=function(e){return ka.current.useDeferredValue(e)};Gt.useEffect=function(e,t){return ka.current.useEffect(e,t)};Gt.useId=function(){return ka.current.useId()};Gt.useImperativeHandle=function(e,t,r){return ka.current.useImperativeHandle(e,t,r)};Gt.useInsertionEffect=function(e,t){return ka.current.useInsertionEffect(e,t)};Gt.useLayoutEffect=function(e,t){return ka.current.useLayoutEffect(e,t)};Gt.useMemo=function(e,t){return ka.current.useMemo(e,t)};Gt.useReducer=function(e,t,r){return ka.current.useReducer(e,t,r)};Gt.useRef=function(e){return ka.current.useRef(e)};Gt.useState=function(e){return ka.current.useState(e)};Gt.useSyncExternalStore=function(e,t,r){return ka.current.useSyncExternalStore(e,t,r)};Gt.useTransition=function(){return ka.current.useTransition()};Gt.version="18.3.1";Sk.exports=Gt;var O=Sk.exports;const Es=qd(O),R2=D8({__proto__:null,default:Es},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J8=O,Z8=Symbol.for("react.element"),Q8=Symbol.for("react.fragment"),eT=Object.prototype.hasOwnProperty,tT=J8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rT={key:!0,ref:!0,__self:!0,__source:!0};function jk(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)eT.call(t,n)&&!rT.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Z8,type:e,key:i,ref:s,props:a,_owner:tT.current}}tg.Fragment=Q8;tg.jsx=jk;tg.jsxs=jk;kk.exports=tg;var p=kk.exports,Ik={exports:{}},ci={},Dk={exports:{}},Ok={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(X,D){var ne=X.length;X.push(D);e:for(;0<ne;){var ge=ne-1>>>1,C=X[ge];if(0<a(C,D))X[ge]=D,X[ne]=C,ne=ge;else break e}}function r(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var D=X[0],ne=X.pop();if(ne!==D){X[0]=ne;e:for(var ge=0,C=X.length,R=C>>>1;ge<R;){var B=2*(ge+1)-1,U=X[B],Y=B+1,ue=X[Y];if(0>a(U,ne))Y<C&&0>a(ue,U)?(X[ge]=ue,X[Y]=ne,ge=Y):(X[ge]=U,X[B]=ne,ge=B);else if(Y<C&&0>a(ue,ne))X[ge]=ue,X[Y]=ne,ge=Y;else break e}}return D}function a(X,D){var ne=X.sortIndex-D.sortIndex;return ne!==0?ne:X.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,f=null,d=3,h=!1,v=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(X){for(var D=r(c);D!==null;){if(D.callback===null)n(c);else if(D.startTime<=X)n(c),D.sortIndex=D.expirationTime,t(l,D);else break;D=r(c)}}function S(X){if(m=!1,w(X),!v)if(r(l)!==null)v=!0,V(L);else{var D=r(c);D!==null&&z(S,D.startTime-X)}}function L(X,D){v=!1,m&&(m=!1,x(E),E=-1),h=!0;var ne=d;try{for(w(D),f=r(l);f!==null&&(!(f.expirationTime>D)||X&&!F());){var ge=f.callback;if(typeof ge=="function"){f.callback=null,d=f.priorityLevel;var C=ge(f.expirationTime<=D);D=e.unstable_now(),typeof C=="function"?f.callback=C:f===r(l)&&n(l),w(D)}else n(l);f=r(l)}if(f!==null)var R=!0;else{var B=r(c);B!==null&&z(S,B.startTime-D),R=!1}return R}finally{f=null,d=ne,h=!1}}var j=!1,N=null,E=-1,P=5,M=-1;function F(){return!(e.unstable_now()-M<P)}function T(){if(N!==null){var X=e.unstable_now();M=X;var D=!0;try{D=N(!0,X)}finally{D?H():(j=!1,N=null)}}else j=!1}var H;if(typeof b=="function")H=function(){b(T)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,Q=W.port2;W.port1.onmessage=T,H=function(){Q.postMessage(null)}}else H=function(){y(T,0)};function V(X){N=X,j||(j=!0,H())}function z(X,D){E=y(function(){X(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(X){X.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,V(L))},e.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<X?Math.floor(1e3/X):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(X){switch(d){case 1:case 2:case 3:var D=3;break;default:D=d}var ne=d;d=D;try{return X()}finally{d=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(X,D){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ne=d;d=X;try{return D()}finally{d=ne}},e.unstable_scheduleCallback=function(X,D,ne){var ge=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ge+ne:ge):ne=ge,X){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ne+C,X={id:u++,callback:D,priorityLevel:X,startTime:ne,expirationTime:C,sortIndex:-1},ne>ge?(X.sortIndex=ne,t(c,X),r(l)===null&&X===r(c)&&(m?(x(E),E=-1):m=!0,z(S,ne-ge))):(X.sortIndex=C,t(l,X),v||h||(v=!0,V(L))),X},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(X){var D=d;return function(){var ne=d;d=D;try{return X.apply(this,arguments)}finally{d=ne}}}})(Ok);Dk.exports=Ok;var nT=Dk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aT=O,oi=nT;function Ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Rk=new Set,od={};function jc(e,t){l0(e,t),l0(e+"Capture",t)}function l0(e,t){for(od[e]=t,e=0;e<t.length;e++)Rk.add(t[e])}var ho=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yv=Object.prototype.hasOwnProperty,iT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A5={},C5={};function sT(e){return Yv.call(C5,e)?!0:Yv.call(A5,e)?!1:iT.test(e)?C5[e]=!0:(A5[e]=!0,!1)}function oT(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function lT(e,t,r,n){if(t===null||typeof t>"u"||oT(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Sa(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var Hn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Hn[e]=new Sa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Hn[t]=new Sa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Hn[e]=new Sa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Hn[e]=new Sa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Hn[e]=new Sa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Hn[e]=new Sa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Hn[e]=new Sa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Hn[e]=new Sa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Hn[e]=new Sa(e,5,!1,e.toLowerCase(),null,!1,!1)});var M2=/[\-:]([a-z])/g;function B2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(M2,B2);Hn[t]=new Sa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(M2,B2);Hn[t]=new Sa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(M2,B2);Hn[t]=new Sa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Hn[e]=new Sa(e,1,!1,e.toLowerCase(),null,!1,!1)});Hn.xlinkHref=new Sa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Hn[e]=new Sa(e,1,!1,e.toLowerCase(),null,!0,!0)});function U2(e,t,r,n){var a=Hn.hasOwnProperty(t)?Hn[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(lT(t,r,a,n)&&(r=null),n||a===null?sT(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var _o=aT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,a1=Symbol.for("react.element"),Iu=Symbol.for("react.portal"),Du=Symbol.for("react.fragment"),z2=Symbol.for("react.strict_mode"),Jv=Symbol.for("react.profiler"),Mk=Symbol.for("react.provider"),Bk=Symbol.for("react.context"),W2=Symbol.for("react.forward_ref"),Zv=Symbol.for("react.suspense"),Qv=Symbol.for("react.suspense_list"),H2=Symbol.for("react.memo"),Yo=Symbol.for("react.lazy"),Uk=Symbol.for("react.offscreen"),T5=Symbol.iterator;function df(e){return e===null||typeof e!="object"?null:(e=T5&&e[T5]||e["@@iterator"],typeof e=="function"?e:null)}var zr=Object.assign,Lm;function Nf(e){if(Lm===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Lm=t&&t[1]||""}return`
`+Lm+e}var jm=!1;function Im(e,t){if(!e||jm)return"";jm=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{jm=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Nf(e):""}function cT(e){switch(e.tag){case 5:return Nf(e.type);case 16:return Nf("Lazy");case 13:return Nf("Suspense");case 19:return Nf("SuspenseList");case 0:case 2:case 15:return e=Im(e.type,!1),e;case 11:return e=Im(e.type.render,!1),e;case 1:return e=Im(e.type,!0),e;default:return""}}function ex(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Du:return"Fragment";case Iu:return"Portal";case Jv:return"Profiler";case z2:return"StrictMode";case Zv:return"Suspense";case Qv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Bk:return(e.displayName||"Context")+".Consumer";case Mk:return(e._context.displayName||"Context")+".Provider";case W2:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case H2:return t=e.displayName||null,t!==null?t:ex(e.type)||"Memo";case Yo:t=e._payload,e=e._init;try{return ex(e(t))}catch{}}return null}function uT(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ex(t);case 8:return t===z2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function wl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function fT(e){var t=zk(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function i1(e){e._valueTracker||(e._valueTracker=fT(e))}function Wk(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=zk(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function sp(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function tx(e,t){var r=t.checked;return zr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function P5(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=wl(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Hk(e,t){t=t.checked,t!=null&&U2(e,"checked",t,!1)}function rx(e,t){Hk(e,t);var r=wl(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?nx(e,t.type,r):t.hasOwnProperty("defaultValue")&&nx(e,t.type,wl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function F5(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function nx(e,t,r){(t!=="number"||sp(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Af=Array.isArray;function Xu(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+wl(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function ax(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ge(91));return zr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function L5(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ge(92));if(Af(r)){if(1<r.length)throw Error(Ge(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:wl(r)}}function $k(e,t){var r=wl(t.value),n=wl(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function j5(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Vk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ix(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Vk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var s1,qk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(s1=s1||document.createElement("div"),s1.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=s1.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ld(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Df={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dT=["Webkit","ms","Moz","O"];Object.keys(Df).forEach(function(e){dT.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Df[t]=Df[e]})});function Gk(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Df.hasOwnProperty(e)&&Df[e]?(""+t).trim():t+"px"}function Xk(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Gk(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var hT=zr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sx(e,t){if(t){if(hT[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ge(62))}}function ox(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lx=null;function $2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var cx=null,Ku=null,Yu=null;function I5(e){if(e=Yd(e)){if(typeof cx!="function")throw Error(Ge(280));var t=e.stateNode;t&&(t=sg(t),cx(e.stateNode,e.type,t))}}function Kk(e){Ku?Yu?Yu.push(e):Yu=[e]:Ku=e}function Yk(){if(Ku){var e=Ku,t=Yu;if(Yu=Ku=null,I5(e),t)for(e=0;e<t.length;e++)I5(t[e])}}function Jk(e,t){return e(t)}function Zk(){}var Dm=!1;function Qk(e,t,r){if(Dm)return e(t,r);Dm=!0;try{return Jk(e,t,r)}finally{Dm=!1,(Ku!==null||Yu!==null)&&(Zk(),Yk())}}function cd(e,t){var r=e.stateNode;if(r===null)return null;var n=sg(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ge(231,t,typeof r));return r}var ux=!1;if(ho)try{var hf={};Object.defineProperty(hf,"passive",{get:function(){ux=!0}}),window.addEventListener("test",hf,hf),window.removeEventListener("test",hf,hf)}catch{ux=!1}function pT(e,t,r,n,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Of=!1,op=null,lp=!1,fx=null,gT={onError:function(e){Of=!0,op=e}};function mT(e,t,r,n,a,i,s,o,l){Of=!1,op=null,pT.apply(gT,arguments)}function vT(e,t,r,n,a,i,s,o,l){if(mT.apply(this,arguments),Of){if(Of){var c=op;Of=!1,op=null}else throw Error(Ge(198));lp||(lp=!0,fx=c)}}function Ic(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function e3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function D5(e){if(Ic(e)!==e)throw Error(Ge(188))}function xT(e){var t=e.alternate;if(!t){if(t=Ic(e),t===null)throw Error(Ge(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return D5(a),e;if(i===n)return D5(a),t;i=i.sibling}throw Error(Ge(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(Ge(189))}}if(r.alternate!==n)throw Error(Ge(190))}if(r.tag!==3)throw Error(Ge(188));return r.stateNode.current===r?e:t}function t3(e){return e=xT(e),e!==null?r3(e):null}function r3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=r3(e);if(t!==null)return t;e=e.sibling}return null}var n3=oi.unstable_scheduleCallback,O5=oi.unstable_cancelCallback,yT=oi.unstable_shouldYield,wT=oi.unstable_requestPaint,tn=oi.unstable_now,bT=oi.unstable_getCurrentPriorityLevel,V2=oi.unstable_ImmediatePriority,a3=oi.unstable_UserBlockingPriority,cp=oi.unstable_NormalPriority,_T=oi.unstable_LowPriority,i3=oi.unstable_IdlePriority,rg=null,Ts=null;function kT(e){if(Ts&&typeof Ts.onCommitFiberRoot=="function")try{Ts.onCommitFiberRoot(rg,e,void 0,(e.current.flags&128)===128)}catch{}}var rs=Math.clz32?Math.clz32:NT,ST=Math.log,ET=Math.LN2;function NT(e){return e>>>=0,e===0?32:31-(ST(e)/ET|0)|0}var o1=64,l1=4194304;function Cf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function up(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=Cf(o):(i&=s,i!==0&&(n=Cf(i)))}else s=r&~a,s!==0?n=Cf(s):i!==0&&(n=Cf(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-rs(t),a=1<<r,n|=e[r],t&=~a;return n}function AT(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function CT(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-rs(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=AT(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function dx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function s3(){var e=o1;return o1<<=1,!(o1&4194240)&&(o1=64),e}function Om(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Xd(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-rs(t),e[t]=r}function TT(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-rs(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function q2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-rs(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var pr=0;function o3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var l3,G2,c3,u3,f3,hx=!1,c1=[],fl=null,dl=null,hl=null,ud=new Map,fd=new Map,Qo=[],PT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function R5(e,t){switch(e){case"focusin":case"focusout":fl=null;break;case"dragenter":case"dragleave":dl=null;break;case"mouseover":case"mouseout":hl=null;break;case"pointerover":case"pointerout":ud.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fd.delete(t.pointerId)}}function pf(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Yd(t),t!==null&&G2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function FT(e,t,r,n,a){switch(t){case"focusin":return fl=pf(fl,e,t,r,n,a),!0;case"dragenter":return dl=pf(dl,e,t,r,n,a),!0;case"mouseover":return hl=pf(hl,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return ud.set(i,pf(ud.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,fd.set(i,pf(fd.get(i)||null,e,t,r,n,a)),!0}return!1}function d3(e){var t=ic(e.target);if(t!==null){var r=Ic(t);if(r!==null){if(t=r.tag,t===13){if(t=e3(r),t!==null){e.blockedOn=t,f3(e.priority,function(){c3(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function G1(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=px(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);lx=n,r.target.dispatchEvent(n),lx=null}else return t=Yd(r),t!==null&&G2(t),e.blockedOn=r,!1;t.shift()}return!0}function M5(e,t,r){G1(e)&&r.delete(t)}function LT(){hx=!1,fl!==null&&G1(fl)&&(fl=null),dl!==null&&G1(dl)&&(dl=null),hl!==null&&G1(hl)&&(hl=null),ud.forEach(M5),fd.forEach(M5)}function gf(e,t){e.blockedOn===t&&(e.blockedOn=null,hx||(hx=!0,oi.unstable_scheduleCallback(oi.unstable_NormalPriority,LT)))}function dd(e){function t(a){return gf(a,e)}if(0<c1.length){gf(c1[0],e);for(var r=1;r<c1.length;r++){var n=c1[r];n.blockedOn===e&&(n.blockedOn=null)}}for(fl!==null&&gf(fl,e),dl!==null&&gf(dl,e),hl!==null&&gf(hl,e),ud.forEach(t),fd.forEach(t),r=0;r<Qo.length;r++)n=Qo[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Qo.length&&(r=Qo[0],r.blockedOn===null);)d3(r),r.blockedOn===null&&Qo.shift()}var Ju=_o.ReactCurrentBatchConfig,fp=!0;function jT(e,t,r,n){var a=pr,i=Ju.transition;Ju.transition=null;try{pr=1,X2(e,t,r,n)}finally{pr=a,Ju.transition=i}}function IT(e,t,r,n){var a=pr,i=Ju.transition;Ju.transition=null;try{pr=4,X2(e,t,r,n)}finally{pr=a,Ju.transition=i}}function X2(e,t,r,n){if(fp){var a=px(e,t,r,n);if(a===null)qm(e,t,n,dp,r),R5(e,n);else if(FT(a,e,t,r,n))n.stopPropagation();else if(R5(e,n),t&4&&-1<PT.indexOf(e)){for(;a!==null;){var i=Yd(a);if(i!==null&&l3(i),i=px(e,t,r,n),i===null&&qm(e,t,n,dp,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else qm(e,t,n,null,r)}}var dp=null;function px(e,t,r,n){if(dp=null,e=$2(n),e=ic(e),e!==null)if(t=Ic(e),t===null)e=null;else if(r=t.tag,r===13){if(e=e3(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return dp=e,null}function h3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bT()){case V2:return 1;case a3:return 4;case cp:case _T:return 16;case i3:return 536870912;default:return 16}default:return 16}}var il=null,K2=null,X1=null;function p3(){if(X1)return X1;var e,t=K2,r=t.length,n,a="value"in il?il.value:il.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return X1=a.slice(e,1<n?1-n:void 0)}function K1(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function u1(){return!0}function B5(){return!1}function ui(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?u1:B5,this.isPropagationStopped=B5,this}return zr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=u1)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=u1)},persist:function(){},isPersistent:u1}),t}var k0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Y2=ui(k0),Kd=zr({},k0,{view:0,detail:0}),DT=ui(Kd),Rm,Mm,mf,ng=zr({},Kd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:J2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==mf&&(mf&&e.type==="mousemove"?(Rm=e.screenX-mf.screenX,Mm=e.screenY-mf.screenY):Mm=Rm=0,mf=e),Rm)},movementY:function(e){return"movementY"in e?e.movementY:Mm}}),U5=ui(ng),OT=zr({},ng,{dataTransfer:0}),RT=ui(OT),MT=zr({},Kd,{relatedTarget:0}),Bm=ui(MT),BT=zr({},k0,{animationName:0,elapsedTime:0,pseudoElement:0}),UT=ui(BT),zT=zr({},k0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),WT=ui(zT),HT=zr({},k0,{data:0}),z5=ui(HT),$T={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=qT[e])?!!t[e]:!1}function J2(){return GT}var XT=zr({},Kd,{key:function(e){if(e.key){var t=$T[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=K1(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?VT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:J2,charCode:function(e){return e.type==="keypress"?K1(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?K1(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),KT=ui(XT),YT=zr({},ng,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),W5=ui(YT),JT=zr({},Kd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:J2}),ZT=ui(JT),QT=zr({},k0,{propertyName:0,elapsedTime:0,pseudoElement:0}),eP=ui(QT),tP=zr({},ng,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),rP=ui(tP),nP=[9,13,27,32],Z2=ho&&"CompositionEvent"in window,Rf=null;ho&&"documentMode"in document&&(Rf=document.documentMode);var aP=ho&&"TextEvent"in window&&!Rf,g3=ho&&(!Z2||Rf&&8<Rf&&11>=Rf),H5=String.fromCharCode(32),$5=!1;function m3(e,t){switch(e){case"keyup":return nP.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function v3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ou=!1;function iP(e,t){switch(e){case"compositionend":return v3(t);case"keypress":return t.which!==32?null:($5=!0,H5);case"textInput":return e=t.data,e===H5&&$5?null:e;default:return null}}function sP(e,t){if(Ou)return e==="compositionend"||!Z2&&m3(e,t)?(e=p3(),X1=K2=il=null,Ou=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return g3&&t.locale!=="ko"?null:t.data;default:return null}}var oP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function V5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!oP[e.type]:t==="textarea"}function x3(e,t,r,n){Kk(n),t=hp(t,"onChange"),0<t.length&&(r=new Y2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Mf=null,hd=null;function lP(e){T3(e,0)}function ag(e){var t=Bu(e);if(Wk(t))return e}function cP(e,t){if(e==="change")return t}var y3=!1;if(ho){var Um;if(ho){var zm="oninput"in document;if(!zm){var q5=document.createElement("div");q5.setAttribute("oninput","return;"),zm=typeof q5.oninput=="function"}Um=zm}else Um=!1;y3=Um&&(!document.documentMode||9<document.documentMode)}function G5(){Mf&&(Mf.detachEvent("onpropertychange",w3),hd=Mf=null)}function w3(e){if(e.propertyName==="value"&&ag(hd)){var t=[];x3(t,hd,e,$2(e)),Qk(lP,t)}}function uP(e,t,r){e==="focusin"?(G5(),Mf=t,hd=r,Mf.attachEvent("onpropertychange",w3)):e==="focusout"&&G5()}function fP(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ag(hd)}function dP(e,t){if(e==="click")return ag(t)}function hP(e,t){if(e==="input"||e==="change")return ag(t)}function pP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ss=typeof Object.is=="function"?Object.is:pP;function pd(e,t){if(ss(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Yv.call(t,a)||!ss(e[a],t[a]))return!1}return!0}function X5(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function K5(e,t){var r=X5(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=X5(r)}}function b3(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?b3(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _3(){for(var e=window,t=sp();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=sp(e.document)}return t}function Q2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function gP(e){var t=_3(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&b3(r.ownerDocument.documentElement,r)){if(n!==null&&Q2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=K5(r,i);var s=K5(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mP=ho&&"documentMode"in document&&11>=document.documentMode,Ru=null,gx=null,Bf=null,mx=!1;function Y5(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;mx||Ru==null||Ru!==sp(n)||(n=Ru,"selectionStart"in n&&Q2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Bf&&pd(Bf,n)||(Bf=n,n=hp(gx,"onSelect"),0<n.length&&(t=new Y2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ru)))}function f1(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Mu={animationend:f1("Animation","AnimationEnd"),animationiteration:f1("Animation","AnimationIteration"),animationstart:f1("Animation","AnimationStart"),transitionend:f1("Transition","TransitionEnd")},Wm={},k3={};ho&&(k3=document.createElement("div").style,"AnimationEvent"in window||(delete Mu.animationend.animation,delete Mu.animationiteration.animation,delete Mu.animationstart.animation),"TransitionEvent"in window||delete Mu.transitionend.transition);function ig(e){if(Wm[e])return Wm[e];if(!Mu[e])return e;var t=Mu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in k3)return Wm[e]=t[r];return e}var S3=ig("animationend"),E3=ig("animationiteration"),N3=ig("animationstart"),A3=ig("transitionend"),C3=new Map,J5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fl(e,t){C3.set(e,t),jc(t,[e])}for(var Hm=0;Hm<J5.length;Hm++){var $m=J5[Hm],vP=$m.toLowerCase(),xP=$m[0].toUpperCase()+$m.slice(1);Fl(vP,"on"+xP)}Fl(S3,"onAnimationEnd");Fl(E3,"onAnimationIteration");Fl(N3,"onAnimationStart");Fl("dblclick","onDoubleClick");Fl("focusin","onFocus");Fl("focusout","onBlur");Fl(A3,"onTransitionEnd");l0("onMouseEnter",["mouseout","mouseover"]);l0("onMouseLeave",["mouseout","mouseover"]);l0("onPointerEnter",["pointerout","pointerover"]);l0("onPointerLeave",["pointerout","pointerover"]);jc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jc("onBeforeInput",["compositionend","keypress","textInput","paste"]);jc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tf));function Z5(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,vT(n,t,void 0,e),e.currentTarget=null}function T3(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Z5(a,o,c),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Z5(a,o,c),i=l}}}if(lp)throw e=fx,lp=!1,fx=null,e}function Tr(e,t){var r=t[bx];r===void 0&&(r=t[bx]=new Set);var n=e+"__bubble";r.has(n)||(P3(t,e,2,!1),r.add(n))}function Vm(e,t,r){var n=0;t&&(n|=4),P3(r,e,n,t)}var d1="_reactListening"+Math.random().toString(36).slice(2);function gd(e){if(!e[d1]){e[d1]=!0,Rk.forEach(function(r){r!=="selectionchange"&&(yP.has(r)||Vm(r,!1,e),Vm(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[d1]||(t[d1]=!0,Vm("selectionchange",!1,t))}}function P3(e,t,r,n){switch(h3(t)){case 1:var a=jT;break;case 4:a=IT;break;default:a=X2}r=a.bind(null,t,r,e),a=void 0,!ux||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function qm(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=ic(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}Qk(function(){var c=i,u=$2(r),f=[];e:{var d=C3.get(e);if(d!==void 0){var h=Y2,v=e;switch(e){case"keypress":if(K1(r)===0)break e;case"keydown":case"keyup":h=KT;break;case"focusin":v="focus",h=Bm;break;case"focusout":v="blur",h=Bm;break;case"beforeblur":case"afterblur":h=Bm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=U5;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=RT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=ZT;break;case S3:case E3:case N3:h=UT;break;case A3:h=eP;break;case"scroll":h=DT;break;case"wheel":h=rP;break;case"copy":case"cut":case"paste":h=WT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=W5}var m=(t&4)!==0,y=!m&&e==="scroll",x=m?d!==null?d+"Capture":null:d;m=[];for(var b=c,w;b!==null;){w=b;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,x!==null&&(S=cd(b,x),S!=null&&m.push(md(b,S,w)))),y)break;b=b.return}0<m.length&&(d=new h(d,v,null,r,u),f.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&r!==lx&&(v=r.relatedTarget||r.fromElement)&&(ic(v)||v[po]))break e;if((h||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=c,v=v?ic(v):null,v!==null&&(y=Ic(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=c),h!==v)){if(m=U5,S="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(m=W5,S="onPointerLeave",x="onPointerEnter",b="pointer"),y=h==null?d:Bu(h),w=v==null?d:Bu(v),d=new m(S,b+"leave",h,r,u),d.target=y,d.relatedTarget=w,S=null,ic(u)===c&&(m=new m(x,b+"enter",v,r,u),m.target=w,m.relatedTarget=y,S=m),y=S,h&&v)t:{for(m=h,x=v,b=0,w=m;w;w=vu(w))b++;for(w=0,S=x;S;S=vu(S))w++;for(;0<b-w;)m=vu(m),b--;for(;0<w-b;)x=vu(x),w--;for(;b--;){if(m===x||x!==null&&m===x.alternate)break t;m=vu(m),x=vu(x)}m=null}else m=null;h!==null&&Q5(f,d,h,m,!1),v!==null&&y!==null&&Q5(f,y,v,m,!0)}}e:{if(d=c?Bu(c):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var L=cP;else if(V5(d))if(y3)L=hP;else{L=fP;var j=uP}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(L=dP);if(L&&(L=L(e,c))){x3(f,L,r,u);break e}j&&j(e,d,c),e==="focusout"&&(j=d._wrapperState)&&j.controlled&&d.type==="number"&&nx(d,"number",d.value)}switch(j=c?Bu(c):window,e){case"focusin":(V5(j)||j.contentEditable==="true")&&(Ru=j,gx=c,Bf=null);break;case"focusout":Bf=gx=Ru=null;break;case"mousedown":mx=!0;break;case"contextmenu":case"mouseup":case"dragend":mx=!1,Y5(f,r,u);break;case"selectionchange":if(mP)break;case"keydown":case"keyup":Y5(f,r,u)}var N;if(Z2)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ou?m3(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(g3&&r.locale!=="ko"&&(Ou||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ou&&(N=p3()):(il=u,K2="value"in il?il.value:il.textContent,Ou=!0)),j=hp(c,E),0<j.length&&(E=new z5(E,e,null,r,u),f.push({event:E,listeners:j}),N?E.data=N:(N=v3(r),N!==null&&(E.data=N)))),(N=aP?iP(e,r):sP(e,r))&&(c=hp(c,"onBeforeInput"),0<c.length&&(u=new z5("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=N))}T3(f,t)})}function md(e,t,r){return{instance:e,listener:t,currentTarget:r}}function hp(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=cd(e,r),i!=null&&n.unshift(md(e,i,a)),i=cd(e,t),i!=null&&n.push(md(e,i,a))),e=e.return}return n}function vu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Q5(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=cd(r,i),l!=null&&s.unshift(md(r,l,o))):a||(l=cd(r,i),l!=null&&s.push(md(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var wP=/\r\n?/g,bP=/\u0000|\uFFFD/g;function eb(e){return(typeof e=="string"?e:""+e).replace(wP,`
`).replace(bP,"")}function h1(e,t,r){if(t=eb(t),eb(e)!==t&&r)throw Error(Ge(425))}function pp(){}var vx=null,xx=null;function yx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var wx=typeof setTimeout=="function"?setTimeout:void 0,_P=typeof clearTimeout=="function"?clearTimeout:void 0,tb=typeof Promise=="function"?Promise:void 0,kP=typeof queueMicrotask=="function"?queueMicrotask:typeof tb<"u"?function(e){return tb.resolve(null).then(e).catch(SP)}:wx;function SP(e){setTimeout(function(){throw e})}function Gm(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),dd(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);dd(t)}function pl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function rb(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var S0=Math.random().toString(36).slice(2),Ns="__reactFiber$"+S0,vd="__reactProps$"+S0,po="__reactContainer$"+S0,bx="__reactEvents$"+S0,EP="__reactListeners$"+S0,NP="__reactHandles$"+S0;function ic(e){var t=e[Ns];if(t)return t;for(var r=e.parentNode;r;){if(t=r[po]||r[Ns]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=rb(e);e!==null;){if(r=e[Ns])return r;e=rb(e)}return t}e=r,r=e.parentNode}return null}function Yd(e){return e=e[Ns]||e[po],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Bu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ge(33))}function sg(e){return e[vd]||null}var _x=[],Uu=-1;function Ll(e){return{current:e}}function Lr(e){0>Uu||(e.current=_x[Uu],_x[Uu]=null,Uu--)}function Nr(e,t){Uu++,_x[Uu]=e.current,e.current=t}var bl={},la=Ll(bl),Ra=Ll(!1),bc=bl;function c0(e,t){var r=e.type.contextTypes;if(!r)return bl;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ma(e){return e=e.childContextTypes,e!=null}function gp(){Lr(Ra),Lr(la)}function nb(e,t,r){if(la.current!==bl)throw Error(Ge(168));Nr(la,t),Nr(Ra,r)}function F3(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Ge(108,uT(e)||"Unknown",a));return zr({},r,n)}function mp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bl,bc=la.current,Nr(la,e),Nr(Ra,Ra.current),!0}function ab(e,t,r){var n=e.stateNode;if(!n)throw Error(Ge(169));r?(e=F3(e,t,bc),n.__reactInternalMemoizedMergedChildContext=e,Lr(Ra),Lr(la),Nr(la,e)):Lr(Ra),Nr(Ra,r)}var no=null,og=!1,Xm=!1;function L3(e){no===null?no=[e]:no.push(e)}function AP(e){og=!0,L3(e)}function jl(){if(!Xm&&no!==null){Xm=!0;var e=0,t=pr;try{var r=no;for(pr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}no=null,og=!1}catch(a){throw no!==null&&(no=no.slice(e+1)),n3(V2,jl),a}finally{pr=t,Xm=!1}}return null}var zu=[],Wu=0,vp=null,xp=0,Ai=[],Ci=0,_c=null,ao=1,io="";function Ql(e,t){zu[Wu++]=xp,zu[Wu++]=vp,vp=e,xp=t}function j3(e,t,r){Ai[Ci++]=ao,Ai[Ci++]=io,Ai[Ci++]=_c,_c=e;var n=ao;e=io;var a=32-rs(n)-1;n&=~(1<<a),r+=1;var i=32-rs(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,ao=1<<32-rs(t)+a|r<<a|n,io=i+e}else ao=1<<i|r<<a|n,io=e}function ey(e){e.return!==null&&(Ql(e,1),j3(e,1,0))}function ty(e){for(;e===vp;)vp=zu[--Wu],zu[Wu]=null,xp=zu[--Wu],zu[Wu]=null;for(;e===_c;)_c=Ai[--Ci],Ai[Ci]=null,io=Ai[--Ci],Ai[Ci]=null,ao=Ai[--Ci],Ai[Ci]=null}var ii=null,ni=null,Dr=!1,Qi=null;function I3(e,t){var r=Ti(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ib(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ii=e,ni=pl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ii=e,ni=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=_c!==null?{id:ao,overflow:io}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ti(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ii=e,ni=null,!0):!1;default:return!1}}function kx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Sx(e){if(Dr){var t=ni;if(t){var r=t;if(!ib(e,t)){if(kx(e))throw Error(Ge(418));t=pl(r.nextSibling);var n=ii;t&&ib(e,t)?I3(n,r):(e.flags=e.flags&-4097|2,Dr=!1,ii=e)}}else{if(kx(e))throw Error(Ge(418));e.flags=e.flags&-4097|2,Dr=!1,ii=e}}}function sb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ii=e}function p1(e){if(e!==ii)return!1;if(!Dr)return sb(e),Dr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!yx(e.type,e.memoizedProps)),t&&(t=ni)){if(kx(e))throw D3(),Error(Ge(418));for(;t;)I3(e,t),t=pl(t.nextSibling)}if(sb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ni=pl(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ni=null}}else ni=ii?pl(e.stateNode.nextSibling):null;return!0}function D3(){for(var e=ni;e;)e=pl(e.nextSibling)}function u0(){ni=ii=null,Dr=!1}function ry(e){Qi===null?Qi=[e]:Qi.push(e)}var CP=_o.ReactCurrentBatchConfig;function vf(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ge(309));var n=r.stateNode}if(!n)throw Error(Ge(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ge(284));if(!r._owner)throw Error(Ge(290,e))}return e}function g1(e,t){throw e=Object.prototype.toString.call(t),Error(Ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ob(e){var t=e._init;return t(e._payload)}function O3(e){function t(x,b){if(e){var w=x.deletions;w===null?(x.deletions=[b],x.flags|=16):w.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function a(x,b){return x=xl(x,b),x.index=0,x.sibling=null,x}function i(x,b,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<b?(x.flags|=2,b):w):(x.flags|=2,b)):(x.flags|=1048576,b)}function s(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,b,w,S){return b===null||b.tag!==6?(b=tv(w,x.mode,S),b.return=x,b):(b=a(b,w),b.return=x,b)}function l(x,b,w,S){var L=w.type;return L===Du?u(x,b,w.props.children,S,w.key):b!==null&&(b.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Yo&&ob(L)===b.type)?(S=a(b,w.props),S.ref=vf(x,b,w),S.return=x,S):(S=rp(w.type,w.key,w.props,null,x.mode,S),S.ref=vf(x,b,w),S.return=x,S)}function c(x,b,w,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=rv(w,x.mode,S),b.return=x,b):(b=a(b,w.children||[]),b.return=x,b)}function u(x,b,w,S,L){return b===null||b.tag!==7?(b=fc(w,x.mode,S,L),b.return=x,b):(b=a(b,w),b.return=x,b)}function f(x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=tv(""+b,x.mode,w),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case a1:return w=rp(b.type,b.key,b.props,null,x.mode,w),w.ref=vf(x,null,b),w.return=x,w;case Iu:return b=rv(b,x.mode,w),b.return=x,b;case Yo:var S=b._init;return f(x,S(b._payload),w)}if(Af(b)||df(b))return b=fc(b,x.mode,w,null),b.return=x,b;g1(x,b)}return null}function d(x,b,w,S){var L=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return L!==null?null:o(x,b,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case a1:return w.key===L?l(x,b,w,S):null;case Iu:return w.key===L?c(x,b,w,S):null;case Yo:return L=w._init,d(x,b,L(w._payload),S)}if(Af(w)||df(w))return L!==null?null:u(x,b,w,S,null);g1(x,w)}return null}function h(x,b,w,S,L){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(w)||null,o(b,x,""+S,L);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case a1:return x=x.get(S.key===null?w:S.key)||null,l(b,x,S,L);case Iu:return x=x.get(S.key===null?w:S.key)||null,c(b,x,S,L);case Yo:var j=S._init;return h(x,b,w,j(S._payload),L)}if(Af(S)||df(S))return x=x.get(w)||null,u(b,x,S,L,null);g1(b,S)}return null}function v(x,b,w,S){for(var L=null,j=null,N=b,E=b=0,P=null;N!==null&&E<w.length;E++){N.index>E?(P=N,N=null):P=N.sibling;var M=d(x,N,w[E],S);if(M===null){N===null&&(N=P);break}e&&N&&M.alternate===null&&t(x,N),b=i(M,b,E),j===null?L=M:j.sibling=M,j=M,N=P}if(E===w.length)return r(x,N),Dr&&Ql(x,E),L;if(N===null){for(;E<w.length;E++)N=f(x,w[E],S),N!==null&&(b=i(N,b,E),j===null?L=N:j.sibling=N,j=N);return Dr&&Ql(x,E),L}for(N=n(x,N);E<w.length;E++)P=h(N,x,E,w[E],S),P!==null&&(e&&P.alternate!==null&&N.delete(P.key===null?E:P.key),b=i(P,b,E),j===null?L=P:j.sibling=P,j=P);return e&&N.forEach(function(F){return t(x,F)}),Dr&&Ql(x,E),L}function m(x,b,w,S){var L=df(w);if(typeof L!="function")throw Error(Ge(150));if(w=L.call(w),w==null)throw Error(Ge(151));for(var j=L=null,N=b,E=b=0,P=null,M=w.next();N!==null&&!M.done;E++,M=w.next()){N.index>E?(P=N,N=null):P=N.sibling;var F=d(x,N,M.value,S);if(F===null){N===null&&(N=P);break}e&&N&&F.alternate===null&&t(x,N),b=i(F,b,E),j===null?L=F:j.sibling=F,j=F,N=P}if(M.done)return r(x,N),Dr&&Ql(x,E),L;if(N===null){for(;!M.done;E++,M=w.next())M=f(x,M.value,S),M!==null&&(b=i(M,b,E),j===null?L=M:j.sibling=M,j=M);return Dr&&Ql(x,E),L}for(N=n(x,N);!M.done;E++,M=w.next())M=h(N,x,E,M.value,S),M!==null&&(e&&M.alternate!==null&&N.delete(M.key===null?E:M.key),b=i(M,b,E),j===null?L=M:j.sibling=M,j=M);return e&&N.forEach(function(T){return t(x,T)}),Dr&&Ql(x,E),L}function y(x,b,w,S){if(typeof w=="object"&&w!==null&&w.type===Du&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case a1:e:{for(var L=w.key,j=b;j!==null;){if(j.key===L){if(L=w.type,L===Du){if(j.tag===7){r(x,j.sibling),b=a(j,w.props.children),b.return=x,x=b;break e}}else if(j.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Yo&&ob(L)===j.type){r(x,j.sibling),b=a(j,w.props),b.ref=vf(x,j,w),b.return=x,x=b;break e}r(x,j);break}else t(x,j);j=j.sibling}w.type===Du?(b=fc(w.props.children,x.mode,S,w.key),b.return=x,x=b):(S=rp(w.type,w.key,w.props,null,x.mode,S),S.ref=vf(x,b,w),S.return=x,x=S)}return s(x);case Iu:e:{for(j=w.key;b!==null;){if(b.key===j)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(x,b.sibling),b=a(b,w.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=rv(w,x.mode,S),b.return=x,x=b}return s(x);case Yo:return j=w._init,y(x,b,j(w._payload),S)}if(Af(w))return v(x,b,w,S);if(df(w))return m(x,b,w,S);g1(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(x,b.sibling),b=a(b,w),b.return=x,x=b):(r(x,b),b=tv(w,x.mode,S),b.return=x,x=b),s(x)):r(x,b)}return y}var f0=O3(!0),R3=O3(!1),yp=Ll(null),wp=null,Hu=null,ny=null;function ay(){ny=Hu=wp=null}function iy(e){var t=yp.current;Lr(yp),e._currentValue=t}function Ex(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Zu(e,t){wp=e,ny=Hu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Oa=!0),e.firstContext=null)}function ji(e){var t=e._currentValue;if(ny!==e)if(e={context:e,memoizedValue:t,next:null},Hu===null){if(wp===null)throw Error(Ge(308));Hu=e,wp.dependencies={lanes:0,firstContext:e}}else Hu=Hu.next=e;return t}var sc=null;function sy(e){sc===null?sc=[e]:sc.push(e)}function M3(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,sy(t)):(r.next=a.next,a.next=r),t.interleaved=r,go(e,n)}function go(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Jo=!1;function oy(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function B3(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function oo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function gl(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Qt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,go(e,r)}return a=n.interleaved,a===null?(t.next=t,sy(n)):(t.next=a.next,a.next=t),n.interleaved=t,go(e,r)}function Y1(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,q2(e,r)}}function lb(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function bp(e,t,r,n){var a=e.updateQueue;Jo=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var f=a.baseState;s=0,u=c=l=null,o=i;do{var d=o.lane,h=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,m=o;switch(d=t,h=r,m.tag){case 1:if(v=m.payload,typeof v=="function"){f=v.call(h,f,d);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,d=typeof v=="function"?v.call(h,f,d):v,d==null)break e;f=zr({},f,d);break e;case 2:Jo=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else h={eventTime:h,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=h,l=f):u=u.next=h,s|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(1);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Sc|=s,e.lanes=s,e.memoizedState=f}}function cb(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Ge(191,a));a.call(n)}}}var Jd={},Ps=Ll(Jd),xd=Ll(Jd),yd=Ll(Jd);function oc(e){if(e===Jd)throw Error(Ge(174));return e}function ly(e,t){switch(Nr(yd,t),Nr(xd,e),Nr(Ps,Jd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ix(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ix(t,e)}Lr(Ps),Nr(Ps,t)}function d0(){Lr(Ps),Lr(xd),Lr(yd)}function U3(e){oc(yd.current);var t=oc(Ps.current),r=ix(t,e.type);t!==r&&(Nr(xd,e),Nr(Ps,r))}function cy(e){xd.current===e&&(Lr(Ps),Lr(xd))}var Rr=Ll(0);function _p(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Km=[];function uy(){for(var e=0;e<Km.length;e++)Km[e]._workInProgressVersionPrimary=null;Km.length=0}var J1=_o.ReactCurrentDispatcher,Ym=_o.ReactCurrentBatchConfig,kc=0,Ur=null,wn=null,Pn=null,kp=!1,Uf=!1,wd=0,TP=0;function Xn(){throw Error(Ge(321))}function fy(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ss(e[r],t[r]))return!1;return!0}function dy(e,t,r,n,a,i){if(kc=i,Ur=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,J1.current=e===null||e.memoizedState===null?jP:IP,e=r(n,a),Uf){i=0;do{if(Uf=!1,wd=0,25<=i)throw Error(Ge(301));i+=1,Pn=wn=null,t.updateQueue=null,J1.current=DP,e=r(n,a)}while(Uf)}if(J1.current=Sp,t=wn!==null&&wn.next!==null,kc=0,Pn=wn=Ur=null,kp=!1,t)throw Error(Ge(300));return e}function hy(){var e=wd!==0;return wd=0,e}function Ss(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pn===null?Ur.memoizedState=Pn=e:Pn=Pn.next=e,Pn}function Ii(){if(wn===null){var e=Ur.alternate;e=e!==null?e.memoizedState:null}else e=wn.next;var t=Pn===null?Ur.memoizedState:Pn.next;if(t!==null)Pn=t,wn=e;else{if(e===null)throw Error(Ge(310));wn=e,e={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},Pn===null?Ur.memoizedState=Pn=e:Pn=Pn.next=e}return Pn}function bd(e,t){return typeof t=="function"?t(e):t}function Jm(e){var t=Ii(),r=t.queue;if(r===null)throw Error(Ge(311));r.lastRenderedReducer=e;var n=wn,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((kc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,s=n):l=l.next=f,Ur.lanes|=u,Sc|=u}c=c.next}while(c!==null&&c!==i);l===null?s=n:l.next=o,ss(n,t.memoizedState)||(Oa=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Ur.lanes|=i,Sc|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Zm(e){var t=Ii(),r=t.queue;if(r===null)throw Error(Ge(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);ss(i,t.memoizedState)||(Oa=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function z3(){}function W3(e,t){var r=Ur,n=Ii(),a=t(),i=!ss(n.memoizedState,a);if(i&&(n.memoizedState=a,Oa=!0),n=n.queue,py(V3.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Pn!==null&&Pn.memoizedState.tag&1){if(r.flags|=2048,_d(9,$3.bind(null,r,n,a,t),void 0,null),In===null)throw Error(Ge(349));kc&30||H3(r,t,a)}return a}function H3(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ur.updateQueue,t===null?(t={lastEffect:null,stores:null},Ur.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function $3(e,t,r,n){t.value=r,t.getSnapshot=n,q3(t)&&G3(e)}function V3(e,t,r){return r(function(){q3(t)&&G3(e)})}function q3(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ss(e,r)}catch{return!0}}function G3(e){var t=go(e,1);t!==null&&ns(t,e,1,-1)}function ub(e){var t=Ss();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bd,lastRenderedState:e},t.queue=e,e=e.dispatch=LP.bind(null,Ur,e),[t.memoizedState,e]}function _d(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ur.updateQueue,t===null?(t={lastEffect:null,stores:null},Ur.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function X3(){return Ii().memoizedState}function Z1(e,t,r,n){var a=Ss();Ur.flags|=e,a.memoizedState=_d(1|t,r,void 0,n===void 0?null:n)}function lg(e,t,r,n){var a=Ii();n=n===void 0?null:n;var i=void 0;if(wn!==null){var s=wn.memoizedState;if(i=s.destroy,n!==null&&fy(n,s.deps)){a.memoizedState=_d(t,r,i,n);return}}Ur.flags|=e,a.memoizedState=_d(1|t,r,i,n)}function fb(e,t){return Z1(8390656,8,e,t)}function py(e,t){return lg(2048,8,e,t)}function K3(e,t){return lg(4,2,e,t)}function Y3(e,t){return lg(4,4,e,t)}function J3(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Z3(e,t,r){return r=r!=null?r.concat([e]):null,lg(4,4,J3.bind(null,t,e),r)}function gy(){}function Q3(e,t){var r=Ii();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&fy(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function eS(e,t){var r=Ii();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&fy(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function tS(e,t,r){return kc&21?(ss(r,t)||(r=s3(),Ur.lanes|=r,Sc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Oa=!0),e.memoizedState=r)}function PP(e,t){var r=pr;pr=r!==0&&4>r?r:4,e(!0);var n=Ym.transition;Ym.transition={};try{e(!1),t()}finally{pr=r,Ym.transition=n}}function rS(){return Ii().memoizedState}function FP(e,t,r){var n=vl(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},nS(e))aS(t,r);else if(r=M3(e,t,r,n),r!==null){var a=ba();ns(r,e,n,a),iS(r,t,n)}}function LP(e,t,r){var n=vl(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(nS(e))aS(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,ss(o,s)){var l=t.interleaved;l===null?(a.next=a,sy(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=M3(e,t,a,n),r!==null&&(a=ba(),ns(r,e,n,a),iS(r,t,n))}}function nS(e){var t=e.alternate;return e===Ur||t!==null&&t===Ur}function aS(e,t){Uf=kp=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function iS(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,q2(e,r)}}var Sp={readContext:ji,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useInsertionEffect:Xn,useLayoutEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useMutableSource:Xn,useSyncExternalStore:Xn,useId:Xn,unstable_isNewReconciler:!1},jP={readContext:ji,useCallback:function(e,t){return Ss().memoizedState=[e,t===void 0?null:t],e},useContext:ji,useEffect:fb,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Z1(4194308,4,J3.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Z1(4194308,4,e,t)},useInsertionEffect:function(e,t){return Z1(4,2,e,t)},useMemo:function(e,t){var r=Ss();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ss();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=FP.bind(null,Ur,e),[n.memoizedState,e]},useRef:function(e){var t=Ss();return e={current:e},t.memoizedState=e},useState:ub,useDebugValue:gy,useDeferredValue:function(e){return Ss().memoizedState=e},useTransition:function(){var e=ub(!1),t=e[0];return e=PP.bind(null,e[1]),Ss().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ur,a=Ss();if(Dr){if(r===void 0)throw Error(Ge(407));r=r()}else{if(r=t(),In===null)throw Error(Ge(349));kc&30||H3(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,fb(V3.bind(null,n,i,e),[e]),n.flags|=2048,_d(9,$3.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Ss(),t=In.identifierPrefix;if(Dr){var r=io,n=ao;r=(n&~(1<<32-rs(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=wd++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=TP++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},IP={readContext:ji,useCallback:Q3,useContext:ji,useEffect:py,useImperativeHandle:Z3,useInsertionEffect:K3,useLayoutEffect:Y3,useMemo:eS,useReducer:Jm,useRef:X3,useState:function(){return Jm(bd)},useDebugValue:gy,useDeferredValue:function(e){var t=Ii();return tS(t,wn.memoizedState,e)},useTransition:function(){var e=Jm(bd)[0],t=Ii().memoizedState;return[e,t]},useMutableSource:z3,useSyncExternalStore:W3,useId:rS,unstable_isNewReconciler:!1},DP={readContext:ji,useCallback:Q3,useContext:ji,useEffect:py,useImperativeHandle:Z3,useInsertionEffect:K3,useLayoutEffect:Y3,useMemo:eS,useReducer:Zm,useRef:X3,useState:function(){return Zm(bd)},useDebugValue:gy,useDeferredValue:function(e){var t=Ii();return wn===null?t.memoizedState=e:tS(t,wn.memoizedState,e)},useTransition:function(){var e=Zm(bd)[0],t=Ii().memoizedState;return[e,t]},useMutableSource:z3,useSyncExternalStore:W3,useId:rS,unstable_isNewReconciler:!1};function Ki(e,t){if(e&&e.defaultProps){t=zr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Nx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:zr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var cg={isMounted:function(e){return(e=e._reactInternals)?Ic(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ba(),a=vl(e),i=oo(n,a);i.payload=t,r!=null&&(i.callback=r),t=gl(e,i,a),t!==null&&(ns(t,e,a,n),Y1(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ba(),a=vl(e),i=oo(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=gl(e,i,a),t!==null&&(ns(t,e,a,n),Y1(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ba(),n=vl(e),a=oo(r,n);a.tag=2,t!=null&&(a.callback=t),t=gl(e,a,n),t!==null&&(ns(t,e,n,r),Y1(t,e,n))}};function db(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!pd(r,n)||!pd(a,i):!0}function sS(e,t,r){var n=!1,a=bl,i=t.contextType;return typeof i=="object"&&i!==null?i=ji(i):(a=Ma(t)?bc:la.current,n=t.contextTypes,i=(n=n!=null)?c0(e,a):bl),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=cg,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function hb(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&cg.enqueueReplaceState(t,t.state,null)}function Ax(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},oy(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=ji(i):(i=Ma(t)?bc:la.current,a.context=c0(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Nx(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&cg.enqueueReplaceState(a,a.state,null),bp(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function h0(e,t){try{var r="",n=t;do r+=cT(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Qm(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Cx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var OP=typeof WeakMap=="function"?WeakMap:Map;function oS(e,t,r){r=oo(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Np||(Np=!0,Mx=n),Cx(e,t)},r}function lS(e,t,r){r=oo(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Cx(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Cx(e,t),typeof n!="function"&&(ml===null?ml=new Set([this]):ml.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function pb(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new OP;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=YP.bind(null,e,t,r),t.then(e,e))}function gb(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function mb(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=oo(-1,1),t.tag=2,gl(r,t,1))),r.lanes|=1),e)}var RP=_o.ReactCurrentOwner,Oa=!1;function ma(e,t,r,n){t.child=e===null?R3(t,null,r,n):f0(t,e.child,r,n)}function vb(e,t,r,n,a){r=r.render;var i=t.ref;return Zu(t,a),n=dy(e,t,r,n,i,a),r=hy(),e!==null&&!Oa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,mo(e,t,a)):(Dr&&r&&ey(t),t.flags|=1,ma(e,t,n,a),t.child)}function xb(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!ky(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,cS(e,t,i,n,a)):(e=rp(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:pd,r(s,n)&&e.ref===t.ref)return mo(e,t,a)}return t.flags|=1,e=xl(i,n),e.ref=t.ref,e.return=t,t.child=e}function cS(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(pd(i,n)&&e.ref===t.ref)if(Oa=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Oa=!0);else return t.lanes=e.lanes,mo(e,t,a)}return Tx(e,t,r,n,a)}function uS(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nr(Vu,Ja),Ja|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Nr(Vu,Ja),Ja|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Nr(Vu,Ja),Ja|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Nr(Vu,Ja),Ja|=n;return ma(e,t,a,r),t.child}function fS(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Tx(e,t,r,n,a){var i=Ma(r)?bc:la.current;return i=c0(t,i),Zu(t,a),r=dy(e,t,r,n,i,a),n=hy(),e!==null&&!Oa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,mo(e,t,a)):(Dr&&n&&ey(t),t.flags|=1,ma(e,t,r,a),t.child)}function yb(e,t,r,n,a){if(Ma(r)){var i=!0;mp(t)}else i=!1;if(Zu(t,a),t.stateNode===null)Q1(e,t),sS(t,r,n),Ax(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=ji(c):(c=Ma(r)?bc:la.current,c=c0(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&hb(t,s,n,c),Jo=!1;var d=t.memoizedState;s.state=d,bp(t,n,s,a),l=t.memoizedState,o!==n||d!==l||Ra.current||Jo?(typeof u=="function"&&(Nx(t,r,u,n),l=t.memoizedState),(o=Jo||db(t,r,o,n,d,l,c))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,B3(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Ki(t.type,o),s.props=c,f=t.pendingProps,d=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=ji(l):(l=Ma(r)?bc:la.current,l=c0(t,l));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||d!==l)&&hb(t,s,n,l),Jo=!1,d=t.memoizedState,s.state=d,bp(t,n,s,a);var v=t.memoizedState;o!==f||d!==v||Ra.current||Jo?(typeof h=="function"&&(Nx(t,r,h,n),v=t.memoizedState),(c=Jo||db(t,r,c,n,d,v,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,v,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,v,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),s.props=n,s.state=v,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return Px(e,t,r,n,i,a)}function Px(e,t,r,n,a,i){fS(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&ab(t,r,!1),mo(e,t,i);n=t.stateNode,RP.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=f0(t,e.child,null,i),t.child=f0(t,null,o,i)):ma(e,t,o,i),t.memoizedState=n.state,a&&ab(t,r,!0),t.child}function dS(e){var t=e.stateNode;t.pendingContext?nb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&nb(e,t.context,!1),ly(e,t.containerInfo)}function wb(e,t,r,n,a){return u0(),ry(a),t.flags|=256,ma(e,t,r,n),t.child}var Fx={dehydrated:null,treeContext:null,retryLane:0};function Lx(e){return{baseLanes:e,cachePool:null,transitions:null}}function hS(e,t,r){var n=t.pendingProps,a=Rr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Nr(Rr,a&1),e===null)return Sx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=dg(s,n,0,null),e=fc(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Lx(r),t.memoizedState=Fx,e):my(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return MP(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=xl(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=xl(o,i):(i=fc(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?Lx(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=Fx,n}return i=e.child,e=i.sibling,n=xl(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function my(e,t){return t=dg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function m1(e,t,r,n){return n!==null&&ry(n),f0(t,e.child,null,r),e=my(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function MP(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=Qm(Error(Ge(422))),m1(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=dg({mode:"visible",children:n.children},a,0,null),i=fc(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&f0(t,e.child,null,s),t.child.memoizedState=Lx(s),t.memoizedState=Fx,i);if(!(t.mode&1))return m1(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Ge(419)),n=Qm(i,n,void 0),m1(e,t,s,n)}if(o=(s&e.childLanes)!==0,Oa||o){if(n=In,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,go(e,a),ns(n,e,a,-1))}return _y(),n=Qm(Error(Ge(421))),m1(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=JP.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ni=pl(a.nextSibling),ii=t,Dr=!0,Qi=null,e!==null&&(Ai[Ci++]=ao,Ai[Ci++]=io,Ai[Ci++]=_c,ao=e.id,io=e.overflow,_c=t),t=my(t,n.children),t.flags|=4096,t)}function bb(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ex(e.return,t,r)}function ev(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function pS(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(ma(e,t,n.children,r),n=Rr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&bb(e,r,t);else if(e.tag===19)bb(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Nr(Rr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&_p(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),ev(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&_p(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}ev(t,!0,r,null,i);break;case"together":ev(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Q1(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function mo(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Sc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ge(153));if(t.child!==null){for(e=t.child,r=xl(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=xl(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function BP(e,t,r){switch(t.tag){case 3:dS(t),u0();break;case 5:U3(t);break;case 1:Ma(t.type)&&mp(t);break;case 4:ly(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Nr(yp,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Nr(Rr,Rr.current&1),t.flags|=128,null):r&t.child.childLanes?hS(e,t,r):(Nr(Rr,Rr.current&1),e=mo(e,t,r),e!==null?e.sibling:null);Nr(Rr,Rr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return pS(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Nr(Rr,Rr.current),n)break;return null;case 22:case 23:return t.lanes=0,uS(e,t,r)}return mo(e,t,r)}var gS,jx,mS,vS;gS=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};jx=function(){};mS=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,oc(Ps.current);var i=null;switch(r){case"input":a=tx(e,a),n=tx(e,n),i=[];break;case"select":a=zr({},a,{value:void 0}),n=zr({},n,{value:void 0}),i=[];break;case"textarea":a=ax(e,a),n=ax(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=pp)}sx(r,n);var s;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(od.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(od.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Tr("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};vS=function(e,t,r,n){r!==n&&(t.flags|=4)};function xf(e,t){if(!Dr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Kn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function UP(e,t,r){var n=t.pendingProps;switch(ty(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kn(t),null;case 1:return Ma(t.type)&&gp(),Kn(t),null;case 3:return n=t.stateNode,d0(),Lr(Ra),Lr(la),uy(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(p1(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Qi!==null&&(zx(Qi),Qi=null))),jx(e,t),Kn(t),null;case 5:cy(t);var a=oc(yd.current);if(r=t.type,e!==null&&t.stateNode!=null)mS(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ge(166));return Kn(t),null}if(e=oc(Ps.current),p1(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Ns]=t,n[vd]=i,e=(t.mode&1)!==0,r){case"dialog":Tr("cancel",n),Tr("close",n);break;case"iframe":case"object":case"embed":Tr("load",n);break;case"video":case"audio":for(a=0;a<Tf.length;a++)Tr(Tf[a],n);break;case"source":Tr("error",n);break;case"img":case"image":case"link":Tr("error",n),Tr("load",n);break;case"details":Tr("toggle",n);break;case"input":P5(n,i),Tr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Tr("invalid",n);break;case"textarea":L5(n,i),Tr("invalid",n)}sx(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&h1(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&h1(n.textContent,o,e),a=["children",""+o]):od.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Tr("scroll",n)}switch(r){case"input":i1(n),F5(n,i,!0);break;case"textarea":i1(n),j5(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=pp)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Vk(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Ns]=t,e[vd]=n,gS(e,t,!1,!1),t.stateNode=e;e:{switch(s=ox(r,n),r){case"dialog":Tr("cancel",e),Tr("close",e),a=n;break;case"iframe":case"object":case"embed":Tr("load",e),a=n;break;case"video":case"audio":for(a=0;a<Tf.length;a++)Tr(Tf[a],e);a=n;break;case"source":Tr("error",e),a=n;break;case"img":case"image":case"link":Tr("error",e),Tr("load",e),a=n;break;case"details":Tr("toggle",e),a=n;break;case"input":P5(e,n),a=tx(e,n),Tr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=zr({},n,{value:void 0}),Tr("invalid",e);break;case"textarea":L5(e,n),a=ax(e,n),Tr("invalid",e);break;default:a=n}sx(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?Xk(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&qk(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ld(e,l):typeof l=="number"&&ld(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(od.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Tr("scroll",e):l!=null&&U2(e,i,l,s))}switch(r){case"input":i1(e),F5(e,n,!1);break;case"textarea":i1(e),j5(e);break;case"option":n.value!=null&&e.setAttribute("value",""+wl(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Xu(e,!!n.multiple,i,!1):n.defaultValue!=null&&Xu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=pp)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Kn(t),null;case 6:if(e&&t.stateNode!=null)vS(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ge(166));if(r=oc(yd.current),oc(Ps.current),p1(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ns]=t,(i=n.nodeValue!==r)&&(e=ii,e!==null))switch(e.tag){case 3:h1(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&h1(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ns]=t,t.stateNode=n}return Kn(t),null;case 13:if(Lr(Rr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Dr&&ni!==null&&t.mode&1&&!(t.flags&128))D3(),u0(),t.flags|=98560,i=!1;else if(i=p1(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Ge(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ge(317));i[Ns]=t}else u0(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Kn(t),i=!1}else Qi!==null&&(zx(Qi),Qi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Rr.current&1?kn===0&&(kn=3):_y())),t.updateQueue!==null&&(t.flags|=4),Kn(t),null);case 4:return d0(),jx(e,t),e===null&&gd(t.stateNode.containerInfo),Kn(t),null;case 10:return iy(t.type._context),Kn(t),null;case 17:return Ma(t.type)&&gp(),Kn(t),null;case 19:if(Lr(Rr),i=t.memoizedState,i===null)return Kn(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)xf(i,!1);else{if(kn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=_p(e),s!==null){for(t.flags|=128,xf(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Nr(Rr,Rr.current&1|2),t.child}e=e.sibling}i.tail!==null&&tn()>p0&&(t.flags|=128,n=!0,xf(i,!1),t.lanes=4194304)}else{if(!n)if(e=_p(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),xf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!Dr)return Kn(t),null}else 2*tn()-i.renderingStartTime>p0&&r!==1073741824&&(t.flags|=128,n=!0,xf(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=tn(),t.sibling=null,r=Rr.current,Nr(Rr,n?r&1|2:r&1),t):(Kn(t),null);case 22:case 23:return by(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ja&1073741824&&(Kn(t),t.subtreeFlags&6&&(t.flags|=8192)):Kn(t),null;case 24:return null;case 25:return null}throw Error(Ge(156,t.tag))}function zP(e,t){switch(ty(t),t.tag){case 1:return Ma(t.type)&&gp(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return d0(),Lr(Ra),Lr(la),uy(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return cy(t),null;case 13:if(Lr(Rr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ge(340));u0()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Lr(Rr),null;case 4:return d0(),null;case 10:return iy(t.type._context),null;case 22:case 23:return by(),null;case 24:return null;default:return null}}var v1=!1,na=!1,WP=typeof WeakSet=="function"?WeakSet:Set,ft=null;function $u(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){qr(e,t,n)}else r.current=null}function Ix(e,t,r){try{r()}catch(n){qr(e,t,n)}}var _b=!1;function HP(e,t){if(vx=fp,e=_3(),Q2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,f=e,d=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(o=s+a),f!==i||n!==0&&f.nodeType!==3||(l=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===r&&++c===a&&(o=s),d===i&&++u===n&&(l=s),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(xx={focusedElem:e,selectionRange:r},fp=!1,ft=t;ft!==null;)if(t=ft,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ft=e;else for(;ft!==null;){t=ft;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,y=v.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ki(t.type,m),y);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ge(163))}}catch(S){qr(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,ft=e;break}ft=t.return}return v=_b,_b=!1,v}function zf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Ix(t,r,i)}a=a.next}while(a!==n)}}function ug(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Dx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function xS(e){var t=e.alternate;t!==null&&(e.alternate=null,xS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ns],delete t[vd],delete t[bx],delete t[EP],delete t[NP])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function yS(e){return e.tag===5||e.tag===3||e.tag===4}function kb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||yS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ox(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=pp));else if(n!==4&&(e=e.child,e!==null))for(Ox(e,t,r),e=e.sibling;e!==null;)Ox(e,t,r),e=e.sibling}function Rx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Rx(e,t,r),e=e.sibling;e!==null;)Rx(e,t,r),e=e.sibling}var Bn=null,Ji=!1;function zo(e,t,r){for(r=r.child;r!==null;)wS(e,t,r),r=r.sibling}function wS(e,t,r){if(Ts&&typeof Ts.onCommitFiberUnmount=="function")try{Ts.onCommitFiberUnmount(rg,r)}catch{}switch(r.tag){case 5:na||$u(r,t);case 6:var n=Bn,a=Ji;Bn=null,zo(e,t,r),Bn=n,Ji=a,Bn!==null&&(Ji?(e=Bn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Bn.removeChild(r.stateNode));break;case 18:Bn!==null&&(Ji?(e=Bn,r=r.stateNode,e.nodeType===8?Gm(e.parentNode,r):e.nodeType===1&&Gm(e,r),dd(e)):Gm(Bn,r.stateNode));break;case 4:n=Bn,a=Ji,Bn=r.stateNode.containerInfo,Ji=!0,zo(e,t,r),Bn=n,Ji=a;break;case 0:case 11:case 14:case 15:if(!na&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Ix(r,t,s),a=a.next}while(a!==n)}zo(e,t,r);break;case 1:if(!na&&($u(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){qr(r,t,o)}zo(e,t,r);break;case 21:zo(e,t,r);break;case 22:r.mode&1?(na=(n=na)||r.memoizedState!==null,zo(e,t,r),na=n):zo(e,t,r);break;default:zo(e,t,r)}}function Sb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new WP),t.forEach(function(n){var a=ZP.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Vi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Bn=o.stateNode,Ji=!1;break e;case 3:Bn=o.stateNode.containerInfo,Ji=!0;break e;case 4:Bn=o.stateNode.containerInfo,Ji=!0;break e}o=o.return}if(Bn===null)throw Error(Ge(160));wS(i,s,a),Bn=null,Ji=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){qr(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)bS(t,e),t=t.sibling}function bS(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Vi(t,e),xs(e),n&4){try{zf(3,e,e.return),ug(3,e)}catch(m){qr(e,e.return,m)}try{zf(5,e,e.return)}catch(m){qr(e,e.return,m)}}break;case 1:Vi(t,e),xs(e),n&512&&r!==null&&$u(r,r.return);break;case 5:if(Vi(t,e),xs(e),n&512&&r!==null&&$u(r,r.return),e.flags&32){var a=e.stateNode;try{ld(a,"")}catch(m){qr(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&Hk(a,i),ox(o,s);var c=ox(o,i);for(s=0;s<l.length;s+=2){var u=l[s],f=l[s+1];u==="style"?Xk(a,f):u==="dangerouslySetInnerHTML"?qk(a,f):u==="children"?ld(a,f):U2(a,u,f,c)}switch(o){case"input":rx(a,i);break;case"textarea":$k(a,i);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Xu(a,!!i.multiple,h,!1):d!==!!i.multiple&&(i.defaultValue!=null?Xu(a,!!i.multiple,i.defaultValue,!0):Xu(a,!!i.multiple,i.multiple?[]:"",!1))}a[vd]=i}catch(m){qr(e,e.return,m)}}break;case 6:if(Vi(t,e),xs(e),n&4){if(e.stateNode===null)throw Error(Ge(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(m){qr(e,e.return,m)}}break;case 3:if(Vi(t,e),xs(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{dd(t.containerInfo)}catch(m){qr(e,e.return,m)}break;case 4:Vi(t,e),xs(e);break;case 13:Vi(t,e),xs(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(yy=tn())),n&4&&Sb(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(na=(c=na)||u,Vi(t,e),na=c):Vi(t,e),xs(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(ft=e,u=e.child;u!==null;){for(f=ft=u;ft!==null;){switch(d=ft,h=d.child,d.tag){case 0:case 11:case 14:case 15:zf(4,d,d.return);break;case 1:$u(d,d.return);var v=d.stateNode;if(typeof v.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){qr(n,r,m)}}break;case 5:$u(d,d.return);break;case 22:if(d.memoizedState!==null){Nb(f);continue}}h!==null?(h.return=d,ft=h):Nb(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Gk("display",s))}catch(m){qr(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){qr(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Vi(t,e),xs(e),n&4&&Sb(e);break;case 21:break;default:Vi(t,e),xs(e)}}function xs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(yS(r)){var n=r;break e}r=r.return}throw Error(Ge(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(ld(a,""),n.flags&=-33);var i=kb(e);Rx(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=kb(e);Ox(e,o,s);break;default:throw Error(Ge(161))}}catch(l){qr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $P(e,t,r){ft=e,_S(e)}function _S(e,t,r){for(var n=(e.mode&1)!==0;ft!==null;){var a=ft,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||v1;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||na;o=v1;var c=na;if(v1=s,(na=l)&&!c)for(ft=a;ft!==null;)s=ft,l=s.child,s.tag===22&&s.memoizedState!==null?Ab(a):l!==null?(l.return=s,ft=l):Ab(a);for(;i!==null;)ft=i,_S(i),i=i.sibling;ft=a,v1=o,na=c}Eb(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,ft=i):Eb(e)}}function Eb(e){for(;ft!==null;){var t=ft;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:na||ug(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!na)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Ki(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&cb(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}cb(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&dd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ge(163))}na||t.flags&512&&Dx(t)}catch(d){qr(t,t.return,d)}}if(t===e){ft=null;break}if(r=t.sibling,r!==null){r.return=t.return,ft=r;break}ft=t.return}}function Nb(e){for(;ft!==null;){var t=ft;if(t===e){ft=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ft=r;break}ft=t.return}}function Ab(e){for(;ft!==null;){var t=ft;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ug(4,t)}catch(l){qr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){qr(t,a,l)}}var i=t.return;try{Dx(t)}catch(l){qr(t,i,l)}break;case 5:var s=t.return;try{Dx(t)}catch(l){qr(t,s,l)}}}catch(l){qr(t,t.return,l)}if(t===e){ft=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ft=o;break}ft=t.return}}var VP=Math.ceil,Ep=_o.ReactCurrentDispatcher,vy=_o.ReactCurrentOwner,Pi=_o.ReactCurrentBatchConfig,Qt=0,In=null,gn=null,Wn=0,Ja=0,Vu=Ll(0),kn=0,kd=null,Sc=0,fg=0,xy=0,Wf=null,Ia=null,yy=0,p0=1/0,to=null,Np=!1,Mx=null,ml=null,x1=!1,sl=null,Ap=0,Hf=0,Bx=null,ep=-1,tp=0;function ba(){return Qt&6?tn():ep!==-1?ep:ep=tn()}function vl(e){return e.mode&1?Qt&2&&Wn!==0?Wn&-Wn:CP.transition!==null?(tp===0&&(tp=s3()),tp):(e=pr,e!==0||(e=window.event,e=e===void 0?16:h3(e.type)),e):1}function ns(e,t,r,n){if(50<Hf)throw Hf=0,Bx=null,Error(Ge(185));Xd(e,r,n),(!(Qt&2)||e!==In)&&(e===In&&(!(Qt&2)&&(fg|=r),kn===4&&el(e,Wn)),Ba(e,n),r===1&&Qt===0&&!(t.mode&1)&&(p0=tn()+500,og&&jl()))}function Ba(e,t){var r=e.callbackNode;CT(e,t);var n=up(e,e===In?Wn:0);if(n===0)r!==null&&O5(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&O5(r),t===1)e.tag===0?AP(Cb.bind(null,e)):L3(Cb.bind(null,e)),kP(function(){!(Qt&6)&&jl()}),r=null;else{switch(o3(n)){case 1:r=V2;break;case 4:r=a3;break;case 16:r=cp;break;case 536870912:r=i3;break;default:r=cp}r=PS(r,kS.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function kS(e,t){if(ep=-1,tp=0,Qt&6)throw Error(Ge(327));var r=e.callbackNode;if(Qu()&&e.callbackNode!==r)return null;var n=up(e,e===In?Wn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Cp(e,n);else{t=n;var a=Qt;Qt|=2;var i=ES();(In!==e||Wn!==t)&&(to=null,p0=tn()+500,uc(e,t));do try{XP();break}catch(o){SS(e,o)}while(1);ay(),Ep.current=i,Qt=a,gn!==null?t=0:(In=null,Wn=0,t=kn)}if(t!==0){if(t===2&&(a=dx(e),a!==0&&(n=a,t=Ux(e,a))),t===1)throw r=kd,uc(e,0),el(e,n),Ba(e,tn()),r;if(t===6)el(e,n);else{if(a=e.current.alternate,!(n&30)&&!qP(a)&&(t=Cp(e,n),t===2&&(i=dx(e),i!==0&&(n=i,t=Ux(e,i))),t===1))throw r=kd,uc(e,0),el(e,n),Ba(e,tn()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Ge(345));case 2:ec(e,Ia,to);break;case 3:if(el(e,n),(n&130023424)===n&&(t=yy+500-tn(),10<t)){if(up(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){ba(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=wx(ec.bind(null,e,Ia,to),t);break}ec(e,Ia,to);break;case 4:if(el(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-rs(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=tn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*VP(n/1960))-n,10<n){e.timeoutHandle=wx(ec.bind(null,e,Ia,to),n);break}ec(e,Ia,to);break;case 5:ec(e,Ia,to);break;default:throw Error(Ge(329))}}}return Ba(e,tn()),e.callbackNode===r?kS.bind(null,e):null}function Ux(e,t){var r=Wf;return e.current.memoizedState.isDehydrated&&(uc(e,t).flags|=256),e=Cp(e,t),e!==2&&(t=Ia,Ia=r,t!==null&&zx(t)),e}function zx(e){Ia===null?Ia=e:Ia.push.apply(Ia,e)}function qP(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!ss(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function el(e,t){for(t&=~xy,t&=~fg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-rs(t),n=1<<r;e[r]=-1,t&=~n}}function Cb(e){if(Qt&6)throw Error(Ge(327));Qu();var t=up(e,0);if(!(t&1))return Ba(e,tn()),null;var r=Cp(e,t);if(e.tag!==0&&r===2){var n=dx(e);n!==0&&(t=n,r=Ux(e,n))}if(r===1)throw r=kd,uc(e,0),el(e,t),Ba(e,tn()),r;if(r===6)throw Error(Ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ec(e,Ia,to),Ba(e,tn()),null}function wy(e,t){var r=Qt;Qt|=1;try{return e(t)}finally{Qt=r,Qt===0&&(p0=tn()+500,og&&jl())}}function Ec(e){sl!==null&&sl.tag===0&&!(Qt&6)&&Qu();var t=Qt;Qt|=1;var r=Pi.transition,n=pr;try{if(Pi.transition=null,pr=1,e)return e()}finally{pr=n,Pi.transition=r,Qt=t,!(Qt&6)&&jl()}}function by(){Ja=Vu.current,Lr(Vu)}function uc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,_P(r)),gn!==null)for(r=gn.return;r!==null;){var n=r;switch(ty(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&gp();break;case 3:d0(),Lr(Ra),Lr(la),uy();break;case 5:cy(n);break;case 4:d0();break;case 13:Lr(Rr);break;case 19:Lr(Rr);break;case 10:iy(n.type._context);break;case 22:case 23:by()}r=r.return}if(In=e,gn=e=xl(e.current,null),Wn=Ja=t,kn=0,kd=null,xy=fg=Sc=0,Ia=Wf=null,sc!==null){for(t=0;t<sc.length;t++)if(r=sc[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}sc=null}return e}function SS(e,t){do{var r=gn;try{if(ay(),J1.current=Sp,kp){for(var n=Ur.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}kp=!1}if(kc=0,Pn=wn=Ur=null,Uf=!1,wd=0,vy.current=null,r===null||r.return===null){kn=1,kd=t,gn=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=Wn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=gb(s);if(h!==null){h.flags&=-257,mb(h,s,o,i,t),h.mode&1&&pb(i,c,t),t=h,l=c;var v=t.updateQueue;if(v===null){var m=new Set;m.add(l),t.updateQueue=m}else v.add(l);break e}else{if(!(t&1)){pb(i,c,t),_y();break e}l=Error(Ge(426))}}else if(Dr&&o.mode&1){var y=gb(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),mb(y,s,o,i,t),ry(h0(l,o));break e}}i=l=h0(l,o),kn!==4&&(kn=2),Wf===null?Wf=[i]:Wf.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=oS(i,l,t);lb(i,x);break e;case 1:o=l;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ml===null||!ml.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=lS(i,o,t);lb(i,S);break e}}i=i.return}while(i!==null)}AS(r)}catch(L){t=L,gn===r&&r!==null&&(gn=r=r.return);continue}break}while(1)}function ES(){var e=Ep.current;return Ep.current=Sp,e===null?Sp:e}function _y(){(kn===0||kn===3||kn===2)&&(kn=4),In===null||!(Sc&268435455)&&!(fg&268435455)||el(In,Wn)}function Cp(e,t){var r=Qt;Qt|=2;var n=ES();(In!==e||Wn!==t)&&(to=null,uc(e,t));do try{GP();break}catch(a){SS(e,a)}while(1);if(ay(),Qt=r,Ep.current=n,gn!==null)throw Error(Ge(261));return In=null,Wn=0,kn}function GP(){for(;gn!==null;)NS(gn)}function XP(){for(;gn!==null&&!yT();)NS(gn)}function NS(e){var t=TS(e.alternate,e,Ja);e.memoizedProps=e.pendingProps,t===null?AS(e):gn=t,vy.current=null}function AS(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=zP(r,t),r!==null){r.flags&=32767,gn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{kn=6,gn=null;return}}else if(r=UP(r,t,Ja),r!==null){gn=r;return}if(t=t.sibling,t!==null){gn=t;return}gn=t=e}while(t!==null);kn===0&&(kn=5)}function ec(e,t,r){var n=pr,a=Pi.transition;try{Pi.transition=null,pr=1,KP(e,t,r,n)}finally{Pi.transition=a,pr=n}return null}function KP(e,t,r,n){do Qu();while(sl!==null);if(Qt&6)throw Error(Ge(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ge(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(TT(e,i),e===In&&(gn=In=null,Wn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||x1||(x1=!0,PS(cp,function(){return Qu(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Pi.transition,Pi.transition=null;var s=pr;pr=1;var o=Qt;Qt|=4,vy.current=null,HP(e,r),bS(r,e),gP(xx),fp=!!vx,xx=vx=null,e.current=r,$P(r),wT(),Qt=o,pr=s,Pi.transition=i}else e.current=r;if(x1&&(x1=!1,sl=e,Ap=a),i=e.pendingLanes,i===0&&(ml=null),kT(r.stateNode),Ba(e,tn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Np)throw Np=!1,e=Mx,Mx=null,e;return Ap&1&&e.tag!==0&&Qu(),i=e.pendingLanes,i&1?e===Bx?Hf++:(Hf=0,Bx=e):Hf=0,jl(),null}function Qu(){if(sl!==null){var e=o3(Ap),t=Pi.transition,r=pr;try{if(Pi.transition=null,pr=16>e?16:e,sl===null)var n=!1;else{if(e=sl,sl=null,Ap=0,Qt&6)throw Error(Ge(331));var a=Qt;for(Qt|=4,ft=e.current;ft!==null;){var i=ft,s=i.child;if(ft.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(ft=c;ft!==null;){var u=ft;switch(u.tag){case 0:case 11:case 15:zf(8,u,i)}var f=u.child;if(f!==null)f.return=u,ft=f;else for(;ft!==null;){u=ft;var d=u.sibling,h=u.return;if(xS(u),u===c){ft=null;break}if(d!==null){d.return=h,ft=d;break}ft=h}}}var v=i.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}ft=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,ft=s;else e:for(;ft!==null;){if(i=ft,i.flags&2048)switch(i.tag){case 0:case 11:case 15:zf(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,ft=x;break e}ft=i.return}}var b=e.current;for(ft=b;ft!==null;){s=ft;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,ft=w;else e:for(s=b;ft!==null;){if(o=ft,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ug(9,o)}}catch(L){qr(o,o.return,L)}if(o===s){ft=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,ft=S;break e}ft=o.return}}if(Qt=a,jl(),Ts&&typeof Ts.onPostCommitFiberRoot=="function")try{Ts.onPostCommitFiberRoot(rg,e)}catch{}n=!0}return n}finally{pr=r,Pi.transition=t}}return!1}function Tb(e,t,r){t=h0(r,t),t=oS(e,t,1),e=gl(e,t,1),t=ba(),e!==null&&(Xd(e,1,t),Ba(e,t))}function qr(e,t,r){if(e.tag===3)Tb(e,e,r);else for(;t!==null;){if(t.tag===3){Tb(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ml===null||!ml.has(n))){e=h0(r,e),e=lS(t,e,1),t=gl(t,e,1),e=ba(),t!==null&&(Xd(t,1,e),Ba(t,e));break}}t=t.return}}function YP(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ba(),e.pingedLanes|=e.suspendedLanes&r,In===e&&(Wn&r)===r&&(kn===4||kn===3&&(Wn&130023424)===Wn&&500>tn()-yy?uc(e,0):xy|=r),Ba(e,t)}function CS(e,t){t===0&&(e.mode&1?(t=l1,l1<<=1,!(l1&130023424)&&(l1=4194304)):t=1);var r=ba();e=go(e,t),e!==null&&(Xd(e,t,r),Ba(e,r))}function JP(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),CS(e,r)}function ZP(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ge(314))}n!==null&&n.delete(t),CS(e,r)}var TS;TS=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ra.current)Oa=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Oa=!1,BP(e,t,r);Oa=!!(e.flags&131072)}else Oa=!1,Dr&&t.flags&1048576&&j3(t,xp,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Q1(e,t),e=t.pendingProps;var a=c0(t,la.current);Zu(t,r),a=dy(null,t,n,e,a,r);var i=hy();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ma(n)?(i=!0,mp(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,oy(t),a.updater=cg,t.stateNode=a,a._reactInternals=t,Ax(t,n,e,r),t=Px(null,t,n,!0,i,r)):(t.tag=0,Dr&&i&&ey(t),ma(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Q1(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=e7(n),e=Ki(n,e),a){case 0:t=Tx(null,t,n,e,r);break e;case 1:t=yb(null,t,n,e,r);break e;case 11:t=vb(null,t,n,e,r);break e;case 14:t=xb(null,t,n,Ki(n.type,e),r);break e}throw Error(Ge(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ki(n,a),Tx(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ki(n,a),yb(e,t,n,a,r);case 3:e:{if(dS(t),e===null)throw Error(Ge(387));n=t.pendingProps,i=t.memoizedState,a=i.element,B3(e,t),bp(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=h0(Error(Ge(423)),t),t=wb(e,t,n,r,a);break e}else if(n!==a){a=h0(Error(Ge(424)),t),t=wb(e,t,n,r,a);break e}else for(ni=pl(t.stateNode.containerInfo.firstChild),ii=t,Dr=!0,Qi=null,r=R3(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(u0(),n===a){t=mo(e,t,r);break e}ma(e,t,n,r)}t=t.child}return t;case 5:return U3(t),e===null&&Sx(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,yx(n,a)?s=null:i!==null&&yx(n,i)&&(t.flags|=32),fS(e,t),ma(e,t,s,r),t.child;case 6:return e===null&&Sx(t),null;case 13:return hS(e,t,r);case 4:return ly(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=f0(t,null,n,r):ma(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ki(n,a),vb(e,t,n,a,r);case 7:return ma(e,t,t.pendingProps,r),t.child;case 8:return ma(e,t,t.pendingProps.children,r),t.child;case 12:return ma(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,Nr(yp,n._currentValue),n._currentValue=s,i!==null)if(ss(i.value,s)){if(i.children===a.children&&!Ra.current){t=mo(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=oo(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Ex(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(Ge(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Ex(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}ma(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Zu(t,r),a=ji(a),n=n(a),t.flags|=1,ma(e,t,n,r),t.child;case 14:return n=t.type,a=Ki(n,t.pendingProps),a=Ki(n.type,a),xb(e,t,n,a,r);case 15:return cS(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ki(n,a),Q1(e,t),t.tag=1,Ma(n)?(e=!0,mp(t)):e=!1,Zu(t,r),sS(t,n,a),Ax(t,n,a,r),Px(null,t,n,!0,e,r);case 19:return pS(e,t,r);case 22:return uS(e,t,r)}throw Error(Ge(156,t.tag))};function PS(e,t){return n3(e,t)}function QP(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ti(e,t,r,n){return new QP(e,t,r,n)}function ky(e){return e=e.prototype,!(!e||!e.isReactComponent)}function e7(e){if(typeof e=="function")return ky(e)?1:0;if(e!=null){if(e=e.$$typeof,e===W2)return 11;if(e===H2)return 14}return 2}function xl(e,t){var r=e.alternate;return r===null?(r=Ti(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function rp(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")ky(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Du:return fc(r.children,a,i,t);case z2:s=8,a|=8;break;case Jv:return e=Ti(12,r,t,a|2),e.elementType=Jv,e.lanes=i,e;case Zv:return e=Ti(13,r,t,a),e.elementType=Zv,e.lanes=i,e;case Qv:return e=Ti(19,r,t,a),e.elementType=Qv,e.lanes=i,e;case Uk:return dg(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Mk:s=10;break e;case Bk:s=9;break e;case W2:s=11;break e;case H2:s=14;break e;case Yo:s=16,n=null;break e}throw Error(Ge(130,e==null?e:typeof e,""))}return t=Ti(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function fc(e,t,r,n){return e=Ti(7,e,n,t),e.lanes=r,e}function dg(e,t,r,n){return e=Ti(22,e,n,t),e.elementType=Uk,e.lanes=r,e.stateNode={isHidden:!1},e}function tv(e,t,r){return e=Ti(6,e,null,t),e.lanes=r,e}function rv(e,t,r){return t=Ti(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function t7(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Om(0),this.expirationTimes=Om(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Om(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Sy(e,t,r,n,a,i,s,o,l){return e=new t7(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Ti(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},oy(i),e}function r7(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Iu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function FS(e){if(!e)return bl;e=e._reactInternals;e:{if(Ic(e)!==e||e.tag!==1)throw Error(Ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ma(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ge(171))}if(e.tag===1){var r=e.type;if(Ma(r))return F3(e,r,t)}return t}function LS(e,t,r,n,a,i,s,o,l){return e=Sy(r,n,!0,e,a,i,s,o,l),e.context=FS(null),r=e.current,n=ba(),a=vl(r),i=oo(n,a),i.callback=t??null,gl(r,i,a),e.current.lanes=a,Xd(e,a,n),Ba(e,n),e}function hg(e,t,r,n){var a=t.current,i=ba(),s=vl(a);return r=FS(r),t.context===null?t.context=r:t.pendingContext=r,t=oo(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=gl(a,t,s),e!==null&&(ns(e,a,s,i),Y1(e,a,s)),s}function Tp(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Pb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ey(e,t){Pb(e,t),(e=e.alternate)&&Pb(e,t)}function n7(){return null}var jS=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ny(e){this._internalRoot=e}pg.prototype.render=Ny.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ge(409));hg(e,t,null,null)};pg.prototype.unmount=Ny.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ec(function(){hg(null,e,null,null)}),t[po]=null}};function pg(e){this._internalRoot=e}pg.prototype.unstable_scheduleHydration=function(e){if(e){var t=u3();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Qo.length&&t!==0&&t<Qo[r].priority;r++);Qo.splice(r,0,e),r===0&&d3(e)}};function Ay(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function gg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Fb(){}function a7(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var c=Tp(s);i.call(c)}}var s=LS(t,n,e,0,null,!1,!1,"",Fb);return e._reactRootContainer=s,e[po]=s.current,gd(e.nodeType===8?e.parentNode:e),Ec(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=Tp(l);o.call(c)}}var l=Sy(e,0,!1,null,null,!1,!1,"",Fb);return e._reactRootContainer=l,e[po]=l.current,gd(e.nodeType===8?e.parentNode:e),Ec(function(){hg(t,l,r,n)}),l}function mg(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=Tp(s);o.call(l)}}hg(t,s,e,a)}else s=a7(r,t,e,a,n);return Tp(s)}l3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Cf(t.pendingLanes);r!==0&&(q2(t,r|1),Ba(t,tn()),!(Qt&6)&&(p0=tn()+500,jl()))}break;case 13:Ec(function(){var n=go(e,1);if(n!==null){var a=ba();ns(n,e,1,a)}}),Ey(e,1)}};G2=function(e){if(e.tag===13){var t=go(e,134217728);if(t!==null){var r=ba();ns(t,e,134217728,r)}Ey(e,134217728)}};c3=function(e){if(e.tag===13){var t=vl(e),r=go(e,t);if(r!==null){var n=ba();ns(r,e,t,n)}Ey(e,t)}};u3=function(){return pr};f3=function(e,t){var r=pr;try{return pr=e,t()}finally{pr=r}};cx=function(e,t,r){switch(t){case"input":if(rx(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=sg(n);if(!a)throw Error(Ge(90));Wk(n),rx(n,a)}}}break;case"textarea":$k(e,r);break;case"select":t=r.value,t!=null&&Xu(e,!!r.multiple,t,!1)}};Jk=wy;Zk=Ec;var i7={usingClientEntryPoint:!1,Events:[Yd,Bu,sg,Kk,Yk,wy]},yf={findFiberByHostInstance:ic,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},s7={bundleType:yf.bundleType,version:yf.version,rendererPackageName:yf.rendererPackageName,rendererConfig:yf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_o.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=t3(e),e===null?null:e.stateNode},findFiberByHostInstance:yf.findFiberByHostInstance||n7,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var y1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!y1.isDisabled&&y1.supportsFiber)try{rg=y1.inject(s7),Ts=y1}catch{}}ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=i7;ci.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ay(t))throw Error(Ge(200));return r7(e,t,null,r)};ci.createRoot=function(e,t){if(!Ay(e))throw Error(Ge(299));var r=!1,n="",a=jS;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Sy(e,1,!1,null,null,r,!1,n,a),e[po]=t.current,gd(e.nodeType===8?e.parentNode:e),new Ny(t)};ci.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ge(188)):(e=Object.keys(e).join(","),Error(Ge(268,e)));return e=t3(t),e=e===null?null:e.stateNode,e};ci.flushSync=function(e){return Ec(e)};ci.hydrate=function(e,t,r){if(!gg(t))throw Error(Ge(200));return mg(null,e,t,!0,r)};ci.hydrateRoot=function(e,t,r){if(!Ay(e))throw Error(Ge(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=jS;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=LS(t,null,e,1,r??null,a,!1,i,s),e[po]=t.current,gd(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new pg(t)};ci.render=function(e,t,r){if(!gg(t))throw Error(Ge(200));return mg(null,e,t,!1,r)};ci.unmountComponentAtNode=function(e){if(!gg(e))throw Error(Ge(40));return e._reactRootContainer?(Ec(function(){mg(null,null,e,!1,function(){e._reactRootContainer=null,e[po]=null})}),!0):!1};ci.unstable_batchedUpdates=wy;ci.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!gg(r))throw Error(Ge(200));if(e==null||e._reactInternals===void 0)throw Error(Ge(38));return mg(e,t,r,!1,n)};ci.version="18.3.1-next-f1338f8080-20240426";function IS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(IS)}catch(e){console.error(e)}}IS(),Ik.exports=ci;var vg=Ik.exports;const o7=qd(vg);var DS,Lb=vg;DS=Lb.createRoot,Lb.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sd(){return Sd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sd.apply(this,arguments)}var ol;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ol||(ol={}));const jb="popstate";function l7(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:s,hash:o}=n.location;return Wx("",{pathname:i,search:s,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:RS(a)}return u7(t,r,null,e)}function mn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function OS(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function c7(){return Math.random().toString(36).substr(2,8)}function Ib(e,t){return{usr:e.state,key:e.key,idx:t}}function Wx(e,t,r,n){return r===void 0&&(r=null),Sd({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?E0(t):t,{state:r,key:t&&t.key||n||c7()})}function RS(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function E0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function u7(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,o=ol.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(Sd({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function f(){o=ol.Pop;let y=u(),x=y==null?null:y-c;c=y,l&&l({action:o,location:m.location,delta:x})}function d(y,x){o=ol.Push;let b=Wx(m.location,y,x);r&&r(b,y),c=u()+1;let w=Ib(b,c),S=m.createHref(b);try{s.pushState(w,"",S)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(S)}i&&l&&l({action:o,location:m.location,delta:1})}function h(y,x){o=ol.Replace;let b=Wx(m.location,y,x);r&&r(b,y),c=u();let w=Ib(b,c),S=m.createHref(b);s.replaceState(w,"",S),i&&l&&l({action:o,location:m.location,delta:0})}function v(y){let x=a.location.origin!=="null"?a.location.origin:a.location.href,b=typeof y=="string"?y:RS(y);return b=b.replace(/ $/,"%20"),mn(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let m={get action(){return o},get location(){return e(a,s)},listen(y){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(jb,f),l=y,()=>{a.removeEventListener(jb,f),l=null}},createHref(y){return t(a,y)},createURL:v,encodeLocation(y){let x=v(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:d,replace:h,go(y){return s.go(y)}};return m}var Db;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Db||(Db={}));function f7(e,t,r){return r===void 0&&(r="/"),d7(e,t,r,!1)}function d7(e,t,r,n){let a=typeof t=="string"?E0(t):t,i=US(a.pathname||"/",r);if(i==null)return null;let s=MS(e);h7(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let c=S7(i);o=_7(s[l],c,n)}return o}function MS(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,s,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};l.relativePath.startsWith("/")&&(mn(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=dc([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(mn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),MS(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:w7(c,i.index),routesMeta:u})};return e.forEach((i,s)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,s);else for(let l of BS(i.path))a(i,s,l)}),t}function BS(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=BS(n.join("/")),o=[];return o.push(...s.map(l=>l===""?i:[i,l].join("/"))),a&&o.push(...s),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function h7(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:b7(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const p7=/^:[\w-]+$/,g7=3,m7=2,v7=1,x7=10,y7=-2,Ob=e=>e==="*";function w7(e,t){let r=e.split("/"),n=r.length;return r.some(Ob)&&(n+=y7),t&&(n+=m7),r.filter(a=>!Ob(a)).reduce((a,i)=>a+(p7.test(i)?g7:i===""?v7:x7),n)}function b7(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function _7(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,a={},i="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=Rb({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!f&&c&&r&&!n[n.length-1].route.index&&(f=Rb({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),s.push({params:a,pathname:dc([i,f.pathname]),pathnameBase:C7(dc([i,f.pathnameBase])),route:d}),f.pathnameBase!=="/"&&(i=dc([i,f.pathnameBase]))}return s}function Rb(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=k7(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,u,f)=>{let{paramName:d,isOptional:h}=u;if(d==="*"){let m=o[f]||"";s=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const v=o[f];return h&&!v?c[d]=void 0:c[d]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:s,pattern:e}}function k7(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),OS(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function S7(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return OS(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function US(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function E7(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?E0(e):e;return{pathname:r?r.startsWith("/")?r:N7(r,t):t,search:T7(n),hash:P7(a)}}function N7(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function nv(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function A7(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function zS(e,t){let r=A7(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function WS(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=E0(e):(a=Sd({},e),mn(!a.pathname||!a.pathname.includes("?"),nv("?","pathname","search",a)),mn(!a.pathname||!a.pathname.includes("#"),nv("#","pathname","hash",a)),mn(!a.search||!a.search.includes("#"),nv("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,o;if(s==null)o=r;else{let f=t.length-1;if(!n&&s.startsWith("..")){let d=s.split("/");for(;d[0]==="..";)d.shift(),f-=1;a.pathname=d.join("/")}o=f>=0?t[f]:"/"}let l=E7(a,o),c=s&&s!=="/"&&s.endsWith("/"),u=(i||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const dc=e=>e.join("/").replace(/\/\/+/g,"/"),C7=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),T7=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,P7=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function F7(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const HS=["post","put","patch","delete"];new Set(HS);const L7=["get",...HS];new Set(L7);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ed(){return Ed=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ed.apply(this,arguments)}const Cy=O.createContext(null),j7=O.createContext(null),Zd=O.createContext(null),xg=O.createContext(null),Dc=O.createContext({outlet:null,matches:[],isDataRoute:!1}),$S=O.createContext(null);function Qd(){return O.useContext(xg)!=null}function eh(){return Qd()||mn(!1),O.useContext(xg).location}function VS(e){O.useContext(Zd).static||O.useLayoutEffect(e)}function Il(){let{isDataRoute:e}=O.useContext(Dc);return e?q7():I7()}function I7(){Qd()||mn(!1);let e=O.useContext(Cy),{basename:t,future:r,navigator:n}=O.useContext(Zd),{matches:a}=O.useContext(Dc),{pathname:i}=eh(),s=JSON.stringify(zS(a,r.v7_relativeSplatPath)),o=O.useRef(!1);return VS(()=>{o.current=!0}),O.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let f=WS(c,JSON.parse(s),i,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:dc([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,s,i,e])}function D7(e,t){return O7(e,t)}function O7(e,t,r,n){Qd()||mn(!1);let{navigator:a,static:i}=O.useContext(Zd),{matches:s}=O.useContext(Dc),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=eh(),f;if(t){var d;let x=typeof t=="string"?E0(t):t;c==="/"||(d=x.pathname)!=null&&d.startsWith(c)||mn(!1),f=x}else f=u;let h=f.pathname||"/",v=h;if(c!=="/"){let x=c.replace(/^\//,"").split("/");v="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let m=!i&&r&&r.matches&&r.matches.length>0?r.matches:f7(e,{pathname:v}),y=z7(m&&m.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:dc([c,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:dc([c,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,r,n);return t&&y?O.createElement(xg.Provider,{value:{location:Ed({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:ol.Pop}},y):y}function R7(){let e=V7(),t=F7(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},t),r?O.createElement("pre",{style:a},r):null,i)}const M7=O.createElement(R7,null);class B7 extends O.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?O.createElement(Dc.Provider,{value:this.props.routeContext},O.createElement($S.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function U7(e){let{routeContext:t,match:r,children:n}=e,a=O.useContext(Cy);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),O.createElement(Dc.Provider,{value:t},n)}function z7(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let u=s.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);u>=0||mn(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<s.length;u++){let f=s[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=u),f.route.id){let{loaderData:d,errors:h}=r,v=f.route.loader&&d[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||v){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,f,d)=>{let h,v=!1,m=null,y=null;r&&(h=o&&f.route.id?o[f.route.id]:void 0,m=f.route.errorElement||M7,l&&(c<0&&d===0?(G7("route-fallback",!1),v=!0,y=null):c===d&&(v=!0,y=f.route.hydrateFallbackElement||null)));let x=t.concat(s.slice(0,d+1)),b=()=>{let w;return h?w=m:v?w=y:f.route.Component?w=O.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,O.createElement(U7,{match:f,routeContext:{outlet:u,matches:x,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?O.createElement(B7,{location:r.location,revalidation:r.revalidation,component:m,error:h,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var qS=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(qS||{}),Pp=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Pp||{});function W7(e){let t=O.useContext(Cy);return t||mn(!1),t}function H7(e){let t=O.useContext(j7);return t||mn(!1),t}function $7(e){let t=O.useContext(Dc);return t||mn(!1),t}function GS(e){let t=$7(),r=t.matches[t.matches.length-1];return r.route.id||mn(!1),r.route.id}function V7(){var e;let t=O.useContext($S),r=H7(Pp.UseRouteError),n=GS(Pp.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function q7(){let{router:e}=W7(qS.UseNavigateStable),t=GS(Pp.UseNavigateStable),r=O.useRef(!1);return VS(()=>{r.current=!0}),O.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Ed({fromRouteId:t},i)))},[e,t])}const Mb={};function G7(e,t,r){!t&&!Mb[e]&&(Mb[e]=!0)}function X7(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function Bb(e){let{to:t,replace:r,state:n,relative:a}=e;Qd()||mn(!1);let{future:i,static:s}=O.useContext(Zd),{matches:o}=O.useContext(Dc),{pathname:l}=eh(),c=Il(),u=WS(t,zS(o,i.v7_relativeSplatPath),l,a==="path"),f=JSON.stringify(u);return O.useEffect(()=>c(JSON.parse(f),{replace:r,state:n,relative:a}),[c,f,a,r,n]),null}function Rn(e){mn(!1)}function K7(e){let{basename:t="/",children:r=null,location:n,navigationType:a=ol.Pop,navigator:i,static:s=!1,future:o}=e;Qd()&&mn(!1);let l=t.replace(/^\/*/,"/"),c=O.useMemo(()=>({basename:l,navigator:i,static:s,future:Ed({v7_relativeSplatPath:!1},o)}),[l,o,i,s]);typeof n=="string"&&(n=E0(n));let{pathname:u="/",search:f="",hash:d="",state:h=null,key:v="default"}=n,m=O.useMemo(()=>{let y=US(u,l);return y==null?null:{location:{pathname:y,search:f,hash:d,state:h,key:v},navigationType:a}},[l,u,f,d,h,v,a]);return m==null?null:O.createElement(Zd.Provider,{value:c},O.createElement(xg.Provider,{children:r,value:m}))}function Ub(e){let{children:t,location:r}=e;return D7(Hx(t),r)}new Promise(()=>{});function Hx(e,t){t===void 0&&(t=[]);let r=[];return O.Children.forEach(e,(n,a)=>{if(!O.isValidElement(n))return;let i=[...t,a];if(n.type===O.Fragment){r.push.apply(r,Hx(n.props.children,i));return}n.type!==Rn&&mn(!1),!n.props.index||!n.props.children||mn(!1);let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=Hx(n.props.children,i)),r.push(s)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $x(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function Y7(e,t){let r=$x(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const J7="6";try{window.__reactRouterVersion=J7}catch{}const Z7="startTransition",zb=R2[Z7];function Q7(e){let{basename:t,children:r,future:n,window:a}=e,i=O.useRef();i.current==null&&(i.current=l7({window:a,v5Compat:!0}));let s=i.current,[o,l]=O.useState({action:s.action,location:s.location}),{v7_startTransition:c}=n||{},u=O.useCallback(f=>{c&&zb?zb(()=>l(f)):l(f)},[l,c]);return O.useLayoutEffect(()=>s.listen(u),[s,u]),O.useEffect(()=>X7(n),[n]),O.createElement(K7,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:s,future:n})}var Wb;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Wb||(Wb={}));var Hb;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Hb||(Hb={}));function eF(e){let t=O.useRef($x(e)),r=O.useRef(!1),n=eh(),a=O.useMemo(()=>Y7(n.search,r.current?null:t.current),[n.search]),i=Il(),s=O.useCallback((o,l)=>{const c=$x(typeof o=="function"?o(a):o);r.current=!0,i("?"+c,l)},[i,a]);return[a,s]}const tF="modulepreload",rF=function(e){return"/"+e},$b={},vo=function(t,r,n){if(!r||r.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=rF(i),i in $b)return;$b[i]=!0;const s=i.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(!!n)for(let u=a.length-1;u>=0;u--){const f=a[u];if(f.href===i&&(!s||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${o}`))return;const c=document.createElement("link");if(c.rel=s?"stylesheet":tF,s||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),s)return new Promise((u,f)=>{c.addEventListener("load",u),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i})},nF=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>vo(()=>Promise.resolve().then(()=>N0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Ty extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class aF extends Ty{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class iF extends Ty{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class sF extends Ty{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Vx;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Vx||(Vx={}));var oF=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class lF{constructor(t,{headers:r={},customFetch:n,region:a=Vx.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=nF(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return oF(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=s):typeof s=="string"?(o["Content-Type"]="text/plain",c=s):typeof FormData<"u"&&s instanceof FormData?c=s:(o["Content-Type"]="application/json",c=JSON.stringify(s)));const u=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:c}).catch(v=>{throw new aF(v)}),f=u.headers.get("x-relay-error");if(f&&f==="true")throw new iF(u);if(!u.ok)throw new sF(u);let d=((n=u.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),h;return d==="application/json"?h=yield u.json():d==="application/octet-stream"?h=yield u.blob():d==="text/event-stream"?h=u:d==="multipart/form-data"?h=yield u.formData():h=yield u.text(),{data:h,error:null}}catch(a){return{data:null,error:a}}})}}var Da={},Py={},yg={},th={},wg={},bg={},cF=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},g0=cF();const uF=g0.fetch,XS=g0.fetch.bind(g0),KS=g0.Headers,fF=g0.Request,dF=g0.Response,N0=Object.freeze(Object.defineProperty({__proto__:null,Headers:KS,Request:fF,Response:dF,default:XS,fetch:uF},Symbol.toStringTag,{value:"Module"})),hF=_k(N0);var _g={};Object.defineProperty(_g,"__esModule",{value:!0});let pF=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};_g.default=pF;var YS=wa&&wa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bg,"__esModule",{value:!0});const gF=YS(hF),mF=YS(_g);let vF=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=gF.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,o,l;let c=null,u=null,f=null,d=i.status,h=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const m=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),y=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&y&&y.length>1&&(f=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,d=406,h="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await i.text();try{c=JSON.parse(m),Array.isArray(c)&&i.status===404&&(u=[],c=null,d=200,h="OK")}catch{i.status===404&&m===""?(d=204,h="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,h="OK"),c&&this.shouldThrowOnError)throw new mF.default(c)}return{error:c,data:u,count:f,status:d,statusText:h}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,o,l;return{error:{message:`${(s=i==null?void 0:i.name)!==null&&s!==void 0?s:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};bg.default=vF;var xF=wa&&wa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wg,"__esModule",{value:!0});const yF=xF(bg);let wF=class extends yF.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`,s==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};wg.default=wF;var bF=wa&&wa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(th,"__esModule",{value:!0});const _F=bF(wg);let kF=class extends _F.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};th.default=kF;var SF=wa&&wa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yg,"__esModule",{value:!0});const wf=SF(th);let EF=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const s=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new wf.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const s=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(s.length>0){const o=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new wf.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){const s="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new wf.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new wf.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new wf.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};yg.default=EF;var kg={},Sg={};Object.defineProperty(Sg,"__esModule",{value:!0});Sg.version=void 0;Sg.version="0.0.0-automated";Object.defineProperty(kg,"__esModule",{value:!0});kg.DEFAULT_HEADERS=void 0;const NF=Sg;kg.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${NF.version}`};var JS=wa&&wa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Py,"__esModule",{value:!0});const AF=JS(yg),CF=JS(th),TF=kg;let PF=class ZS{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},TF.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new AF.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new ZS(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){let s;const o=new URL(`${this.url}/rpc/${t}`);let l;n||a?(s=n?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{o.searchParams.append(u,f)})):(s="POST",l=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new CF.default({method:s,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Py.default=PF;var A0=wa&&wa.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Da,"__esModule",{value:!0});Da.PostgrestError=Da.PostgrestBuilder=Da.PostgrestTransformBuilder=Da.PostgrestFilterBuilder=Da.PostgrestQueryBuilder=Da.PostgrestClient=void 0;const QS=A0(Py);Da.PostgrestClient=QS.default;const eE=A0(yg);Da.PostgrestQueryBuilder=eE.default;const tE=A0(th);Da.PostgrestFilterBuilder=tE.default;const rE=A0(wg);Da.PostgrestTransformBuilder=rE.default;const nE=A0(bg);Da.PostgrestBuilder=nE.default;const aE=A0(_g);Da.PostgrestError=aE.default;var FF=Da.default={PostgrestClient:QS.default,PostgrestQueryBuilder:eE.default,PostgrestFilterBuilder:tE.default,PostgrestTransformBuilder:rE.default,PostgrestBuilder:nE.default,PostgrestError:aE.default};const{PostgrestClient:LF,PostgrestQueryBuilder:oZ,PostgrestFilterBuilder:lZ,PostgrestTransformBuilder:cZ,PostgrestBuilder:uZ,PostgrestError:fZ}=FF,jF="2.11.2",IF={"X-Client-Info":`realtime-js/${jF}`},DF="1.0.0",iE=1e4,OF=1e3;var e0;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(e0||(e0={}));var Ya;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ya||(Ya={}));var Zi;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Zi||(Zi={}));var qx;(function(e){e.websocket="websocket"})(qx||(qx={}));var nc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(nc||(nc={}));class RF{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(t.slice(s,s+a));s=s+a;const l=n.decode(t.slice(s,s+i));s=s+i;const c=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class sE{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Er;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Er||(Er={}));const Vb=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,s)=>(i[s]=MF(s,e,t,a),i),{})},MF=(e,t,r,n)=>{const a=t.find(o=>o.name===e),i=a==null?void 0:a.type,s=r[e];return i&&!n.includes(i)?oE(i,s):Gx(s)},oE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return WF(t,r)}switch(e){case Er.bool:return BF(t);case Er.float4:case Er.float8:case Er.int2:case Er.int4:case Er.int8:case Er.numeric:case Er.oid:return UF(t);case Er.json:case Er.jsonb:return zF(t);case Er.timestamp:return HF(t);case Er.abstime:case Er.date:case Er.daterange:case Er.int4range:case Er.int8range:case Er.money:case Er.reltime:case Er.text:case Er.time:case Er.timestamptz:case Er.timetz:case Er.tsrange:case Er.tstzrange:return Gx(t);default:return Gx(t)}},Gx=e=>e,BF=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},UF=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},zF=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},WF=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>oE(t,o))}return e},HF=e=>typeof e=="string"?e.replace(" ","T"):e,lE=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class av{constructor(t,r,n={},a=iE){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var qb;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(qb||(qb={}));class $f{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=$f.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=$f.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=$f.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const f=i[c];if(f){const d=u.map(y=>y.presence_ref),h=f.map(y=>y.presence_ref),v=u.filter(y=>h.indexOf(y.presence_ref)<0),m=f.filter(y=>d.indexOf(y.presence_ref)<0);v.length>0&&(o[c]=v),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(h=>h.presence_ref),d=u.filter(h=>f.indexOf(h.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(s,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gb;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Gb||(Gb={}));var Xb;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Xb||(Xb={}));var ro;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(ro||(ro={}));class Fy{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ya.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new av(this,Zi.join,this.params,this.timeout),this.rejoinTimer=new sE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ya.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ya.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ya.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ya.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zi.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new $f(this),this.broadcastEndpointURL=lE(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:s,private:o}}=this.params;this._onError(u=>t==null?void 0:t(ro.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(ro.CLOSED));const l={},c={broadcast:i,presence:s,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){t==null||t(ro.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,h=(f=d==null?void 0:d.length)!==null&&f!==void 0?f:0,v=[];for(let m=0;m<h;m++){const y=d[m],{filter:{event:x,schema:b,table:w,filter:S}}=y,L=u&&u[m];if(L&&L.event===x&&L.schema===b&&L.table===w&&L.filter===S)v.push(Object.assign(Object.assign({},y),{id:L.id}));else{this.unsubscribe(),t==null||t(ro.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(ro.SUBSCRIBED);return}}).receive("error",u=>{t==null||t(ro.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(ro.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ya.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zi.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const a=new av(this,Zi.leave,{},t);a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new av(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Zi;if(n&&[o,l,c,u].indexOf(s)>=0&&n!==this._joinRef())return;let d=this._onMessage(s,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var v,m,y;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((y=(m=h.filter)===null||m===void 0?void 0:m.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===s}).map(h=>h.callback(d,n)):(i=this.bindings[s])===null||i===void 0||i.filter(h=>{var v,m,y,x,b,w;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const S=h.id,L=(v=h.filter)===null||v===void 0?void 0:v.event;return S&&((m=r.ids)===null||m===void 0?void 0:m.includes(S))&&(L==="*"||(L==null?void 0:L.toLocaleLowerCase())===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const S=(b=(x=h==null?void 0:h.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return S==="*"||S===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof d=="object"&&"ids"in d){const v=d.data,{schema:m,table:y,commit_timestamp:x,type:b,errors:w}=v;d=Object.assign(Object.assign({},{schema:m,table:y,commit_timestamp:x,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(v))}h.callback(d,n)})}_isClosed(){return this.state===Ya.closed}_isJoined(){return this.state===Ya.joined}_isJoining(){return this.state===Ya.joining}_isLeaving(){return this.state===Ya.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Fy.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Zi.close,{},t)}_onError(t){this._on(Zi.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ya.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Vb(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Vb(t.columns,t.old_record)),r}}const $F=()=>{},VF=typeof WebSocket<"u",qF=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class GF{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=IF,this.params={},this.timeout=iE,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=$F,this.conn=null,this.sendBuffer=[],this.serializer=new RF,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...o)=>vo(()=>Promise.resolve().then(()=>N0),void 0).then(({default:l})=>l(...o)):s=fetch,(...o)=>s(...o)},this.endPoint=`${t}/${qx.websocket}`,this.httpEndpoint=lE(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,s)=>s(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new sE(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(VF){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new XF(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),vo(()=>import("./browser-89ca8cfe.js").then(t=>t.b),[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:DF}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case e0.connecting:return nc.Connecting;case e0.open:return nc.Open;case e0.closing:return nc.Closing;default:return nc.Closed}}isConnected(){return this.connectionState()===nc.Open}channel(t,r={config:{}}){const n=new Fy(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(a=>{r&&a.updateJoinPayload({access_token:r}),a.joinedOnce&&a._isJoined()&&a._push(Zi.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(OF,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:i,ref:s}=r;s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${a} ${s&&"("+s+")"||""}`,i),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,i,s)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Zi.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([qF],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class XF{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=e0.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class Ly extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Cn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class KF extends Ly{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Xx extends Ly{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var YF=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const cE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>vo(()=>Promise.resolve().then(()=>N0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},JF=()=>YF(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield vo(()=>Promise.resolve().then(()=>N0),void 0)).Response:Response}),Kx=e=>{if(Array.isArray(e))return e.map(r=>Kx(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=Kx(n)}),t};var Oc=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const iv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ZF=(e,t,r)=>Oc(void 0,void 0,void 0,function*(){const n=yield JF();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new KF(iv(a),e.status||500))}).catch(a=>{t(new Xx(iv(a),a))}):t(new Xx(iv(e),e))}),QF=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function rh(e,t,r,n,a,i){return Oc(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,QF(t,n,a,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>ZF(l,o,n))})})}function Fp(e,t,r,n){return Oc(this,void 0,void 0,function*(){return rh(e,"GET",t,r,n)})}function Zo(e,t,r,n,a){return Oc(this,void 0,void 0,function*(){return rh(e,"POST",t,n,a,r)})}function eL(e,t,r,n,a){return Oc(this,void 0,void 0,function*(){return rh(e,"PUT",t,n,a,r)})}function tL(e,t,r,n){return Oc(this,void 0,void 0,function*(){return rh(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function uE(e,t,r,n,a){return Oc(this,void 0,void 0,function*(){return rh(e,"DELETE",t,n,a,r)})}var La=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const rL={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class nL{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=cE(a)}uploadOrUpdate(t,r,n,a){return La(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},Kb),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:i,headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{})),d=yield f.json();return f.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(Cn(i))return{data:null,error:i};throw i}})}upload(t,r,n){return La(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return La(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Kb.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),d=yield f.json();return f.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(Cn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return La(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield Zo(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new Ly("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:o},error:null}}catch(n){if(Cn(n))return{data:null,error:n};throw n}})}update(t,r,n){return La(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return La(this,void 0,void 0,function*(){try{return{data:yield Zo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Cn(a))return{data:null,error:a};throw a}})}copy(t,r,n){return La(this,void 0,void 0,function*(){try{return{data:{path:(yield Zo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Cn(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return La(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield Zo(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(Cn(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return La(this,void 0,void 0,function*(){try{const a=yield Zo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(Cn(a))return{data:null,error:a};throw a}})}download(t,r){return La(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Fp(this.fetch,`${this.url}/${a}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Cn(o))return{data:null,error:o};throw o}})}info(t){return La(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Fp(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Kx(n),error:null}}catch(n){if(Cn(n))return{data:null,error:n};throw n}})}exists(t){return La(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield tL(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Cn(n)&&n instanceof Xx){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return La(this,void 0,void 0,function*(){try{return{data:yield uE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Cn(r))return{data:null,error:r};throw r}})}list(t,r,n){return La(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},rL),r),{prefix:t||""});return{data:yield Zo(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Cn(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const aL="2.7.1",iL={"X-Client-Info":`storage-js/${aL}`};var xu=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class sL{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},iL),r),this.fetch=cE(n)}listBuckets(){return xu(this,void 0,void 0,function*(){try{return{data:yield Fp(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Cn(t))return{data:null,error:t};throw t}})}getBucket(t){return xu(this,void 0,void 0,function*(){try{return{data:yield Fp(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Cn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return xu(this,void 0,void 0,function*(){try{return{data:yield Zo(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Cn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return xu(this,void 0,void 0,function*(){try{return{data:yield eL(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Cn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return xu(this,void 0,void 0,function*(){try{return{data:yield Zo(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Cn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return xu(this,void 0,void 0,function*(){try{return{data:yield uE(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Cn(r))return{data:null,error:r};throw r}})}}class oL extends sL{constructor(t,r={},n){super(t,r,n)}from(t){return new nL(this.url,this.headers,t,this.fetch)}}const lL="2.49.4";let Pf="";typeof Deno<"u"?Pf="deno":typeof document<"u"?Pf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Pf="react-native":Pf="node";const cL={"X-Client-Info":`supabase-js-${Pf}/${lL}`},uL={headers:cL},fL={schema:"public"},dL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},hL={};var pL=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const gL=e=>{let t;return e?t=e:typeof fetch>"u"?t=XS:t=fetch,(...r)=>t(...r)},mL=()=>typeof Headers>"u"?KS:Headers,vL=(e,t,r)=>{const n=gL(r),a=mL();return(i,s)=>pL(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},s),{headers:c}))})};var xL=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function yL(e){return e.replace(/\/$/,"")}function wL(e,t){const{db:r,auth:n,realtime:a,global:i}=e,{db:s,auth:o,realtime:l,global:c}=t,u={db:Object.assign(Object.assign({},s),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},c),i),accessToken:()=>xL(this,void 0,void 0,function*(){return""})};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}const fE="2.69.1",Pu=30*1e3,Yx=3,sv=Yx*Pu,bL="http://localhost:9999",_L="supabase.auth.token",kL={"X-Client-Info":`gotrue-js/${fE}`},Jx="X-Supabase-Api-Version",dE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},SL=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,EL=6e5;class jy extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function zt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class NL extends jy{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function AL(e){return zt(e)&&e.name==="AuthApiError"}class hE extends jy{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Dl extends jy{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Go extends Dl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function CL(e){return zt(e)&&e.name==="AuthSessionMissingError"}class ov extends Dl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class w1 extends Dl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class b1 extends Dl{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function TL(e){return zt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Yb extends Dl{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Zx extends Dl{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function lv(e){return zt(e)&&e.name==="AuthRetryableFetchError"}class Jb extends Dl{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Vf extends Dl{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Zb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qb=` 	
\r=`.split(""),PL=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Qb.length;t+=1)e[Qb[t].charCodeAt(0)]=-2;for(let t=0;t<Zb.length;t+=1)e[Zb[t].charCodeAt(0)]=t;return e})();function pE(e,t,r){const n=PL[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function e_(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{jL(s,n,r)};for(let s=0;s<e.length;s+=1)pE(e.charCodeAt(s),a,i);return t.join("")}function FL(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function LL(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}FL(n,t)}}function jL(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function IL(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)pE(e.charCodeAt(a),r,n);return new Uint8Array(t)}function DL(e){const t=[];return LL(e,r=>t.push(r)),new Uint8Array(t)}function OL(e){return Math.round(Date.now()/1e3)+e}function RL(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const ws=()=>typeof window<"u"&&typeof document<"u",Zl={tested:!1,writable:!1},qf=()=>{if(!ws())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zl.tested)return Zl.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Zl.tested=!0,Zl.writable=!0}catch{Zl.tested=!0,Zl.writable=!1}return Zl.writable};function ML(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const gE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>vo(()=>Promise.resolve().then(()=>N0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},BL=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",mE=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},_1=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},k1=async(e,t)=>{await e.removeItem(t)};class Eg{constructor(){this.promise=new Eg.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Eg.promiseConstructor=Promise;function cv(e){const t=e.split(".");if(t.length!==3)throw new Vf("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!SL.test(t[n]))throw new Vf("JWT not in base64url format");return{header:JSON.parse(e_(t[0])),payload:JSON.parse(e_(t[1])),signature:IL(t[2]),raw:{header:t[0],payload:t[1]}}}async function UL(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function zL(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function WL(e){return("0"+e.toString(16)).substr(-2)}function HL(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,WL).join("")}async function $L(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function VL(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await $L(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yu(e,t,r=!1){const n=HL();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await mE(e,`${t}-code-verifier`,a);const i=await VL(n);return[i,n===i?"plain":"s256"]}const qL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function GL(e){const t=e.headers.get(Jx);if(!t||!t.match(qL))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function XL(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function KL(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var YL=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const tc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),JL=[502,503,504];async function t_(e){var t;if(!BL(e))throw new Zx(tc(e),0);if(JL.includes(e.status))throw new Zx(tc(e),e.status);let r;try{r=await e.json()}catch(i){throw new hE(tc(i),i)}let n;const a=GL(e);if(a&&a.getTime()>=dE["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Jb(tc(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Go}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new Jb(tc(r),e.status,r.weak_password.reasons);throw new NL(tc(r),e.status||500,n)}const ZL=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Kt(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[Jx]||(i[Jx]=dE["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await QL(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function QL(e,t,r,n,a,i){const s=ZL(t,n,a,i);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new Zx(tc(l),0)}if(o.ok||await t_(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await t_(l)}}function Xo(e){var t;let r=null;nj(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=OL(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function r_(e){const t=Xo(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function tl(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function ej(e){return{data:e,error:null}}function tj(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=YL(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function rj(e){return e}function nj(e){return e.access_token&&e.refresh_token&&e.expires_in}var aj=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class ij{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=gE(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Kt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(zt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Kt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:tl})}catch(n){if(zt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=aj(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Kt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:tj,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(zt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Kt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:tl})}catch(r){if(zt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Kt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:rj});if(u.error)throw u.error;const f=await u.json(),d=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(v=>{const m=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);c[`${y}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(zt(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await Kt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:tl})}catch(r){if(zt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Kt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:tl})}catch(n){if(zt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Kt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:tl})}catch(n){if(zt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Kt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(zt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Kt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(zt(r))return{data:null,error:r};throw r}}}const sj={getItem:e=>qf()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{qf()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{qf()&&globalThis.localStorage.removeItem(e)}};function n_(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function oj(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const wu={debug:!!(globalThis&&qf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class vE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class lj extends vE{}async function cj(e,t,r){wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),wu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw wu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new lj(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wu.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}oj();const uj={url:bL,storageKey:_L,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:kL,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function a_(e,t,r){return await r()}class Nd{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Nd.nextInstanceID,Nd.nextInstanceID+=1,this.instanceID>0&&ws()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},uj),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new ij({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=gE(a.fetch),this.lock=a.lock||a_,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ws()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=cj:this.lock=a_,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:qf()?this.storage=sj:(this.memoryStorage={},this.storage=n_(this.memoryStorage)):(this.memoryStorage={},this.storage=n_(this.memoryStorage)),ws()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${fE}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=ML(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),ws()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),TL(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return zt(r)?{error:r}:{error:new hE("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Xo}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(zt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:f,options:d}=t;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await yu(this.storage,this.storageKey)),i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:f,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:v},xform:Xo})}else if("phone"in t){const{phone:u,password:f,options:d}=t;i=await Kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(a=d==null?void 0:d.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Xo})}else throw new w1("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(zt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:o}=t;r=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:r_})}else if("phone"in t){const{phone:i,password:s,options:o}=t;r=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:r_})}else throw new w1("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ov}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(zt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await _1(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Xo});if(await k1(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ov}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(zt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,o=await Kt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Xo}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ov}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(zt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await yu(this.storage,this.storageKey));const{error:f}=await Kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new w1("You must provide either an email or phone number.")}catch(o){if(zt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await Kt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Xo});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(zt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await yu(this.storage,this.storageKey)),await Kt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:ej})}catch(i){if(zt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Go;const{error:a}=await Kt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(zt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await Kt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:o}=await Kt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o}}throw new w1("You must provide either an email or phone number and a type")}catch(r){if(zt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await _1(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<sv:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:tl}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Go}:await Kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:tl})})}catch(r){if(zt(r))return CL(r)&&(await this._removeSession(),await k1(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Go;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await yu(this.storage,this.storageKey));const{data:c,error:u}=await Kt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:tl});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(zt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Go;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=cv(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(zt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Go;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(zt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!ws())throw new b1("No browser detected.");if(t.error||t.error_description||t.error_code)throw new b1(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Yb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new b1("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Yb("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!s||!c)throw new b1("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let d=u+f;l&&(d=parseInt(l));const h=d-u;h*1e3<=Pu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const v=d-f;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,d,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,d,u);const{data:m,error:y}=await this._getUser(i);if(y)throw y;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:d,refresh_token:s,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(zt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await _1(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!(AL(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await k1(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=RL(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await yu(this.storage,this.storageKey,!0));try{return await Kt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(zt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(zt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,c,u;const{data:f,error:d}=i;if(d)throw d;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Kt(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return ws()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(zt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await Kt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(zt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await zL(async a=>(a>0&&await UL(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Kt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Xo})),(a,i)=>{const s=200*Math.pow(2,a);return i&&lv(i)&&Date.now()+s-n<Pu})}catch(n){if(this._debug(r,"error",n),zt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ws()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await _1(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<sv;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${sv}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),lv(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Go;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Eg;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new Go;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),zt(i)){const s={session:null,error:i};return lv(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await mE(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await k1(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ws()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Pu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Pu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Pu}ms, refresh threshold is ${Yx} ticks`),a<=Yx&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof vE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ws()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await yu(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Kt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(zt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Kt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(zt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:o}=await Kt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(zt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Kt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(zt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=cv(a.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(s=>s.kid===t);if(n||(n=this.jwks.keys.find(s=>s.kid===t),n&&this.jwks_cached_at+EL>Date.now()))return n;const{data:a,error:i}=await Kt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new Vf("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(s=>s.kid===t),!n)throw new Vf("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};n=h.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=cv(n);if(XL(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:s},error:null}}const c=KL(a.alg),u=await this.fetchJwk(a.kid,r),f=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,f,s,DL(`${o}.${l}`)))throw new Vf("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(zt(n))return{data:null,error:n};throw n}}}Nd.nextInstanceID=0;const fj=Nd;class dj extends fj{constructor(t){super(t)}}var hj=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class pj{constructor(t,r,n){var a,i,s;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=yL(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:fL,realtime:hL,auth:Object.assign(Object.assign({},dL),{storageKey:l}),global:uL},u=wL(n??{},c);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=vL(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new LF(`${o}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new lF(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new oL(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return hj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:i,flowType:s,lock:o,debug:l},c,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dj({url:this.authUrl,headers:Object.assign(Object.assign({},f),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:s,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new GF(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const gj=(e,t,r)=>new pj(e,t,r),mj="https://ycndsjnivfwizaoqzjnz.supabase.co",vj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InljbmRzam5pdmZ3aXphb3F6am56Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU2NDY1NjUsImV4cCI6MjA2MTIyMjU2NX0.ahTjoHRhtwhaQ-IIXobu72WhBiEgi15hEd2N02xAQ7o",He=gj(mj,vj,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce",storage:window.localStorage}});He.auth.onAuthStateChange((e,t)=>{e==="SIGNED_OUT"||e==="USER_DELETED"?localStorage.removeItem("supabase.auth.token"):(e==="SIGNED_IN"||e==="TOKEN_REFRESHED")&&t&&localStorage.setItem("supabase.auth.token",t.access_token)});function dr(e){"@babel/helpers - typeof";return dr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dr(e)}var Qx={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){if(n===null||n===!0||n===!1)return NaN;var a=Number(n);return isNaN(a)?a:a<0?Math.ceil(a):Math.floor(a)}e.exports=t.default})(Qx,Qx.exports);var xj=Qx.exports;const yj=qd(xj);var e2={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){var a=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()));return a.setUTCFullYear(n.getFullYear()),n.getTime()-a.getTime()}e.exports=t.default})(e2,e2.exports);var wj=e2.exports;const i_=qd(wj);function bj(e,t){var r=Ej(t);return r.formatToParts?kj(r,e):Sj(r,e)}var _j={year:0,month:1,day:2,hour:3,minute:4,second:5};function kj(e,t){try{for(var r=e.formatToParts(t),n=[],a=0;a<r.length;a++){var i=_j[r[a].type];i>=0&&(n[i]=parseInt(r[a].value,10))}return n}catch(s){if(s instanceof RangeError)return[NaN];throw s}}function Sj(e,t){var r=e.format(t),n=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[n[3],n[1],n[2],n[4],n[5],n[6]]}var uv={};function Ej(e){if(!uv[e]){var t=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r=t==="06/25/2014, 00:00:00"||t==="06/25/2014 00:00:00";uv[e]=r?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return uv[e]}function xE(e,t,r,n,a,i,s){var o=new Date(0);return o.setUTCFullYear(e,t,r),o.setUTCHours(n,a,i,s),o}var s_=36e5,Nj=6e4,fv={timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function yE(e,t,r){var n,a;if(!e||(n=fv.timezoneZ.exec(e),n))return 0;var i;if(n=fv.timezoneHH.exec(e),n)return i=parseInt(n[1],10),o_(i)?-(i*s_):NaN;if(n=fv.timezoneHHMM.exec(e),n){i=parseInt(n[2],10);var s=parseInt(n[3],10);return o_(i,s)?(a=Math.abs(i)*s_+s*Nj,n[1]==="+"?-a:a):NaN}if(Tj(e)){t=new Date(t||Date.now());var o=r?t:Aj(t),l=t2(o,e),c=r?l:Cj(t,l,e);return-c}return NaN}function Aj(e){return xE(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function t2(e,t){var r=bj(e,t),n=xE(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),a=e.getTime(),i=a%1e3;return a-=i>=0?i:1e3+i,n-a}function Cj(e,t,r){var n=e.getTime(),a=n-t,i=t2(new Date(a),r);if(t===i)return t;a-=i-t;var s=t2(new Date(a),r);return i===s?i:Math.max(i,s)}function o_(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var l_={};function Tj(e){if(l_[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),l_[e]=!0,!0}catch{return!1}}var Pj=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,dv=36e5,c_=6e4,Fj=2,ya={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Pj};function Lj(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var r=t||{},n=r.additionalDigits==null?Fj:yj(r.additionalDigits);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var a=jj(e),i=Ij(a.date,n),s=i.year,o=i.restDateString,l=Dj(o,s);if(isNaN(l))return new Date(NaN);if(l){var c=l.getTime(),u=0,f;if(a.time&&(u=Oj(a.time),isNaN(u)))return new Date(NaN);if(a.timeZone||r.timeZone){if(f=yE(a.timeZone||r.timeZone,new Date(c+u)),isNaN(f))return new Date(NaN)}else f=i_(new Date(c+u)),f=i_(new Date(c+u+f));return new Date(c+u+f)}else return new Date(NaN)}function jj(e){var t={},r=ya.dateTimePattern.exec(e),n;if(r?(t.date=r[1],n=r[3]):(r=ya.datePattern.exec(e),r?(t.date=r[1],n=r[2]):(t.date=null,n=e)),n){var a=ya.timeZone.exec(n);a?(t.time=n.replace(a[1],""),t.timeZone=a[1].trim()):t.time=n}return t}function Ij(e,t){var r=ya.YYY[t],n=ya.YYYYY[t],a;if(a=ya.YYYY.exec(e)||n.exec(e),a){var i=a[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(a=ya.YY.exec(e)||r.exec(e),a){var s=a[1];return{year:parseInt(s,10)*100,restDateString:e.slice(s.length)}}return{year:null}}function Dj(e,t){if(t===null)return null;var r,n,a,i;if(e.length===0)return n=new Date(0),n.setUTCFullYear(t),n;if(r=ya.MM.exec(e),r)return n=new Date(0),a=parseInt(r[1],10)-1,f_(t,a)?(n.setUTCFullYear(t,a),n):new Date(NaN);if(r=ya.DDD.exec(e),r){n=new Date(0);var s=parseInt(r[1],10);return Bj(t,s)?(n.setUTCFullYear(t,0,s),n):new Date(NaN)}if(r=ya.MMDD.exec(e),r){n=new Date(0),a=parseInt(r[1],10)-1;var o=parseInt(r[2],10);return f_(t,a,o)?(n.setUTCFullYear(t,a,o),n):new Date(NaN)}if(r=ya.Www.exec(e),r)return i=parseInt(r[1],10)-1,d_(t,i)?u_(t,i):new Date(NaN);if(r=ya.WwwD.exec(e),r){i=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return d_(t,i,l)?u_(t,i,l):new Date(NaN)}return null}function Oj(e){var t,r,n;if(t=ya.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),hv(r)?r%24*dv:NaN;if(t=ya.HHMM.exec(e),t)return r=parseInt(t[1],10),n=parseFloat(t[2].replace(",",".")),hv(r,n)?r%24*dv+n*c_:NaN;if(t=ya.HHMMSS.exec(e),t){r=parseInt(t[1],10),n=parseInt(t[2],10);var a=parseFloat(t[3].replace(",","."));return hv(r,n,a)?r%24*dv+n*c_+a*1e3:NaN}return null}function u_(e,t,r){t=t||0,r=r||0;var n=new Date(0);n.setUTCFullYear(e,0,4);var a=n.getUTCDay()||7,i=t*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}var Rj=[31,28,31,30,31,30,31,31,30,31,30,31],Mj=[31,29,31,30,31,30,31,31,30,31,30,31];function wE(e){return e%400===0||e%4===0&&e%100!==0}function f_(e,t,r){if(t<0||t>11)return!1;if(r!=null){if(r<1)return!1;var n=wE(e);if(n&&r>Mj[t]||!n&&r>Rj[t])return!1}return!0}function Bj(e,t){if(t<1)return!1;var r=wE(e);return!(r&&t>366||!r&&t>365)}function d_(e,t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function hv(e,t,r){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||r!=null&&(r<0||r>=60))}function Uj(e,t,r){var n=Lj(e,r),a=yE(t,n,!0),i=new Date(n.getTime()-a),s=new Date(0);return s.setFullYear(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()),s.setHours(i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()),s}const zj=({name:e})=>{const[t,r]=O.useState("US/Eastern"),[n,a]=O.useState(new Date),[i,s]=O.useState("");O.useEffect(()=>{(async()=>{try{const{data:{user:c}}=await He.auth.getUser();if(!c)return;const{data:u,error:f}=await He.from("accounting_settings").select("time_zone, company_legal_name").eq("user_id",c.id).single();if(f)throw f;u&&(r(u.time_zone),s(u.company_legal_name||""))}catch(c){console.error("Error fetching timezone:",c)}})()},[]),O.useEffect(()=>{const l=setInterval(()=>{a(new Date)},6e4);return()=>clearInterval(l)},[]);const o=()=>{const c=Uj(n,t).getHours();return c<12?"Good Morning":c<18?"Good Afternoon":"Good Evening"};return p.jsxs("div",{children:[p.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[o(),", ",e,"!"]}),p.jsxs("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:["Here's your financial overview for ",i]})]})};var Wj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Hj=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Lt=(e,t)=>{const r=O.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,children:o,...l},c)=>O.createElement("svg",{ref:c,...Wj,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:`lucide lucide-${Hj(e)}`,...l},[...t.map(([u,f])=>O.createElement(u,f)),...(Array.isArray(o)?o:[o])||[]]));return r.displayName=`${e}`,r},$j=Lt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Vj=Lt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),qj=Lt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Gj=Lt("BookOpenCheck",[["path",{d:"M8 3H2v15h7c1.7 0 3 1.3 3 3V7c0-2.2-1.8-4-4-4Z",key:"1i8u0n"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V3h-6c-2.2 0-4 1.8-4 4v14c0-1.7 1.3-3 3-3h7v-2.3",key:"jb5l51"}]]),Xj=Lt("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Kj=Lt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Yj=Lt("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]),bE=Lt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Jj=Lt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),_E=Lt("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),qu=Lt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),kE=Lt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),SE=Lt("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]),Ng=Lt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),h_=Lt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Zj=Lt("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]),Qj=Lt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),eI=Lt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),EE=Lt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),tI=Lt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),rI=Lt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),nI=Lt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),NE=Lt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),AE=Lt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),Ol=Lt("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),aI=Lt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),iI=Lt("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Rc=Lt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),sI=Lt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]),ko=Lt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),CE=Lt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),oI=Lt("ScrollText",[["path",{d:"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4",key:"13a6an"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M15 12h-5",key:"r7krc0"}]]),TE=Lt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),PE=Lt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),lI=Lt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),cI=Lt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Mc=Lt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Iy=Lt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Dy=Lt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),uI=Lt("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),Oy=Lt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),fI=Lt("User2",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 1 0-16 0",key:"199sx2"}]]),r2=Lt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),FE=Lt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),LE=Lt("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),fa=Lt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),dI=()=>{const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,i]=O.useState(null),[s,o]=O.useState("1d"),l=async u=>{try{n(!0),i(null);const f=new Date,d=new Date;let h=1;switch(u){case"7d":f.setDate(f.getDate()-7),h=7;break;case"30d":f.setDate(f.getDate()-30),h=30;break;default:f.setHours(f.getHours()-24),h=1}d.setDate(d.getDate()-h*2);const v=new Date(f),{count:m,error:y}=await He.from("Account").select("*",{count:"exact",head:!0}).gte("created_at",f.toISOString()),{count:x}=await He.from("Account").select("*",{count:"exact",head:!0}).gte("created_at",d.toISOString()).lt("created_at",v.toISOString());if(y)throw y;const{count:b,error:w}=await He.from("Customer").select("*",{count:"exact",head:!0}).gte("created_at",f.toISOString()),{count:S}=await He.from("Customer").select("*",{count:"exact",head:!0}).gte("created_at",d.toISOString()).lt("created_at",v.toISOString());if(w)throw w;const{count:L,error:j}=await He.from("SaleItems").select("*",{count:"exact",head:!0}).gte("created_at",f.toISOString()),{count:N}=await He.from("SaleItems").select("*",{count:"exact",head:!0}).gte("created_at",d.toISOString()).lt("created_at",v.toISOString());if(j)throw j;const{count:E,error:P}=await He.from("SalesInvoice").select("*",{count:"exact",head:!0}).gte("created_at",f.toISOString()),{count:M}=await He.from("SalesInvoice").select("*",{count:"exact",head:!0}).gte("created_at",d.toISOString()).lt("created_at",v.toISOString());if(P)throw P;const{count:F,error:T}=await He.from("bank_transactions").select("*",{count:"exact",head:!0}).gte("created_at",f.toISOString()),{count:H}=await He.from("bank_transactions").select("*",{count:"exact",head:!0}).gte("created_at",d.toISOString()).lt("created_at",v.toISOString());if(T)throw T;const{count:W,error:Q}=await He.from("VendorInvoice").select("*",{count:"exact",head:!0}).gte("created_at",f.toISOString()),{count:V}=await He.from("VendorInvoice").select("*",{count:"exact",head:!0}).gte("created_at",d.toISOString()).lt("created_at",v.toISOString());if(Q)throw Q;const z=[];m&&m>0&&z.push({type:"Accounts",count:m,previousCount:x||0,change:c(m,x||0)}),b&&b>0&&z.push({type:"Customers",count:b,previousCount:S||0,change:c(b,S||0)}),L&&L>0&&z.push({type:"Sales Items",count:L,previousCount:N||0,change:c(L,N||0)}),E&&E>0&&z.push({type:"Invoices",count:E,previousCount:M||0,change:c(E,M||0)}),F&&F>0&&z.push({type:"Bank Transactions",count:F,previousCount:H||0,change:c(F,H||0)}),W&&W>0&&z.push({type:"Bills",count:W,previousCount:V||0,change:c(W,V||0)}),t(z)}catch(f){console.error("Error fetching recent activity:",f),i(f instanceof Error?f.message:"Failed to fetch recent activity")}finally{n(!1)}},c=(u,f)=>f===0?u>0?100:0:Number(((u-f)/f*100).toFixed(1));return O.useEffect(()=>{l(s);const u=setInterval(()=>l(s),5*60*1e3);return()=>clearInterval(u)},[s]),p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden h-full",children:[p.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Activity"}),p.jsxs("div",{className:"flex space-x-2 text-sm",children:[p.jsx("button",{onClick:()=>o("1d"),className:`px-2 py-1 rounded transition-colors ${s==="1d"?"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"1 day"}),p.jsx("button",{onClick:()=>o("7d"),className:`px-2 py-1 rounded transition-colors ${s==="7d"?"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"7 days"}),p.jsx("button",{onClick:()=>o("30d"),className:`px-2 py-1 rounded transition-colors ${s==="30d"?"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:"30 days"})]})]}),r?p.jsx("div",{className:"p-4 flex justify-center",children:p.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):a?p.jsx("div",{className:"p-4 text-center text-red-500 dark:text-red-400",children:a}):e.length===0?p.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:p.jsx("p",{children:"No new activity"})}):p.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:e.map(u=>p.jsxs("div",{className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[p.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:["New ",u.type]}),p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:u.count}),p.jsxs("div",{className:`flex items-center ${u.change>0?"text-green-500 dark:text-green-400":u.change<0?"text-red-500 dark:text-red-400":"text-gray-400 dark:text-gray-500"}`,children:[u.change>0?p.jsx(Dy,{className:"w-4 h-4 mr-1"}):p.jsx(Iy,{className:"w-4 h-4 mr-1"}),p.jsxs("span",{className:"text-sm font-medium",children:[u.change>0?"+":"",u.change,"%"]})]})]})]},u.type))})]})},pv=({title:e,value:t,change:r,trendData:n=[],type:a})=>{const i=()=>{switch(a){case"sales":return"bg-blue-50 dark:bg-blue-900/20";case"bills":return"bg-red-50 dark:bg-red-900/20";case"cash":return"bg-green-50 dark:bg-green-900/20";default:return"bg-gray-50 dark:bg-gray-800"}},s=()=>{switch(a){case"sales":return"text-blue-500 dark:text-blue-400";case"bills":return"text-red-500 dark:text-red-400";case"cash":return"text-green-500 dark:text-green-400";default:return"text-gray-500 dark:text-gray-400"}},o=()=>a==="bills"?r<0?"text-green-500 dark:text-green-400":"text-red-500 dark:text-red-400":r>0?"text-green-500 dark:text-green-400":"text-red-500 dark:text-red-400",l=Math.max(...n,1),c=n.map(u=>u/l*32);return p.jsxs("div",{className:`rounded-lg p-6 ${i()}`,children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("span",{className:"text-gray-700 dark:text-gray-200 font-medium",children:e}),r>0?p.jsx(Dy,{className:`w-5 h-5 ${s()}`}):p.jsx(Iy,{className:`w-5 h-5 ${s()}`})]}),p.jsxs("div",{className:"flex items-baseline mb-4",children:[p.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t)}),p.jsxs("span",{className:`ml-2 ${o()} text-sm font-medium`,children:[r>0?"+":"",r,"%"]})]}),p.jsx("div",{className:"h-8 flex items-end space-x-1",children:c.map((u,f)=>p.jsx("div",{className:`w-1.5 ${s()} opacity-70 rounded-t transition-all duration-300`,style:{height:`${u}px`}},f))})]})},hI=()=>{const[e,t]=O.useState(""),[r,n]=O.useState({value:0,change:0,trendData:[]}),[a,i]=O.useState({value:0,change:0,trendData:[]}),[s,o]=O.useState({value:0,change:0,trendData:[]}),[l,c]=O.useState(!0);O.useEffect(()=>{(async()=>{const{data:{user:d}}=await He.auth.getUser();if(d){const h=d.user_metadata.full_name;t(h||"User")}})()},[]);const u=async()=>{try{c(!0);const f=new Date,d=new Date(f.getTime()-28*24*60*60*1e3),{data:h,error:v}=await He.from("SalesInvoice").select("InvoiceAmount, InvoiceDate").gte("InvoiceDate",d.toISOString()).order("InvoiceDate",{ascending:!0});if(v)throw v;const m=Array(4).fill(0);let y=0;h==null||h.forEach(F=>{const T=3-Math.floor((f.getTime()-new Date(F.InvoiceDate).getTime())/6048e5);T>=0&&T<4&&(m[T]+=Number(F.InvoiceAmount)||0,y+=Number(F.InvoiceAmount)||0)});const x=m[2],b=m[3],w=x?(b-x)/x*100:0;n({value:y,change:Math.round(w*10)/10,trendData:m});const{data:S,error:L}=await He.from("bank_transactions").select("amount, credit_debit_indicator, date").gte("date",d.toISOString()).order("date",{ascending:!0});if(L)throw L;let j=0;const N=Array(4).fill(0);S==null||S.forEach(F=>{const T=Number(F.amount)||0;j+=F.credit_debit_indicator==="credit"?T:-T;const H=3-Math.floor((f.getTime()-new Date(F.date).getTime())/(7*24*60*60*1e3));H>=0&&H<4&&(N[H]=j)});const E=N[2],P=N[3],M=E?(P-E)/E*100:0;o({value:j,change:Math.round(M*10)/10,trendData:N}),i({value:45e3,change:-2.5,trendData:[42e3,44e3,43e3,45e3]})}catch(f){console.error("Error fetching KPI data:",f)}finally{c(!1)}};return O.useEffect(()=>{u();const f=setInterval(u,5*60*1e3);return()=>clearInterval(f)},[]),p.jsxs("div",{className:"p-6",children:[p.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:p.jsx(zj,{name:e})}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[p.jsx("div",{className:"animate-fade-in",children:p.jsx(pv,{title:"Total Sales",value:r.value,change:r.change,trendData:r.trendData,type:"sales"})}),p.jsx("div",{className:"animate-fade-in [animation-delay:100ms]",children:p.jsx(pv,{title:"Total Bills",value:a.value,change:a.change,trendData:a.trendData,type:"bills"})}),p.jsx("div",{className:"animate-fade-in [animation-delay:200ms]",children:p.jsx(pv,{title:"Cash Balance",value:s.value,change:s.change,trendData:s.trendData,type:"cash"})})]}),p.jsx("div",{className:"max-w-sm",children:p.jsx(dI,{})})]})};function p_(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Ag(...e){return t=>{let r=!1;const n=e.map(a=>{const i=p_(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():p_(e[a],null)}}}}function ca(...e){return O.useCallback(Ag(...e),e)}function m0(e){const t=gI(e),r=O.forwardRef((n,a)=>{const{children:i,...s}=n,o=O.Children.toArray(i),l=o.find(vI);if(l){const c=l.props.children,u=o.map(f=>f===l?O.Children.count(c)>1?O.Children.only(null):O.isValidElement(c)?c.props.children:null:f);return p.jsx(t,{...s,ref:a,children:O.isValidElement(c)?O.cloneElement(c,void 0,u):null})}return p.jsx(t,{...s,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var pI=m0("Slot");function gI(e){const t=O.forwardRef((r,n)=>{const{children:a,...i}=r;if(O.isValidElement(a)){const s=yI(a),o=xI(i,a.props);return a.type!==O.Fragment&&(o.ref=n?Ag(n,s):s),O.cloneElement(a,o)}return O.Children.count(a)>1?O.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var mI=Symbol("radix.slottable");function vI(e){return O.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===mI}function xI(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...o)=>{const l=i(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function yI(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function jE(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=jE(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function IE(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=jE(e))&&(n&&(n+=" "),n+=t);return n}const g_=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,m_=IE,wI=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return m_(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,s=Object.keys(a).map(c=>{const u=r==null?void 0:r[c],f=i==null?void 0:i[c];if(u===null)return null;const d=g_(u)||g_(f);return a[c][d]}),o=r&&Object.entries(r).reduce((c,u)=>{let[f,d]=u;return d===void 0||(c[f]=d),c},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,u)=>{let{class:f,className:d,...h}=u;return Object.entries(h).every(v=>{let[m,y]=v;return Array.isArray(y)?y.includes({...i,...o}[m]):{...i,...o}[m]===y})?[...c,f,d]:c},[]);return m_(e,s,l,r==null?void 0:r.class,r==null?void 0:r.className)},Ry="-",bI=e=>{const t=kI(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:s=>{const o=s.split(Ry);return o[0]===""&&o.length!==1&&o.shift(),DE(o,t)||_I(s)},getConflictingClassGroupIds:(s,o)=>{const l=r[s]||[];return o&&n[s]?[...l,...n[s]]:l}}},DE=(e,t)=>{var s;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?DE(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(Ry);return(s=t.validators.find(({validator:o})=>o(i)))==null?void 0:s.classGroupId},v_=/^\[(.+)\]$/,_I=e=>{if(v_.test(e)){const t=v_.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},kI=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return EI(Object.entries(e.classGroups),r).forEach(([i,s])=>{n2(s,n,i,t)}),n},n2=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:x_(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(SI(a)){n2(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,s])=>{n2(s,x_(t,i),r,n)})})},x_=(e,t)=>{let r=e;return t.split(Ry).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},SI=e=>e.isThemeGetter,EI=(e,t)=>t?e.map(([r,n])=>{const a=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([s,o])=>[t+s,o])):i);return[r,a]}):e,NI=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,s)=>{r.set(i,s),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let s=r.get(i);if(s!==void 0)return s;if((s=n.get(i))!==void 0)return a(i,s),s},set(i,s){r.has(i)?r.set(i,s):a(i,s)}}},OE="!",AI=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],i=t.length,s=o=>{const l=[];let c=0,u=0,f;for(let y=0;y<o.length;y++){let x=o[y];if(c===0){if(x===a&&(n||o.slice(y,y+i)===t)){l.push(o.slice(u,y)),u=y+i;continue}if(x==="/"){f=y;continue}}x==="["?c++:x==="]"&&c--}const d=l.length===0?o:o.substring(u),h=d.startsWith(OE),v=h?d.substring(1):d,m=f&&f>u?f-u:void 0;return{modifiers:l,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:m}};return r?o=>r({className:o,parseClassName:s}):s},CI=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},TI=e=>({cache:NI(e.cacheSize),parseClassName:AI(e),...bI(e)}),PI=/\s+/,FI=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,i=[],s=e.trim().split(PI);let o="";for(let l=s.length-1;l>=0;l-=1){const c=s[l],{modifiers:u,hasImportantModifier:f,baseClassName:d,maybePostfixModifierPosition:h}=r(c);let v=!!h,m=n(v?d.substring(0,h):d);if(!m){if(!v){o=c+(o.length>0?" "+o:o);continue}if(m=n(d),!m){o=c+(o.length>0?" "+o:o);continue}v=!1}const y=CI(u).join(":"),x=f?y+OE:y,b=x+m;if(i.includes(b))continue;i.push(b);const w=a(m,v);for(let S=0;S<w.length;++S){const L=w[S];i.push(x+L)}o=c+(o.length>0?" "+o:o)}return o};function LI(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=RE(t))&&(n&&(n+=" "),n+=r);return n}const RE=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=RE(e[n]))&&(r&&(r+=" "),r+=t);return r};function jI(e,...t){let r,n,a,i=s;function s(l){const c=t.reduce((u,f)=>f(u),e());return r=TI(c),n=r.cache.get,a=r.cache.set,i=o,o(l)}function o(l){const c=n(l);if(c)return c;const u=FI(l,r);return a(l,u),u}return function(){return i(LI.apply(null,arguments))}}const Cr=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},ME=/^\[(?:([a-z-]+):)?(.+)\]$/i,II=/^\d+\/\d+$/,DI=new Set(["px","full","screen"]),OI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,RI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,MI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,BI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,UI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zs=e=>t0(e)||DI.has(e)||II.test(e),Wo=e=>C0(e,"length",XI),t0=e=>!!e&&!Number.isNaN(Number(e)),gv=e=>C0(e,"number",t0),bf=e=>!!e&&Number.isInteger(Number(e)),zI=e=>e.endsWith("%")&&t0(e.slice(0,-1)),Ut=e=>ME.test(e),Ho=e=>OI.test(e),WI=new Set(["length","size","percentage"]),HI=e=>C0(e,WI,BE),$I=e=>C0(e,"position",BE),VI=new Set(["image","url"]),qI=e=>C0(e,VI,YI),GI=e=>C0(e,"",KI),_f=()=>!0,C0=(e,t,r)=>{const n=ME.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},XI=e=>RI.test(e)&&!MI.test(e),BE=()=>!1,KI=e=>BI.test(e),YI=e=>UI.test(e),JI=()=>{const e=Cr("colors"),t=Cr("spacing"),r=Cr("blur"),n=Cr("brightness"),a=Cr("borderColor"),i=Cr("borderRadius"),s=Cr("borderSpacing"),o=Cr("borderWidth"),l=Cr("contrast"),c=Cr("grayscale"),u=Cr("hueRotate"),f=Cr("invert"),d=Cr("gap"),h=Cr("gradientColorStops"),v=Cr("gradientColorStopPositions"),m=Cr("inset"),y=Cr("margin"),x=Cr("opacity"),b=Cr("padding"),w=Cr("saturate"),S=Cr("scale"),L=Cr("sepia"),j=Cr("skew"),N=Cr("space"),E=Cr("translate"),P=()=>["auto","contain","none"],M=()=>["auto","hidden","clip","visible","scroll"],F=()=>["auto",Ut,t],T=()=>[Ut,t],H=()=>["",Zs,Wo],W=()=>["auto",t0,Ut],Q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],V=()=>["solid","dashed","dotted","double","none"],z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],X=()=>["start","end","center","between","around","evenly","stretch"],D=()=>["","0",Ut],ne=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ge=()=>[t0,Ut];return{cacheSize:500,separator:":",theme:{colors:[_f],spacing:[Zs,Wo],blur:["none","",Ho,Ut],brightness:ge(),borderColor:[e],borderRadius:["none","","full",Ho,Ut],borderSpacing:T(),borderWidth:H(),contrast:ge(),grayscale:D(),hueRotate:ge(),invert:D(),gap:T(),gradientColorStops:[e],gradientColorStopPositions:[zI,Wo],inset:F(),margin:F(),opacity:ge(),padding:T(),saturate:ge(),scale:ge(),sepia:D(),skew:ge(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",Ut]}],container:["container"],columns:[{columns:[Ho]}],"break-after":[{"break-after":ne()}],"break-before":[{"break-before":ne()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Q(),Ut]}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",bf,Ut]}],basis:[{basis:F()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ut]}],grow:[{grow:D()}],shrink:[{shrink:D()}],order:[{order:["first","last","none",bf,Ut]}],"grid-cols":[{"grid-cols":[_f]}],"col-start-end":[{col:["auto",{span:["full",bf,Ut]},Ut]}],"col-start":[{"col-start":W()}],"col-end":[{"col-end":W()}],"grid-rows":[{"grid-rows":[_f]}],"row-start-end":[{row:["auto",{span:[bf,Ut]},Ut]}],"row-start":[{"row-start":W()}],"row-end":[{"row-end":W()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ut]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ut]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...X()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...X(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...X(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[N]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[N]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ut,t]}],"min-w":[{"min-w":[Ut,t,"min","max","fit"]}],"max-w":[{"max-w":[Ut,t,"none","full","min","max","fit","prose",{screen:[Ho]},Ho]}],h:[{h:[Ut,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ut,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ut,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ut,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Ho,Wo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",gv]}],"font-family":[{font:[_f]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ut]}],"line-clamp":[{"line-clamp":["none",t0,gv]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Zs,Ut]}],"list-image":[{"list-image":["none",Ut]}],"list-style-type":[{list:["none","disc","decimal",Ut]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...V(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Zs,Wo]}],"underline-offset":[{"underline-offset":["auto",Zs,Ut]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ut]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ut]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Q(),$I]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",HI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},qI]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...V(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:V()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...V()]}],"outline-offset":[{"outline-offset":[Zs,Ut]}],"outline-w":[{outline:[Zs,Wo]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:H()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Zs,Wo]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ho,GI]}],"shadow-color":[{shadow:[_f]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...z(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ho,Ut]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[L]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ut]}],duration:[{duration:ge()}],ease:[{ease:["linear","in","out","in-out",Ut]}],delay:[{delay:ge()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ut]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[bf,Ut]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ut]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ut]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ut]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Zs,Wo,gv]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ZI=jI(JI);function Ln(...e){return ZI(IE(e))}const QI=wI("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),pt=O.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},i)=>{const s=n?pI:"button";return p.jsx(s,{className:Ln(QI({variant:t,size:r,className:e})),ref:i,...a})});pt.displayName="Button";function Rl(e,t){const[r,n]=O.useState(()=>{const s=localStorage.getItem("tableSortConfig");return s?JSON.parse(s):t||null});return O.useEffect(()=>{r&&localStorage.setItem("tableSortConfig",JSON.stringify(r))},[r]),{sortedItems:Es.useMemo(()=>r?[...e].sort((s,o)=>{const l=s[r.key],c=o[r.key];return l==null?1:c==null?-1:typeof l=="string"&&typeof c=="string"?r.direction==="asc"?l.localeCompare(c):c.localeCompare(l):l instanceof Date&&c instanceof Date?r.direction==="asc"?l.getTime()-c.getTime():c.getTime()-l.getTime():r.direction==="asc"?l-c:c-l}):e,[e,r]),sortConfig:r,requestSort:s=>{n(o=>!o||o.key!==s?{key:s,direction:"asc"}:o.direction==="asc"?{key:s,direction:"desc"}:null)}}}const Is=O.forwardRef(({className:e,...t},r)=>p.jsx("div",{className:"relative w-full overflow-auto",children:p.jsx("table",{ref:r,className:Ln("w-full caption-bottom text-sm",e),...t})}));Is.displayName="Table";const Ds=O.forwardRef(({className:e,...t},r)=>p.jsx("thead",{ref:r,className:Ln("[&_tr]:border-b",e),...t}));Ds.displayName="TableHeader";const Os=O.forwardRef(({className:e,...t},r)=>p.jsx("tbody",{ref:r,className:Ln("[&_tr:last-child]:border-0",e),...t}));Os.displayName="TableBody";const eD=O.forwardRef(({className:e,...t},r)=>p.jsx("tfoot",{ref:r,className:Ln("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));eD.displayName="TableFooter";const br=O.forwardRef(({className:e,...t},r)=>p.jsx("tr",{ref:r,className:Ln("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));br.displayName="TableRow";const vt=O.forwardRef(({className:e,...t},r)=>p.jsx("th",{ref:r,className:Ln("p-4 text-left align-middle font-medium text-gray-500 dark:text-gray-400 [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));vt.displayName="TableHead";const ct=O.forwardRef(({className:e,...t},r)=>p.jsx("td",{ref:r,className:Ln("p-4 align-middle text-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));ct.displayName="TableCell";const tD=O.forwardRef(({className:e,...t},r)=>p.jsx("caption",{ref:r,className:Ln("mt-4 text-sm text-muted-foreground",e),...t}));tD.displayName="TableCaption";const rD=[{value:"Revenue",color:"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-400",icon:Dy},{value:"Expense",color:"bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-400",icon:Iy},{value:"Asset",color:"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-400",icon:LE},{value:"Liability",color:"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-400",icon:bE},{value:"Equity",color:"bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-400",icon:Zj}],nD=["Asset","Liability","Equity","Revenue","Expense"],aD=()=>{const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,i]=O.useState(!1),[s,o]=O.useState(null),[l,c]=O.useState(!1),[u,f]=O.useState({account_name:"",account_group:"",account_description:"",account_type:""}),[d,h]=O.useState(!1),[v,m]=O.useState(null),[y,x]=O.useState(null),[b,w]=O.useState(!1),[S,L]=O.useState(!1),[j,N]=O.useState("Revenue"),[E,P]=O.useState({}),{sortedItems:M,sortConfig:F,requestSort:T}=Rl(e.filter(z=>z.account_type===j),{key:"created_at",direction:"desc"}),H=async()=>{try{i(!0),o(null);const{data:{user:z}}=await He.auth.getUser();if(!z){o("You must be logged in to view accounts");return}const{data:X,error:D}=await He.from("Account").select("*").order("id");if(D)throw D;t(X||[])}catch(z){console.error("Error fetching accounts:",z),o(z instanceof Error?z.message:"Failed to fetch accounts")}finally{n(!1),i(!1)}},W=z=>{f({account_name:z.account_name,account_type:z.account_type,account_group:z.account_group,account_description:z.account_description}),x(z.id),c(!0)},Q=async z=>{z.preventDefault(),m(null),P({});const X={};if(u.account_name.trim()||(X.account_name="Account Name is required"),u.account_type||(X.account_type="Account Type is required"),u.account_group.trim()||(X.account_group="Account Group is required"),u.account_description.trim()||(X.account_description="Description is required"),Object.keys(X).length>0){P(X),m("Please fill in all required fields");return}try{h(!0);const{data:{user:D},error:ne}=await He.auth.getUser();if(ne)throw ne;if(!D)throw new Error("You must be logged in to manage accounts");if(y){const{error:ge}=await He.from("Account").update(u).eq("id",y);if(ge)throw ge}else{const{error:ge}=await He.from("Account").insert([{...u,user_id:D.id}]);if(ge)throw ge}f({account_name:"",account_group:"",account_type:"",account_description:""}),x(null),c(!1),H()}catch(D){console.error("Error saving account:",D),m(D instanceof Error?D.message:"Failed to save account")}finally{h(!1)}},V=async()=>{if(y)try{L(!0),m(null),o(null);const{data:{user:z},error:X}=await He.auth.getUser();if(X)throw X;if(!z)throw new Error("You must be logged in to delete accounts");const{data:D,error:ne}=await He.from("Account").select("user_id").eq("id",y).single();if(ne)throw ne;if(!D)throw new Error("Account not found");if(D.user_id!==z.id)throw new Error("You can only delete your own accounts");const{error:ge}=await He.from("Account").delete().eq("id",y).eq("user_id",z.id);if(ge)throw ge;c(!1),x(null),f({account_name:"",account_group:"",account_type:"",account_description:""}),await H(),w(!1)}catch(z){console.error("Error deleting account:",z);const X=z instanceof Error?z.message:"Failed to delete account";m(X),o(X),w(!1)}finally{L(!1)}};return O.useEffect(()=>{H()},[]),p.jsxs("div",{className:"p-8 font-inter",children:[p.jsxs("div",{className:"flex justify-between items-center mb-8",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white tracking-tight",children:"Accounts"}),p.jsx("button",{onClick:H,className:"p-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors rounded-md hover:bg-gray-100 dark:hover:bg-gray-800",disabled:r||b,children:p.jsx(ko,{className:`w-5 h-5 ${r?"animate-spin":""}`})})]}),p.jsx(pt,{icon:p.jsx(Rc,{className:"w-4 h-4"}),variant:"default",className:"bg-black hover:bg-black/90 text-white",onClick:()=>{f({account_name:"",account_group:"",account_description:"",account_type:""}),x(null),c(!0)},children:"New Account"})]}),p.jsx("div",{className:"mb-8 flex space-x-3",children:rD.map(z=>{const X=z.icon;return p.jsxs("button",{onClick:()=>N(z.value),className:`px-5 py-2.5 rounded-md font-medium transition-all duration-200 flex items-center space-x-3 text-sm leading-5 hover:shadow-sm ${j===z.value?z.color:"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[p.jsx(X,{className:"w-4 h-4"}),p.jsx("span",{children:z.value})]},z.value)})}),s&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:s}),r?p.jsx("div",{className:"text-center py-12 flex items-center justify-center",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(vt,{onClick:()=>T("account_name"),className:"cursor-pointer",children:"Account Name"}),p.jsx(vt,{onClick:()=>T("account_type"),className:"cursor-pointer",children:"Account Type"}),p.jsx(vt,{onClick:()=>T("account_group"),className:"cursor-pointer",children:"Group"}),p.jsx(vt,{onClick:()=>T("account_description"),className:"cursor-pointer",children:"Description"}),p.jsx(vt,{children:"Actions"})]})}),p.jsxs(Os,{children:[M.map(z=>p.jsxs(br,{children:[p.jsx(ct,{children:p.jsx("div",{className:"text-sm leading-5 font-medium text-gray-900 dark:text-white",children:z.account_name})}),p.jsx(ct,{children:p.jsx("div",{className:"text-sm leading-5 text-gray-500 dark:text-gray-400",children:z.account_type||"-"})}),p.jsx(ct,{children:p.jsx("div",{className:"text-sm leading-5 text-gray-500 dark:text-gray-400",children:z.account_group||"-"})}),p.jsx(ct,{children:p.jsx("div",{className:"text-sm leading-5 text-gray-500 dark:text-gray-400",children:z.account_description||"-"})}),p.jsx(ct,{children:p.jsx("button",{onClick:()=>W(z),className:"p-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-all duration-200 rounded-md hover:bg-blue-50 dark:hover:bg-blue-900/20",children:p.jsx(Ol,{className:"w-4 h-4"})})})]},z.id)),e.length===0&&p.jsx(br,{children:p.jsx(ct,{colSpan:6,className:"text-center",children:'No accounts found. Click "New Account" to add one.'})})]})]})})}),p.jsx("div",{className:`fixed inset-y-0 right-0 w-[480px] bg-white dark:bg-gray-900 shadow-xl transform transition-transform duration-300 ease-in-out ${l?"translate-x-0":"translate-x-full"}`,children:p.jsxs("div",{className:"h-full flex flex-col",children:[p.jsxs("div",{className:"px-8 py-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white tracking-tight",children:y?"Edit Account":"New Account"}),p.jsx("button",{onClick:()=>{c(!1),x(null),m(null)},className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-all duration-200 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("form",{onSubmit:Q,className:"flex-1 overflow-y-auto px-8 py-6",children:[v&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400 text-sm",children:v}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"account_name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Account Name *"}),p.jsx("input",{type:"text",id:"account_name",value:u.account_name,onChange:z=>f({...u,account_name:z.target.value}),className:Ln("w-full px-4 py-2.5 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white text-sm leading-5 transition-shadow duration-200 hover:border-gray-400 dark:hover:border-gray-600",E.account_name&&"border-red-500 focus:ring-red-500"),placeholder:"Enter account name"}),E.account_name&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:E.account_name})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"account_type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Account Type *"}),p.jsxs("select",{id:"account_type",value:u.account_type,onChange:z=>f({...u,account_type:z.target.value}),className:Ln("w-full px-4 py-2.5 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white text-sm leading-5 transition-shadow duration-200 hover:border-gray-400 dark:hover:border-gray-600",E.account_type&&"border-red-500 focus:ring-red-500"),children:[p.jsx("option",{value:"",children:"Select account type"}),nD.map(z=>p.jsx("option",{value:z,children:z},z))]}),E.account_type&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:E.account_type})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"account_group",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Account Group *"}),p.jsx("input",{type:"text",id:"account_group",value:u.account_group,onChange:z=>f({...u,account_group:z.target.value}),className:Ln("w-full px-4 py-2.5 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white text-sm leading-5 transition-shadow duration-200 hover:border-gray-400 dark:hover:border-gray-600",E.account_group&&"border-red-500 focus:ring-red-500"),placeholder:"Enter account group"}),E.account_group&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:E.account_group})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"account_description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description *"}),p.jsx("textarea",{id:"account_description",value:u.account_description,onChange:z=>f({...u,account_description:z.target.value}),rows:4,className:Ln("w-full px-4 py-2.5 border border-gray-300 dark:border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white text-sm leading-5 transition-shadow duration-200 hover:border-gray-400 dark:hover:border-gray-600",E.account_description&&"border-red-500 focus:ring-red-500"),placeholder:"Enter account description"}),E.account_description&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:E.account_description})]})]})]}),p.jsx("div",{className:"px-8 py-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:p.jsxs("div",{className:"flex space-x-3",children:[y&&p.jsx(pt,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:()=>w(!0),disabled:d||S,children:"Delete Account"}),p.jsx(pt,{variant:"primary",className:"flex-1 bg-black hover:bg-black/90 text-white",onClick:Q,disabled:d||S,children:d?"Saving...":y?"Save Changes":"Save Account"}),p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>{c(!1),x(null),m(null)},disabled:d,children:"Cancel"})]})})]})}),b&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirm Deletion"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Are you sure you want to delete this account? This action cannot be undone."}),p.jsxs("div",{className:"flex space-x-4",children:[p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>w(!1),disabled:S,children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:V,disabled:S,children:S?"Deleting...":"Delete"})]})]})})]})},iD=["Pending","Paid","Partially Paid","Overdue","Cancelled"],sD=({isOpen:e,onClose:t,onSave:r,onAlert:n})=>{const[a,i]=O.useState([]),[s,o]=O.useState([]),[l,c]=O.useState(!1),[u,f]=O.useState(null),[d,h]=O.useState({customerName:"",customerEmail:"",invoiceDate:new Date().toISOString().split("T")[0],invoiceAmount:"",itemName:"",description:"",status:"Pending",attachment:void 0,sendEmail:!1}),v=async y=>{if(y)try{const{data:x,error:b}=await He.from("Customer").select("Customer_Email").eq("Customer_name",y).single();if(b)throw b;x&&h(w=>({...w,customerEmail:x.Customer_Email||""}))}catch(x){console.error("Error fetching customer email:",x)}};O.useEffect(()=>{e&&(async()=>{try{const{data:x,error:b}=await He.from("Customer").select("Customer_name").order("Customer_name");if(b)throw b;const{data:w,error:S}=await He.from("SaleItems").select("Item_Name").order("Item_Name");if(S)throw S;i(x||[]),o(w||[])}catch(x){console.error("Error fetching data:",x),f(x instanceof Error?x.message:"Failed to fetch data")}})()},[e]);const m=async y=>{if(y.preventDefault(),f(null),!d.customerName||!d.invoiceDate||!d.invoiceAmount){f("Please fill in all required fields");return}if(d.attachment){if(d.attachment.size>1024*1024){f("File size must not exceed 1 MB");return}if(d.attachment.type!=="application/pdf"){f("Only PDF files are allowed");return}}try{c(!0);let x=null,b=null;if(d.attachment){const M=d.attachment.name.split(".").pop(),T=`${`${Date.now()}.${M}`}`,{error:H}=await He.storage.from("invoicefiles").upload(T,d.attachment);if(H)throw H;x=T}const{data:w,error:S}=await He.from("Account").select("id").eq("account_name","Accounts Receivable").single();if(S)throw new Error("Required accounts not found");const{data:L,error:j}=await He.from("Account").select("id").eq("account_name","Sales Income").single();if(j)throw new Error("Required accounts not found");const{data:N,error:E}=await He.from("SalesInvoice").insert([{Customer_name:d.customerName,InvoiceDate:d.invoiceDate,InvoiceAmount:parseFloat(d.invoiceAmount),Description:d.description,Status:d.status,attachment_path:x,OutstandingAmount:parseFloat(d.invoiceAmount),ItemID:s.findIndex(M=>M.Item_Name===d.itemName)+1}]).select().single();if(E)throw E;b=N.id;const{error:P}=await He.from("Transaction").insert([{transaction_date:d.invoiceDate,account_id:w.id,debit_amount:parseFloat(d.invoiceAmount),credit_amount:0,description:`Invoice #${b} - ${d.customerName}`,invoice_id:b,bill_id:0,row_num:1,Status:d.status},{transaction_date:d.invoiceDate,account_id:L.id,debit_amount:0,credit_amount:parseFloat(d.invoiceAmount),description:`Invoice #${b} - ${d.customerName}`,invoice_id:b,bill_id:0,row_num:2,Status:d.status}]);if(P)throw P;d.sendEmail&&d.customerEmail&&(n==null||n("Sending invoice email...","info"),await He.functions.invoke("send-invoice-email",{body:{to:d.customerEmail,invoiceNumber:b,customerName:d.customerName,amount:d.invoiceAmount,attachmentPath:x}}),n==null||n("Invoice email sent successfully","success")),r(),n==null||n("Invoice created successfully","success"),t()}catch(x){console.error("Error saving invoice:",x),f(x instanceof Error?x.message:"Failed to save invoice")}finally{c(!1)}};return e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-5xl",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add Invoice"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("form",{onSubmit:m,className:"p-4",children:[u&&p.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:u}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Customer Name *"}),p.jsxs("select",{value:d.customerName,onChange:y=>{const x=y.target.value;h({...d,customerName:x}),v(x)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0,children:[p.jsx("option",{value:"",children:"Select customer"}),a.map(y=>p.jsx("option",{value:y.Customer_name,children:y.Customer_name},y.Customer_name))]}),p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Customer Email"}),p.jsx("input",{type:"email",value:d.customerEmail,onChange:y=>h({...d,customerEmail:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",placeholder:"customer@example.com"}),p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Invoice Date *"}),p.jsx("input",{type:"date",value:d.invoiceDate,onChange:y=>h({...d,invoiceDate:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white [&::-webkit-calendar-picker-indicator]:dark:invert",required:!0}),p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Invoice Amount *"}),p.jsx("input",{type:"number",step:"0.01",value:d.invoiceAmount,onChange:y=>h({...d,invoiceAmount:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",placeholder:"0.00",required:!0})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Item"}),p.jsxs("select",{value:d.itemName,onChange:y=>h({...d,itemName:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:[p.jsx("option",{value:"",children:"Select item"}),s.map(y=>p.jsx("option",{value:y.Item_Name,children:y.Item_Name},y.Item_Name))]}),p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),p.jsx("textarea",{value:d.description,onChange:y=>h({...d,description:y.target.value}),rows:3,className:"w-full px-3 py-1.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",placeholder:"Enter invoice description"}),p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Attachment (PDF only, max 1MB)"}),p.jsx("input",{type:"file",accept:".pdf",onChange:y=>{var b;const x=(b=y.target.files)==null?void 0:b[0];h({...d,attachment:x})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("input",{type:"checkbox",id:"sendEmail",checked:d.sendEmail,onChange:y=>h({...d,sendEmail:y.target.checked}),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500"}),p.jsx("label",{htmlFor:"sendEmail",className:"text-sm text-gray-700 dark:text-gray-300",children:"Send email to customer automatically"})]}),p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),p.jsx("select",{value:d.status,onChange:y=>h({...d,status:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:iD.map(y=>p.jsx("option",{value:y,children:y},y))})]})]}),p.jsxs("div",{className:"mt-4 flex space-x-3",children:[p.jsx(pt,{type:"submit",variant:"primary",className:"flex-1",disabled:l,children:l?"Saving...":"Save Invoice"}),p.jsx(pt,{type:"button",variant:"outline",className:"flex-1",onClick:t,disabled:l,children:"Cancel"})]})]})]})}):null},oD=["Pending","Paid","Partially Paid","Overdue","Cancelled"],lD=({isOpen:e,onClose:t,invoice:r,onSave:n,onAlert:a})=>{const[i,s]=O.useState(r.Status),[o,l]=O.useState(!1),[c,u]=O.useState(null);if(!e)return null;const f=async()=>{try{l(!0),u(null);const{error:d}=await He.from("SalesInvoice").update({Status:i}).eq("id",r.id);if(d)throw d;const{error:h}=await He.from("Transaction").update({Status:i}).eq("invoice_id",r.id);if(h)throw h;n(),a==null||a(`Invoice status updated to ${i}`,i==="Overdue"?"warning":"success"),t()}catch(d){console.error("Error updating invoice status:",d),u(d instanceof Error?d.message:"Failed to update status")}finally{l(!1)}};return p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-lg",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Invoice #",r.id," Details"]}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"p-6 space-y-4",children:[c&&p.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:c}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Invoice Date"}),p.jsx("input",{type:"text",value:new Date(r.InvoiceDate).toLocaleDateString(),disabled:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-500 dark:text-gray-400"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Customer"}),p.jsx("input",{type:"text",value:r.Customer_name,disabled:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-500 dark:text-gray-400"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),p.jsx("textarea",{value:r.Description||"",disabled:!0,rows:3,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-500 dark:text-gray-400"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Invoice Amount"}),p.jsx("input",{type:"text",value:r.InvoiceAmount?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r.InvoiceAmount):"-",disabled:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-500 dark:text-gray-400"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Outstanding Amount"}),p.jsx("input",{type:"text",value:r.OutstandingAmount?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r.OutstandingAmount):"-",disabled:!0,className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg text-gray-500 dark:text-gray-400"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),p.jsx("select",{value:i,onChange:d=>s(d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:oD.map(d=>p.jsx("option",{value:d,children:d},d))})]})]}),p.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[p.jsx(pt,{variant:"outline",onClick:t,disabled:o,children:"Cancel"}),p.jsx(pt,{variant:"primary",onClick:f,disabled:o,children:o?"Saving...":"Save Changes"})]})]})})},cD=({isOpen:e,onClose:t,invoice:r})=>{const[n,a]=O.useState(null),[i,s]=O.useState(null),[o,l]=O.useState(!0);return O.useEffect(()=>{const c=async()=>{if(r.attachment_path)try{l(!0);const{data:u,error:f}=await He.storage.from("invoicefiles").createSignedUrl(r.attachment_path,3600);if(f)throw f;a(u.signedUrl)}catch(u){console.error("Error fetching PDF:",u),s("Failed to load PDF")}finally{l(!1)}};return e&&r.attachment_path&&c(),()=>{a(null),s(null),l(!1)}},[e,r.attachment_path]),e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-3xl",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Invoice #",r.id," Preview"]}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsx("div",{className:"p-6",children:i?p.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-100 dark:bg-gray-800 rounded-lg",children:p.jsx("p",{className:"text-red-500 dark:text-red-400",children:i})}):r.attachment_path?o?p.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-100 dark:bg-gray-800 rounded-lg",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):n&&p.jsx("div",{className:"space-y-4",children:p.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-100 dark:bg-gray-800 rounded-lg",children:p.jsxs("div",{className:"text-center",children:[p.jsx(Ng,{className:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-600 mb-4"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"PDF document ready for viewing"}),p.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[p.jsx(kE,{className:"w-4 h-4 mr-2"}),"Open PDF"]})]})})}):p.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-100 dark:bg-gray-800 rounded-lg",children:p.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No attachment available"})})}),p.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700",children:p.jsx(pt,{variant:"outline",onClick:t,children:"Close"})})]})}):null},uD=[{value:"Pending",color:"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-400"},{value:"Paid",color:"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-400"},{value:"Partially Paid",color:"bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-400"},{value:"Overdue",color:"bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-400"},{value:"Cancelled",color:"bg-gray-100 dark:bg-gray-900/50 text-gray-800 dark:text-gray-400"}],fD=({onAlert:e})=>{const[t,r]=O.useState([]),[n,a]=O.useState(!0),[i,s]=O.useState([]),[o,l]=O.useState(null),[c,u]=O.useState(!1),[f,d]=O.useState(!1),[h,v]=O.useState(!1),[m,y]=O.useState(null),[x,b]=O.useState(!1),[w,S]=O.useState(!1),[L,j]=O.useState("Pending"),{sortedItems:N,sortConfig:E,requestSort:P}=Rl(t.filter(W=>W.Status===L),{key:"InvoiceDate",direction:"desc"}),M=async()=>{try{a(!0),l(null);const{data:W,error:Q}=await He.from("SalesInvoice").select("*").order("InvoiceDate",{ascending:!1});if(Q)throw Q;r(W||[])}catch(W){console.error("Error fetching invoices:",W),l(W instanceof Error?W.message:"Failed to fetch invoices")}finally{a(!1)}};O.useEffect(()=>{M()},[]);const F=W=>{s(Q=>Q.includes(W)?Q.filter(V=>V!==W):[...Q,W])},T=()=>{s(i.length===t.length?[]:t.map(W=>W.id))},H=async()=>{try{v(!0),l(null);const{error:W}=await He.from("SalesInvoice").delete().in("id",i);if(W)throw W;s([]),d(!1),e==null||e("Invoices deleted successfully","success"),await M()}catch(W){console.error("Error deleting invoices:",W),l(W instanceof Error?W.message:"Failed to delete invoices"),d(!1)}finally{v(!1)}};return p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Sales Invoices"}),p.jsx("button",{onClick:M,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",disabled:n,children:p.jsx(ko,{className:`w-5 h-5 ${n?"animate-spin":""}`})}),i.length>0&&p.jsx("button",{onClick:()=>d(!0),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors",title:"Delete selected invoices",children:p.jsx(Mc,{className:"w-5 h-5"})}),i.length>0&&p.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:[i.length," selected"]})]}),p.jsx("div",{className:"flex items-center space-x-4",children:p.jsx(pt,{variant:"default",className:"bg-black hover:bg-black/90 text-white",icon:p.jsx(Rc,{className:"w-4 h-4"}),onClick:()=>u(!0),children:"Add Invoice"})})]}),p.jsx("div",{className:"mb-6 flex space-x-2",children:uD.map(W=>p.jsx("button",{onClick:()=>j(W.value),className:`px-4 py-2 rounded-lg font-medium transition-colors ${L===W.value?W.color:"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:W.value},W.value))}),o&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:o}),p.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(vt,{className:"w-12",children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:i.length===t.length&&t.length>0,onChange:T})}),p.jsx(vt,{onClick:()=>P("id"),className:"cursor-pointer",children:"Invoice No."}),p.jsx(vt,{onClick:()=>P("InvoiceDate"),className:"cursor-pointer",children:"Date"}),p.jsx(vt,{onClick:()=>P("Customer_name"),className:"cursor-pointer",children:"Customer"}),p.jsx(vt,{onClick:()=>P("OutstandingAmount"),className:"cursor-pointer",children:"Outstanding Amount"}),p.jsx(vt,{children:"Actions"})]})}),p.jsxs(Os,{children:[N.map(W=>p.jsxs(br,{className:`hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${i.includes(W.id)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[p.jsx(ct,{children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:i.includes(W.id),onChange:()=>F(W.id)})}),p.jsxs(ct,{className:"font-medium",children:["#",W.id]}),p.jsx(ct,{children:new Date(W.InvoiceDate).toLocaleDateString()}),p.jsx(ct,{children:W.Customer_name}),p.jsx(ct,{children:W.OutstandingAmount?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(W.OutstandingAmount):"-"}),p.jsx(ct,{children:p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("button",{onClick:()=>{y(W),b(!0)},className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"Edit invoice status",children:p.jsx(Ol,{className:"w-4 h-4"})}),W.attachment_path&&W.attachment_path.trim()&&p.jsx("button",{onClick:()=>{y(W),S(!0)},className:"text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",title:"View attachment",children:p.jsx(AE,{className:"w-4 h-4"})})]})})]},W.id)),t.length===0&&!n&&p.jsx(br,{children:p.jsx(ct,{colSpan:6,className:"text-center",children:"No invoices found"})})]})]})})}),p.jsx(sD,{isOpen:c,onClose:()=>u(!1),onAlert:e,onSave:M}),f&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirm Deletion"}),p.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Are you sure you want to delete ",i.length," selected invoice",i.length>1?"s":"","? This action cannot be undone."]}),p.jsxs("div",{className:"flex space-x-4",children:[p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>d(!1),children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:H,disabled:h,children:h?"Deleting...":"Delete"})]})]})}),m&&p.jsxs(p.Fragment,{children:[p.jsx(lD,{isOpen:x,onClose:()=>{b(!1),y(null)},onAlert:e,invoice:m,onSave:M}),p.jsx(cD,{isOpen:w,onClose:()=>{S(!1),y(null)},invoice:m})]})]})};var ia=Uint8Array,ai=Uint16Array,My=Int32Array,Cg=new ia([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tg=new ia([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a2=new ia([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),UE=function(e,t){for(var r=new ai(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new My(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},zE=UE(Cg,2),WE=zE.b,i2=zE.r;WE[28]=258,i2[258]=28;var HE=UE(Tg,0),dD=HE.b,y_=HE.r,s2=new ai(32768);for(var Fr=0;Fr<32768;++Fr){var $o=(Fr&43690)>>1|(Fr&21845)<<1;$o=($o&52428)>>2|($o&13107)<<2,$o=($o&61680)>>4|($o&3855)<<4,s2[Fr]=(($o&65280)>>8|($o&255)<<8)>>1}var Fs=function(e,t,r){for(var n=e.length,a=0,i=new ai(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new ai(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new ai(1<<t);var l=15-t;for(a=0;a<n;++a)if(e[a])for(var c=a<<4|e[a],u=t-e[a],f=s[e[a]-1]++<<u,d=f|(1<<u)-1;f<=d;++f)o[s2[f]>>l]=c}else for(o=new ai(n),a=0;a<n;++a)e[a]&&(o[a]=s2[s[e[a]-1]++]>>15-e[a]);return o},_l=new ia(288);for(var Fr=0;Fr<144;++Fr)_l[Fr]=8;for(var Fr=144;Fr<256;++Fr)_l[Fr]=9;for(var Fr=256;Fr<280;++Fr)_l[Fr]=7;for(var Fr=280;Fr<288;++Fr)_l[Fr]=8;var Ad=new ia(32);for(var Fr=0;Fr<32;++Fr)Ad[Fr]=5;var hD=Fs(_l,9,0),pD=Fs(_l,9,1),gD=Fs(Ad,5,0),mD=Fs(Ad,5,1),mv=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},qi=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},vv=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},By=function(e){return(e+7)/8|0},$E=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new ia(e.subarray(t,r))},vD=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Yi=function(e,t,r){var n=new Error(t||vD[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Yi),!r)throw n;return n},xD=function(e,t,r,n){var a=e.length,i=n?n.length:0;if(!a||t.f&&!t.l)return r||new ia(0);var s=!r,o=s||t.i!=2,l=t.i;s&&(r=new ia(a*3));var c=function(Pe){var re=r.length;if(Pe>re){var Ue=new ia(Math.max(re*2,Pe));Ue.set(r),r=Ue}},u=t.f||0,f=t.p||0,d=t.b||0,h=t.l,v=t.d,m=t.m,y=t.n,x=a*8;do{if(!h){u=qi(e,f,1);var b=qi(e,f+1,3);if(f+=3,b)if(b==1)h=pD,v=mD,m=9,y=5;else if(b==2){var j=qi(e,f,31)+257,N=qi(e,f+10,15)+4,E=j+qi(e,f+5,31)+1;f+=14;for(var P=new ia(E),M=new ia(19),F=0;F<N;++F)M[a2[F]]=qi(e,f+F*3,7);f+=N*3;for(var T=mv(M),H=(1<<T)-1,W=Fs(M,T,1),F=0;F<E;){var Q=W[qi(e,f,H)];f+=Q&15;var w=Q>>4;if(w<16)P[F++]=w;else{var V=0,z=0;for(w==16?(z=3+qi(e,f,3),f+=2,V=P[F-1]):w==17?(z=3+qi(e,f,7),f+=3):w==18&&(z=11+qi(e,f,127),f+=7);z--;)P[F++]=V}}var X=P.subarray(0,j),D=P.subarray(j);m=mv(X),y=mv(D),h=Fs(X,m,1),v=Fs(D,y,1)}else Yi(1);else{var w=By(f)+4,S=e[w-4]|e[w-3]<<8,L=w+S;if(L>a){l&&Yi(0);break}o&&c(d+S),r.set(e.subarray(w,L),d),t.b=d+=S,t.p=f=L*8,t.f=u;continue}if(f>x){l&&Yi(0);break}}o&&c(d+131072);for(var ne=(1<<m)-1,ge=(1<<y)-1,C=f;;C=f){var V=h[vv(e,f)&ne],R=V>>4;if(f+=V&15,f>x){l&&Yi(0);break}if(V||Yi(2),R<256)r[d++]=R;else if(R==256){C=f,h=null;break}else{var B=R-254;if(R>264){var F=R-257,U=Cg[F];B=qi(e,f,(1<<U)-1)+WE[F],f+=U}var Y=v[vv(e,f)&ge],ue=Y>>4;Y||Yi(3),f+=Y&15;var D=dD[ue];if(ue>3){var U=Tg[ue];D+=vv(e,f)&(1<<U)-1,f+=U}if(f>x){l&&Yi(0);break}o&&c(d+131072);var pe=d+B;if(d<D){var he=i-D,ye=Math.min(D,pe);for(he+d<0&&Yi(3);d<ye;++d)r[d]=n[he+d]}for(;d<pe;++d)r[d]=r[d-D]}}t.l=h,t.p=C,t.b=d,t.f=u,h&&(u=1,t.m=m,t.d=v,t.n=y)}while(!u);return d!=r.length&&s?$E(r,0,d):r.subarray(0,d)},Qs=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},kf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},xv=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:qE,l:0};if(a==1){var s=new ia(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(L,j){return L.f-j.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,f=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=a-1;)o=r[r[c].f<r[f].f?c++:f++],l=r[c!=u&&r[c].f<r[f].f?c++:f++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var d=i[0].s,n=1;n<a;++n)i[n].s>d&&(d=i[n].s);var h=new ai(d+1),v=o2(r[u-1],h,0);if(v>t){var n=0,m=0,y=v-t,x=1<<y;for(i.sort(function(j,N){return h[N.s]-h[j.s]||j.f-N.f});n<a;++n){var b=i[n].s;if(h[b]>t)m+=x-(1<<v-h[b]),h[b]=t;else break}for(m>>=y;m>0;){var w=i[n].s;h[w]<t?m-=1<<t-h[w]++-1:++n}for(;n>=0&&m;--n){var S=i[n].s;h[S]==t&&(--h[S],++m)}v=t}return{t:new ia(h),l:v}},o2=function(e,t,r){return e.s==-1?Math.max(o2(e.l,t,r+1),o2(e.r,t,r+1)):t[e.s]=r},w_=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ai(++t),n=0,a=e[0],i=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},Sf=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},VE=function(e,t,r){var n=r.length,a=By(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},b_=function(e,t,r,n,a,i,s,o,l,c,u){Qs(t,u++,r),++a[256];for(var f=xv(a,15),d=f.t,h=f.l,v=xv(i,15),m=v.t,y=v.l,x=w_(d),b=x.c,w=x.n,S=w_(m),L=S.c,j=S.n,N=new ai(19),E=0;E<b.length;++E)++N[b[E]&31];for(var E=0;E<L.length;++E)++N[L[E]&31];for(var P=xv(N,7),M=P.t,F=P.l,T=19;T>4&&!M[a2[T-1]];--T);var H=c+5<<3,W=Sf(a,_l)+Sf(i,Ad)+s,Q=Sf(a,d)+Sf(i,m)+s+14+3*T+Sf(N,M)+2*N[16]+3*N[17]+7*N[18];if(l>=0&&H<=W&&H<=Q)return VE(t,u,e.subarray(l,l+c));var V,z,X,D;if(Qs(t,u,1+(Q<W)),u+=2,Q<W){V=Fs(d,h,0),z=d,X=Fs(m,y,0),D=m;var ne=Fs(M,F,0);Qs(t,u,w-257),Qs(t,u+5,j-1),Qs(t,u+10,T-4),u+=14;for(var E=0;E<T;++E)Qs(t,u+3*E,M[a2[E]]);u+=3*T;for(var ge=[b,L],C=0;C<2;++C)for(var R=ge[C],E=0;E<R.length;++E){var B=R[E]&31;Qs(t,u,ne[B]),u+=M[B],B>15&&(Qs(t,u,R[E]>>5&127),u+=R[E]>>12)}}else V=hD,z=_l,X=gD,D=Ad;for(var E=0;E<o;++E){var U=n[E];if(U>255){var B=U>>18&31;kf(t,u,V[B+257]),u+=z[B+257],B>7&&(Qs(t,u,U>>23&31),u+=Cg[B]);var Y=U&31;kf(t,u,X[Y]),u+=D[Y],Y>3&&(kf(t,u,U>>5&8191),u+=Tg[Y])}else kf(t,u,V[U]),u+=z[U]}return kf(t,u,V[256]),u+z[256]},yD=new My([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),qE=new ia(0),wD=function(e,t,r,n,a,i){var s=i.z||e.length,o=new ia(n+s+5*(1+Math.ceil(s/7e3))+a),l=o.subarray(n,o.length-a),c=i.l,u=(i.r||0)&7;if(t){u&&(l[0]=i.r>>3);for(var f=yD[t-1],d=f>>13,h=f&8191,v=(1<<r)-1,m=i.p||new ai(32768),y=i.h||new ai(v+1),x=Math.ceil(r/3),b=2*x,w=function(Ye){return(e[Ye]^e[Ye+1]<<x^e[Ye+2]<<b)&v},S=new My(25e3),L=new ai(288),j=new ai(32),N=0,E=0,P=i.i||0,M=0,F=i.w||0,T=0;P+2<s;++P){var H=w(P),W=P&32767,Q=y[H];if(m[W]=Q,y[H]=W,F<=P){var V=s-P;if((N>7e3||M>24576)&&(V>423||!c)){u=b_(e,l,0,S,L,j,E,M,T,P-T,u),M=N=E=0,T=P;for(var z=0;z<286;++z)L[z]=0;for(var z=0;z<30;++z)j[z]=0}var X=2,D=0,ne=h,ge=W-Q&32767;if(V>2&&H==w(P-ge))for(var C=Math.min(d,V)-1,R=Math.min(32767,P),B=Math.min(258,V);ge<=R&&--ne&&W!=Q;){if(e[P+X]==e[P+X-ge]){for(var U=0;U<B&&e[P+U]==e[P+U-ge];++U);if(U>X){if(X=U,D=ge,U>C)break;for(var Y=Math.min(ge,U-2),ue=0,z=0;z<Y;++z){var pe=P-ge+z&32767,he=m[pe],ye=pe-he&32767;ye>ue&&(ue=ye,Q=pe)}}}W=Q,Q=m[W],ge+=W-Q&32767}if(D){S[M++]=268435456|i2[X]<<18|y_[D];var Pe=i2[X]&31,re=y_[D]&31;E+=Cg[Pe]+Tg[re],++L[257+Pe],++j[re],F=P+X,++N}else S[M++]=e[P],++L[e[P]]}}for(P=Math.max(P,F);P<s;++P)S[M++]=e[P],++L[e[P]];u=b_(e,l,c,S,L,j,E,M,T,P-T,u),c||(i.r=u&7|l[u/8|0]<<3,u-=7,i.h=y,i.p=m,i.i=P,i.w=F)}else{for(var P=i.w||0;P<s+c;P+=65535){var Ue=P+65535;Ue>=s&&(l[u/8|0]=c,Ue=s),u=VE(l,u+1,e.subarray(P,Ue))}i.i=s}return $E(o,0,n+By(u)+a)},GE=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},bD=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new ia(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return wD(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},XE=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},_D=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=GE();a.p(t.dictionary),XE(e,2,a.d())}},kD=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Yi(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Yi(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function l2(e,t){t||(t={});var r=GE();r.p(e);var n=bD(e,t,t.dictionary?6:2,4);return _D(n,t),XE(n,n.length-4,r.d()),n}function SD(e,t){return xD(e.subarray(kD(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}var ED=typeof TextDecoder<"u"&&new TextDecoder,ND=0;try{ED.decode(qE,{stream:!0}),ND=1}catch{}var Nt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function yv(){Nt.console&&typeof Nt.console.log=="function"&&Nt.console.log.apply(Nt.console,arguments)}var wr={log:yv,warn:function(e){Nt.console&&(typeof Nt.console.warn=="function"?Nt.console.warn.apply(Nt.console,arguments):yv.call(null,arguments))},error:function(e){Nt.console&&(typeof Nt.console.error=="function"?Nt.console.error.apply(Nt.console,arguments):yv(e))}};function wv(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){rc(n.response,t,r)},n.onerror=function(){wr.error("could not download file")},n.send()}function __(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function S1(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Gf,c2,rc=Nt.saveAs||((typeof window>"u"?"undefined":dr(window))!=="object"||window!==Nt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Nt.URL||Nt.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?__(a.href)?wv(e,t,r):S1(a,a.target="_blank"):S1(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){S1(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(__(e))wv(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){S1(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:dr(i)!=="object"&&(wr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return wv(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(Nt.HTMLElement)||Nt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":dr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(e)}else{var l=Nt.URL||Nt.webkitURL,c=l.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function KE(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function bv(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=Yn(r,n,a,i,t[0],7,-680876936),i=Yn(i,r,n,a,t[1],12,-389564586),a=Yn(a,i,r,n,t[2],17,606105819),n=Yn(n,a,i,r,t[3],22,-1044525330),r=Yn(r,n,a,i,t[4],7,-176418897),i=Yn(i,r,n,a,t[5],12,1200080426),a=Yn(a,i,r,n,t[6],17,-1473231341),n=Yn(n,a,i,r,t[7],22,-45705983),r=Yn(r,n,a,i,t[8],7,1770035416),i=Yn(i,r,n,a,t[9],12,-1958414417),a=Yn(a,i,r,n,t[10],17,-42063),n=Yn(n,a,i,r,t[11],22,-1990404162),r=Yn(r,n,a,i,t[12],7,1804603682),i=Yn(i,r,n,a,t[13],12,-40341101),a=Yn(a,i,r,n,t[14],17,-1502002290),r=Jn(r,n=Yn(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=Jn(i,r,n,a,t[6],9,-1069501632),a=Jn(a,i,r,n,t[11],14,643717713),n=Jn(n,a,i,r,t[0],20,-373897302),r=Jn(r,n,a,i,t[5],5,-701558691),i=Jn(i,r,n,a,t[10],9,38016083),a=Jn(a,i,r,n,t[15],14,-660478335),n=Jn(n,a,i,r,t[4],20,-405537848),r=Jn(r,n,a,i,t[9],5,568446438),i=Jn(i,r,n,a,t[14],9,-1019803690),a=Jn(a,i,r,n,t[3],14,-187363961),n=Jn(n,a,i,r,t[8],20,1163531501),r=Jn(r,n,a,i,t[13],5,-1444681467),i=Jn(i,r,n,a,t[2],9,-51403784),a=Jn(a,i,r,n,t[7],14,1735328473),r=Zn(r,n=Jn(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=Zn(i,r,n,a,t[8],11,-2022574463),a=Zn(a,i,r,n,t[11],16,1839030562),n=Zn(n,a,i,r,t[14],23,-35309556),r=Zn(r,n,a,i,t[1],4,-1530992060),i=Zn(i,r,n,a,t[4],11,1272893353),a=Zn(a,i,r,n,t[7],16,-155497632),n=Zn(n,a,i,r,t[10],23,-1094730640),r=Zn(r,n,a,i,t[13],4,681279174),i=Zn(i,r,n,a,t[0],11,-358537222),a=Zn(a,i,r,n,t[3],16,-722521979),n=Zn(n,a,i,r,t[6],23,76029189),r=Zn(r,n,a,i,t[9],4,-640364487),i=Zn(i,r,n,a,t[12],11,-421815835),a=Zn(a,i,r,n,t[15],16,530742520),r=Qn(r,n=Zn(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=Qn(i,r,n,a,t[7],10,1126891415),a=Qn(a,i,r,n,t[14],15,-1416354905),n=Qn(n,a,i,r,t[5],21,-57434055),r=Qn(r,n,a,i,t[12],6,1700485571),i=Qn(i,r,n,a,t[3],10,-1894986606),a=Qn(a,i,r,n,t[10],15,-1051523),n=Qn(n,a,i,r,t[1],21,-2054922799),r=Qn(r,n,a,i,t[8],6,1873313359),i=Qn(i,r,n,a,t[15],10,-30611744),a=Qn(a,i,r,n,t[6],15,-1560198380),n=Qn(n,a,i,r,t[13],21,1309151649),r=Qn(r,n,a,i,t[4],6,-145523070),i=Qn(i,r,n,a,t[11],10,-1120210379),a=Qn(a,i,r,n,t[2],15,718787259),n=Qn(n,a,i,r,t[9],21,-343485551),e[0]=ll(r,e[0]),e[1]=ll(n,e[1]),e[2]=ll(a,e[2]),e[3]=ll(i,e[3])}function Pg(e,t,r,n,a,i){return t=ll(ll(t,e),ll(n,i)),ll(t<<a|t>>>32-a,r)}function Yn(e,t,r,n,a,i,s){return Pg(t&r|~t&n,e,t,a,i,s)}function Jn(e,t,r,n,a,i,s){return Pg(t&n|r&~n,e,t,a,i,s)}function Zn(e,t,r,n,a,i,s){return Pg(t^r^n,e,t,a,i,s)}function Qn(e,t,r,n,a,i,s){return Pg(r^(t|~n),e,t,a,i,s)}function YE(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)bv(n,AD(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(bv(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,bv(n,a),n}function AD(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}Gf=Nt.atob.bind(Nt),c2=Nt.btoa.bind(Nt);var k_="0123456789abcdef".split("");function CD(e){for(var t="",r=0;r<4;r++)t+=k_[e>>8*r+4&15]+k_[e>>8*r&15];return t}function TD(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function u2(e){return YE(e).map(TD).join("")}var PD=function(e){for(var t=0;t<e.length;t++)e[t]=CD(e[t]);return e.join("")}(YE("hello"))!="5d41402abc4b2a76b9719d911017c592";function ll(e,t){if(PD){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function f2(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length>>0),new Array(i+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+s.charCodeAt(l))%256,o[l]=o[c],o[c]=u}r=e,n=o}else o=n;var f=t.length,d=0,h=0,v="";for(l=0;l<f;l++)h=(h+(u=o[d=(d+1)%256]))%256,o[d]=o[h],o[h]=u,s=o[(o[d]+o[h])%256],v+=String.fromCharCode(t.charCodeAt(l)^s);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var S_={print:4,modify:8,copy:16,"annot-forms":32};function Fu(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(o){if(S_.perm!==void 0)throw new Error("Invalid permission: "+o);a+=S_[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=u2(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=f2(this.encryptionKey,this.padding)}function Lu(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=e[n]}return t}function E_(e){if(dr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(o){Nt.console&&wr.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Cd(e){if(!(this instanceof Cd))return new Cd(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function JE(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function rl(e,t,r,n,a){if(!(this instanceof rl))return new rl(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,JE.call(this,n,a)}function lc(e,t,r,n,a){if(!(this instanceof lc))return new lc(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,JE.call(this,n,a)}function kt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,l=16,c="S",u=null;dr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,d={},h={internal:{},__private__:{}};h.__private__.PubSub=E_;var v="1.3",m=h.__private__.getPdfVersion=function(){return v};h.__private__.setPdfVersion=function(k){v=k};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return y};var x=h.__private__.getPageFormat=function(k){return y[k]};a=a||"a4";var b={COMPAT:"compat",ADVANCED:"advanced"},w=b.COMPAT;function S(){this.saveGraphicsState(),oe(new bt(qe,0,0,-qe,0,To()*qe).toString()+" cm"),this.setFontSize(this.getFontSize()/qe),c="n",w=b.ADVANCED}function L(){this.restoreGraphicsState(),c="S",w=b.COMPAT}var j=h.__private__.combineFontStyleAndFontWeight=function(k,G){if(k=="bold"&&G=="normal"||k=="bold"&&G==400||k=="normal"&&G=="italic"||k=="bold"&&G=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return G&&(k=G==400||G==="normal"?k==="italic"?"italic":"normal":G!=700&&G!=="bold"||k!=="normal"?(G==700?"bold":G)+""+k:"bold"),k};h.advancedAPI=function(k){var G=w===b.COMPAT;return G&&S.call(this),typeof k!="function"||(k(this),G&&L.call(this)),this},h.compatAPI=function(k){var G=w===b.ADVANCED;return G&&L.call(this),typeof k!="function"||(k(this),G&&S.call(this)),this},h.isAdvancedAPI=function(){return w===b.ADVANCED};var N,E=function(k){if(w!==b.ADVANCED)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},P=h.roundToPrecision=h.__private__.roundToPrecision=function(k,G){var de=t||G;if(isNaN(k)||isNaN(de))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(de).replace(/0+$/,"")};N=h.hpf=h.__private__.hpf=typeof l=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return P(k,l)}:l==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return P(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return P(k,16)};var M=h.f2=h.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return P(k,2)},F=h.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return P(k,3)},T=h.scale=h.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return w===b.COMPAT?k*qe:w===b.ADVANCED?k:void 0},H=function(k){return w===b.COMPAT?To()-k:w===b.ADVANCED?k:void 0},W=function(k){return T(H(k))};h.__private__.setPrecision=h.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var Q,V="00000000000000000000000000000000",z=h.__private__.getFileId=function(){return V},X=h.__private__.setFileId=function(k){return V=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():V.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(qn=new Fu(u.userPermissions,u.userPassword,u.ownerPassword,V)),V};h.setFileId=function(k){return X(k),this},h.getFileId=function(){return z()};var D=h.__private__.convertDateToPDFDate=function(k){var G=k.getTimezoneOffset(),de=G<0?"+":"-",me=Math.floor(Math.abs(G/60)),_e=Math.abs(G%60),je=[de,B(me),"'",B(_e),"'"].join("");return["D:",k.getFullYear(),B(k.getMonth()+1),B(k.getDate()),B(k.getHours()),B(k.getMinutes()),B(k.getSeconds()),je].join("")},ne=h.__private__.convertPDFDateToDate=function(k){var G=parseInt(k.substr(2,4),10),de=parseInt(k.substr(6,2),10)-1,me=parseInt(k.substr(8,2),10),_e=parseInt(k.substr(10,2),10),je=parseInt(k.substr(12,2),10),$e=parseInt(k.substr(14,2),10);return new Date(G,de,me,_e,je,$e,0)},ge=h.__private__.setCreationDate=function(k){var G;if(k===void 0&&(k=new Date),k instanceof Date)G=D(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");G=k}return Q=G},C=h.__private__.getCreationDate=function(k){var G=Q;return k==="jsDate"&&(G=ne(Q)),G};h.setCreationDate=function(k){return ge(k),this},h.getCreationDate=function(k){return C(k)};var R,B=h.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},U=h.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},Y=0,ue=[],pe=[],he=0,ye=[],Pe=[],re=!1,Ue=pe,Ye=function(){Y=0,he=0,pe=[],ue=[],ye=[],ae=Wr(),ie=Wr()};h.__private__.setCustomOutputDestination=function(k){re=!0,Ue=k};var Ce=function(k){re||(Ue=k)};h.__private__.resetCustomOutputDestination=function(){re=!1,Ue=pe};var oe=h.__private__.out=function(k){return k=k.toString(),he+=k.length+1,Ue.push(k),Ue},De=h.__private__.write=function(k){return oe(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},Qe=h.__private__.getArrayBuffer=function(k){for(var G=k.length,de=new ArrayBuffer(G),me=new Uint8Array(de);G--;)me[G]=k.charCodeAt(G);return de},Be=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Be};var Ke=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(k){return Ke=w===b.ADVANCED?k/qe:k,this};var tt,rt=h.__private__.getFontSize=h.getFontSize=function(){return w===b.COMPAT?Ke:Ke*qe},ht=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(k){return ht=k,this},h.__private__.getR2L=h.getR2L=function(){return ht};var gt,St=h.__private__.setZoomMode=function(k){var G=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))tt=k;else if(isNaN(k)){if(G.indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');tt=k}else tt=parseInt(k,10)};h.__private__.getZoomMode=function(){return tt};var Tt,Ht=h.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');gt=k};h.__private__.getPageMode=function(){return gt};var It=h.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');Tt=k};h.__private__.getLayoutMode=function(){return Tt},h.__private__.setDisplayMode=h.setDisplayMode=function(k,G,de){return St(k),It(G),Ht(de),this};var mt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(k){if(Object.keys(mt).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return mt[k]},h.__private__.getDocumentProperties=function(){return mt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(k){for(var G in mt)mt.hasOwnProperty(G)&&k[G]&&(mt[G]=k[G]);return this},h.__private__.setDocumentProperty=function(k,G){if(Object.keys(mt).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return mt[k]=G};var at,qe,or,wt,vn,ir={},_r={},fi=[],Jt={},fs={},Ar={},Ha={},Ri=null,xr=0,Ft=[],rr=new E_(h),zs=e.hotfixes||[],xn={},di={},hi=[],bt=function k(G,de,me,_e,je,$e){if(!(this instanceof k))return new k(G,de,me,_e,je,$e);isNaN(G)&&(G=1),isNaN(de)&&(de=0),isNaN(me)&&(me=0),isNaN(_e)&&(_e=1),isNaN(je)&&(je=0),isNaN($e)&&($e=0),this._matrix=[G,de,me,_e,je,$e]};Object.defineProperty(bt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(bt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(bt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(bt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(bt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(bt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(bt.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(bt.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(bt.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(bt.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(bt.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(bt.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(bt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(bt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(bt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(bt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),bt.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(N).join(k)},bt.prototype.multiply=function(k){var G=k.sx*this.sx+k.shy*this.shx,de=k.sx*this.shy+k.shy*this.sy,me=k.shx*this.sx+k.sy*this.shx,_e=k.shx*this.shy+k.sy*this.sy,je=k.tx*this.sx+k.ty*this.shx+this.tx,$e=k.tx*this.shy+k.ty*this.sy+this.ty;return new bt(G,de,me,_e,je,$e)},bt.prototype.decompose=function(){var k=this.sx,G=this.shy,de=this.shx,me=this.sy,_e=this.tx,je=this.ty,$e=Math.sqrt(k*k+G*G),lt=(k/=$e)*de+(G/=$e)*me;de-=k*lt,me-=G*lt;var xt=Math.sqrt(de*de+me*me);return lt/=xt,k*(me/=xt)<G*(de/=xt)&&(k=-k,G=-G,lt=-lt,$e=-$e),{scale:new bt($e,0,0,xt,0,0),translate:new bt(1,0,0,1,_e,je),rotate:new bt(k,G,-G,k,0,0),skew:new bt(1,0,lt,1,0,0)}},bt.prototype.toString=function(k){return this.join(" ")},bt.prototype.inversed=function(){var k=this.sx,G=this.shy,de=this.shx,me=this.sy,_e=this.tx,je=this.ty,$e=1/(k*me-G*de),lt=me*$e,xt=-G*$e,Rt=-de*$e,Dt=k*$e;return new bt(lt,xt,Rt,Dt,-lt*_e-Rt*je,-xt*_e-Dt*je)},bt.prototype.applyToPoint=function(k){var G=k.x*this.sx+k.y*this.shx+this.tx,de=k.x*this.shy+k.y*this.sy+this.ty;return new tu(G,de)},bt.prototype.applyToRectangle=function(k){var G=this.applyToPoint(k),de=this.applyToPoint(new tu(k.x+k.w,k.y+k.h));return new V0(G.x,G.y,de.x-G.x,de.y-G.y)},bt.prototype.clone=function(){var k=this.sx,G=this.shy,de=this.shx,me=this.sy,_e=this.tx,je=this.ty;return new bt(k,G,de,me,_e,je)},h.Matrix=bt;var $a=h.matrixMult=function(k,G){return G.multiply(k)},Na=new bt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Na;var Vn=function(k,G){if(!fs[k]){var de=(G instanceof rl?"Sh":"P")+(Object.keys(Jt).length+1).toString(10);G.id=de,fs[k]=de,Jt[de]=G,rr.publish("addPattern",G)}};h.ShadingPattern=rl,h.TilingPattern=lc,h.addShadingPattern=function(k,G){return E("addShadingPattern()"),Vn(k,G),this},h.beginTilingPattern=function(k){E("beginTilingPattern()"),Fh(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},h.endTilingPattern=function(k,G){E("endTilingPattern()"),G.stream=Pe[R].join(`
`),Vn(k,G),rr.publish("endTilingPattern",G),hi.pop().restore()};var Yr=h.__private__.newObject=function(){var k=Wr();return J(k,!0),k},Wr=h.__private__.newObjectDeferred=function(){return Y++,ue[Y]=function(){return he},Y},J=function(k,G){return G=typeof G=="boolean"&&G,ue[k]=he,G&&oe(k+" 0 obj"),k},ce=h.__private__.newAdditionalObject=function(){var k={objId:Wr(),content:""};return ye.push(k),k},ae=Wr(),ie=Wr(),le=h.__private__.decodeColorString=function(k){var G=k.split(" ");if(G.length!==2||G[1]!=="g"&&G[1]!=="G")G.length===5&&(G[4]==="k"||G[4]==="K")&&(G=[(1-G[0])*(1-G[3]),(1-G[1])*(1-G[3]),(1-G[2])*(1-G[3]),"r"]);else{var de=parseFloat(G[0]);G=[de,de,de,"r"]}for(var me="#",_e=0;_e<3;_e++)me+=("0"+Math.floor(255*parseFloat(G[_e])).toString(16)).slice(-2);return me},fe=h.__private__.encodeColorString=function(k){var G;typeof k=="string"&&(k={ch1:k});var de=k.ch1,me=k.ch2,_e=k.ch3,je=k.ch4,$e=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof de=="string"&&de.charAt(0)!=="#"){var lt=new KE(de);if(lt.ok)de=lt.toHex();else if(!/^\d*\.?\d*$/.test(de))throw new Error('Invalid color "'+de+'" passed to jsPDF.encodeColorString.')}if(typeof de=="string"&&/^#[0-9A-Fa-f]{3}$/.test(de)&&(de="#"+de[1]+de[1]+de[2]+de[2]+de[3]+de[3]),typeof de=="string"&&/^#[0-9A-Fa-f]{6}$/.test(de)){var xt=parseInt(de.substr(1),16);de=xt>>16&255,me=xt>>8&255,_e=255&xt}if(me===void 0||je===void 0&&de===me&&me===_e)if(typeof de=="string")G=de+" "+$e[0];else switch(k.precision){case 2:G=M(de/255)+" "+$e[0];break;case 3:default:G=F(de/255)+" "+$e[0]}else if(je===void 0||dr(je)==="object"){if(je&&!isNaN(je.a)&&je.a===0)return G=["1.","1.","1.",$e[1]].join(" ");if(typeof de=="string")G=[de,me,_e,$e[1]].join(" ");else switch(k.precision){case 2:G=[M(de/255),M(me/255),M(_e/255),$e[1]].join(" ");break;default:case 3:G=[F(de/255),F(me/255),F(_e/255),$e[1]].join(" ")}}else if(typeof de=="string")G=[de,me,_e,je,$e[2]].join(" ");else switch(k.precision){case 2:G=[M(de),M(me),M(_e),M(je),$e[2]].join(" ");break;case 3:default:G=[F(de),F(me),F(_e),F(je),$e[2]].join(" ")}return G},Se=h.__private__.getFilters=function(){return s},Fe=h.__private__.putStream=function(k){var G=(k=k||{}).data||"",de=k.filters||Se(),me=k.alreadyAppliedFilters||[],_e=k.addLength1||!1,je=G.length,$e=k.objectId,lt=function(Gn){return Gn};if(u!==null&&$e===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(lt=qn.encryptor($e,0));var xt={};de===!0&&(de=["FlateEncode"]);var Rt=k.additionalKeyValues||[],Dt=(xt=kt.API.processDataByFilters!==void 0?kt.API.processDataByFilters(G,de):{data:G,reverseChain:[]}).reverseChain+(Array.isArray(me)?me.join(" "):me.toString());if(xt.data.length!==0&&(Rt.push({key:"Length",value:xt.data.length}),_e===!0&&Rt.push({key:"Length1",value:je})),Dt.length!=0)if(Dt.split("/").length-1==1)Rt.push({key:"Filter",value:Dt});else{Rt.push({key:"Filter",value:"["+Dt+"]"});for(var Yt=0;Yt<Rt.length;Yt+=1)if(Rt[Yt].key==="DecodeParms"){for(var Or=[],Hr=0;Hr<xt.reverseChain.split("/").length-1;Hr+=1)Or.push("null");Or.push(Rt[Yt].value),Rt[Yt].value="["+Or.join(" ")+"]"}}oe("<<");for(var cn=0;cn<Rt.length;cn++)oe("/"+Rt[cn].key+" "+Rt[cn].value);oe(">>"),xt.data.length!==0&&(oe("stream"),oe(lt(xt.data)),oe("endstream"))},ke=h.__private__.putPage=function(k){var G=k.number,de=k.data,me=k.objId,_e=k.contentsObjId;J(me,!0),oe("<</Type /Page"),oe("/Parent "+k.rootDictionaryObjId+" 0 R"),oe("/Resources "+k.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(N(k.mediaBox.bottomLeftX))+" "+parseFloat(N(k.mediaBox.bottomLeftY))+" "+N(k.mediaBox.topRightX)+" "+N(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&oe("/CropBox ["+N(k.cropBox.bottomLeftX)+" "+N(k.cropBox.bottomLeftY)+" "+N(k.cropBox.topRightX)+" "+N(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&oe("/BleedBox ["+N(k.bleedBox.bottomLeftX)+" "+N(k.bleedBox.bottomLeftY)+" "+N(k.bleedBox.topRightX)+" "+N(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&oe("/TrimBox ["+N(k.trimBox.bottomLeftX)+" "+N(k.trimBox.bottomLeftY)+" "+N(k.trimBox.topRightX)+" "+N(k.trimBox.topRightY)+"]"),k.artBox!==null&&oe("/ArtBox ["+N(k.artBox.bottomLeftX)+" "+N(k.artBox.bottomLeftY)+" "+N(k.artBox.topRightX)+" "+N(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&oe("/UserUnit "+k.userUnit),rr.publish("putPage",{objId:me,pageContext:Ft[G],pageNumber:G,page:de}),oe("/Contents "+_e+" 0 R"),oe(">>"),oe("endobj");var je=de.join(`
`);return w===b.ADVANCED&&(je+=`
Q`),J(_e,!0),Fe({data:je,filters:Se(),objectId:_e}),oe("endobj"),me},Ae=h.__private__.putPages=function(){var k,G,de=[];for(k=1;k<=xr;k++)Ft[k].objId=Wr(),Ft[k].contentsObjId=Wr();for(k=1;k<=xr;k++)de.push(ke({number:k,data:Pe[k],objId:Ft[k].objId,contentsObjId:Ft[k].contentsObjId,mediaBox:Ft[k].mediaBox,cropBox:Ft[k].cropBox,bleedBox:Ft[k].bleedBox,trimBox:Ft[k].trimBox,artBox:Ft[k].artBox,userUnit:Ft[k].userUnit,rootDictionaryObjId:ae,resourceDictionaryObjId:ie}));J(ae,!0),oe("<</Type /Pages");var me="/Kids [";for(G=0;G<xr;G++)me+=de[G]+" 0 R ";oe(me+"]"),oe("/Count "+xr),oe(">>"),oe("endobj"),rr.publish("postPutPages")},Te=function(k){rr.publish("putFont",{font:k,out:oe,newObject:Yr,putStream:Fe}),k.isAlreadyPutted!==!0&&(k.objectNumber=Yr(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+Lu(k.postScriptName)),oe("/Subtype /Type1"),typeof k.encoding=="string"&&oe("/Encoding /"+k.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},Ve=function(){for(var k in ir)ir.hasOwnProperty(k)&&(f===!1||f===!0&&d.hasOwnProperty(k))&&Te(ir[k])},Je=function(k){k.objectNumber=Yr();var G=[];G.push({key:"Type",value:"/XObject"}),G.push({key:"Subtype",value:"/Form"}),G.push({key:"BBox",value:"["+[N(k.x),N(k.y),N(k.x+k.width),N(k.y+k.height)].join(" ")+"]"}),G.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var de=k.pages[1].join(`
`);Fe({data:de,additionalKeyValues:G,objectId:k.objectNumber}),oe("endobj")},ot=function(){for(var k in xn)xn.hasOwnProperty(k)&&Je(xn[k])},Xe=function(k,G){var de,me=[],_e=1/(G-1);for(de=0;de<1;de+=_e)me.push(de);if(me.push(1),k[0].offset!=0){var je={offset:0,color:k[0].color};k.unshift(je)}if(k[k.length-1].offset!=1){var $e={offset:1,color:k[k.length-1].color};k.push($e)}for(var lt="",xt=0,Rt=0;Rt<me.length;Rt++){for(de=me[Rt];de>k[xt+1].offset;)xt++;var Dt=k[xt].offset,Yt=(de-Dt)/(k[xt+1].offset-Dt),Or=k[xt].color,Hr=k[xt+1].color;lt+=U(Math.round((1-Yt)*Or[0]+Yt*Hr[0]).toString(16))+U(Math.round((1-Yt)*Or[1]+Yt*Hr[1]).toString(16))+U(Math.round((1-Yt)*Or[2]+Yt*Hr[2]).toString(16))}return lt.trim()},st=function(k,G){G||(G=21);var de=Yr(),me=Xe(k.colors,G),_e=[];_e.push({key:"FunctionType",value:"0"}),_e.push({key:"Domain",value:"[0.0 1.0]"}),_e.push({key:"Size",value:"["+G+"]"}),_e.push({key:"BitsPerSample",value:"8"}),_e.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_e.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fe({data:me,additionalKeyValues:_e,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:de}),oe("endobj"),k.objectNumber=Yr(),oe("<< /ShadingType "+k.type),oe("/ColorSpace /DeviceRGB");var je="/Coords ["+N(parseFloat(k.coords[0]))+" "+N(parseFloat(k.coords[1]))+" ";k.type===2?je+=N(parseFloat(k.coords[2]))+" "+N(parseFloat(k.coords[3])):je+=N(parseFloat(k.coords[2]))+" "+N(parseFloat(k.coords[3]))+" "+N(parseFloat(k.coords[4]))+" "+N(parseFloat(k.coords[5])),oe(je+="]"),k.matrix&&oe("/Matrix ["+k.matrix.toString()+"]"),oe("/Function "+de+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},Pt=function(k,G){var de=Wr(),me=Yr();G.push({resourcesOid:de,objectOid:me}),k.objectNumber=me;var _e=[];_e.push({key:"Type",value:"/Pattern"}),_e.push({key:"PatternType",value:"1"}),_e.push({key:"PaintType",value:"1"}),_e.push({key:"TilingType",value:"1"}),_e.push({key:"BBox",value:"["+k.boundingBox.map(N).join(" ")+"]"}),_e.push({key:"XStep",value:N(k.xStep)}),_e.push({key:"YStep",value:N(k.yStep)}),_e.push({key:"Resources",value:de+" 0 R"}),k.matrix&&_e.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),Fe({data:k.stream,additionalKeyValues:_e,objectId:k.objectNumber}),oe("endobj")},sr=function(k){var G;for(G in Jt)Jt.hasOwnProperty(G)&&(Jt[G]instanceof rl?st(Jt[G]):Jt[G]instanceof lc&&Pt(Jt[G],k))},gr=function(k){for(var G in k.objectNumber=Yr(),oe("<<"),k)switch(G){case"opacity":oe("/ca "+M(k[G]));break;case"stroke-opacity":oe("/CA "+M(k[G]))}oe(">>"),oe("endobj")},ln=function(){var k;for(k in Ar)Ar.hasOwnProperty(k)&&gr(Ar[k])},Mi=function(){for(var k in oe("/XObject <<"),xn)xn.hasOwnProperty(k)&&xn[k].objectNumber>=0&&oe("/"+k+" "+xn[k].objectNumber+" 0 R");rr.publish("putXobjectDict"),oe(">>")},Ws=function(){qn.oid=Yr(),oe("<<"),oe("/Filter /Standard"),oe("/V "+qn.v),oe("/R "+qn.r),oe("/U <"+qn.toHexString(qn.U)+">"),oe("/O <"+qn.toHexString(qn.O)+">"),oe("/P "+qn.P),oe(">>"),oe("endobj")},ds=function(){for(var k in oe("/Font <<"),ir)ir.hasOwnProperty(k)&&(f===!1||f===!0&&d.hasOwnProperty(k))&&oe("/"+k+" "+ir[k].objectNumber+" 0 R");oe(">>")},Bi=function(){if(Object.keys(Jt).length>0){for(var k in oe("/Shading <<"),Jt)Jt.hasOwnProperty(k)&&Jt[k]instanceof rl&&Jt[k].objectNumber>=0&&oe("/"+k+" "+Jt[k].objectNumber+" 0 R");rr.publish("putShadingPatternDict"),oe(">>")}},hs=function(k){if(Object.keys(Jt).length>0){for(var G in oe("/Pattern <<"),Jt)Jt.hasOwnProperty(G)&&Jt[G]instanceof h.TilingPattern&&Jt[G].objectNumber>=0&&Jt[G].objectNumber<k&&oe("/"+G+" "+Jt[G].objectNumber+" 0 R");rr.publish("putTilingPatternDict"),oe(">>")}},Va=function(){if(Object.keys(Ar).length>0){var k;for(k in oe("/ExtGState <<"),Ar)Ar.hasOwnProperty(k)&&Ar[k].objectNumber>=0&&oe("/"+k+" "+Ar[k].objectNumber+" 0 R");rr.publish("putGStateDict"),oe(">>")}},Jr=function(k){J(k.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),ds(),Bi(),hs(k.objectOid),Va(),Mi(),oe(">>"),oe("endobj")},mh=function(){var k=[];Ve(),ln(),ot(),sr(k),rr.publish("putResources"),k.forEach(Jr),Jr({resourcesOid:ie,objectOid:Number.MAX_SAFE_INTEGER}),rr.publish("postPutResources")},vh=function(){rr.publish("putAdditionalObjects");for(var k=0;k<ye.length;k++){var G=ye[k];J(G.objId,!0),oe(G.content),oe("endobj")}rr.publish("postPutAdditionalObjects")},xh=function(k){_r[k.fontName]=_r[k.fontName]||{},_r[k.fontName][k.fontStyle]=k.id},O0=function(k,G,de,me,_e){var je={id:"F"+(Object.keys(ir).length+1).toString(10),postScriptName:k,fontName:G,fontStyle:de,encoding:me,isStandardFont:_e||!1,metadata:{}};return rr.publish("addFont",{font:je,instance:this}),ir[je.id]=je,xh(je),je.id},Kg=function(k){for(var G=0,de=Be.length;G<de;G++){var me=O0.call(this,k[G][0],k[G][1],k[G][2],Be[G][3],!0);f===!1&&(d[me]=!0);var _e=k[G][0].split("-");xh({id:me,fontName:_e[0],fontStyle:_e[1]||""})}rr.publish("addFonts",{fonts:ir,dictionary:_r})},Ui=function(k){return k.foo=function(){try{return k.apply(this,arguments)}catch(me){var G=me.stack||"";~G.indexOf(" at ")&&(G=G.split(" at ")[1]);var de="Error in function "+G.split(`
`)[0].split("<")[0]+": "+me.message;if(!Nt.console)throw new Error(de);Nt.console.error(de,me),Nt.alert&&alert(de)}},k.foo.bar=k,k.foo},Kc=function(k,G){var de,me,_e,je,$e,lt,xt,Rt,Dt;if(_e=(G=G||{}).sourceEncoding||"Unicode",$e=G.outputEncoding,(G.autoencode||$e)&&ir[at].metadata&&ir[at].metadata[_e]&&ir[at].metadata[_e].encoding&&(je=ir[at].metadata[_e].encoding,!$e&&ir[at].encoding&&($e=ir[at].encoding),!$e&&je.codePages&&($e=je.codePages[0]),typeof $e=="string"&&($e=je[$e]),$e)){for(xt=!1,lt=[],de=0,me=k.length;de<me;de++)(Rt=$e[k.charCodeAt(de)])?lt.push(String.fromCharCode(Rt)):lt.push(k[de]),lt[de].charCodeAt(0)>>8&&(xt=!0);k=lt.join("")}for(de=k.length;xt===void 0&&de!==0;)k.charCodeAt(de-1)>>8&&(xt=!0),de--;if(!xt)return k;for(lt=G.noBOM?[]:[254,255],de=0,me=k.length;de<me;de++){if((Dt=(Rt=k.charCodeAt(de))>>8)>>8)throw new Error("Character at position "+de+" of string '"+k+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");lt.push(Dt),lt.push(Rt-(Dt<<8))}return String.fromCharCode.apply(void 0,lt)},Aa=h.__private__.pdfEscape=h.pdfEscape=function(k,G){return Kc(k,G).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},R0=h.__private__.beginPage=function(k){Pe[++xr]=[],Ft[xr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},wh(xr),Ce(Pe[R])},yh=function(k,G){var de,me,_e;switch(r=G||r,typeof k=="string"&&(de=x(k.toLowerCase()),Array.isArray(de)&&(me=de[0],_e=de[1])),Array.isArray(k)&&(me=k[0]*qe,_e=k[1]*qe),isNaN(me)&&(me=a[0],_e=a[1]),(me>14400||_e>14400)&&(wr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),me=Math.min(14400,me),_e=Math.min(14400,_e)),a=[me,_e],r.substr(0,1)){case"l":_e>me&&(a=[_e,me]);break;case"p":me>_e&&(a=[_e,me])}R0(a),Nh(z0),oe(zi),H0!==0&&oe(H0+" J"),$0!==0&&oe($0+" j"),rr.publish("addPage",{pageNumber:xr})},Yg=function(k){k>0&&k<=xr&&(Pe.splice(k,1),Ft.splice(k,1),xr--,R>xr&&(R=xr),this.setPage(R))},wh=function(k){k>0&&k<=xr&&(R=k)},Jg=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Pe.length-1},bh=function(k,G,de){var me,_e=void 0;return de=de||{},k=k!==void 0?k:ir[at].fontName,G=G!==void 0?G:ir[at].fontStyle,me=k.toLowerCase(),_r[me]!==void 0&&_r[me][G]!==void 0?_e=_r[me][G]:_r[k]!==void 0&&_r[k][G]!==void 0?_e=_r[k][G]:de.disableWarning===!1&&wr.warn("Unable to look up font label for font '"+k+"', '"+G+"'. Refer to getFontList() for available fonts."),_e||de.noFallback||(_e=_r.times[G])==null&&(_e=_r.times.normal),_e},Zg=h.__private__.putInfo=function(){var k=Yr(),G=function(me){return me};for(var de in u!==null&&(G=qn.encryptor(k,0)),oe("<<"),oe("/Producer ("+Aa(G("jsPDF "+kt.version))+")"),mt)mt.hasOwnProperty(de)&&mt[de]&&oe("/"+de.substr(0,1).toUpperCase()+de.substr(1)+" ("+Aa(G(mt[de]))+")");oe("/CreationDate ("+Aa(G(Q))+")"),oe(">>"),oe("endobj")},M0=h.__private__.putCatalog=function(k){var G=(k=k||{}).rootDictionaryObjId||ae;switch(Yr(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+G+" 0 R"),tt||(tt="fullwidth"),tt){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var de=""+tt;de.substr(de.length-1)==="%"&&(tt=parseInt(tt)/100),typeof tt=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+M(tt)+"]")}switch(Tt||(Tt="continuous"),Tt){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}gt&&oe("/PageMode /"+gt),rr.publish("putCatalog"),oe(">>"),oe("endobj")},Qg=h.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(Y+1)),oe("/Root "+Y+" 0 R"),oe("/Info "+(Y-1)+" 0 R"),u!==null&&oe("/Encrypt "+qn.oid+" 0 R"),oe("/ID [ <"+V+"> <"+V+"> ]"),oe(">>")},em=h.__private__.putHeader=function(){oe("%PDF-"+v),oe("%")},tm=h.__private__.putXRef=function(){var k="0000000000";oe("xref"),oe("0 "+(Y+1)),oe("0000000000 65535 f ");for(var G=1;G<=Y;G++)typeof ue[G]=="function"?oe((k+ue[G]()).slice(-10)+" 00000 n "):ue[G]!==void 0?oe((k+ue[G]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},Hs=h.__private__.buildDocument=function(){Ye(),Ce(pe),rr.publish("buildDocument"),em(),Ae(),vh(),mh(),u!==null&&Ws(),Zg(),M0();var k=he;return tm(),Qg(),oe("startxref"),oe(""+k),oe("%%EOF"),Ce(Pe[R]),pe.join(`
`)},Yc=h.__private__.getBlob=function(k){return new Blob([Qe(k)],{type:"application/pdf"})},Jc=h.output=h.__private__.output=Ui(function(k,G){switch(typeof(G=G||{})=="string"?G={filename:G}:G.filename=G.filename||"generated.pdf",k){case void 0:return Hs();case"save":h.save(G.filename);break;case"arraybuffer":return Qe(Hs());case"blob":return Yc(Hs());case"bloburi":case"bloburl":if(Nt.URL!==void 0&&typeof Nt.URL.createObjectURL=="function")return Nt.URL&&Nt.URL.createObjectURL(Yc(Hs()))||void 0;wr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var de="",me=Hs();try{de=c2(me)}catch{de=c2(unescape(encodeURIComponent(me)))}return"data:application/pdf;filename="+G.filename+";base64,"+de;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Nt)==="[object Window]"){var _e="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",je=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';G.pdfObjectUrl&&(_e=G.pdfObjectUrl,je="");var $e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+_e+'"'+je+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(G)+");<\/script></body></html>",lt=Nt.open();return lt!==null&&lt.document.write($e),lt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Nt)==="[object Window]"){var xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(G.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+G.filename+'" width="500px" height="400px" /></body></html>',Rt=Nt.open();if(Rt!==null){Rt.document.write(xt);var Dt=this;Rt.document.documentElement.querySelector("#pdfViewer").onload=function(){Rt.document.title=G.filename,Rt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Dt.output("bloburl"))}}return Rt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Nt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",G)+'"></iframe></body></html>',Or=Nt.open();if(Or!==null&&(Or.document.write(Yt),Or.document.title=G.filename),Or||typeof safari>"u")return Or;break;case"datauri":case"dataurl":return Nt.document.location.href=this.output("datauristring",G);default:return null}}),_h=function(k){return Array.isArray(zs)===!0&&zs.indexOf(k)>-1};switch(n){case"pt":qe=1;break;case"mm":qe=72/25.4;break;case"cm":qe=72/2.54;break;case"in":qe=72;break;case"px":qe=_h("px_scaling")==1?.75:96/72;break;case"pc":case"em":qe=12;break;case"ex":qe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);qe=n}var qn=null;ge(),X();var rm=function(k){return u!==null?qn.encryptor(k,0):function(G){return G}},kh=h.__private__.getPageInfo=h.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ft[k].objId,pageNumber:k,pageContext:Ft[k]}},jt=h.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var G in Ft)if(Ft[G].objId===k)break;return kh(G)},nm=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Ft[R].objId,pageNumber:R,pageContext:Ft[R]}};h.addPage=function(){return yh.apply(this,arguments),this},h.setPage=function(){return wh.apply(this,arguments),Ce.call(this,Pe[R]),this},h.insertPage=function(k){return this.addPage(),this.movePage(R,k),this},h.movePage=function(k,G){var de,me;if(k>G){de=Pe[k],me=Ft[k];for(var _e=k;_e>G;_e--)Pe[_e]=Pe[_e-1],Ft[_e]=Ft[_e-1];Pe[G]=de,Ft[G]=me,this.setPage(G)}else if(k<G){de=Pe[k],me=Ft[k];for(var je=k;je<G;je++)Pe[je]=Pe[je+1],Ft[je]=Ft[je+1];Pe[G]=de,Ft[G]=me,this.setPage(G)}return this},h.deletePage=function(){return Yg.apply(this,arguments),this},h.__private__.text=h.text=function(k,G,de,me,_e){var je,$e,lt,xt,Rt,Dt,Yt,Or,Hr,cn=(me=me||{}).scope||this;if(typeof k=="number"&&typeof G=="number"&&(typeof de=="string"||Array.isArray(de))){var Gn=de;de=G,G=k,k=Gn}if(arguments[3]instanceof bt?(E("The transform parameter of text() with a Matrix value"),Hr=_e):(lt=arguments[4],xt=arguments[5],dr(Yt=arguments[3])==="object"&&Yt!==null||(typeof lt=="string"&&(xt=lt,lt=null),typeof Yt=="string"&&(xt=Yt,Yt=null),typeof Yt=="number"&&(lt=Yt,Yt=null),me={flags:Yt,angle:lt,align:xt})),isNaN(G)||isNaN(de)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return cn;var En="",Wi=!1,qa=typeof me.lineHeightFactor=="number"?me.lineHeightFactor:Hl,ms=cn.internal.scaleFactor;function Lh(kr){return kr=kr.split("	").join(Array(me.TabLen||9).join(" ")),Aa(kr,Yt)}function K0(kr){for(var Sr,Qr=kr.concat(),yn=[],Xs=Qr.length;Xs--;)typeof(Sr=Qr.shift())=="string"?yn.push(Sr):Array.isArray(kr)&&(Sr.length===1||Sr[1]===void 0&&Sr[2]===void 0)?yn.push(Sr[0]):yn.push([Sr[0],Sr[1],Sr[2]]);return yn}function Y0(kr,Sr){var Qr;if(typeof kr=="string")Qr=Sr(kr)[0];else if(Array.isArray(kr)){for(var yn,Xs,af=kr.concat(),du=[],Rh=af.length;Rh--;)typeof(yn=af.shift())=="string"?du.push(Sr(yn)[0]):Array.isArray(yn)&&typeof yn[0]=="string"&&(Xs=Sr(yn[0],yn[1],yn[2]),du.push([Xs[0],Xs[1],Xs[2]]));Qr=du}return Qr}var nu=!1,J0=!0;if(typeof k=="string")nu=!0;else if(Array.isArray(k)){var Z0=k.concat();$e=[];for(var au,Dn=Z0.length;Dn--;)(typeof(au=Z0.shift())!="string"||Array.isArray(au)&&typeof au[0]!="string")&&(J0=!1);nu=J0}if(nu===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var iu=Ke/cn.internal.scaleFactor,su=iu*(qa-1);switch(me.baseline){case"bottom":de-=su;break;case"top":de+=iu-su;break;case"hanging":de+=iu-2*su;break;case"middle":de+=iu/2-su}if((Dt=me.maxWidth||0)>0&&(typeof k=="string"?k=cn.splitTextToSize(k,Dt):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(kr,Sr){return kr.concat(cn.splitTextToSize(Sr,Dt))},[]))),je={text:k,x:G,y:de,options:me,mutex:{pdfEscape:Aa,activeFontKey:at,fonts:ir,activeFontSize:Ke}},rr.publish("preProcessText",je),k=je.text,lt=(me=je.options).angle,!(Hr instanceof bt)&&lt&&typeof lt=="number"){lt*=Math.PI/180,me.rotationDirection===0&&(lt=-lt),w===b.ADVANCED&&(lt=-lt);var ou=Math.cos(lt),Q0=Math.sin(lt);Hr=new bt(ou,Q0,-Q0,ou,0,0)}else lt&&lt instanceof bt&&(Hr=lt);w!==b.ADVANCED||Hr||(Hr=Na),(Rt=me.charSpace||eu)!==void 0&&(En+=N(T(Rt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Or=me.horizontalScale)!==void 0&&(En+=N(100*Or)+` Tz
`),me.lang;var Ca=-1,hm=me.renderingMode!==void 0?me.renderingMode:me.stroke,ef=cn.internal.getCurrentPageInfo().pageContext;switch(hm){case 0:case!1:case"fill":Ca=0;break;case 1:case!0:case"stroke":Ca=1;break;case 2:case"fillThenStroke":Ca=2;break;case 3:case"invisible":Ca=3;break;case 4:case"fillAndAddForClipping":Ca=4;break;case 5:case"strokeAndAddPathForClipping":Ca=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ca=6;break;case 7:case"addToPathForClipping":Ca=7}var jh=ef.usedRenderingMode!==void 0?ef.usedRenderingMode:-1;Ca!==-1?En+=Ca+` Tr
`:jh!==-1&&(En+=`0 Tr
`),Ca!==-1&&(ef.usedRenderingMode=Ca),xt=me.align||"left";var pi,lu=Ke*qa,Ih=cn.internal.pageSize.getWidth(),Dh=ir[at];Rt=me.charSpace||eu,Dt=me.maxWidth||0,Yt=Object.assign({autoencode:!0,noBOM:!0},me.flags);var Po=[],ql=function(kr){return cn.getStringUnitWidth(kr,{font:Dh,charSpace:Rt,fontSize:Ke,doKerning:!1})*Ke/ms};if(Object.prototype.toString.call(k)==="[object Array]"){var Ta;$e=K0(k),xt!=="left"&&(pi=$e.map(ql));var ha,Fo=0;if(xt==="right"){G-=pi[0],k=[],Dn=$e.length;for(var Vs=0;Vs<Dn;Vs++)Vs===0?(ha=gs(G),Ta=$s(de)):(ha=T(Fo-pi[Vs]),Ta=-lu),k.push([$e[Vs],ha,Ta]),Fo=pi[Vs]}else if(xt==="center"){G-=pi[0]/2,k=[],Dn=$e.length;for(var qs=0;qs<Dn;qs++)qs===0?(ha=gs(G),Ta=$s(de)):(ha=T((Fo-pi[qs])/2),Ta=-lu),k.push([$e[qs],ha,Ta]),Fo=pi[qs]}else if(xt==="left"){k=[],Dn=$e.length;for(var cu=0;cu<Dn;cu++)k.push($e[cu])}else if(xt==="justify"&&Dh.encoding==="Identity-H"){k=[],Dn=$e.length,Dt=Dt!==0?Dt:Ih;for(var Gs=0,Zr=0;Zr<Dn;Zr++)if(Ta=Zr===0?$s(de):-lu,ha=Zr===0?gs(G):Gs,Zr<Dn-1){var tf=T((Dt-pi[Zr])/($e[Zr].split(" ").length-1)),pa=$e[Zr].split(" ");k.push([pa[0]+" ",ha,Ta]),Gs=0;for(var gi=1;gi<pa.length;gi++){var uu=(ql(pa[gi-1]+" "+pa[gi])-ql(pa[gi]))*ms+tf;gi==pa.length-1?k.push([pa[gi],uu,0]):k.push([pa[gi]+" ",uu,0]),Gs-=uu}}else k.push([$e[Zr],ha,Ta]);k.push(["",Gs,0])}else{if(xt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],Dn=$e.length,Dt=Dt!==0?Dt:Ih,Zr=0;Zr<Dn;Zr++)Ta=Zr===0?$s(de):-lu,ha=Zr===0?gs(G):0,Zr<Dn-1?Po.push(N(T((Dt-pi[Zr])/($e[Zr].split(" ").length-1)))):Po.push(0),k.push([$e[Zr],ha,Ta])}}var Oh=typeof me.R2L=="boolean"?me.R2L:ht;Oh===!0&&(k=Y0(k,function(kr,Sr,Qr){return[kr.split("").reverse().join(""),Sr,Qr]})),je={text:k,x:G,y:de,options:me,mutex:{pdfEscape:Aa,activeFontKey:at,fonts:ir,activeFontSize:Ke}},rr.publish("postProcessText",je),k=je.text,Wi=je.mutex.isHex||!1;var rf=ir[at].encoding;rf!=="WinAnsiEncoding"&&rf!=="StandardEncoding"||(k=Y0(k,function(kr,Sr,Qr){return[Lh(kr),Sr,Qr]})),$e=K0(k),k=[];for(var Gl,Xl,Lo,Kl=0,fu=1,Yl=Array.isArray($e[0])?fu:Kl,jo="",nf=function(kr,Sr,Qr){var yn="";return Qr instanceof bt?(Qr=typeof me.angle=="number"?$a(Qr,new bt(1,0,0,1,kr,Sr)):$a(new bt(1,0,0,1,kr,Sr),Qr),w===b.ADVANCED&&(Qr=$a(new bt(1,0,0,-1,0,0),Qr)),yn=Qr.join(" ")+` Tm
`):yn=N(kr)+" "+N(Sr)+` Td
`,yn},mi=0;mi<$e.length;mi++){switch(jo="",Yl){case fu:Lo=(Wi?"<":"(")+$e[mi][0]+(Wi?">":")"),Gl=parseFloat($e[mi][1]),Xl=parseFloat($e[mi][2]);break;case Kl:Lo=(Wi?"<":"(")+$e[mi]+(Wi?">":")"),Gl=gs(G),Xl=$s(de)}Po!==void 0&&Po[mi]!==void 0&&(jo=Po[mi]+` Tw
`),mi===0?k.push(jo+nf(Gl,Xl,Hr)+Lo):Yl===Kl?k.push(jo+Lo):Yl===fu&&k.push(jo+nf(Gl,Xl,Hr)+Lo)}k=Yl===Kl?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var vi=`BT
/`;return vi+=at+" "+Ke+` Tf
`,vi+=N(Ke*qa)+` TL
`,vi+=$l+`
`,vi+=En,vi+=k,oe(vi+="ET"),d[at]=!0,cn};var am=h.__private__.clip=h.clip=function(k){return oe(k==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return am("evenodd")},h.__private__.discardPath=h.discardPath=function(){return oe("n"),this};var ps=h.__private__.isValidStyle=function(k){var G=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(G=!0),G};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(k){return ps(k)&&(c=k),this};var Sh=h.__private__.getStyle=h.getStyle=function(k){var G=c;switch(k){case"D":case"S":G="S";break;case"F":G="f";break;case"FD":case"DF":G="B";break;case"f":case"f*":case"B":case"B*":G=k}return G},Eh=h.close=function(){return oe("h"),this};h.stroke=function(){return oe("S"),this},h.fill=function(k){return Zc("f",k),this},h.fillEvenOdd=function(k){return Zc("f*",k),this},h.fillStroke=function(k){return Zc("B",k),this},h.fillStrokeEvenOdd=function(k){return Zc("B*",k),this};var Zc=function(k,G){dr(G)==="object"?sm(G,k):oe(k)},B0=function(k){k===null||w===b.ADVANCED&&k===void 0||(k=Sh(k),oe(k))};function im(k,G,de,me,_e){var je=new lc(G||this.boundingBox,de||this.xStep,me||this.yStep,this.gState,_e||this.matrix);je.stream=this.stream;var $e=k+"$$"+this.cloneIndex+++"$$";return Vn($e,je),je}var sm=function(k,G){var de=fs[k.key],me=Jt[de];if(me instanceof rl)oe("q"),oe(om(G)),me.gState&&h.setGState(me.gState),oe(k.matrix.toString()+" cm"),oe("/"+de+" sh"),oe("Q");else if(me instanceof lc){var _e=new bt(1,0,0,-1,0,To());k.matrix&&(_e=_e.multiply(k.matrix||Na),de=im.call(me,k.key,k.boundingBox,k.xStep,k.yStep,_e).id),oe("q"),oe("/Pattern cs"),oe("/"+de+" scn"),me.gState&&h.setGState(me.gState),oe(G),oe("Q")}},om=function(k){switch(k){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},U0=h.moveTo=function(k,G){return oe(N(T(k))+" "+N(W(G))+" m"),this},Wl=h.lineTo=function(k,G){return oe(N(T(k))+" "+N(W(G))+" l"),this},Ao=h.curveTo=function(k,G,de,me,_e,je){return oe([N(T(k)),N(W(G)),N(T(de)),N(W(me)),N(T(_e)),N(W(je)),"c"].join(" ")),this};h.__private__.line=h.line=function(k,G,de,me,_e){if(isNaN(k)||isNaN(G)||isNaN(de)||isNaN(me)||!ps(_e))throw new Error("Invalid arguments passed to jsPDF.line");return w===b.COMPAT?this.lines([[de-k,me-G]],k,G,[1,1],_e||"S"):this.lines([[de-k,me-G]],k,G,[1,1]).stroke()},h.__private__.lines=h.lines=function(k,G,de,me,_e,je){var $e,lt,xt,Rt,Dt,Yt,Or,Hr,cn,Gn,En,Wi;if(typeof k=="number"&&(Wi=de,de=G,G=k,k=Wi),me=me||[1,1],je=je||!1,isNaN(G)||isNaN(de)||!Array.isArray(k)||!Array.isArray(me)||!ps(_e)||typeof je!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(U0(G,de),$e=me[0],lt=me[1],Rt=k.length,Gn=G,En=de,xt=0;xt<Rt;xt++)(Dt=k[xt]).length===2?(Gn=Dt[0]*$e+Gn,En=Dt[1]*lt+En,Wl(Gn,En)):(Yt=Dt[0]*$e+Gn,Or=Dt[1]*lt+En,Hr=Dt[2]*$e+Gn,cn=Dt[3]*lt+En,Gn=Dt[4]*$e+Gn,En=Dt[5]*lt+En,Ao(Yt,Or,Hr,cn,Gn,En));return je&&Eh(),B0(_e),this},h.path=function(k){for(var G=0;G<k.length;G++){var de=k[G],me=de.c;switch(de.op){case"m":U0(me[0],me[1]);break;case"l":Wl(me[0],me[1]);break;case"c":Ao.apply(this,me);break;case"h":Eh()}}return this},h.__private__.rect=h.rect=function(k,G,de,me,_e){if(isNaN(k)||isNaN(G)||isNaN(de)||isNaN(me)||!ps(_e))throw new Error("Invalid arguments passed to jsPDF.rect");return w===b.COMPAT&&(me=-me),oe([N(T(k)),N(W(G)),N(T(de)),N(T(me)),"re"].join(" ")),B0(_e),this},h.__private__.triangle=h.triangle=function(k,G,de,me,_e,je,$e){if(isNaN(k)||isNaN(G)||isNaN(de)||isNaN(me)||isNaN(_e)||isNaN(je)||!ps($e))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[de-k,me-G],[_e-de,je-me],[k-_e,G-je]],k,G,[1,1],$e,!0),this},h.__private__.roundedRect=h.roundedRect=function(k,G,de,me,_e,je,$e){if(isNaN(k)||isNaN(G)||isNaN(de)||isNaN(me)||isNaN(_e)||isNaN(je)||!ps($e))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var lt=4/3*(Math.SQRT2-1);return _e=Math.min(_e,.5*de),je=Math.min(je,.5*me),this.lines([[de-2*_e,0],[_e*lt,0,_e,je-je*lt,_e,je],[0,me-2*je],[0,je*lt,-_e*lt,je,-_e,je],[2*_e-de,0],[-_e*lt,0,-_e,-je*lt,-_e,-je],[0,2*je-me],[0,-je*lt,_e*lt,-je,_e,-je]],k+_e,G,[1,1],$e,!0),this},h.__private__.ellipse=h.ellipse=function(k,G,de,me,_e){if(isNaN(k)||isNaN(G)||isNaN(de)||isNaN(me)||!ps(_e))throw new Error("Invalid arguments passed to jsPDF.ellipse");var je=4/3*(Math.SQRT2-1)*de,$e=4/3*(Math.SQRT2-1)*me;return U0(k+de,G),Ao(k+de,G-$e,k+je,G-me,k,G-me),Ao(k-je,G-me,k-de,G-$e,k-de,G),Ao(k-de,G+$e,k-je,G+me,k,G+me),Ao(k+je,G+me,k+de,G+$e,k+de,G),B0(_e),this},h.__private__.circle=h.circle=function(k,G,de,me){if(isNaN(k)||isNaN(G)||isNaN(de)||!ps(me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,G,de,de,me)},h.setFont=function(k,G,de){return de&&(G=j(G,de)),at=bh(k,G,{disableWarning:!1}),this};var lm=h.__private__.getFont=h.getFont=function(){return ir[bh.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var k,G,de={};for(k in _r)if(_r.hasOwnProperty(k))for(G in de[k]=[],_r[k])_r[k].hasOwnProperty(G)&&de[k].push(G);return de},h.addFont=function(k,G,de,me,_e){var je=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&je.indexOf(arguments[3])!==-1?_e=arguments[3]:arguments[3]&&je.indexOf(arguments[3])==-1&&(de=j(de,me)),_e=_e||"Identity-H",O0.call(this,k,G,de,_e)};var Hl,z0=e.lineWidth||.200025,Qc=h.__private__.getLineWidth=h.getLineWidth=function(){return z0},Nh=h.__private__.setLineWidth=h.setLineWidth=function(k){return z0=k,oe(N(T(k))+" w"),this};h.__private__.setLineDash=kt.API.setLineDash=kt.API.setLineDashPattern=function(k,G){if(k=k||[],G=G||0,isNaN(G)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(de){return N(T(de))}).join(" "),G=N(T(G)),oe("["+k+"] "+G+" d"),this};var Ah=h.__private__.getLineHeight=h.getLineHeight=function(){return Ke*Hl};h.__private__.getLineHeight=h.getLineHeight=function(){return Ke*Hl};var Ch=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(Hl=k),this},Th=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Hl};Ch(e.lineHeight);var gs=h.__private__.getHorizontalCoordinate=function(k){return T(k)},$s=h.__private__.getVerticalCoordinate=function(k){return w===b.ADVANCED?k:Ft[R].mediaBox.topRightY-Ft[R].mediaBox.bottomLeftY-T(k)},cm=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(k){return N(gs(k))},Co=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(k){return N($s(k))},zi=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return le(zi)},h.__private__.setStrokeColor=h.setDrawColor=function(k,G,de,me){return zi=fe({ch1:k,ch2:G,ch3:de,ch4:me,pdfColorType:"draw",precision:2}),oe(zi),this};var W0=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return le(W0)},h.__private__.setFillColor=h.setFillColor=function(k,G,de,me){return W0=fe({ch1:k,ch2:G,ch3:de,ch4:me,pdfColorType:"fill",precision:2}),oe(W0),this};var $l=e.textColor||"0 g",um=h.__private__.getTextColor=h.getTextColor=function(){return le($l)};h.__private__.setTextColor=h.setTextColor=function(k,G,de,me){return $l=fe({ch1:k,ch2:G,ch3:de,ch4:me,pdfColorType:"text",precision:3}),this};var eu=e.charSpace,fm=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(eu||0)};h.__private__.setCharSpace=h.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return eu=k,this};var H0=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(k){var G=h.CapJoinStyles[k];if(G===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return H0=G,oe(G+" J"),this};var $0=0;h.__private__.setLineJoin=h.setLineJoin=function(k){var G=h.CapJoinStyles[k];if(G===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $0=G,oe(G+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(N(T(k))+" M"),this},h.GState=Cd,h.setGState=function(k){(k=typeof k=="string"?Ar[Ha[k]]:Ph(null,k)).equals(Ri)||(oe("/"+k.id+" gs"),Ri=k)};var Ph=function(k,G){if(!k||!Ha[k]){var de=!1;for(var me in Ar)if(Ar.hasOwnProperty(me)&&Ar[me].equals(G)){de=!0;break}if(de)G=Ar[me];else{var _e="GS"+(Object.keys(Ar).length+1).toString(10);Ar[_e]=G,G.id=_e}return k&&(Ha[k]=G.id),rr.publish("addGState",G),G}};h.addGState=function(k,G){return Ph(k,G),this},h.saveGraphicsState=function(){return oe("q"),fi.push({key:at,size:Ke,color:$l}),this},h.restoreGraphicsState=function(){oe("Q");var k=fi.pop();return at=k.key,Ke=k.size,$l=k.color,Ri=null,this},h.setCurrentTransformationMatrix=function(k){return oe(k.toString()+" cm"),this},h.comment=function(k){return oe("#"+k),this};var tu=function(k,G){var de=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return de},set:function(je){isNaN(je)||(de=parseFloat(je))}});var me=G||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return me},set:function(je){isNaN(je)||(me=parseFloat(je))}});var _e="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return _e},set:function(je){_e=je.toString()}}),this},V0=function(k,G,de,me){tu.call(this,k,G),this.type="rect";var _e=de||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return _e},set:function($e){isNaN($e)||(_e=parseFloat($e))}});var je=me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return je},set:function($e){isNaN($e)||(je=parseFloat($e))}}),this},q0=function(){this.page=xr,this.currentPage=R,this.pages=Pe.slice(0),this.pagesContext=Ft.slice(0),this.x=or,this.y=wt,this.matrix=vn,this.width=Vl(R),this.height=To(R),this.outputDestination=Ue,this.id="",this.objectNumber=-1};q0.prototype.restore=function(){xr=this.page,R=this.currentPage,Ft=this.pagesContext,Pe=this.pages,or=this.x,wt=this.y,vn=this.matrix,G0(R,this.width),X0(R,this.height),Ue=this.outputDestination};var Fh=function(k,G,de,me,_e){hi.push(new q0),xr=R=0,Pe=[],or=k,wt=G,vn=_e,R0([de,me])},dm=function(k){if(di[k])hi.pop().restore();else{var G=new q0,de="Xo"+(Object.keys(xn).length+1).toString(10);G.id=de,di[k]=de,xn[de]=G,rr.publish("addFormObject",G),hi.pop().restore()}};for(var ru in h.beginFormObject=function(k,G,de,me,_e){return Fh(k,G,de,me,_e),this},h.endFormObject=function(k){return dm(k),this},h.doFormObject=function(k,G){var de=xn[di[k]];return oe("q"),oe(G.toString()+" cm"),oe("/"+de.id+" Do"),oe("Q"),this},h.getFormObject=function(k){var G=xn[di[k]];return{x:G.x,y:G.y,width:G.width,height:G.height,matrix:G.matrix}},h.save=function(k,G){return k=k||"generated.pdf",(G=G||{}).returnPromise=G.returnPromise||!1,G.returnPromise===!1?(rc(Yc(Hs()),k),typeof rc.unload=="function"&&Nt.setTimeout&&setTimeout(rc.unload,911),this):new Promise(function(de,me){try{var _e=rc(Yc(Hs()),k);typeof rc.unload=="function"&&Nt.setTimeout&&setTimeout(rc.unload,911),de(_e)}catch(je){me(je.message)}})},kt.API)kt.API.hasOwnProperty(ru)&&(ru==="events"&&kt.API.events.length?function(k,G){var de,me,_e;for(_e=G.length-1;_e!==-1;_e--)de=G[_e][0],me=G[_e][1],k.subscribe.apply(k,[de].concat(typeof me=="function"?[me]:me))}(rr,kt.API.events):h[ru]=kt.API[ru]);var Vl=h.getPageWidth=function(k){return(Ft[k=k||R].mediaBox.topRightX-Ft[k].mediaBox.bottomLeftX)/qe},G0=h.setPageWidth=function(k,G){Ft[k].mediaBox.topRightX=G*qe+Ft[k].mediaBox.bottomLeftX},To=h.getPageHeight=function(k){return(Ft[k=k||R].mediaBox.topRightY-Ft[k].mediaBox.bottomLeftY)/qe},X0=h.setPageHeight=function(k,G){Ft[k].mediaBox.topRightY=G*qe+Ft[k].mediaBox.bottomLeftY};return h.internal={pdfEscape:Aa,getStyle:Sh,getFont:lm,getFontSize:rt,getCharSpace:fm,getTextColor:um,getLineHeight:Ah,getLineHeightFactor:Th,getLineWidth:Qc,write:De,getHorizontalCoordinate:gs,getVerticalCoordinate:$s,getCoordinateString:cm,getVerticalCoordinateString:Co,collections:{},newObject:Yr,newAdditionalObject:ce,newObjectDeferred:Wr,newObjectDeferredBegin:J,getFilters:Se,putStream:Fe,events:rr,scaleFactor:qe,pageSize:{getWidth:function(){return Vl(R)},setWidth:function(k){G0(R,k)},getHeight:function(){return To(R)},setHeight:function(k){X0(R,k)}},encryptionOptions:u,encryption:qn,getEncryptor:rm,output:Jc,getNumberOfPages:Jg,pages:Pe,out:oe,f2:M,f3:F,getPageInfo:kh,getPageInfoByObjId:jt,getCurrentPageInfo:nm,getPDFVersion:m,Point:tu,Rectangle:V0,Matrix:bt,hasHotfix:_h},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Vl(R)},set:function(k){G0(R,k)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return To(R)},set:function(k){X0(R,k)},enumerable:!0,configurable:!0}),Kg.call(h,Be),at="F1",yh(a,r),rr.publish("initialized"),h}Fu.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Fu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Fu.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Fu.prototype.processOwnerPassword=function(e,t){return f2(u2(t).substr(0,5),e)},Fu.prototype.encryptor=function(e,t){var r=u2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return f2(r,n)}},Cd.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||dr(e)!==dr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},kt.API={events:[]},kt.version="2.5.2";var Vr=kt.API,Uy=1,Bc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},bu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ot=function(e){return e.toFixed(2)},Vo=function(e){return e.toFixed(5)};Vr.__acroform__={};var Wa=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},N_=function(e){return e*Uy},bs=function(e){var t=new QE,r=dt.internal.getHeight(e)||0,n=dt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ot(n)),Number(Ot(r))],t},FD=Vr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},LD=Vr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},jD=Vr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},rn=Vr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return jD(e,t-1)},nn=Vr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return FD(e,t-1)},an=Vr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return LD(e,t-1)},ID=Vr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(a)||0,l.lowerLeft_Y=n(i+o)||0,l.upperRight_X=r(a+s)||0,l.upperRight_Y=n(i)||0,[Number(Ot(l.lowerLeft_X)),Number(Ot(l.lowerLeft_Y)),Number(Ot(l.upperRight_X)),Number(Ot(l.upperRight_Y))]},DD=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=d2(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Ot(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=bs(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},d2=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(F){return F.split(`
`)}):a.map(function(F){return[F]});var i=r,s=dt.internal.getHeight(e)||0;s=s<0?-s:s;var o=dt.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(F,T,H){if(F+1<a.length){var W=T+" "+a[F+1][0];return E1(W,e,H).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var c,u,f=E1("3",e,i).height,d=e.multiline?s-i:(s-f)/2,h=d+=2,v=0,m=0,y=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+E1(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var x="",b=0,w=0;w<a.length;w++)if(a.hasOwnProperty(w)){var S=!1;if(a[w].length!==1&&y!==a[w].length-1){if((f+2)*(b+2)+2>s)continue e;x+=a[w][y],S=!0,m=w,w--}else{x=(x+=a[w][y]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var L=parseInt(w),j=l(L,x,i),N=w>=a.length-1;if(j&&!N){x+=" ",y=0;continue}if(j||N){if(N)m=L;else if(e.multiline&&(f+2)*(b+2)+2>s)continue e}else{if(!e.multiline||(f+2)*(b+2)+2>s)continue e;m=L}}for(var E="",P=v;P<=m;P++){var M=a[P];if(e.multiline){if(P===m){E+=M[y]+" ",y=(y+1)%M.length;continue}if(P===v){E+=M[M.length-1]+" ";continue}}E+=M[0]+" "}switch(E=E.substr(E.length-1)==" "?E.substr(0,E.length-1):E,u=E1(E,e,i).width,e.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;case"left":default:c=2}t+=Ot(c)+" "+Ot(h)+` Td
`,t+="("+Bc(E)+`) Tj
`,t+=-Ot(c)+` 0 Td
`,h=-(i+2),u=0,v=S?m:m+1,b++,x=""}break}return n.text=t,n.fontSize=i,n},E1=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},OD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},RD=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},MD=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,a=e[r];t.internal.newObjectDeferredBegin(a.objId,!0),dr(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},BD=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(cs.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(OD)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Uy=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new e6,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&RD(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],c=o.Rect;if(o.Rect&&(o.Rect=ID(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=dt.createDefaultAppearanceStream(o),dr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=DD(o);l.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var f="";for(var d in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(d)){var h=o.appearanceStreamContent[d];if(f+="/"+d+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var s in h)if(h.hasOwnProperty(s)){var v=h[s];typeof v=="function"&&(v=v.call(a,o)),f+="/"+s+" "+v+" ",a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v)}}else typeof(v=h)=="function"&&(v=v.call(a,o)),f+="/"+s+" "+v,a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:l,objectId:o.objId}),a.internal.out("endobj")}i&&MD(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},ZE=Vr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),dr(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+Bc(n(e[i].toString()))+")"):a+=e[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},_v=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+Bc(n(e))+")"},As=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};As.prototype.toString=function(){return this.objId+" 0 R"},As.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},As.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:ZE(a,this.objId,this.scope)}):a instanceof As?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var QE=function(){As.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Wa(QE,As);var e6=function(){As.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Bc(r(e))+")"}},set:function(r){e=r}})};Wa(e6,As);var cs=function e(){As.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!rn(t,3)},set:function(x){x?this.F=nn(t,3):this.F=an(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Lp)return;i="FieldObject"+e.FieldNum++}var x=function(b){return b};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Bc(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(x){s=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/Uy:c},set:function(x){c=x}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(x){u=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Lp||this instanceof yl))return _v(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof bn?d:_v(d,this.objId,this.scope)},set:function(x){x=x.toString(),d=this instanceof bn?x:x.substr(0,1)==="("?bu(x.substr(1,x.length-2)):bu(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof bn?bu(d.substr(1,d.length-1)):d},set:function(x){x=x.toString(),d=this instanceof bn?"/"+x:x}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof bn?h:_v(h,this.objId,this.scope)},set:function(x){x=x.toString(),h=this instanceof bn?x:x.substr(0,1)==="("?bu(x.substr(1,x.length-2)):bu(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof bn?bu(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof bn?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(x){x=!!x,m=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(x){v=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,1)},set:function(x){x?this.Ff=nn(this.Ff,1):this.Ff=an(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,2)},set:function(x){x?this.Ff=nn(this.Ff,2):this.Ff=an(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,3)},set:function(x){x?this.Ff=nn(this.Ff,3):this.Ff=an(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');y=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(y){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:y=2;break;case"center":case 1:y=1;break;case"left":case 0:default:y=0}}})};Wa(cs,As);var hc=function(){cs.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ZE(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,o){o||(o=1);for(var l,c=[];l=s.exec(i);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,18)},set:function(r){r?this.Ff=nn(this.Ff,18):this.Ff=an(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=nn(this.Ff,19):this.Ff=an(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,20)},set:function(r){r?(this.Ff=nn(this.Ff,20),t.sort()):this.Ff=an(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,22)},set:function(r){r?this.Ff=nn(this.Ff,22):this.Ff=an(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,23)},set:function(r){r?this.Ff=nn(this.Ff,23):this.Ff=an(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,27)},set:function(r){r?this.Ff=nn(this.Ff,27):this.Ff=an(this.Ff,27)}}),this.hasAppearanceStream=!1};Wa(hc,cs);var pc=function(){hc.call(this),this.fontName="helvetica",this.combo=!1};Wa(pc,hc);var gc=function(){pc.call(this),this.combo=!0};Wa(gc,pc);var Xf=function(){gc.call(this),this.edit=!0};Wa(Xf,gc);var bn=function(){cs.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,15)},set:function(r){r?this.Ff=nn(this.Ff,15):this.Ff=an(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,16)},set:function(r){r?this.Ff=nn(this.Ff,16):this.Ff=an(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,17)},set:function(r){r?this.Ff=nn(this.Ff,17):this.Ff=an(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,26)},set:function(r){r?this.Ff=nn(this.Ff,26):this.Ff=an(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+Bc(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){dr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Wa(bn,cs);var Kf=function(){bn.call(this),this.pushButton=!0};Wa(Kf,bn);var mc=function(){bn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Wa(mc,bn);var Lp=function(){var e,t;cs.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+Bc(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){dr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=dt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Wa(Lp,cs),mc.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},mc.prototype.createOption=function(e){var t=new Lp;return t.Parent=this,t.optionName=e,this.Kids.push(t),UD.call(this.scope,t),t};var Yf=function(){bn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=dt.CheckBox.createAppearanceStream()};Wa(Yf,bn);var yl=function(){cs.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,13)},set:function(t){t?this.Ff=nn(this.Ff,13):this.Ff=an(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,21)},set:function(t){t?this.Ff=nn(this.Ff,21):this.Ff=an(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,23)},set:function(t){t?this.Ff=nn(this.Ff,23):this.Ff=an(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,24)},set:function(t){t?this.Ff=nn(this.Ff,24):this.Ff=an(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,25)},set:function(t){t?this.Ff=nn(this.Ff,25):this.Ff=an(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,26)},set:function(t){t?this.Ff=nn(this.Ff,26):this.Ff=an(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Wa(yl,cs);var Jf=function(){yl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!rn(this.Ff,14)},set:function(e){e?this.Ff=nn(this.Ff,14):this.Ff=an(this.Ff,14)}}),this.password=!0};Wa(Jf,yl);var dt={CheckBox:{createAppearanceStream:function(){return{N:{On:dt.CheckBox.YesNormal},D:{On:dt.CheckBox.YesPushDown,Off:dt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=bs(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=d2(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ot(dt.internal.getWidth(e))+" "+Ot(dt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Ot(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=bs(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=dt.internal.getHeight(e),s=dt.internal.getWidth(e),o=d2(e,e.caption);return a.push("1 g"),a.push("0 0 "+Ot(s)+" "+Ot(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Ot(s-1)+" "+Ot(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Ot(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=bs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ot(dt.internal.getWidth(e))+" "+Ot(dt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:dt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=dt.RadioButton.Circle.YesNormal,t.D[e]=dt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=bs(e);t.scope=e.scope;var r=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=dt.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Vo(dt.internal.getWidth(e)/2)+" "+Vo(dt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=bs(e);t.scope=e.scope;var r=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*dt.internal.Bezier_C).toFixed(5)),s=Number((n*dt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Vo(dt.internal.getWidth(e)/2)+" "+Vo(dt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Vo(dt.internal.getWidth(e)/2)+" "+Vo(dt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=bs(e);t.scope=e.scope;var r=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*dt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Vo(dt.internal.getWidth(e)/2)+" "+Vo(dt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:dt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=dt.RadioButton.Cross.YesNormal,t.D[e]=dt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=bs(e);t.scope=e.scope;var r=[],n=dt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ot(dt.internal.getWidth(e)-2)+" "+Ot(dt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ot(n.x1.x)+" "+Ot(n.x1.y)+" m"),r.push(Ot(n.x2.x)+" "+Ot(n.x2.y)+" l"),r.push(Ot(n.x4.x)+" "+Ot(n.x4.y)+" m"),r.push(Ot(n.x3.x)+" "+Ot(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=bs(e);t.scope=e.scope;var r=dt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ot(dt.internal.getWidth(e))+" "+Ot(dt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ot(dt.internal.getWidth(e)-2)+" "+Ot(dt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Ot(r.x1.x)+" "+Ot(r.x1.y)+" m"),n.push(Ot(r.x2.x)+" "+Ot(r.x2.y)+" l"),n.push(Ot(r.x4.x)+" "+Ot(r.x4.y)+" m"),n.push(Ot(r.x3.x)+" "+Ot(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=bs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ot(dt.internal.getWidth(e))+" "+Ot(dt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};dt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=dt.internal.getWidth(e),r=dt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},dt.internal.getWidth=function(e){var t=0;return dr(e)==="object"&&(t=N_(e.Rect[2])),t},dt.internal.getHeight=function(e){var t=0;return dr(e)==="object"&&(t=N_(e.Rect[3])),t};var UD=Vr.addField=function(e){if(BD(this,e),!(e instanceof cs))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Vr.AcroFormChoiceField=hc,Vr.AcroFormListBox=pc,Vr.AcroFormComboBox=gc,Vr.AcroFormEditBox=Xf,Vr.AcroFormButton=bn,Vr.AcroFormPushButton=Kf,Vr.AcroFormRadioButton=mc,Vr.AcroFormCheckBox=Yf,Vr.AcroFormTextField=yl,Vr.AcroFormPasswordField=Jf,Vr.AcroFormAppearance=dt,Vr.AcroForm={ChoiceField:hc,ListBox:pc,ComboBox:gc,EditBox:Xf,Button:bn,PushButton:Kf,RadioButton:mc,CheckBox:Yf,TextField:yl,PasswordField:Jf,Appearance:dt},kt.AcroForm={ChoiceField:hc,ListBox:pc,ComboBox:gc,EditBox:Xf,Button:bn,PushButton:Kf,RadioButton:mc,CheckBox:Yf,TextField:yl,PasswordField:Jf,Appearance:dt};var zD=kt.AcroForm;function t6(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(F,T){var H,W,Q,V,z,X=t;if((T=T||t)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(j(F))for(z in r)for(Q=r[z],H=0;H<Q.length;H+=1){for(V=!0,W=0;W<Q[H].length;W+=1)if(Q[H][W]!==void 0&&Q[H][W]!==F[W]){V=!1;break}if(V===!0){X=z;break}}else for(z in r)for(Q=r[z],H=0;H<Q.length;H+=1){for(V=!0,W=0;W<Q[H].length;W+=1)if(Q[H][W]!==void 0&&Q[H][W]!==F.charCodeAt(W)){V=!1;break}if(V===!0){X=z;break}}return X===t&&T!==t&&(X=T),X},a=function F(T){for(var H=this.internal.write,W=this.internal.putStream,Q=(0,this.internal.getFilters)();Q.indexOf("FlateEncode")!==-1;)Q.splice(Q.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var V=[];if(V.push({key:"Type",value:"/XObject"}),V.push({key:"Subtype",value:"/Image"}),V.push({key:"Width",value:T.width}),V.push({key:"Height",value:T.height}),T.colorSpace===y.INDEXED?V.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(V.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===y.DEVICE_CMYK&&V.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),V.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&V.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)){for(var z="",X=0,D=T.transparency.length;X<D;X++)z+=T.transparency[X]+" "+T.transparency[X]+" ";V.push({key:"Mask",value:"["+z+"]"})}T.sMask!==void 0&&V.push({key:"SMask",value:T.objectId+1+" 0 R"});var ne=T.filter!==void 0?["/"+T.filter]:void 0;if(W({data:T.data,additionalKeyValues:V,alreadyAppliedFilters:ne,objectId:T.objectId}),H("endobj"),"sMask"in T&&T.sMask!==void 0){var ge="/Predictor "+T.predictor+" /Colors 1 /BitsPerComponent "+T.bitsPerComponent+" /Columns "+T.width,C={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:T.bitsPerComponent,decodeParameters:ge,data:T.sMask};"filter"in T&&(C.filter=T.filter),F.call(this,C)}if(T.colorSpace===y.INDEXED){var R=this.internal.newObject();W({data:E(new Uint8Array(T.palette)),objectId:R}),H("endobj")}},i=function(){var F=this.internal.collections.addImage_images;for(var T in F)a.call(this,F[T])},s=function(){var F,T=this.internal.collections.addImage_images,H=this.internal.write;for(var W in T)H("/I"+(F=T[W]).index,F.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},l=function(){var F=this.internal.collections.addImage_images;return o.call(this),F},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(F){return typeof e["process"+F.toUpperCase()]=="function"},f=function(F){return dr(F)==="object"&&F.nodeType===1},d=function(F,T){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var H=""+F.getAttribute("src");if(H.indexOf("data:image/")===0)return Gf(unescape(H).split("base64,").pop());var W=e.loadFile(H,!0);if(W!==void 0)return W}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var Q;switch(T){case"PNG":Q="image/png";break;case"WEBP":Q="image/webp";break;case"JPEG":case"JPG":default:Q="image/jpeg"}return Gf(F.toDataURL(Q,1).split("base64,").pop())}},h=function(F){var T=this.internal.collections.addImage_images;if(T){for(var H in T)if(F===T[H].alias)return T[H]}},v=function(F,T,H){return F||T||(F=-96,T=-96),F<0&&(F=-1*H.width*72/F/this.internal.scaleFactor),T<0&&(T=-1*H.height*72/T/this.internal.scaleFactor),F===0&&(F=T*H.width/H.height),T===0&&(T=F*H.height/H.width),[F,T]},m=function(F,T,H,W,Q,V){var z=v.call(this,H,W,Q),X=this.internal.getCoordinateString,D=this.internal.getVerticalCoordinateString,ne=l.call(this);if(H=z[0],W=z[1],ne[Q.index]=Q,V){V*=Math.PI/180;var ge=Math.cos(V),C=Math.sin(V),R=function(U){return U.toFixed(4)},B=[R(ge),R(C),R(-1*C),R(ge),0,0,"cm"]}this.internal.write("q"),V?(this.internal.write([1,"0","0",1,X(F),D(T+W),"cm"].join(" ")),this.internal.write(B.join(" ")),this.internal.write([X(H),"0","0",X(W),"0","0","cm"].join(" "))):this.internal.write([X(H),"0","0",X(W),X(F),D(T+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Q.index+" Do"),this.internal.write("Q")},y=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(F){var T,H,W=0;if(typeof F=="string")for(H=F.length,T=0;T<H;T++)W=(W<<5)-W+F.charCodeAt(T),W|=0;else if(j(F))for(H=F.byteLength/2,T=0;T<H;T++)W=(W<<5)-W+F[T],W|=0;return W},w=e.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var T=!0;return F.length===0&&(T=!1),F.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(T=!1),T},S=e.__addimage__.extractImageFromDataUrl=function(F){var T=(F=F||"").split("base64,"),H=null;if(T.length===2){var W=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(T[0]);Array.isArray(W)&&(H={mimeType:W[1],charset:W[2],data:T[1]})}return H},L=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(F){return L()&&F instanceof ArrayBuffer};var j=e.__addimage__.isArrayBufferView=function(F){return L()&&typeof Uint32Array<"u"&&(F instanceof Int8Array||F instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array)},N=e.__addimage__.binaryStringToUint8Array=function(F){for(var T=F.length,H=new Uint8Array(T),W=0;W<T;W++)H[W]=F.charCodeAt(W);return H},E=e.__addimage__.arrayBufferToBinaryString=function(F){for(var T="",H=j(F)?F:new Uint8Array(F),W=0;W<H.length;W+=8192)T+=String.fromCharCode.apply(null,H.subarray(W,W+8192));return T};e.addImage=function(){var F,T,H,W,Q,V,z,X,D;if(typeof arguments[1]=="number"?(T=t,H=arguments[1],W=arguments[2],Q=arguments[3],V=arguments[4],z=arguments[5],X=arguments[6],D=arguments[7]):(T=arguments[1],H=arguments[2],W=arguments[3],Q=arguments[4],V=arguments[5],z=arguments[6],X=arguments[7],D=arguments[8]),dr(F=arguments[0])==="object"&&!f(F)&&"imageData"in F){var ne=F;F=ne.imageData,T=ne.format||T||t,H=ne.x||H||0,W=ne.y||W||0,Q=ne.w||ne.width||Q,V=ne.h||ne.height||V,z=ne.alias||z,X=ne.compression||X,D=ne.rotation||ne.angle||D}var ge=this.internal.getFilters();if(X===void 0&&ge.indexOf("FlateEncode")!==-1&&(X="SLOW"),isNaN(H)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var C=P.call(this,F,T,z,X);return m.call(this,H,W,Q,V,C,D),this};var P=function(F,T,H,W){var Q,V,z;if(typeof F=="string"&&n(F)===t){F=unescape(F);var X=M(F,!1);(X!==""||(X=e.loadFile(F,!0))!==void 0)&&(F=X)}if(f(F)&&(F=d(F,T)),T=n(F,T),!u(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((z=H)==null||z.length===0)&&(H=function(D){return typeof D=="string"||j(D)?b(D):j(D.data)?b(D.data):null}(F)),(Q=h.call(this,H))||(L()&&(F instanceof Uint8Array||T==="RGBA"||(V=F,F=N(F))),Q=this["process"+T.toUpperCase()](F,c.call(this),H,function(D){return D&&typeof D=="string"&&(D=D.toUpperCase()),D in e.image_compression?D:x.NONE}(W),V)),!Q)throw new Error("An unknown error occurred whilst processing the image.");return Q},M=e.__addimage__.convertBase64ToBinaryString=function(F,T){var H;T=typeof T!="boolean"||T;var W,Q="";if(typeof F=="string"){W=(H=S(F))!==null?H.data:F;try{Q=Gf(W)}catch(V){if(T)throw w(W)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+V.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Q};e.getImageProperties=function(F){var T,H,W="";if(f(F)&&(F=d(F)),typeof F=="string"&&n(F)===t&&((W=M(F,!1))===""&&(W=e.loadFile(F)||""),F=W),H=n(F),!u(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(!L()||F instanceof Uint8Array||(F=N(F)),!(T=this["process"+H.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=H,T}})(kt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};kt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,u=!1,f=0;f<c.length&&!u;f++)switch((n=c[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var d=0;d<c.length;d++){n=c[d];var h=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(m.objId),b=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(x(n.contents))+")",i+=" /Popup "+y.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+h(x(b))+") >>",m.content=i;var w=m.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(i+=" /Open true"),i+=" >>",y.content=i,this.internal.write(m.objId,"0 R",y.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(v(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var L=this.annotations._nameMap[n.options.name];n.options.pageNumber=L.page,n.options.top=L.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var j=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:c(n),w:l(r+a),h:c(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,o,l=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var u=this.splitTextToSize(r,o).length;s=Math.ceil(c*u)}else o=l,s=c;return this.text(r,n,a,i),a+=.2*c,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,a-c,o,s,i),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(kt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=e.__arabicParser__.isArabicEndLetter=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(m){return s(m)&&a.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(m){var y=0,x=r,b="",w=0;for(y=0;y<m.length;y+=1)x[m.charCodeAt(y)]!==void 0?(w++,typeof(x=x[m.charCodeAt(y)])=="number"&&(b+=String.fromCharCode(x),x=r,w=0),y===m.length-1&&(x=r,b+=m.charAt(y-(w-1)),y-=w-1,w=0)):(x=r,b+=m.charAt(y-w),y-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var d=e.__arabicParser__.getCorrectForm=function(m,y,x){return s(m)?i(m)===!1?-1:!c(m)||!s(y)&&!s(x)||!s(x)&&o(y)||o(m)&&!s(y)||o(m)&&l(y)||o(m)&&o(y)?0:u(m)&&s(y)&&!o(y)&&s(x)&&c(x)?3:o(m)||!s(x)?1:2:-1},h=function(m){var y=0,x=0,b=0,w="",S="",L="",j=(m=m||"").split("\\s+"),N=[];for(y=0;y<j.length;y+=1){for(N.push(""),x=0;x<j[y].length;x+=1)w=j[y][x],S=j[y][x-1],L=j[y][x+1],s(w)?(b=d(w,S,L),N[y]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):N[y]+=w;N[y]=f(N[y])}return N.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var m,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(y)){var b=0;for(x=[],b=0;b<y.length;b+=1)Array.isArray(y[b])?x.push([h(y[b][0]),y[b][1],y[b][2]]):x.push([h(y[b])]);m=x}else m=h(y);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",v])}(kt.API),kt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(kt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(m){l=m}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var d=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(m){v=m}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),f=c.font||this.getFont(),d=c.scaleFactor||this.internal.scaleFactor,h=0,v=0,m=0,y=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=c.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(w,S){return w.concat(y.splitTextToSize(S,x))},[])):l=Array.isArray(l)?l:[l];for(var b=0;b<l.length;b++)h<(m=this.getStringUnitWidth(l[b],{font:f})*u)&&(h=m);return h!==0&&(v=l.length),{w:h/=d,h:Math.max((v*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/d,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,d=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,h&&d&&(this.printHeaderRow(l.lineNumber,!0),l.y+=d[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};e.table=function(l,c,u,f,d){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,v,m,y,x=[],b=[],w=[],S={},L={},j=[],N=[],E=(d=d||{}).autoSize||!1,P=d.printHeaders!==!1,M=d.css&&d.css["font-size"]!==void 0?16*d.css["font-size"]:d.fontSize||12,F=d.margins||Object.assign({width:this.getPageWidth()},t),T=typeof d.padding=="number"?d.padding:3,H=d.headerBackgroundColor||"#c8c8c8",W=d.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=H,this.internal.__cell__.headerTextColor=W,this.setFontSize(M),f==null)b=x=Object.keys(u[0]),w=x.map(function(){return"left"});else if(Array.isArray(f)&&dr(f[0])==="object")for(x=f.map(function(ne){return ne.name}),b=f.map(function(ne){return ne.prompt||ne.name||""}),w=f.map(function(ne){return ne.align||"left"}),h=0;h<f.length;h+=1)L[f[h].name]=f[h].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(b=x=f,w=x.map(function(){return"left"}));if(E||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<x.length;h+=1){for(S[y=x[h]]=u.map(function(ne){return ne[y]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(b[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=S[y],this.setFont(void 0,"normal"),m=0;m<v.length;m+=1)j.push(this.getTextDimensions(v[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);L[y]=Math.max.apply(null,j)+T+T,j=[]}if(P){var Q={};for(h=0;h<x.length;h+=1)Q[x[h]]={},Q[x[h]].text=b[h],Q[x[h]].align=w[h];var V=o.call(this,Q,L);N=x.map(function(ne){return new i(l,c,L[ne],V,Q[ne].text,void 0,Q[ne].align)}),this.setTableHeaderRow(N),this.printHeaderRow(1,!1)}var z=f.reduce(function(ne,ge){return ne[ge.name]=ge.align,ne},{});for(h=0;h<u.length;h+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:h,data:u[h]},this);var X=o.call(this,u[h],L);for(m=0;m<x.length;m+=1){var D=u[h][x[m]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:h,col:m,data:D},this),s.call(this,new i(l,c,L[x[m]],X,D,h+2,z[x[m]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,d=this.internal.scaleFactor;return Object.keys(l).map(function(h){var v=l[h];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,c[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/d+u+u},this).reduce(function(h,v){return Math.max(h,v)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var d=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,d.push(u)),u.lineNumber=l;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(v)}d.length>0&&this.setTableHeaderRow(d),this.setFont(void 0,"normal"),r=!1}}(kt.API);var r6={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},n6=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],h2=t6(n6),a6=[100,200,300,400,500,600,700,800,900],WD=t6(a6);function p2(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return r6[i=i||"normal"]?i:"normal"}(e.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),a=function(i){return typeof h2[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function A_(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var HD={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},C_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function T_(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function $D(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},HD,r.genericFontFamilies||{}),i=null,s=null,o=0;o<t.length;++o)if(a[(i=p2(t[o])).family]&&(i.family=a[i.family]),e.hasOwnProperty(i.family)){s=e[i.family];break}if(!(s=s||e[n]))throw new Error("Could not find a font-family for the rule '"+T_(i)+"' and default family '"+n+"'.");if(s=function(l,c){if(c[l])return c[l];var u=h2[l],f=u<=h2.normal?-1:1,d=A_(c,n6,u,f);if(!d)throw new Error("Could not find a matching font-stretch value for "+l);return d}(i.stretch,s),s=function(l,c){if(c[l])return c[l];for(var u=r6[l],f=0;f<u.length;++f)if(c[u[f]])return c[u[f]];throw new Error("Could not find a matching font-style for "+l)}(i.style,s),!(s=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var u=WD[l],f=A_(c,a6,u,l<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+l);return f}(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+T_(i)+"'.");return s}function P_(e){return e.trimLeft()}function VD(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function qD(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var N1,F_,L_,kv=["times"];(function(e){var t,r,n,a,i,s,o,l,c,u=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new l,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new s,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new s,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var f=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var R=C;Object.defineProperty(this,"pdf",{get:function(){return R}});var B=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return B},set:function(Ce){B=!!Ce}});var U=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return U},set:function(Ce){U=!!Ce}});var Y=0;Object.defineProperty(this,"posX",{get:function(){return Y},set:function(Ce){isNaN(Ce)||(Y=Ce)}});var ue=0;Object.defineProperty(this,"posY",{get:function(){return ue},set:function(Ce){isNaN(Ce)||(ue=Ce)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(Ce){var oe;typeof Ce=="number"?oe=[Ce,Ce,Ce,Ce]:((oe=new Array(4))[0]=Ce[0],oe[1]=Ce.length>=2?Ce[1]:oe[0],oe[2]=Ce.length>=3?Ce[2]:oe[0],oe[3]=Ce.length>=4?Ce[3]:oe[1]),c.margin=oe}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(Ce){pe=Ce}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(Ce){he=Ce}});var ye=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ye},set:function(Ce){ye=Ce}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(Ce){Ce instanceof u&&(c=Ce)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(Ce){c.path=Ce}});var Pe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Pe},set:function(Ce){Pe=Ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ce){var oe;oe=d(Ce),this.ctx.fillStyle=oe.style,this.ctx.isFillTransparent=oe.a===0,this.ctx.fillOpacity=oe.a,this.pdf.setFillColor(oe.r,oe.g,oe.b,{a:oe.a}),this.pdf.setTextColor(oe.r,oe.g,oe.b,{a:oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ce){var oe=d(Ce);this.ctx.strokeStyle=oe.style,this.ctx.isStrokeTransparent=oe.a===0,this.ctx.strokeOpacity=oe.a,oe.a===0?this.pdf.setDrawColor(255,255,255):(oe.a,this.pdf.setDrawColor(oe.r,oe.g,oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ce){["butt","round","square"].indexOf(Ce)!==-1&&(this.ctx.lineCap=Ce,this.pdf.setLineCap(Ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ce){isNaN(Ce)||(this.ctx.lineWidth=Ce,this.pdf.setLineWidth(Ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ce){["bevel","round","miter"].indexOf(Ce)!==-1&&(this.ctx.lineJoin=Ce,this.pdf.setLineJoin(Ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ce){isNaN(Ce)||(this.ctx.miterLimit=Ce,this.pdf.setMiterLimit(Ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ce){this.ctx.textBaseline=Ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ce){["right","end","center","left","start"].indexOf(Ce)!==-1&&(this.ctx.textAlign=Ce)}});var re=null;function Ue(Ce,oe){if(re===null){var De=function(Qe){var Be=[];return Object.keys(Qe).forEach(function(Ke){Qe[Ke].forEach(function(tt){var rt=null;switch(tt){case"bold":rt={family:Ke,weight:"bold"};break;case"italic":rt={family:Ke,style:"italic"};break;case"bolditalic":rt={family:Ke,weight:"bold",style:"italic"};break;case"":case"normal":rt={family:Ke}}rt!==null&&(rt.ref={name:Ke,style:tt},Be.push(rt))})}),Be}(Ce.getFontList());re=function(Qe){for(var Be={},Ke=0;Ke<Qe.length;++Ke){var tt=p2(Qe[Ke]),rt=tt.family,ht=tt.stretch,gt=tt.style,St=tt.weight;Be[rt]=Be[rt]||{},Be[rt][ht]=Be[rt][ht]||{},Be[rt][ht][gt]=Be[rt][ht][gt]||{},Be[rt][ht][gt][St]=tt}return Be}(De.concat(oe))}return re}var Ye=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ye},set:function(Ce){re=null,Ye=Ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ce){var oe;if(this.ctx.font=Ce,(oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ce))!==null){var De=oe[1],Qe=(oe[2],oe[3]),Be=oe[4],Ke=(oe[5],oe[6]),tt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Be)[2];Be=Math.floor(tt==="px"?parseFloat(Be)*this.pdf.internal.scaleFactor:tt==="em"?parseFloat(Be)*this.pdf.getFontSize():parseFloat(Be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Be);var rt=function(mt){var at,qe,or=[],wt=mt.trim();if(wt==="")return kv;if(wt in C_)return[C_[wt]];for(;wt!=="";){switch(qe=null,at=(wt=P_(wt)).charAt(0)){case'"':case"'":qe=VD(wt.substring(1),at);break;default:qe=qD(wt)}if(qe===null||(or.push(qe[0]),(wt=P_(qe[1]))!==""&&wt.charAt(0)!==","))return kv;wt=wt.replace(/^,/,"")}return or}(Ke);if(this.fontFaces){var ht=$D(Ue(this.pdf,this.fontFaces),rt.map(function(mt){return{family:mt,stretch:"normal",weight:Qe,style:De}}));this.pdf.setFont(ht.ref.name,ht.ref.style)}else{var gt="";(Qe==="bold"||parseInt(Qe,10)>=700||De==="bold")&&(gt="bold"),De==="italic"&&(gt+="italic"),gt.length===0&&(gt="normal");for(var St="",Tt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ht=0;Ht<rt.length;Ht++){if(this.pdf.internal.getFont(rt[Ht],gt,{noFallback:!0,disableWarning:!0})!==void 0){St=rt[Ht];break}if(gt==="bolditalic"&&this.pdf.internal.getFont(rt[Ht],"bold",{noFallback:!0,disableWarning:!0})!==void 0)St=rt[Ht],gt="bold";else if(this.pdf.internal.getFont(rt[Ht],"normal",{noFallback:!0,disableWarning:!0})!==void 0){St=rt[Ht],gt="normal";break}}if(St===""){for(var It=0;It<rt.length;It++)if(Tt[rt[It]]){St=Tt[rt[It]];break}}St=St===""?"Times":St,this.pdf.setFont(St,gt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ce){this.ctx.globalCompositeOperation=Ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ce){this.ctx.globalAlpha=Ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ce){this.ctx.lineDashOffset=Ce,ge.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ce){this.ctx.lineDash=Ce,ge.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ce){this.ctx.ignoreClearRect=!!Ce}})};f.prototype.setLineDash=function(C){this.lineDash=C},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){S.call(this,"fill",!1)},f.prototype.stroke=function(){S.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(C,R){if(isNaN(C)||isNaN(R))throw wr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var B=this.ctx.transform.applyToPoint(new s(C,R));this.path.push({type:"mt",x:B.x,y:B.y}),this.ctx.lastPoint=new s(C,R)},f.prototype.closePath=function(){var C=new s(0,0),R=0;for(R=this.path.length-1;R!==-1;R--)if(this.path[R].type==="begin"&&dr(this.path[R+1])==="object"&&typeof this.path[R+1].x=="number"){C=new s(this.path[R+1].x,this.path[R+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(C.x,C.y)},f.prototype.lineTo=function(C,R){if(isNaN(C)||isNaN(R))throw wr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var B=this.ctx.transform.applyToPoint(new s(C,R));this.path.push({type:"lt",x:B.x,y:B.y}),this.ctx.lastPoint=new s(B.x,B.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},f.prototype.quadraticCurveTo=function(C,R,B,U){if(isNaN(B)||isNaN(U)||isNaN(C)||isNaN(R))throw wr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Y=this.ctx.transform.applyToPoint(new s(B,U)),ue=this.ctx.transform.applyToPoint(new s(C,R));this.path.push({type:"qct",x1:ue.x,y1:ue.y,x:Y.x,y:Y.y}),this.ctx.lastPoint=new s(Y.x,Y.y)},f.prototype.bezierCurveTo=function(C,R,B,U,Y,ue){if(isNaN(Y)||isNaN(ue)||isNaN(C)||isNaN(R)||isNaN(B)||isNaN(U))throw wr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new s(Y,ue)),he=this.ctx.transform.applyToPoint(new s(C,R)),ye=this.ctx.transform.applyToPoint(new s(B,U));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:ye.x,y2:ye.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new s(pe.x,pe.y)},f.prototype.arc=function(C,R,B,U,Y,ue){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(U)||isNaN(Y))throw wr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ue=!!ue,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new s(C,R));C=pe.x,R=pe.y;var he=this.ctx.transform.applyToPoint(new s(0,B)),ye=this.ctx.transform.applyToPoint(new s(0,0));B=Math.sqrt(Math.pow(he.x-ye.x,2)+Math.pow(he.y-ye.y,2))}Math.abs(Y-U)>=2*Math.PI&&(U=0,Y=2*Math.PI),this.path.push({type:"arc",x:C,y:R,radius:B,startAngle:U,endAngle:Y,counterclockwise:ue})},f.prototype.arcTo=function(C,R,B,U,Y){throw new Error("arcTo not implemented.")},f.prototype.rect=function(C,R,B,U){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(U))throw wr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,R),this.lineTo(C+B,R),this.lineTo(C+B,R+U),this.lineTo(C,R+U),this.lineTo(C,R),this.lineTo(C+B,R),this.lineTo(C,R)},f.prototype.fillRect=function(C,R,B,U){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(U))throw wr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var Y={};this.lineCap!=="butt"&&(Y.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Y.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,R,B,U),this.fill(),Y.hasOwnProperty("lineCap")&&(this.lineCap=Y.lineCap),Y.hasOwnProperty("lineJoin")&&(this.lineJoin=Y.lineJoin)}},f.prototype.strokeRect=function(C,R,B,U){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(U))throw wr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(C,R,B,U),this.stroke())},f.prototype.clearRect=function(C,R,B,U){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(U))throw wr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,R,B,U))},f.prototype.save=function(C){C=typeof C!="boolean"||C;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("q");if(this.pdf.setPage(R),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var U=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=U}},f.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("Q");this.pdf.setPage(R),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var d=function(C){var R,B,U,Y;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))R=0,B=0,U=0,Y=0;else{var ue=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(ue!==null)R=parseInt(ue[1]),B=parseInt(ue[2]),U=parseInt(ue[3]),Y=1;else if((ue=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)R=parseInt(ue[1]),B=parseInt(ue[2]),U=parseInt(ue[3]),Y=parseFloat(ue[4]);else{if(Y=1,typeof C=="string"&&C.charAt(0)!=="#"){var pe=new KE(C);C=pe.ok?pe.toHex():"#000000"}C.length===4?(R=C.substring(1,2),R+=R,B=C.substring(2,3),B+=B,U=C.substring(3,4),U+=U):(R=C.substring(1,3),B=C.substring(3,5),U=C.substring(5,7)),R=parseInt(R,16),B=parseInt(B,16),U=parseInt(U,16)}}return{r:R,g:B,b:U,a:Y,style:C}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(C,R,B,U){if(isNaN(R)||isNaN(B)||typeof C!="string")throw wr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(U=isNaN(U)?void 0:U,!h.call(this)){var Y=X(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;T.call(this,{text:C,x:R,y:B,scale:ue,angle:Y,align:this.textAlign,maxWidth:U})}},f.prototype.strokeText=function(C,R,B,U){if(isNaN(R)||isNaN(B)||typeof C!="string")throw wr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){U=isNaN(U)?void 0:U;var Y=X(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;T.call(this,{text:C,x:R,y:B,scale:ue,renderingMode:"stroke",angle:Y,align:this.textAlign,maxWidth:U})}},f.prototype.measureText=function(C){if(typeof C!="string")throw wr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var R=this.pdf,B=this.pdf.internal.scaleFactor,U=R.internal.getFontSize(),Y=R.getStringUnitWidth(C)*U/R.internal.scaleFactor,ue=function(pe){var he=(pe=pe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this};return new ue({width:Y*=Math.round(96*B/72*1e4)/1e4})},f.prototype.scale=function(C,R){if(isNaN(C)||isNaN(R))throw wr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var B=new l(C,0,0,R,0,0);this.ctx.transform=this.ctx.transform.multiply(B)},f.prototype.rotate=function(C){if(isNaN(C))throw wr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var R=new l(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(R)},f.prototype.translate=function(C,R){if(isNaN(C)||isNaN(R))throw wr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var B=new l(1,0,0,1,C,R);this.ctx.transform=this.ctx.transform.multiply(B)},f.prototype.transform=function(C,R,B,U,Y,ue){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(U)||isNaN(Y)||isNaN(ue))throw wr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new l(C,R,B,U,Y,ue);this.ctx.transform=this.ctx.transform.multiply(pe)},f.prototype.setTransform=function(C,R,B,U,Y,ue){C=isNaN(C)?1:C,R=isNaN(R)?0:R,B=isNaN(B)?0:B,U=isNaN(U)?1:U,Y=isNaN(Y)?0:Y,ue=isNaN(ue)?0:ue,this.ctx.transform=new l(C,R,B,U,Y,ue)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(C,R,B,U,Y,ue,pe,he,ye){var Pe=this.pdf.getImageProperties(C),re=1,Ue=1,Ye=1,Ce=1;U!==void 0&&he!==void 0&&(Ye=he/U,Ce=ye/Y,re=Pe.width/U*he/U,Ue=Pe.height/Y*ye/Y),ue===void 0&&(ue=R,pe=B,R=0,B=0),U!==void 0&&he===void 0&&(he=U,ye=Y),U===void 0&&he===void 0&&(he=Pe.width,ye=Pe.height);for(var oe,De=this.ctx.transform.decompose(),Qe=X(De.rotate.shx),Be=new l,Ke=(Be=(Be=(Be=Be.multiply(De.translate)).multiply(De.skew)).multiply(De.scale)).applyToRectangle(new o(ue-R*Ye,pe-B*Ce,U*re,Y*Ue)),tt=y.call(this,Ke),rt=[],ht=0;ht<tt.length;ht+=1)rt.indexOf(tt[ht])===-1&&rt.push(tt[ht]);if(w(rt),this.autoPaging)for(var gt=rt[0],St=rt[rt.length-1],Tt=gt;Tt<St+1;Tt++){this.pdf.setPage(Tt);var Ht=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],It=Tt===1?this.posY+this.margin[0]:this.margin[0],mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],at=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],qe=Tt===1?0:mt+(Tt-2)*at;if(this.ctx.clip_path.length!==0){var or=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(oe,this.posX+this.margin[3],-qe+It+this.ctx.prevPageLastElemOffset),L.call(this,"fill",!0),this.path=or}var wt=JSON.parse(JSON.stringify(Ke));wt=b([wt],this.posX+this.margin[3],-qe+It+this.ctx.prevPageLastElemOffset)[0];var vn=(Tt>gt||Tt<St)&&m.call(this);vn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ht,at,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",wt.x,wt.y,wt.w,wt.h,null,null,Qe),vn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(C,"JPEG",Ke.x,Ke.y,Ke.w,Ke.h,null,null,Qe)};var y=function(C,R,B){var U=[];R=R||this.pdf.internal.pageSize.width,B=B||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Y=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":U.push(Math.floor((C.y+Y)/B)+1);break;case"arc":U.push(Math.floor((C.y+Y-C.radius)/B)+1),U.push(Math.floor((C.y+Y+C.radius)/B)+1);break;case"qct":var ue=D(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);U.push(Math.floor((ue.y+Y)/B)+1),U.push(Math.floor((ue.y+ue.h+Y)/B)+1);break;case"bct":var pe=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);U.push(Math.floor((pe.y+Y)/B)+1),U.push(Math.floor((pe.y+pe.h+Y)/B)+1);break;case"rect":U.push(Math.floor((C.y+Y)/B)+1),U.push(Math.floor((C.y+C.h+Y)/B)+1)}for(var he=0;he<U.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<U[he];)x.call(this);return U},x=function(){var C=this.fillStyle,R=this.strokeStyle,B=this.font,U=this.lineCap,Y=this.lineWidth,ue=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=R,this.font=B,this.lineCap=U,this.lineWidth=Y,this.lineJoin=ue},b=function(C,R,B){for(var U=0;U<C.length;U++)switch(C[U].type){case"bct":C[U].x2+=R,C[U].y2+=B;case"qct":C[U].x1+=R,C[U].y1+=B;case"mt":case"lt":case"arc":default:C[U].x+=R,C[U].y+=B}return C},w=function(C){return C.sort(function(R,B){return R-B})},S=function(C,R){for(var B,U,Y=this.fillStyle,ue=this.strokeStyle,pe=this.lineCap,he=this.lineWidth,ye=Math.abs(he*this.ctx.transform.scaleX),Pe=this.lineJoin,re=JSON.parse(JSON.stringify(this.path)),Ue=JSON.parse(JSON.stringify(this.path)),Ye=[],Ce=0;Ce<Ue.length;Ce++)if(Ue[Ce].x!==void 0)for(var oe=y.call(this,Ue[Ce]),De=0;De<oe.length;De+=1)Ye.indexOf(oe[De])===-1&&Ye.push(oe[De]);for(var Qe=0;Qe<Ye.length;Qe++)for(;this.pdf.internal.getNumberOfPages()<Ye[Qe];)x.call(this);if(w(Ye),this.autoPaging)for(var Be=Ye[0],Ke=Ye[Ye.length-1],tt=Be;tt<Ke+1;tt++){this.pdf.setPage(tt),this.fillStyle=Y,this.strokeStyle=ue,this.lineCap=pe,this.lineWidth=ye,this.lineJoin=Pe;var rt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ht=tt===1?this.posY+this.margin[0]:this.margin[0],gt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],St=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Tt=tt===1?0:gt+(tt-2)*St;if(this.ctx.clip_path.length!==0){var Ht=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(B,this.posX+this.margin[3],-Tt+ht+this.ctx.prevPageLastElemOffset),L.call(this,C,!0),this.path=Ht}if(U=JSON.parse(JSON.stringify(re)),this.path=b(U,this.posX+this.margin[3],-Tt+ht+this.ctx.prevPageLastElemOffset),R===!1||tt===0){var It=(tt>Be||tt<Ke)&&m.call(this);It&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],rt,St,null).clip().discardPath()),L.call(this,C,R),It&&this.pdf.restoreGraphicsState()}this.lineWidth=he}else this.lineWidth=ye,L.call(this,C,R),this.lineWidth=he;this.path=re},L=function(C,R){if((C!=="stroke"||R||!v.call(this))&&(C==="stroke"||R||!h.call(this))){for(var B,U,Y=[],ue=this.path,pe=0;pe<ue.length;pe++){var he=ue[pe];switch(he.type){case"begin":Y.push({begin:!0});break;case"close":Y.push({close:!0});break;case"mt":Y.push({start:he,deltas:[],abs:[]});break;case"lt":var ye=Y.length;if(ue[pe-1]&&!isNaN(ue[pe-1].x)&&(B=[he.x-ue[pe-1].x,he.y-ue[pe-1].y],ye>0)){for(;ye>=0;ye--)if(Y[ye-1].close!==!0&&Y[ye-1].begin!==!0){Y[ye-1].deltas.push(B),Y[ye-1].abs.push(he);break}}break;case"bct":B=[he.x1-ue[pe-1].x,he.y1-ue[pe-1].y,he.x2-ue[pe-1].x,he.y2-ue[pe-1].y,he.x-ue[pe-1].x,he.y-ue[pe-1].y],Y[Y.length-1].deltas.push(B);break;case"qct":var Pe=ue[pe-1].x+2/3*(he.x1-ue[pe-1].x),re=ue[pe-1].y+2/3*(he.y1-ue[pe-1].y),Ue=he.x+2/3*(he.x1-he.x),Ye=he.y+2/3*(he.y1-he.y),Ce=he.x,oe=he.y;B=[Pe-ue[pe-1].x,re-ue[pe-1].y,Ue-ue[pe-1].x,Ye-ue[pe-1].y,Ce-ue[pe-1].x,oe-ue[pe-1].y],Y[Y.length-1].deltas.push(B);break;case"arc":Y.push({deltas:[],abs:[],arc:!0}),Array.isArray(Y[Y.length-1].abs)&&Y[Y.length-1].abs.push(he)}}U=R?null:C==="stroke"?"stroke":"fill";for(var De=!1,Qe=0;Qe<Y.length;Qe++)if(Y[Qe].arc)for(var Be=Y[Qe].abs,Ke=0;Ke<Be.length;Ke++){var tt=Be[Ke];tt.type==="arc"?E.call(this,tt.x,tt.y,tt.radius,tt.startAngle,tt.endAngle,tt.counterclockwise,void 0,R,!De):H.call(this,tt.x,tt.y),De=!0}else if(Y[Qe].close===!0)this.pdf.internal.out("h"),De=!1;else if(Y[Qe].begin!==!0){var rt=Y[Qe].start.x,ht=Y[Qe].start.y;W.call(this,Y[Qe].deltas,rt,ht),De=!0}U&&P.call(this,U),R&&M.call(this)}},j=function(C){var R=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,B=R*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-B;case"top":return C+R-B;case"hanging":return C+R-2*B;case"middle":return C+R/2-B;case"ideographic":return C;case"alphabetic":default:return C}},N=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(R,B){this.colorStops.push([R,B])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var E=function(C,R,B,U,Y,ue,pe,he,ye){for(var Pe=V.call(this,B,U,Y,ue),re=0;re<Pe.length;re++){var Ue=Pe[re];re===0&&(ye?F.call(this,Ue.x1+C,Ue.y1+R):H.call(this,Ue.x1+C,Ue.y1+R)),Q.call(this,C,R,Ue.x2,Ue.y2,Ue.x3,Ue.y3,Ue.x4,Ue.y4)}he?M.call(this):P.call(this,pe)},P=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(C,R){this.pdf.internal.out(r(C)+" "+n(R)+" m")},T=function(C){var R;switch(C.align){case"right":case"end":R="right";break;case"center":R="center";break;case"left":case"start":default:R="left"}var B=this.pdf.getTextDimensions(C.text),U=j.call(this,C.y),Y=N.call(this,U)-B.h,ue=this.ctx.transform.applyToPoint(new s(C.x,U)),pe=this.ctx.transform.decompose(),he=new l;he=(he=(he=he.multiply(pe.translate)).multiply(pe.skew)).multiply(pe.scale);for(var ye,Pe,re,Ue=this.ctx.transform.applyToRectangle(new o(C.x,U,B.w,B.h)),Ye=he.applyToRectangle(new o(C.x,Y,B.w,B.h)),Ce=y.call(this,Ye),oe=[],De=0;De<Ce.length;De+=1)oe.indexOf(Ce[De])===-1&&oe.push(Ce[De]);if(w(oe),this.autoPaging)for(var Qe=oe[0],Be=oe[oe.length-1],Ke=Qe;Ke<Be+1;Ke++){this.pdf.setPage(Ke);var tt=Ke===1?this.posY+this.margin[0]:this.margin[0],rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ht=this.pdf.internal.pageSize.height-this.margin[2],gt=ht-this.margin[0],St=this.pdf.internal.pageSize.width-this.margin[1],Tt=St-this.margin[3],Ht=Ke===1?0:rt+(Ke-2)*gt;if(this.ctx.clip_path.length!==0){var It=this.path;ye=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ye,this.posX+this.margin[3],-1*Ht+tt),L.call(this,"fill",!0),this.path=It}var mt=b([JSON.parse(JSON.stringify(Ye))],this.posX+this.margin[3],-Ht+tt+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*C.scale),re=this.lineWidth,this.lineWidth=re*C.scale);var at=this.autoPaging!=="text";if(at||mt.y+mt.h<=ht){if(at||mt.y>=tt&&mt.x<=St){var qe=at?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||St-mt.x)[0],or=b([JSON.parse(JSON.stringify(Ue))],this.posX+this.margin[3],-Ht+tt+this.ctx.prevPageLastElemOffset)[0],wt=at&&(Ke>Qe||Ke<Be)&&m.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,gt,null).clip().discardPath()),this.pdf.text(qe,or.x,or.y,{angle:C.angle,align:R,renderingMode:C.renderingMode}),wt&&this.pdf.restoreGraphicsState()}}else mt.y<ht&&(this.ctx.prevPageLastElemOffset+=ht-mt.y);C.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=re)}else C.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*C.scale),re=this.lineWidth,this.lineWidth=re*C.scale),this.pdf.text(C.text,ue.x+this.posX,ue.y+this.posY,{angle:C.angle,align:R,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=re)},H=function(C,R,B,U){B=B||0,U=U||0,this.pdf.internal.out(r(C+B)+" "+n(R+U)+" l")},W=function(C,R,B){return this.pdf.lines(C,R,B,null,null)},Q=function(C,R,B,U,Y,ue,pe,he){this.pdf.internal.out([t(a(B+C)),t(i(U+R)),t(a(Y+C)),t(i(ue+R)),t(a(pe+C)),t(i(he+R)),"c"].join(" "))},V=function(C,R,B,U){for(var Y=2*Math.PI,ue=Math.PI/2;R>B;)R-=Y;var pe=Math.abs(B-R);pe<Y&&U&&(pe=Y-pe);for(var he=[],ye=U?-1:1,Pe=R;pe>1e-5;){var re=Pe+ye*Math.min(pe,ue);he.push(z.call(this,C,Pe,re)),pe-=Math.abs(re-Pe),Pe=re}return he},z=function(C,R,B){var U=(B-R)/2,Y=C*Math.cos(U),ue=C*Math.sin(U),pe=Y,he=-ue,ye=pe*pe+he*he,Pe=ye+pe*Y+he*ue,re=4/3*(Math.sqrt(2*ye*Pe)-Pe)/(pe*ue-he*Y),Ue=pe-re*he,Ye=he+re*pe,Ce=Ue,oe=-Ye,De=U+R,Qe=Math.cos(De),Be=Math.sin(De);return{x1:C*Math.cos(R),y1:C*Math.sin(R),x2:Ue*Qe-Ye*Be,y2:Ue*Be+Ye*Qe,x3:Ce*Qe-oe*Be,y3:Ce*Be+oe*Qe,x4:C*Math.cos(B),y4:C*Math.sin(B)}},X=function(C){return 180*C/Math.PI},D=function(C,R,B,U,Y,ue){var pe=C+.5*(B-C),he=R+.5*(U-R),ye=Y+.5*(B-Y),Pe=ue+.5*(U-ue),re=Math.min(C,Y,pe,ye),Ue=Math.max(C,Y,pe,ye),Ye=Math.min(R,ue,he,Pe),Ce=Math.max(R,ue,he,Pe);return new o(re,Ye,Ue-re,Ce-Ye)},ne=function(C,R,B,U,Y,ue,pe,he){var ye,Pe,re,Ue,Ye,Ce,oe,De,Qe,Be,Ke,tt,rt,ht,gt=B-C,St=U-R,Tt=Y-B,Ht=ue-U,It=pe-Y,mt=he-ue;for(Pe=0;Pe<41;Pe++)Qe=(oe=(re=C+(ye=Pe/40)*gt)+ye*((Ye=B+ye*Tt)-re))+ye*(Ye+ye*(Y+ye*It-Ye)-oe),Be=(De=(Ue=R+ye*St)+ye*((Ce=U+ye*Ht)-Ue))+ye*(Ce+ye*(ue+ye*mt-Ce)-De),Pe==0?(Ke=Qe,tt=Be,rt=Qe,ht=Be):(Ke=Math.min(Ke,Qe),tt=Math.min(tt,Be),rt=Math.max(rt,Qe),ht=Math.max(ht,Be));return new o(Math.round(Ke),Math.round(tt),Math.round(rt-Ke),Math.round(ht-tt))},ge=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,R,B=(C=this.ctx.lineDash,R=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:R}));this.prevLineDash!==B&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=B)}}})(kt.API),function(e){var t=function(i){var s,o,l,c,u,f,d,h,v,m;for(o=[],l=0,c=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;c>l;l+=4)(u=(i.charCodeAt(l)<<24)+(i.charCodeAt(l+1)<<16)+(i.charCodeAt(l+2)<<8)+i.charCodeAt(l+3))!==0?(f=(u=((u=((u=((u=(u-(m=u%85))/85)-(v=u%85))/85)-(h=u%85))/85)-(d=u%85))/85)%85,o.push(f+33,d+33,h+33,v+33,m+33)):o.push(122);return function(y,x){for(var b=x;b>0;b--)y.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},r=function(i){var s,o,l,c,u,f=String,d="length",h=255,v="charCodeAt",m="slice",y="replace";for(i[m](-2),i=i[m](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),l=[],c=0,u=(i+=s="uuuuu"[m](i[d]%5||5))[d];u>c;c+=5)o=52200625*(i[v](c)-33)+614125*(i[v](c+1)-33)+7225*(i[v](c+2)-33)+85*(i[v](c+3)-33)+(i[v](c+4)-33),l.push(h&o>>24,h&o>>16,h&o>>8,h&o);return function(x,b){for(var w=b;w>0;w--)x.pop()}(l,s[d]),f.fromCharCode.apply(f,l)},n=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",l=0;l<i.length;l+=2)o+=String.fromCharCode("0x"+(i[l]+i[l+1]));return o},a=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=l2(s)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};e.processDataByFilters=function(i,s){var o=0,l=i||"",c=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=a(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(kt.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,c,u){var f=new XMLHttpRequest,d=0,h=function(v){var m=v.length,y=[],x=String.fromCharCode;for(d=0;d<m;d+=1)y.push(x(255&v.charCodeAt(d)));return y.join("")};if(f.open("GET",l,!c),f.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(f.onload=function(){f.status===200?u(h(this.responseText)):u(void 0)}),f.send(null),c&&f.status===200)return h(f.responseText)}(a,i,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(kt.API),function(e){function t(){return(Nt.html2canvas?Promise.resolve(Nt.html2canvas):vo(()=>import("./html2canvas.esm-e0a7d97b.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(Nt.DOMPurify?Promise.resolve(Nt.DOMPurify):vo(()=>import("./purify.es-2de9db7f.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var o=dr(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(s,o){var l=document.createElement(s);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},i=function s(o){var l=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),c=s.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(l){return this.set({src:a("div",{innerHTML:s,dompurify:l})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),d=c.firstChild;d;d=d.nextSibling)u!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||f.appendChild(l(d,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var d=0;d<c.length;++d){var h=c[d],v=h.src.find(function(m){return m.format==="truetype"});v&&l.addFont(v.url,h.ref.name,h.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,l.context2d.save(!0),o(this.prop.container,f)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(s,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map(function(l){if(l in i.template.prop)return function(){this.prop[l]=s[l]};switch(l){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[l]=s[l]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(s,o){return this.then(function(){var l=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(l):l})},i.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(s=s||kt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},i.prototype.setProgress=function(s,o,l,c){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,l,c){return this.setProgress(s?this.progress.val+s:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(s,o){var l=this;return this.thenCore(s,o,function(c,u){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(f){return l.updateProgress(null,c),f}).then(c,u).then(function(f){return l.updateProgress(1),f})})},i.prototype.thenCore=function(s,o,l){l=l||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),u=l.call(c,s,o);return i.convert(u,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach(function(l){o=o.thenCore(l)}),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then(function(){throw new Error(s)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,kt.getPageSize=function(s,o,l){if(dr(s)==="object"){var c=s;s=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",s=(""+(s||"P")).toLowerCase();var u,f=(""+l).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var h,v=0,m=0;if(d.hasOwnProperty(f))v=d[f][1]/u,m=d[f][0]/u;else try{v=l[1],m=l[0]}catch{throw new Error("Invalid format: "+l)}if(s==="p"||s==="portrait")s="p",m>v&&(h=m,m=v,v=h);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",v>m&&(h=m,m=v,v=h)}return{width:m,height:v,unit:o,k:u,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(p2):null;var l=new i(o);return o.worker?l:l.from(s).doCallback()}}(kt.API),kt.API.addJS=function(e){return L_=e,this.internal.events.subscribe("postPutResources",function(){N1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(N1+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),F_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+L_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){N1!==void 0&&F_!==void 0&&this.internal.out("/Names <</JavaScript "+N1+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(i=0;i<c;i++){var f=r.internal.newObject();u.push(f);var d=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+d.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(kt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=function(f){for(var d,h=256*f.charCodeAt(4)+f.charCodeAt(5),v=f.length,m={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=h,t.indexOf(f.charCodeAt(y+1))!==-1){d=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),m={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:d,numcomponents:f.charCodeAt(y+9)};break}h=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:a}}return u}}(kt.API);var _u,A1,j_,I_,D_,GD=function(){var e,t,r;function n(i){var s,o,l,c,u,f,d,h,v,m,y,x,b,w;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(s=this.readUInt32(),v=(function(){var S,L;for(L=[],S=0;S<4;++S)L.push(String.fromCharCode(this.data[this.pos++]));return L}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),c=this.readUInt16()||100,f.delay=1e3*u/c,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(v==="fdAT"&&(this.pos+=4,s-=4),i=(f!=null?f.data:void 0)||this.imgData,x=0;0<=s?x<s:x>s;0<=s?++x:--x)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((m=l-this.transparency.indexed.length)>0)for(b=0;0<=m?b<m:b>m;0<=m?++b:--b)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":d=(y=this.read(s)).indexOf(0),h=String.fromCharCode.apply(String,y.slice(0,d)),this.text[h]=String.fromCharCode.apply(String,y.slice(d+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(w=this.colorType)===4||w===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),l=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function u(f,d,h,v){var m,y,x,b,w,S,L,j,N,E,P,M,F,T,H,W,Q,V,z,X,D,ne=Math.ceil((c.width-f)/h),ge=Math.ceil((c.height-d)/v),C=c.width==ne&&c.height==ge;for(T=s*ne,M=C?o:new Uint8Array(T*ge),S=i.length,F=0,y=0;F<ge&&l<S;){switch(i[l++]){case 0:for(b=Q=0;Q<T;b=Q+=1)M[y++]=i[l++];break;case 1:for(b=V=0;V<T;b=V+=1)m=i[l++],w=b<s?0:M[y-s],M[y++]=(m+w)%256;break;case 2:for(b=z=0;z<T;b=z+=1)m=i[l++],x=(b-b%s)/s,H=F&&M[(F-1)*T+x*s+b%s],M[y++]=(H+m)%256;break;case 3:for(b=X=0;X<T;b=X+=1)m=i[l++],x=(b-b%s)/s,w=b<s?0:M[y-s],H=F&&M[(F-1)*T+x*s+b%s],M[y++]=(m+Math.floor((w+H)/2))%256;break;case 4:for(b=D=0;D<T;b=D+=1)m=i[l++],x=(b-b%s)/s,w=b<s?0:M[y-s],F===0?H=W=0:(H=M[(F-1)*T+x*s+b%s],W=x&&M[(F-1)*T+(x-1)*s+b%s]),L=w+H-W,j=Math.abs(L-w),E=Math.abs(L-H),P=Math.abs(L-W),N=j<=E&&j<=P?w:E<=P?H:W,M[y++]=(m+N)%256;break;default:throw new Error("Invalid filter algorithm: "+i[l-1])}if(!C){var R=((d+F*v)*c.width+f)*s,B=F*T;for(b=0;b<ne;b+=1){for(var U=0;U<s;U+=1)o[R++]=M[B++];R+=(h-1)*s}}F++}}return i=SD(i),c.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},n.prototype.decodePalette=function(){var i,s,o,l,c,u,f,d,h;for(o=this.palette,u=this.transparency.indexed||[],c=new Uint8Array((u.length||0)+o.length),l=0,i=0,s=f=0,d=o.length;f<d;s=f+=3)c[l++]=o[s],c[l++]=o[s+1],c[l++]=o[s+2],c[l++]=(h=u[i++])!=null?h:255;return c},n.prototype.copyToImageData=function(i,s){var o,l,c,u,f,d,h,v,m,y,x;if(l=this.colors,m=null,o=this.hasAlphaChannel,this.palette.length&&(m=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),l=4,o=!0),v=(c=i.data||i).length,f=m||s,u=d=0,l===1)for(;u<v;)h=m?4*s[u/4]:d,y=f[h++],c[u++]=y,c[u++]=y,c[u++]=y,c[u++]=o?f[h++]:255,d=h;else for(;u<v;)h=m?4*s[u/4]:d,c[u++]=f[h++],c[u++]=f[h++],c[u++]=f[h++],c[u++]=o?f[h++]:255,d=h},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(Nt)==="[object Window]"){try{t=Nt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(i){var s;if(a()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var s,o,l,c,u,f,d,h;if(this.animation){for(h=[],o=u=0,f=(d=this.animation.frames).length;u<f;o=++u)s=d[o],l=i.createImageData(s.width,s.height),c=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(l,c),s.imageData=l,h.push(s.image=e(l));return h}},n.prototype.renderFrame=function(i,s){var o,l,c;return o=(l=this.animation.frames)[s],c=l[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(i){var s,o,l,c,u,f,d=this;return o=0,f=this.animation,c=f.numFrames,l=f.frames,u=f.numPlays,(s=function(){var h,v;if(h=o++%c,v=l[h],d.renderFrame(i,h),c>1&&o/c<u)return d.animation._timeout=setTimeout(s,v.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function XD(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<(7&a)+1;e[t++],e[t++];var o=null,l=null;i&&(o=t,l=s,t+=3*s);var c=!0,u=[],f=0,d=null,h=0,v=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];f=e[t++]|e[t++]<<8,d=e[t++],!(1&m)&&(d=null),h=m>>2&7,t++;break;case 254:for(;;){if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,S=e[t++],L=S>>6&1,j=1<<(7&S)+1,N=o,E=l,P=!1;S>>7&&(P=!0,N=t,E=j,t+=3*j);var M=t;for(t++;;){var F;if(!((F=e[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}u.push({x:y,y:x,width:b,height:w,has_local_palette:P,palette_offset:N,palette_size:E,data_offset:M,data_length:t-M,transparent_index:d,interlaced:!!L,delay:f,disposal:h});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return v},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,H){var W=this.frameInfo(T),Q=W.width*W.height,V=new Uint8Array(Q);O_(e,W.data_offset,V,Q);var z=W.palette_offset,X=W.transparent_index;X===null&&(X=256);var D=W.width,ne=r-D,ge=D,C=4*(W.y*r+W.x),R=4*((W.y+W.height)*r+W.x),B=C,U=4*ne;W.interlaced===!0&&(U+=4*r*7);for(var Y=8,ue=0,pe=V.length;ue<pe;++ue){var he=V[ue];if(ge===0&&(ge=D,(B+=U)>=R&&(U=4*ne+4*r*(Y-1),B=C+(D+ne)*(Y<<1),Y>>=1)),he===X)B+=4;else{var ye=e[z+3*he],Pe=e[z+3*he+1],re=e[z+3*he+2];H[B++]=re,H[B++]=Pe,H[B++]=ye,H[B++]=255}--ge}},this.decodeAndBlitFrameRGBA=function(T,H){var W=this.frameInfo(T),Q=W.width*W.height,V=new Uint8Array(Q);O_(e,W.data_offset,V,Q);var z=W.palette_offset,X=W.transparent_index;X===null&&(X=256);var D=W.width,ne=r-D,ge=D,C=4*(W.y*r+W.x),R=4*((W.y+W.height)*r+W.x),B=C,U=4*ne;W.interlaced===!0&&(U+=4*r*7);for(var Y=8,ue=0,pe=V.length;ue<pe;++ue){var he=V[ue];if(ge===0&&(ge=D,(B+=U)>=R&&(U=4*ne+4*r*(Y-1),B=C+(D+ne)*(Y<<1),Y>>=1)),he===X)B+=4;else{var ye=e[z+3*he],Pe=e[z+3*he+1],re=e[z+3*he+2];H[B++]=ye,H[B++]=Pe,H[B++]=re,H[B++]=255}--ge}}}function O_(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,o=s+1,l=a+1,c=(1<<l)-1,u=0,f=0,d=0,h=e[t++],v=new Int32Array(4096),m=null;;){for(;u<16&&h!==0;)f|=e[t++]<<u,u+=8,h===1?h=e[t++]:--h;if(u<l)break;var y=f&c;if(f>>=l,u-=l,y!==i){if(y===s)break;for(var x=y<o?y:m,b=0,w=x;w>i;)w=v[w]>>8,++b;var S=w;if(d+b+(x!==y?1:0)>n)return void wr.log("Warning, gif stream longer than expected.");r[d++]=S;var L=d+=b;for(x!==y&&(r[d++]=S),w=x;b--;)w=v[w],r[--L]=255&w,w>>=8;m!==null&&o<4096&&(v[o++]=m<<8|S,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=y}else o=s+1,c=(1<<(l=a+1))-1,m=null}return d!==n&&wr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Sv(e){var t,r,n,a,i,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(65535),d=new Array(65535),h=new Array(64),v=new Array(64),m=[],y=0,x=7,b=new Array(64),w=new Array(64),S=new Array(64),L=new Array(256),j=new Array(2048),N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function V(C,R){for(var B=0,U=0,Y=new Array,ue=1;ue<=16;ue++){for(var pe=1;pe<=C[ue];pe++)Y[R[U]]=[],Y[R[U]][0]=B,Y[R[U]][1]=ue,U++,B++;B*=2}return Y}function z(C){for(var R=C[0],B=C[1]-1;B>=0;)R&1<<B&&(y|=1<<x),B--,--x<0&&(y==255?(X(255),X(0)):X(y),x=7,y=0)}function X(C){m.push(C)}function D(C){X(C>>8&255),X(255&C)}function ne(C,R,B,U,Y){for(var ue,pe=Y[0],he=Y[240],ye=function(Be,Ke){var tt,rt,ht,gt,St,Tt,Ht,It,mt,at,qe=0;for(mt=0;mt<8;++mt){tt=Be[qe],rt=Be[qe+1],ht=Be[qe+2],gt=Be[qe+3],St=Be[qe+4],Tt=Be[qe+5],Ht=Be[qe+6];var or=tt+(It=Be[qe+7]),wt=tt-It,vn=rt+Ht,ir=rt-Ht,_r=ht+Tt,fi=ht-Tt,Jt=gt+St,fs=gt-St,Ar=or+Jt,Ha=or-Jt,Ri=vn+_r,xr=vn-_r;Be[qe]=Ar+Ri,Be[qe+4]=Ar-Ri;var Ft=.707106781*(xr+Ha);Be[qe+2]=Ha+Ft,Be[qe+6]=Ha-Ft;var rr=.382683433*((Ar=fs+fi)-(xr=ir+wt)),zs=.5411961*Ar+rr,xn=1.306562965*xr+rr,di=.707106781*(Ri=fi+ir),hi=wt+di,bt=wt-di;Be[qe+5]=bt+zs,Be[qe+3]=bt-zs,Be[qe+1]=hi+xn,Be[qe+7]=hi-xn,qe+=8}for(qe=0,mt=0;mt<8;++mt){tt=Be[qe],rt=Be[qe+8],ht=Be[qe+16],gt=Be[qe+24],St=Be[qe+32],Tt=Be[qe+40],Ht=Be[qe+48];var $a=tt+(It=Be[qe+56]),Na=tt-It,Vn=rt+Ht,Yr=rt-Ht,Wr=ht+Tt,J=ht-Tt,ce=gt+St,ae=gt-St,ie=$a+ce,le=$a-ce,fe=Vn+Wr,Se=Vn-Wr;Be[qe]=ie+fe,Be[qe+32]=ie-fe;var Fe=.707106781*(Se+le);Be[qe+16]=le+Fe,Be[qe+48]=le-Fe;var ke=.382683433*((ie=ae+J)-(Se=Yr+Na)),Ae=.5411961*ie+ke,Te=1.306562965*Se+ke,Ve=.707106781*(fe=J+Yr),Je=Na+Ve,ot=Na-Ve;Be[qe+40]=ot+Ae,Be[qe+24]=ot-Ae,Be[qe+8]=Je+Te,Be[qe+56]=Je-Te,qe++}for(mt=0;mt<64;++mt)at=Be[mt]*Ke[mt],h[mt]=at>0?at+.5|0:at-.5|0;return h}(C,R),Pe=0;Pe<64;++Pe)v[N[Pe]]=ye[Pe];var re=v[0]-B;B=v[0],re==0?z(U[0]):(z(U[d[ue=32767+re]]),z(f[ue]));for(var Ue=63;Ue>0&&v[Ue]==0;)Ue--;if(Ue==0)return z(pe),B;for(var Ye,Ce=1;Ce<=Ue;){for(var oe=Ce;v[Ce]==0&&Ce<=Ue;)++Ce;var De=Ce-oe;if(De>=16){Ye=De>>4;for(var Qe=1;Qe<=Ye;++Qe)z(he);De&=15}ue=32767+v[Ce],z(Y[(De<<4)+d[ue]]),z(f[ue]),Ce++}return Ue!=63&&z(pe),B}function ge(C){C=Math.min(Math.max(C,1),100),i!=C&&(function(R){for(var B=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],U=0;U<64;U++){var Y=s((B[U]*R+50)/100);Y=Math.min(Math.max(Y,1),255),o[N[U]]=Y}for(var ue=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var he=s((ue[pe]*R+50)/100);he=Math.min(Math.max(he,1),255),l[N[pe]]=he}for(var ye=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Pe=0,re=0;re<8;re++)for(var Ue=0;Ue<8;Ue++)c[Pe]=1/(o[N[Pe]]*ye[re]*ye[Ue]*8),u[Pe]=1/(l[N[Pe]]*ye[re]*ye[Ue]*8),Pe++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),i=C)}this.encode=function(C,R){R&&ge(R),m=new Array,y=0,x=7,D(65496),D(65504),D(16),X(74),X(70),X(73),X(70),X(0),X(1),X(1),X(0),D(1),D(1),X(0),X(0),function(){D(65499),D(132),X(0);for(var rt=0;rt<64;rt++)X(o[rt]);X(1);for(var ht=0;ht<64;ht++)X(l[ht])}(),function(rt,ht){D(65472),D(17),X(8),D(ht),D(rt),X(3),X(1),X(17),X(0),X(2),X(17),X(1),X(3),X(17),X(1)}(C.width,C.height),function(){D(65476),D(418),X(0);for(var rt=0;rt<16;rt++)X(E[rt+1]);for(var ht=0;ht<=11;ht++)X(P[ht]);X(16);for(var gt=0;gt<16;gt++)X(M[gt+1]);for(var St=0;St<=161;St++)X(F[St]);X(1);for(var Tt=0;Tt<16;Tt++)X(T[Tt+1]);for(var Ht=0;Ht<=11;Ht++)X(H[Ht]);X(17);for(var It=0;It<16;It++)X(W[It+1]);for(var mt=0;mt<=161;mt++)X(Q[mt])}(),D(65498),D(12),X(3),X(1),X(0),X(2),X(17),X(3),X(17),X(0),X(63),X(0);var B=0,U=0,Y=0;y=0,x=7,this.encode.displayName="_encode_";for(var ue,pe,he,ye,Pe,re,Ue,Ye,Ce,oe=C.data,De=C.width,Qe=C.height,Be=4*De,Ke=0;Ke<Qe;){for(ue=0;ue<Be;){for(Pe=Be*Ke+ue,Ue=-1,Ye=0,Ce=0;Ce<64;Ce++)re=Pe+(Ye=Ce>>3)*Be+(Ue=4*(7&Ce)),Ke+Ye>=Qe&&(re-=Be*(Ke+1+Ye-Qe)),ue+Ue>=Be&&(re-=ue+Ue-Be+4),pe=oe[re++],he=oe[re++],ye=oe[re++],b[Ce]=(j[pe]+j[he+256>>0]+j[ye+512>>0]>>16)-128,w[Ce]=(j[pe+768>>0]+j[he+1024>>0]+j[ye+1280>>0]>>16)-128,S[Ce]=(j[pe+1280>>0]+j[he+1536>>0]+j[ye+1792>>0]>>16)-128;B=ne(b,c,B,t,n),U=ne(w,u,U,r,a),Y=ne(S,u,Y,r,a),ue+=32}Ke+=8}if(x>=0){var tt=[];tt[1]=x+1,tt[0]=(1<<x+1)-1,z(tt)}return D(65497),new Uint8Array(m)},e=e||50,function(){for(var C=String.fromCharCode,R=0;R<256;R++)L[R]=C(R)}(),t=V(E,P),r=V(T,H),n=V(M,F),a=V(W,Q),function(){for(var C=1,R=2,B=1;B<=15;B++){for(var U=C;U<R;U++)d[32767+U]=B,f[32767+U]=[],f[32767+U][1]=B,f[32767+U][0]=U;for(var Y=-(R-1);Y<=-C;Y++)d[32767+Y]=B,f[32767+Y]=[],f[32767+Y][1]=B,f[32767+Y][0]=R-1+Y;C<<=1,R<<=1}}(),function(){for(var C=0;C<256;C++)j[C]=19595*C,j[C+256>>0]=38470*C,j[C+512>>0]=7471*C+32768,j[C+768>>0]=-11059*C,j[C+1024>>0]=-21709*C,j[C+1280>>0]=32768*C+8421375,j[C+1536>>0]=-27439*C,j[C+1792>>0]=-5329*C}(),ge(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Gi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function R_(e){function t(E){if(!E)throw Error("assert :P")}function r(E,P,M){for(var F=0;4>F;F++)if(E[P+F]!=M.charCodeAt(F))return!0;return!1}function n(E,P,M,F,T){for(var H=0;H<T;H++)E[P+H]=M[F+H]}function a(E,P,M,F){for(var T=0;T<F;T++)E[P+T]=M}function i(E){return new Int32Array(E)}function s(E,P){for(var M=[],F=0;F<E;F++)M.push(new P);return M}function o(E,P){var M=[];return function F(T,H,W){for(var Q=W[H],V=0;V<Q&&(T.push(W.length>H+1?[]:new P),!(W.length<H+1));V++)F(T[V],H+1,W)}(M,0,E),M}var l=function(){var E=this;function P(g,_){for(var A=1<<_-1>>>0;g&A;)A>>>=1;return A?(g&A-1)+A:g}function M(g,_,A,I,q){t(!(I%A));do g[_+(I-=A)]=q;while(0<I)}function F(g,_,A,I,q){if(t(2328>=q),512>=q)var K=i(512);else if((K=i(q))==null)return 0;return function(Z,ee,te,se,ve,Ee){var Ne,be,Me=ee,Le=1<<te,xe=i(16),we=i(16);for(t(ve!=0),t(se!=null),t(Z!=null),t(0<te),be=0;be<ve;++be){if(15<se[be])return 0;++xe[se[be]]}if(xe[0]==ve)return 0;for(we[1]=0,Ne=1;15>Ne;++Ne){if(xe[Ne]>1<<Ne)return 0;we[Ne+1]=we[Ne]+xe[Ne]}for(be=0;be<ve;++be)Ne=se[be],0<se[be]&&(Ee[we[Ne]++]=be);if(we[15]==1)return(se=new T).g=0,se.value=Ee[0],M(Z,Me,1,Le,se),Le;var Oe,We=-1,Re=Le-1,ut=0,nt=1,_t=1,it=1<<te;for(be=0,Ne=1,ve=2;Ne<=te;++Ne,ve<<=1){if(nt+=_t<<=1,0>(_t-=xe[Ne]))return 0;for(;0<xe[Ne];--xe[Ne])(se=new T).g=Ne,se.value=Ee[be++],M(Z,Me+ut,ve,it,se),ut=P(ut,Ne)}for(Ne=te+1,ve=2;15>=Ne;++Ne,ve<<=1){if(nt+=_t<<=1,0>(_t-=xe[Ne]))return 0;for(;0<xe[Ne];--xe[Ne]){if(se=new T,(ut&Re)!=We){for(Me+=it,Oe=1<<(We=Ne)-te;15>We&&!(0>=(Oe-=xe[We]));)++We,Oe<<=1;Le+=it=1<<(Oe=We-te),Z[ee+(We=ut&Re)].g=Oe+te,Z[ee+We].value=Me-ee-We}se.g=Ne-te,se.value=Ee[be++],M(Z,Me+(ut>>te),ve,it,se),ut=P(ut,Ne)}}return nt!=2*we[15]-1?0:Le}(g,_,A,I,q,K)}function T(){this.value=this.g=0}function H(){this.value=this.g=0}function W(){this.G=s(5,T),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Dn,H)}function Q(g,_,A,I){t(g!=null),t(_!=null),t(2147483648>I),g.Ca=254,g.I=0,g.b=-8,g.Ka=0,g.oa=_,g.pa=A,g.Jd=_,g.Yc=A+I,g.Zc=4<=I?A+I-4+1:A,ue(g)}function V(g,_){for(var A=0;0<_--;)A|=he(g,128)<<_;return A}function z(g,_){var A=V(g,_);return pe(g)?-A:A}function X(g,_,A,I){var q,K=0;for(t(g!=null),t(_!=null),t(4294967288>I),g.Sb=I,g.Ra=0,g.u=0,g.h=0,4<I&&(I=4),q=0;q<I;++q)K+=_[A+q]<<8*q;g.Ra=K,g.bb=I,g.oa=_,g.pa=A}function D(g){for(;8<=g.u&&g.bb<g.Sb;)g.Ra>>>=8,g.Ra+=g.oa[g.pa+g.bb]<<ou-8>>>0,++g.bb,g.u-=8;B(g)&&(g.h=1,g.u=0)}function ne(g,_){if(t(0<=_),!g.h&&_<=su){var A=R(g)&iu[_];return g.u+=_,D(g),A}return g.h=1,g.u=0}function ge(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function C(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function R(g){return g.Ra>>>(g.u&ou-1)>>>0}function B(g){return t(g.bb<=g.Sb),g.h||g.bb==g.Sb&&g.u>ou}function U(g,_){g.u=_,g.h=B(g)}function Y(g){g.u>=Q0&&(t(g.u>=Q0),D(g))}function ue(g){t(g!=null&&g.oa!=null),g.pa<g.Zc?(g.I=(g.oa[g.pa++]|g.I<<8)>>>0,g.b+=8):(t(g!=null&&g.oa!=null),g.pa<g.Yc?(g.b+=8,g.I=g.oa[g.pa++]|g.I<<8):g.Ka?g.b=0:(g.I<<=8,g.b+=8,g.Ka=1))}function pe(g){return V(g,1)}function he(g,_){var A=g.Ca;0>g.b&&ue(g);var I=g.b,q=A*_>>>8,K=(g.I>>>I>q)+0;for(K?(A-=q,g.I-=q+1<<I>>>0):A=q+1,I=A,q=0;256<=I;)q+=8,I>>=8;return I=7^q+Ca[I],g.b-=I,g.Ca=(A<<I)-1,K}function ye(g,_,A){g[_+0]=A>>24&255,g[_+1]=A>>16&255,g[_+2]=A>>8&255,g[_+3]=A>>0&255}function Pe(g,_){return g[_+0]<<0|g[_+1]<<8}function re(g,_){return Pe(g,_)|g[_+2]<<16}function Ue(g,_){return Pe(g,_)|Pe(g,_+2)<<16}function Ye(g,_){var A=1<<_;return t(g!=null),t(0<_),g.X=i(A),g.X==null?0:(g.Mb=32-_,g.Xa=_,1)}function Ce(g,_){t(g!=null),t(_!=null),t(g.Xa==_.Xa),n(_.X,0,g.X,0,1<<_.Xa)}function oe(){this.X=[],this.Xa=this.Mb=0}function De(g,_,A,I){t(A!=null),t(I!=null);var q=A[0],K=I[0];return q==0&&(q=(g*K+_/2)/_),K==0&&(K=(_*q+g/2)/g),0>=q||0>=K?0:(A[0]=q,I[0]=K,1)}function Qe(g,_){return g+(1<<_)-1>>>_}function Be(g,_){return((4278255360&g)+(4278255360&_)>>>0&4278255360)+((16711935&g)+(16711935&_)>>>0&16711935)>>>0}function Ke(g,_){E[_]=function(A,I,q,K,Z,ee,te){var se;for(se=0;se<Z;++se){var ve=E[g](ee[te+se-1],q,K+se);ee[te+se]=Be(A[I+se],ve)}}}function tt(){this.ud=this.hd=this.jd=0}function rt(g,_){return((4278124286&(g^_))>>>1)+(g&_)>>>0}function ht(g){return 0<=g&&256>g?g:0>g?0:255<g?255:void 0}function gt(g,_){return ht(g+(g-_+.5>>1))}function St(g,_,A){return Math.abs(_-A)-Math.abs(g-A)}function Tt(g,_,A,I,q,K,Z){for(I=K[Z-1],A=0;A<q;++A)K[Z+A]=I=Be(g[_+A],I)}function Ht(g,_,A,I,q){var K;for(K=0;K<A;++K){var Z=g[_+K],ee=Z>>8&255,te=16711935&(te=(te=16711935&Z)+((ee<<16)+ee));I[q+K]=(4278255360&Z)+te>>>0}}function It(g,_){_.jd=g>>0&255,_.hd=g>>8&255,_.ud=g>>16&255}function mt(g,_,A,I,q,K){var Z;for(Z=0;Z<I;++Z){var ee=_[A+Z],te=ee>>>8,se=ee,ve=255&(ve=(ve=ee>>>16)+((g.jd<<24>>24)*(te<<24>>24)>>>5));se=255&(se=(se=se+((g.hd<<24>>24)*(te<<24>>24)>>>5))+((g.ud<<24>>24)*(ve<<24>>24)>>>5)),q[K+Z]=(4278255360&ee)+(ve<<16)+se}}function at(g,_,A,I,q){E[_]=function(K,Z,ee,te,se,ve,Ee,Ne,be){for(te=Ee;te<Ne;++te)for(Ee=0;Ee<be;++Ee)se[ve++]=q(ee[I(K[Z++])])},E[g]=function(K,Z,ee,te,se,ve,Ee){var Ne=8>>K.b,be=K.Ea,Me=K.K[0],Le=K.w;if(8>Ne)for(K=(1<<K.b)-1,Le=(1<<Ne)-1;Z<ee;++Z){var xe,we=0;for(xe=0;xe<be;++xe)xe&K||(we=I(te[se++])),ve[Ee++]=q(Me[we&Le]),we>>=Ne}else E["VP8LMapColor"+A](te,se,Me,Le,ve,Ee,Z,ee,be)}}function qe(g,_,A,I,q){for(A=_+A;_<A;){var K=g[_++];I[q++]=K>>16&255,I[q++]=K>>8&255,I[q++]=K>>0&255}}function or(g,_,A,I,q){for(A=_+A;_<A;){var K=g[_++];I[q++]=K>>16&255,I[q++]=K>>8&255,I[q++]=K>>0&255,I[q++]=K>>24&255}}function wt(g,_,A,I,q){for(A=_+A;_<A;){var K=(Z=g[_++])>>16&240|Z>>12&15,Z=Z>>0&240|Z>>28&15;I[q++]=K,I[q++]=Z}}function vn(g,_,A,I,q){for(A=_+A;_<A;){var K=(Z=g[_++])>>16&248|Z>>13&7,Z=Z>>5&224|Z>>3&31;I[q++]=K,I[q++]=Z}}function ir(g,_,A,I,q){for(A=_+A;_<A;){var K=g[_++];I[q++]=K>>0&255,I[q++]=K>>8&255,I[q++]=K>>16&255}}function _r(g,_,A,I,q,K){if(K==0)for(A=_+A;_<A;)ye(I,((K=g[_++])[0]>>24|K[1]>>8&65280|K[2]<<8&16711680|K[3]<<24)>>>0),q+=32;else n(I,q,g,_,A)}function fi(g,_){E[_][0]=E[g+"0"],E[_][1]=E[g+"1"],E[_][2]=E[g+"2"],E[_][3]=E[g+"3"],E[_][4]=E[g+"4"],E[_][5]=E[g+"5"],E[_][6]=E[g+"6"],E[_][7]=E[g+"7"],E[_][8]=E[g+"8"],E[_][9]=E[g+"9"],E[_][10]=E[g+"10"],E[_][11]=E[g+"11"],E[_][12]=E[g+"12"],E[_][13]=E[g+"13"],E[_][14]=E[g+"0"],E[_][15]=E[g+"0"]}function Jt(g){return g==mm||g==vm||g==Hh||g==xm}function fs(){this.eb=[],this.size=this.A=this.fb=0}function Ar(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ha(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new fs,this.f.kb=new Ar,this.sd=null}function Ri(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function xr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ft(g){return alert("todo:WebPSamplerProcessPlane"),g.T}function rr(g,_){var A=g.T,I=_.ba.f.RGBA,q=I.eb,K=I.fb+g.ka*I.A,Z=yi[_.ba.S],ee=g.y,te=g.O,se=g.f,ve=g.N,Ee=g.ea,Ne=g.W,be=_.cc,Me=_.dc,Le=_.Mc,xe=_.Nc,we=g.ka,Oe=g.ka+g.T,We=g.U,Re=We+1>>1;for(we==0?Z(ee,te,null,null,se,ve,Ee,Ne,se,ve,Ee,Ne,q,K,null,null,We):(Z(_.ec,_.fc,ee,te,be,Me,Le,xe,se,ve,Ee,Ne,q,K-I.A,q,K,We),++A);we+2<Oe;we+=2)be=se,Me=ve,Le=Ee,xe=Ne,ve+=g.Rc,Ne+=g.Rc,K+=2*I.A,Z(ee,(te+=2*g.fa)-g.fa,ee,te,be,Me,Le,xe,se,ve,Ee,Ne,q,K-I.A,q,K,We);return te+=g.fa,g.j+Oe<g.o?(n(_.ec,_.fc,ee,te,We),n(_.cc,_.dc,se,ve,Re),n(_.Mc,_.Nc,Ee,Ne,Re),A--):1&Oe||Z(ee,te,null,null,se,ve,Ee,Ne,se,ve,Ee,Ne,q,K+I.A,null,null,We),A}function zs(g,_,A){var I=g.F,q=[g.J];if(I!=null){var K=g.U,Z=_.ba.S,ee=Z==Wh||Z==Hh;_=_.ba.f.RGBA;var te=[0],se=g.ka;te[0]=g.T,g.Kb&&(se==0?--te[0]:(--se,q[0]-=g.width),g.j+g.ka+g.T==g.o&&(te[0]=g.o-g.j-se));var ve=_.eb;se=_.fb+se*_.A,g=Sr(I,q[0],g.width,K,te,ve,se+(ee?0:3),_.A),t(A==te),g&&Jt(Z)&&vi(ve,se,ee,K,te,_.A)}return 0}function xn(g){var _=g.ma,A=_.ba.S,I=11>A,q=A==Uh||A==zh||A==Wh||A==gm||A==12||Jt(A);if(_.memory=null,_.Ib=null,_.Jb=null,_.Nd=null,!J0(_.Oa,g,q?11:12))return 0;if(q&&Jt(A)&&$e(),g.da)alert("todo:use_scaling");else{if(I){if(_.Ib=Ft,g.Kb){if(A=g.U+1>>1,_.memory=i(g.U+2*A),_.memory==null)return 0;_.ec=_.memory,_.fc=0,_.cc=_.ec,_.dc=_.fc+g.U,_.Mc=_.cc,_.Nc=_.dc+A,_.Ib=rr,$e()}}else alert("todo:EmitYUV");q&&(_.Jb=zs,I&&_e())}if(I&&!s5){for(g=0;256>g;++g)m8[g]=89858*(g-128)+Vh>>$h,y8[g]=-22014*(g-128)+Vh,x8[g]=-45773*(g-128),v8[g]=113618*(g-128)+Vh>>$h;for(g=of;g<bm;++g)_=76283*(g-16)+Vh>>$h,w8[g-of]=qa(_,255),b8[g-of]=qa(_+8>>4,15);s5=1}return 1}function di(g){var _=g.ma,A=g.U,I=g.T;return t(!(1&g.ka)),0>=A||0>=I?0:(A=_.Ib(g,_),_.Jb!=null&&_.Jb(g,_,A),_.Dc+=A,1)}function hi(g){g.ma.memory=null}function bt(g,_,A,I){return ne(g,8)!=47?0:(_[0]=ne(g,14)+1,A[0]=ne(g,14)+1,I[0]=ne(g,1),ne(g,3)!=0?0:!g.h)}function $a(g,_){if(4>g)return g+1;var A=g-2>>1;return(2+(1&g)<<A)+ne(_,A)+1}function Na(g,_){return 120<_?_-120:1<=(A=((A=r8[_-1])>>4)*g+(8-(15&A)))?A:1;var A}function Vn(g,_,A){var I=R(A),q=g[_+=255&I].g-8;return 0<q&&(U(A,A.u+8),I=R(A),_+=g[_].value,_+=I&(1<<q)-1),U(A,A.u+g[_].g),g[_].value}function Yr(g,_,A){return A.g+=g.g,A.value+=g.value<<_>>>0,t(8>=A.g),g.g}function Wr(g,_,A){var I=g.xc;return t((_=I==0?0:g.vc[g.md*(A>>I)+(_>>I)])<g.Wb),g.Ya[_]}function J(g,_,A,I){var q=g.ab,K=g.c*_,Z=g.C;_=Z+_;var ee=A,te=I;for(I=g.Ta,A=g.Ua;0<q--;){var se=g.gc[q],ve=Z,Ee=_,Ne=ee,be=te,Me=(te=I,ee=A,se.Ea);switch(t(ve<Ee),t(Ee<=se.nc),se.hc){case 2:jh(Ne,be,(Ee-ve)*Me,te,ee);break;case 0:var Le=ve,xe=Ee,we=te,Oe=ee,We=(it=se).Ea;Le==0&&(hm(Ne,be,null,null,1,we,Oe),Tt(Ne,be+1,0,0,We-1,we,Oe+1),be+=We,Oe+=We,++Le);for(var Re=1<<it.b,ut=Re-1,nt=Qe(We,it.b),_t=it.K,it=it.w+(Le>>it.b)*nt;Le<xe;){var ar=_t,lr=it,Zt=1;for(ef(Ne,be,we,Oe-We,1,we,Oe);Zt<We;){var Xt=(Zt&~ut)+Re;Xt>We&&(Xt=We),(0,Po[ar[lr++]>>8&15])(Ne,be+ +Zt,we,Oe+Zt-We,Xt-Zt,we,Oe+Zt),Zt=Xt}be+=We,Oe+=We,++Le&ut||(it+=nt)}Ee!=se.nc&&n(te,ee-Me,te,ee+(Ee-ve-1)*Me,Me);break;case 1:for(Me=Ne,xe=be,We=(Ne=se.Ea)-(Oe=Ne&~(we=(be=1<<se.b)-1)),Le=Qe(Ne,se.b),Re=se.K,se=se.w+(ve>>se.b)*Le;ve<Ee;){for(ut=Re,nt=se,_t=new tt,it=xe+Oe,ar=xe+Ne;xe<it;)It(ut[nt++],_t),ql(_t,Me,xe,be,te,ee),xe+=be,ee+=be;xe<ar&&(It(ut[nt++],_t),ql(_t,Me,xe,We,te,ee),xe+=We,ee+=We),++ve&we||(se+=Le)}break;case 3:if(Ne==te&&be==ee&&0<se.b){for(xe=te,Ne=Me=ee+(Ee-ve)*Me-(Oe=(Ee-ve)*Qe(se.Ea,se.b)),be=te,we=ee,Le=[],Oe=(We=Oe)-1;0<=Oe;--Oe)Le[Oe]=be[we+Oe];for(Oe=We-1;0<=Oe;--Oe)xe[Ne+Oe]=Le[Oe];pi(se,ve,Ee,te,Me,te,ee)}else pi(se,ve,Ee,Ne,be,te,ee)}ee=I,te=A}te!=A&&n(I,A,ee,te,K)}function ce(g,_){var A=g.V,I=g.Ba+g.c*g.C,q=_-g.C;if(t(_<=g.l.o),t(16>=q),0<q){var K=g.l,Z=g.Ta,ee=g.Ua,te=K.width;if(J(g,q,A,I),q=ee=[ee],t((A=g.C)<(I=_)),t(K.v<K.va),I>K.o&&(I=K.o),A<K.j){var se=K.j-A;A=K.j,q[0]+=se*te}if(A>=I?A=0:(q[0]+=4*K.v,K.ka=A-K.j,K.U=K.va-K.v,K.T=I-A,A=1),A){if(ee=ee[0],11>(A=g.ca).S){var ve=A.f.RGBA,Ee=(I=A.S,q=K.U,K=K.T,se=ve.eb,ve.A),Ne=K;for(ve=ve.fb+g.Ma*ve.A;0<Ne--;){var be=Z,Me=ee,Le=q,xe=se,we=ve;switch(I){case Bh:Ta(be,Me,Le,xe,we);break;case Uh:ha(be,Me,Le,xe,we);break;case mm:ha(be,Me,Le,xe,we),vi(xe,we,0,Le,1,0);break;case Yw:qs(be,Me,Le,xe,we);break;case zh:_r(be,Me,Le,xe,we,1);break;case vm:_r(be,Me,Le,xe,we,1),vi(xe,we,0,Le,1,0);break;case Wh:_r(be,Me,Le,xe,we,0);break;case Hh:_r(be,Me,Le,xe,we,0),vi(xe,we,1,Le,1,0);break;case gm:Fo(be,Me,Le,xe,we);break;case xm:Fo(be,Me,Le,xe,we),kr(xe,we,Le,1,0);break;case Jw:Vs(be,Me,Le,xe,we);break;default:t(0)}ee+=te,ve+=Ee}g.Ma+=K}else alert("todo:EmitRescaledRowsYUVA");t(g.Ma<=A.height)}}g.C=_,t(g.C<=g.i)}function ae(g){var _;if(0<g.ua)return 0;for(_=0;_<g.Wb;++_){var A=g.Ya[_].G,I=g.Ya[_].H;if(0<A[1][I[1]+0].g||0<A[2][I[2]+0].g||0<A[3][I[3]+0].g)return 0}return 1}function ie(g,_,A,I,q,K){if(g.Z!=0){var Z=g.qd,ee=g.rd;for(t(Do[g.Z]!=null);_<A;++_)Do[g.Z](Z,ee,I,q,I,q,K),Z=I,ee=q,q+=K;g.qd=Z,g.rd=ee}}function le(g,_){var A=g.l.ma,I=A.Z==0||A.Z==1?g.l.j:g.C;if(I=g.C<I?I:g.C,t(_<=g.l.o),_>I){var q=g.l.width,K=A.ca,Z=A.tb+q*I,ee=g.V,te=g.Ba+g.c*I,se=g.gc;t(g.ab==1),t(se[0].hc==3),Ih(se[0],I,_,ee,te,K,Z),ie(A,I,_,K,Z,q)}g.C=g.Ma=_}function fe(g,_,A,I,q,K,Z){var ee=g.$/I,te=g.$%I,se=g.m,ve=g.s,Ee=A+g.$,Ne=Ee;q=A+I*q;var be=A+I*K,Me=280+ve.ua,Le=g.Pb?ee:16777216,xe=0<ve.ua?ve.Wa:null,we=ve.wc,Oe=Ee<be?Wr(ve,te,ee):null;t(g.C<K),t(be<=q);var We=!1;e:for(;;){for(;We||Ee<be;){var Re=0;if(ee>=Le){var ut=Ee-A;t((Le=g).Pb),Le.wd=Le.m,Le.xd=ut,0<Le.s.ua&&Ce(Le.s.Wa,Le.s.vb),Le=ee+a8}if(te&we||(Oe=Wr(ve,te,ee)),t(Oe!=null),Oe.Qb&&(_[Ee]=Oe.qb,We=!0),!We)if(Y(se),Oe.jc){Re=se,ut=_;var nt=Ee,_t=Oe.pd[R(Re)&Dn-1];t(Oe.jc),256>_t.g?(U(Re,Re.u+_t.g),ut[nt]=_t.value,Re=0):(U(Re,Re.u+_t.g-256),t(256<=_t.value),Re=_t.value),Re==0&&(We=!0)}else Re=Vn(Oe.G[0],Oe.H[0],se);if(se.h)break;if(We||256>Re){if(!We)if(Oe.nd)_[Ee]=(Oe.qb|Re<<8)>>>0;else{if(Y(se),We=Vn(Oe.G[1],Oe.H[1],se),Y(se),ut=Vn(Oe.G[2],Oe.H[2],se),nt=Vn(Oe.G[3],Oe.H[3],se),se.h)break;_[Ee]=(nt<<24|We<<16|Re<<8|ut)>>>0}if(We=!1,++Ee,++te>=I&&(te=0,++ee,Z!=null&&ee<=K&&!(ee%16)&&Z(g,ee),xe!=null))for(;Ne<Ee;)Re=_[Ne++],xe.X[(506832829*Re&4294967295)>>>xe.Mb]=Re}else if(280>Re){if(Re=$a(Re-256,se),ut=Vn(Oe.G[4],Oe.H[4],se),Y(se),ut=Na(I,ut=$a(ut,se)),se.h)break;if(Ee-A<ut||q-Ee<Re)break e;for(nt=0;nt<Re;++nt)_[Ee+nt]=_[Ee+nt-ut];for(Ee+=Re,te+=Re;te>=I;)te-=I,++ee,Z!=null&&ee<=K&&!(ee%16)&&Z(g,ee);if(t(Ee<=q),te&we&&(Oe=Wr(ve,te,ee)),xe!=null)for(;Ne<Ee;)Re=_[Ne++],xe.X[(506832829*Re&4294967295)>>>xe.Mb]=Re}else{if(!(Re<Me))break e;for(We=Re-280,t(xe!=null);Ne<Ee;)Re=_[Ne++],xe.X[(506832829*Re&4294967295)>>>xe.Mb]=Re;Re=Ee,t(!(We>>>(ut=xe).Xa)),_[Re]=ut.X[We],We=!0}We||t(se.h==B(se))}if(g.Pb&&se.h&&Ee<q)t(g.m.h),g.a=5,g.m=g.wd,g.$=g.xd,0<g.s.ua&&Ce(g.s.vb,g.s.Wa);else{if(se.h)break e;Z!=null&&Z(g,ee>K?K:ee),g.a=0,g.$=Ee-A}return 1}return g.a=3,0}function Se(g){t(g!=null),g.vc=null,g.yc=null,g.Ya=null;var _=g.Wa;_!=null&&(_.X=null),g.vb=null,t(g!=null)}function Fe(){var g=new dm;return g==null?null:(g.a=0,g.xb=e5,fi("Predictor","VP8LPredictors"),fi("Predictor","VP8LPredictors_C"),fi("PredictorAdd","VP8LPredictorsAdd"),fi("PredictorAdd","VP8LPredictorsAdd_C"),jh=Ht,ql=mt,Ta=qe,ha=or,Fo=wt,Vs=vn,qs=ir,E.VP8LMapColor32b=lu,E.VP8LMapColor8b=Dh,g)}function ke(g,_,A,I,q){var K=1,Z=[g],ee=[_],te=I.m,se=I.s,ve=null,Ee=0;e:for(;;){if(A)for(;K&&ne(te,1);){var Ne=Z,be=ee,Me=I,Le=1,xe=Me.m,we=Me.gc[Me.ab],Oe=ne(xe,2);if(Me.Oc&1<<Oe)K=0;else{switch(Me.Oc|=1<<Oe,we.hc=Oe,we.Ea=Ne[0],we.nc=be[0],we.K=[null],++Me.ab,t(4>=Me.ab),Oe){case 0:case 1:we.b=ne(xe,3)+2,Le=ke(Qe(we.Ea,we.b),Qe(we.nc,we.b),0,Me,we.K),we.K=we.K[0];break;case 3:var We,Re=ne(xe,8)+1,ut=16<Re?0:4<Re?1:2<Re?2:3;if(Ne[0]=Qe(we.Ea,ut),we.b=ut,We=Le=ke(Re,1,0,Me,we.K)){var nt,_t=Re,it=we,ar=1<<(8>>it.b),lr=i(ar);if(lr==null)We=0;else{var Zt=it.K[0],Xt=it.w;for(lr[0]=it.K[0][0],nt=1;nt<1*_t;++nt)lr[nt]=Be(Zt[Xt+nt],lr[nt-1]);for(;nt<4*ar;++nt)lr[nt]=0;it.K[0]=null,it.K[0]=lr,We=1}}Le=We;break;case 2:break;default:t(0)}K=Le}}if(Z=Z[0],ee=ee[0],K&&ne(te,1)&&!(K=1<=(Ee=ne(te,4))&&11>=Ee)){I.a=3;break e}var yr;if(yr=K)t:{var mr,Mt,un,Pa=I,fn=Z,Fa=ee,cr=Ee,Xa=A,Ka=Pa.m,Nn=Pa.s,On=[null],ga=1,wi=0,vs=n8[cr];r:for(;;){if(Xa&&ne(Ka,1)){var An=ne(Ka,3)+2,Ys=Qe(fn,An),Jl=Qe(Fa,An),hu=Ys*Jl;if(!ke(Ys,Jl,0,Pa,On))break r;for(On=On[0],Nn.xc=An,mr=0;mr<hu;++mr){var Oo=On[mr]>>8&65535;On[mr]=Oo,Oo>=ga&&(ga=Oo+1)}}if(Ka.h)break r;for(Mt=0;5>Mt;++Mt){var $r=Zw[Mt];!Mt&&0<cr&&($r+=1<<cr),wi<$r&&(wi=$r)}var _m=s(ga*vs,T),c5=ga,u5=s(c5,W);if(u5==null)var Gh=null;else t(65536>=c5),Gh=u5;var lf=i(wi);if(Gh==null||lf==null||_m==null){Pa.a=1;break r}var Xh=_m;for(mr=un=0;mr<ga;++mr){var $i=Gh[mr],pu=$i.G,gu=$i.H,f5=0,Kh=1,d5=0;for(Mt=0;5>Mt;++Mt){$r=Zw[Mt],pu[Mt]=Xh,gu[Mt]=un,!Mt&&0<cr&&($r+=1<<cr);a:{var Yh,km=$r,Jh=Pa,cf=lf,S8=Xh,E8=un,Sm=0,Ro=Jh.m,N8=ne(Ro,1);if(a(cf,0,0,km),N8){var A8=ne(Ro,1)+1,C8=ne(Ro,1),h5=ne(Ro,C8==0?1:8);cf[h5]=1,A8==2&&(cf[h5=ne(Ro,8)]=1);var Zh=1}else{var p5=i(19),g5=ne(Ro,4)+4;if(19<g5){Jh.a=3;var Qh=0;break a}for(Yh=0;Yh<g5;++Yh)p5[t8[Yh]]=ne(Ro,3);var Em=void 0,uf=void 0,m5=Jh,T8=p5,e1=km,v5=cf,Nm=0,Mo=m5.m,x5=8,y5=s(128,T);n:for(;F(y5,0,7,T8,19);){if(ne(Mo,1)){var P8=2+2*ne(Mo,3);if((Em=2+ne(Mo,P8))>e1)break n}else Em=e1;for(uf=0;uf<e1&&Em--;){Y(Mo);var w5=y5[0+(127&R(Mo))];U(Mo,Mo.u+w5.g);var mu=w5.value;if(16>mu)v5[uf++]=mu,mu!=0&&(x5=mu);else{var F8=mu==16,b5=mu-16,L8=QC[b5],_5=ne(Mo,ZC[b5])+L8;if(uf+_5>e1)break n;for(var j8=F8?x5:0;0<_5--;)v5[uf++]=j8}}Nm=1;break n}Nm||(m5.a=3),Zh=Nm}(Zh=Zh&&!Ro.h)&&(Sm=F(S8,E8,8,cf,km)),Zh&&Sm!=0?Qh=Sm:(Jh.a=3,Qh=0)}if(Qh==0)break r;if(Kh&&e8[Mt]==1&&(Kh=Xh[un].g==0),f5+=Xh[un].g,un+=Qh,3>=Mt){var ff,Am=lf[0];for(ff=1;ff<$r;++ff)lf[ff]>Am&&(Am=lf[ff]);d5+=Am}}if($i.nd=Kh,$i.Qb=0,Kh&&($i.qb=(pu[3][gu[3]+0].value<<24|pu[1][gu[1]+0].value<<16|pu[2][gu[2]+0].value)>>>0,f5==0&&256>pu[0][gu[0]+0].value&&($i.Qb=1,$i.qb+=pu[0][gu[0]+0].value<<8)),$i.jc=!$i.Qb&&6>d5,$i.jc){var t1,Js=$i;for(t1=0;t1<Dn;++t1){var Bo=t1,Uo=Js.pd[Bo],r1=Js.G[0][Js.H[0]+Bo];256<=r1.value?(Uo.g=r1.g+256,Uo.value=r1.value):(Uo.g=0,Uo.value=0,Bo>>=Yr(r1,8,Uo),Bo>>=Yr(Js.G[1][Js.H[1]+Bo],16,Uo),Bo>>=Yr(Js.G[2][Js.H[2]+Bo],0,Uo),Yr(Js.G[3][Js.H[3]+Bo],24,Uo))}}}Nn.vc=On,Nn.Wb=ga,Nn.Ya=Gh,Nn.yc=_m,yr=1;break t}yr=0}if(!(K=yr)){I.a=3;break e}if(0<Ee){if(se.ua=1<<Ee,!Ye(se.Wa,Ee)){I.a=1,K=0;break e}}else se.ua=0;var Cm=I,k5=Z,I8=ee,Tm=Cm.s,Pm=Tm.xc;if(Cm.c=k5,Cm.i=I8,Tm.md=Qe(k5,Pm),Tm.wc=Pm==0?-1:(1<<Pm)-1,A){I.xb=f8;break e}if((ve=i(Z*ee))==null){I.a=1,K=0;break e}K=(K=fe(I,ve,0,Z,ee,ee,null))&&!te.h;break e}return K?(q!=null?q[0]=ve:(t(ve==null),t(A)),I.$=0,A||Se(se)):Se(se),K}function Ae(g,_){var A=g.c*g.i,I=A+_+16*_;return t(g.c<=_),g.V=i(I),g.V==null?(g.Ta=null,g.Ua=0,g.a=1,0):(g.Ta=g.V,g.Ua=g.Ba+A+_,1)}function Te(g,_){var A=g.C,I=_-A,q=g.V,K=g.Ba+g.c*A;for(t(_<=g.l.o);0<I;){var Z=16<I?16:I,ee=g.l.ma,te=g.l.width,se=te*Z,ve=ee.ca,Ee=ee.tb+te*A,Ne=g.Ta,be=g.Ua;J(g,Z,q,K),Qr(Ne,be,ve,Ee,se),ie(ee,A,A+Z,ve,Ee,te),I-=Z,q+=Z*g.c,A+=Z}t(A==_),g.C=g.Ma=_}function Ve(){this.ub=this.yd=this.td=this.Rb=0}function Je(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ot(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Xe(){this.Yb=function(){var g=[];return function _(A,I,q){for(var K=q[I],Z=0;Z<K&&(A.push(q.length>I+1?[]:0),!(q.length<I+1));Z++)_(A[Z],I+1,q)}(g,0,[3,11]),g}()}function st(){this.jb=i(3),this.Wc=o([4,8],Xe),this.Xc=o([4,17],Xe)}function Pt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function sr(){this.ld=this.La=this.dd=this.tc=0}function gr(){this.Na=this.la=0}function ln(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Mi(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ws(){this.uc=this.M=this.Nb=0,this.wa=Array(new sr),this.Y=0,this.ya=Array(new Mi),this.aa=0,this.l=new hs}function ds(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Bi(){this.cb=this.a=0,this.sc="",this.m=new ge,this.Od=new Ve,this.Kc=new Je,this.ed=new Pt,this.Qa=new ot,this.Ic=this.$c=this.Aa=0,this.D=new Ws,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,ge),this.ia=0,this.pb=s(4,ln),this.Pa=new st,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ds),this.Hd=0,this.rb=Array(new gr),this.sb=0,this.wa=Array(new sr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Mi),this.L=this.aa=0,this.gd=o([4,2],sr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function hs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Va(){var g=new Bi;return g!=null&&(g.a=0,g.sc="OK",g.cb=0,g.Xb=0,sf||(sf=xh)),g}function Jr(g,_,A){return g.a==0&&(g.a=_,g.sc=A,g.cb=0),0}function mh(g,_,A){return 3<=A&&g[_+0]==157&&g[_+1]==1&&g[_+2]==42}function vh(g,_){if(g==null)return 0;if(g.a=0,g.sc="OK",_==null)return Jr(g,2,"null VP8Io passed to VP8GetHeaders()");var A=_.data,I=_.w,q=_.ha;if(4>q)return Jr(g,7,"Truncated header.");var K=A[I+0]|A[I+1]<<8|A[I+2]<<16,Z=g.Od;if(Z.Rb=!(1&K),Z.td=K>>1&7,Z.yd=K>>4&1,Z.ub=K>>5,3<Z.td)return Jr(g,3,"Incorrect keyframe parameters.");if(!Z.yd)return Jr(g,4,"Frame not displayable.");I+=3,q-=3;var ee=g.Kc;if(Z.Rb){if(7>q)return Jr(g,7,"cannot parse picture header");if(!mh(A,I,q))return Jr(g,3,"Bad code word");ee.c=16383&(A[I+4]<<8|A[I+3]),ee.Td=A[I+4]>>6,ee.i=16383&(A[I+6]<<8|A[I+5]),ee.Ud=A[I+6]>>6,I+=7,q-=7,g.za=ee.c+15>>4,g.Ub=ee.i+15>>4,_.width=ee.c,_.height=ee.i,_.Da=0,_.j=0,_.v=0,_.va=_.width,_.o=_.height,_.da=0,_.ib=_.width,_.hb=_.height,_.U=_.width,_.T=_.height,a((K=g.Pa).jb,0,255,K.jb.length),t((K=g.Qa)!=null),K.Cb=0,K.Bb=0,K.Fb=1,a(K.Zb,0,0,K.Zb.length),a(K.Lb,0,0,K.Lb)}if(Z.ub>q)return Jr(g,7,"bad partition length");Q(K=g.m,A,I,Z.ub),I+=Z.ub,q-=Z.ub,Z.Rb&&(ee.Ld=pe(K),ee.Kd=pe(K)),ee=g.Qa;var te,se=g.Pa;if(t(K!=null),t(ee!=null),ee.Cb=pe(K),ee.Cb){if(ee.Bb=pe(K),pe(K)){for(ee.Fb=pe(K),te=0;4>te;++te)ee.Zb[te]=pe(K)?z(K,7):0;for(te=0;4>te;++te)ee.Lb[te]=pe(K)?z(K,6):0}if(ee.Bb)for(te=0;3>te;++te)se.jb[te]=pe(K)?V(K,8):255}else ee.Bb=0;if(K.Ka)return Jr(g,3,"cannot parse segment header");if((ee=g.ed).zd=pe(K),ee.Tb=V(K,6),ee.wb=V(K,3),ee.Pc=pe(K),ee.Pc&&pe(K)){for(se=0;4>se;++se)pe(K)&&(ee.vd[se]=z(K,6));for(se=0;4>se;++se)pe(K)&&(ee.od[se]=z(K,6))}if(g.L=ee.Tb==0?0:ee.zd?1:2,K.Ka)return Jr(g,3,"cannot parse filter header");var ve=q;if(q=te=I,I=te+ve,ee=ve,g.Xb=(1<<V(g.m,2))-1,ve<3*(se=g.Xb))A=7;else{for(te+=3*se,ee-=3*se,ve=0;ve<se;++ve){var Ee=A[q+0]|A[q+1]<<8|A[q+2]<<16;Ee>ee&&(Ee=ee),Q(g.Jc[+ve],A,te,Ee),te+=Ee,ee-=Ee,q+=3}Q(g.Jc[+se],A,te,ee),A=te<I?0:5}if(A!=0)return Jr(g,A,"cannot parse partitions");for(A=V(te=g.m,7),q=pe(te)?z(te,4):0,I=pe(te)?z(te,4):0,ee=pe(te)?z(te,4):0,se=pe(te)?z(te,4):0,te=pe(te)?z(te,4):0,ve=g.Qa,Ee=0;4>Ee;++Ee){if(ve.Cb){var Ne=ve.Zb[Ee];ve.Fb||(Ne+=A)}else{if(0<Ee){g.pb[Ee]=g.pb[0];continue}Ne=A}var be=g.pb[Ee];be.Sc[0]=ym[qa(Ne+q,127)],be.Sc[1]=wm[qa(Ne+0,127)],be.Eb[0]=2*ym[qa(Ne+I,127)],be.Eb[1]=101581*wm[qa(Ne+ee,127)]>>16,8>be.Eb[1]&&(be.Eb[1]=8),be.Qc[0]=ym[qa(Ne+se,117)],be.Qc[1]=wm[qa(Ne+te,127)],be.lc=Ne+te}if(!Z.Rb)return Jr(g,4,"Not a key frame.");for(pe(K),Z=g.Pa,A=0;4>A;++A){for(q=0;8>q;++q)for(I=0;3>I;++I)for(ee=0;11>ee;++ee)se=he(K,c8[A][q][I][ee])?V(K,8):o8[A][q][I][ee],Z.Wc[A][q].Yb[I][ee]=se;for(q=0;17>q;++q)Z.Xc[A][q]=Z.Wc[A][u8[q]]}return g.kc=pe(K),g.kc&&(g.Bd=V(K,8)),g.cb=1}function xh(g,_,A,I,q,K,Z){var ee=_[q].Yb[A];for(A=0;16>q;++q){if(!he(g,ee[A+0]))return q;for(;!he(g,ee[A+1]);)if(ee=_[++q].Yb[0],A=0,q==16)return 16;var te=_[q+1].Yb;if(he(g,ee[A+2])){var se=g,ve=0;if(he(se,(Ne=ee)[(Ee=A)+3]))if(he(se,Ne[Ee+6])){for(ee=0,Ee=2*(ve=he(se,Ne[Ee+8]))+(Ne=he(se,Ne[Ee+9+ve])),ve=0,Ne=i8[Ee];Ne[ee];++ee)ve+=ve+he(se,Ne[ee]);ve+=3+(8<<Ee)}else he(se,Ne[Ee+7])?(ve=7+2*he(se,165),ve+=he(se,145)):ve=5+he(se,159);else ve=he(se,Ne[Ee+4])?3+he(se,Ne[Ee+5]):2;ee=te[2]}else ve=1,ee=te[1];te=Z+s8[q],0>(se=g).b&&ue(se);var Ee,Ne=se.b,be=(Ee=se.Ca>>1)-(se.I>>Ne)>>31;--se.b,se.Ca+=be,se.Ca|=1,se.I-=(Ee+1&be)<<Ne,K[te]=((ve^be)-be)*I[(0<q)+0]}return 16}function O0(g){var _=g.rb[g.sb-1];_.la=0,_.Na=0,a(g.zc,0,0,g.zc.length),g.ja=0}function Kg(g,_){if(g==null)return 0;if(_==null)return Jr(g,2,"NULL VP8Io parameter in VP8Decode().");if(!g.cb&&!vh(g,_))return 0;if(t(g.cb),_.ac==null||_.ac(_)){_.ob&&(g.L=0);var A=qh[g.L];if(g.L==2?(g.yb=0,g.zb=0):(g.yb=_.v-A>>4,g.zb=_.j-A>>4,0>g.yb&&(g.yb=0),0>g.zb&&(g.zb=0)),g.Va=_.o+15+A>>4,g.Hb=_.va+15+A>>4,g.Hb>g.za&&(g.Hb=g.za),g.Va>g.Ub&&(g.Va=g.Ub),0<g.L){var I=g.ed;for(A=0;4>A;++A){var q;if(g.Qa.Cb){var K=g.Qa.Lb[A];g.Qa.Fb||(K+=I.Tb)}else K=I.Tb;for(q=0;1>=q;++q){var Z=g.gd[A][q],ee=K;if(I.Pc&&(ee+=I.vd[0],q&&(ee+=I.od[0])),0<(ee=0>ee?0:63<ee?63:ee)){var te=ee;0<I.wb&&(te=4<I.wb?te>>2:te>>1)>9-I.wb&&(te=9-I.wb),1>te&&(te=1),Z.dd=te,Z.tc=2*ee+te,Z.ld=40<=ee?2:15<=ee?1:0}else Z.tc=0;Z.La=q}}}A=0}else Jr(g,6,"Frame setup failed"),A=g.a;if(A=A==0){if(A){g.$c=0,0<g.Aa||(g.Ic=k8);e:{A=g.Ic,I=4*(te=g.za);var se=32*te,ve=te+1,Ee=0<g.L?te*(0<g.Aa?2:1):0,Ne=(g.Aa==2?2:1)*te;if((Z=I+832+(q=3*(16*A+qh[g.L])/2*se)+(K=g.Fa!=null&&0<g.Fa.length?g.Kc.c*g.Kc.i:0))!=Z)A=0;else{if(Z>g.Vb){if(g.Vb=0,g.Ec=i(Z),g.Fc=0,g.Ec==null){A=Jr(g,1,"no memory during frame initialization.");break e}g.Vb=Z}Z=g.Ec,ee=g.Fc,g.Ac=Z,g.Bc=ee,ee+=I,g.Gd=s(se,ds),g.Hd=0,g.rb=s(ve+1,gr),g.sb=1,g.wa=Ee?s(Ee,sr):null,g.Y=0,g.D.Nb=0,g.D.wa=g.wa,g.D.Y=g.Y,0<g.Aa&&(g.D.Y+=te),t(!0),g.oc=Z,g.pc=ee,ee+=832,g.ya=s(Ne,Mi),g.aa=0,g.D.ya=g.ya,g.D.aa=g.aa,g.Aa==2&&(g.D.aa+=te),g.R=16*te,g.B=8*te,te=(se=qh[g.L])*g.R,se=se/2*g.B,g.sa=Z,g.ta=ee+te,g.qa=g.sa,g.ra=g.ta+16*A*g.R+se,g.Ha=g.qa,g.Ia=g.ra+8*A*g.B+se,g.$c=0,ee+=q,g.mb=K?Z:null,g.nb=K?ee:null,t(ee+K<=g.Fc+g.Vb),O0(g),a(g.Ac,g.Bc,0,I),A=1}}if(A){if(_.ka=0,_.y=g.sa,_.O=g.ta,_.f=g.qa,_.N=g.ra,_.ea=g.Ha,_.Vd=g.Ia,_.fa=g.R,_.Rc=g.B,_.F=null,_.J=0,!Rh){for(A=-255;255>=A;++A)yn[255+A]=0>A?-A:A;for(A=-1020;1020>=A;++A)Xs[1020+A]=-128>A?-128:127<A?127:A;for(A=-112;112>=A;++A)af[112+A]=-16>A?-16:15<A?15:A;for(A=-255;510>=A;++A)du[255+A]=0>A?0:255<A?255:A;Rh=1}cu=Zg,Gs=Yg,tf=wh,pa=Jg,gi=bh,Zr=yh,uu=W0,Oh=$l,rf=fm,Gl=H0,Xl=um,Lo=eu,Kl=$0,fu=Ph,Yl=Th,jo=gs,nf=$s,mi=cm,Hi[0]=ps,Hi[1]=Qg,Hi[2]=nm,Hi[3]=am,Hi[4]=Sh,Hi[5]=Zc,Hi[6]=Eh,Hi[7]=B0,Hi[8]=sm,Hi[9]=im,Io[0]=_h,Io[1]=tm,Io[2]=Hs,Io[3]=Yc,Io[4]=qn,Io[5]=rm,Io[6]=kh,Ks[0]=Ao,Ks[1]=em,Ks[2]=om,Ks[3]=U0,Ks[4]=Hl,Ks[5]=lm,Ks[6]=z0,A=1}else A=0}A&&(A=function(be,Me){for(be.M=0;be.M<be.Va;++be.M){var Le,xe=be.Jc[be.M&be.Xb],we=be.m,Oe=be;for(Le=0;Le<Oe.za;++Le){var We=we,Re=Oe,ut=Re.Ac,nt=Re.Bc+4*Le,_t=Re.zc,it=Re.ya[Re.aa+Le];if(Re.Qa.Bb?it.$b=he(We,Re.Pa.jb[0])?2+he(We,Re.Pa.jb[2]):he(We,Re.Pa.jb[1]):it.$b=0,Re.kc&&(it.Ad=he(We,Re.Bd)),it.Za=!he(We,145)+0,it.Za){var ar=it.Ob,lr=0;for(Re=0;4>Re;++Re){var Zt,Xt=_t[0+Re];for(Zt=0;4>Zt;++Zt){Xt=l8[ut[nt+Zt]][Xt];for(var yr=Qw[he(We,Xt[0])];0<yr;)yr=Qw[2*yr+he(We,Xt[yr])];Xt=-yr,ut[nt+Zt]=Xt}n(ar,lr,ut,nt,4),lr+=4,_t[0+Re]=Xt}}else Xt=he(We,156)?he(We,128)?1:3:he(We,163)?2:0,it.Ob[0]=Xt,a(ut,nt,Xt,4),a(_t,0,Xt,4);it.Dd=he(We,142)?he(We,114)?he(We,183)?1:3:2:0}if(Oe.m.Ka)return Jr(be,7,"Premature end-of-partition0 encountered.");for(;be.ja<be.za;++be.ja){if(Oe=xe,We=(we=be).rb[we.sb-1],ut=we.rb[we.sb+we.ja],Le=we.ya[we.aa+we.ja],nt=we.kc?Le.Ad:0)We.la=ut.la=0,Le.Za||(We.Na=ut.Na=0),Le.Hc=0,Le.Gc=0,Le.ia=0;else{var mr,Mt;if(We=ut,ut=Oe,nt=we.Pa.Xc,_t=we.ya[we.aa+we.ja],it=we.pb[_t.$b],Re=_t.ad,ar=0,lr=we.rb[we.sb-1],Xt=Zt=0,a(Re,ar,0,384),_t.Za)var un=0,Pa=nt[3];else{yr=i(16);var fn=We.Na+lr.Na;if(fn=sf(ut,nt[1],fn,it.Eb,0,yr,0),We.Na=lr.Na=(0<fn)+0,1<fn)cu(yr,0,Re,ar);else{var Fa=yr[0]+3>>3;for(yr=0;256>yr;yr+=16)Re[ar+yr]=Fa}un=1,Pa=nt[0]}var cr=15&We.la,Xa=15&lr.la;for(yr=0;4>yr;++yr){var Ka=1&Xa;for(Fa=Mt=0;4>Fa;++Fa)cr=cr>>1|(Ka=(fn=sf(ut,Pa,fn=Ka+(1&cr),it.Sc,un,Re,ar))>un)<<7,Mt=Mt<<2|(3<fn?3:1<fn?2:Re[ar+0]!=0),ar+=16;cr>>=4,Xa=Xa>>1|Ka<<7,Zt=(Zt<<8|Mt)>>>0}for(Pa=cr,un=Xa>>4,mr=0;4>mr;mr+=2){for(Mt=0,cr=We.la>>4+mr,Xa=lr.la>>4+mr,yr=0;2>yr;++yr){for(Ka=1&Xa,Fa=0;2>Fa;++Fa)fn=Ka+(1&cr),cr=cr>>1|(Ka=0<(fn=sf(ut,nt[2],fn,it.Qc,0,Re,ar)))<<3,Mt=Mt<<2|(3<fn?3:1<fn?2:Re[ar+0]!=0),ar+=16;cr>>=2,Xa=Xa>>1|Ka<<5}Xt|=Mt<<4*mr,Pa|=cr<<4<<mr,un|=(240&Xa)<<mr}We.la=Pa,lr.la=un,_t.Hc=Zt,_t.Gc=Xt,_t.ia=43690&Xt?0:it.ia,nt=!(Zt|Xt)}if(0<we.L&&(we.wa[we.Y+we.ja]=we.gd[Le.$b][Le.Za],we.wa[we.Y+we.ja].La|=!nt),Oe.Ka)return Jr(be,7,"Premature end-of-file encountered.")}if(O0(be),we=Me,Oe=1,Le=(xe=be).D,We=0<xe.L&&xe.M>=xe.zb&&xe.M<=xe.Va,xe.Aa==0)e:{if(Le.M=xe.M,Le.uc=We,Y0(xe,Le),Oe=1,Le=(Mt=xe.D).Nb,We=(Xt=qh[xe.L])*xe.R,ut=Xt/2*xe.B,yr=16*Le*xe.R,Fa=8*Le*xe.B,nt=xe.sa,_t=xe.ta-We+yr,it=xe.qa,Re=xe.ra-ut+Fa,ar=xe.Ha,lr=xe.Ia-ut+Fa,Xa=(cr=Mt.M)==0,Zt=cr>=xe.Va-1,xe.Aa==2&&Y0(xe,Mt),Mt.uc)for(Ka=(fn=xe).D.M,t(fn.D.uc),Mt=fn.yb;Mt<fn.Hb;++Mt){un=Mt,Pa=Ka;var Nn=(On=($r=fn).D).Nb;mr=$r.R;var On=On.wa[On.Y+un],ga=$r.sa,wi=$r.ta+16*Nn*mr+16*un,vs=On.dd,An=On.tc;if(An!=0)if(t(3<=An),$r.L==1)0<un&&jo(ga,wi,mr,An+4),On.La&&mi(ga,wi,mr,An),0<Pa&&Yl(ga,wi,mr,An+4),On.La&&nf(ga,wi,mr,An);else{var Ys=$r.B,Jl=$r.qa,hu=$r.ra+8*Nn*Ys+8*un,Oo=$r.Ha,$r=$r.Ia+8*Nn*Ys+8*un;Nn=On.ld,0<un&&(Oh(ga,wi,mr,An+4,vs,Nn),Gl(Jl,hu,Oo,$r,Ys,An+4,vs,Nn)),On.La&&(Lo(ga,wi,mr,An,vs,Nn),fu(Jl,hu,Oo,$r,Ys,An,vs,Nn)),0<Pa&&(uu(ga,wi,mr,An+4,vs,Nn),rf(Jl,hu,Oo,$r,Ys,An+4,vs,Nn)),On.La&&(Xl(ga,wi,mr,An,vs,Nn),Kl(Jl,hu,Oo,$r,Ys,An,vs,Nn))}}if(xe.ia&&alert("todo:DitherRow"),we.put!=null){if(Mt=16*cr,cr=16*(cr+1),Xa?(we.y=xe.sa,we.O=xe.ta+yr,we.f=xe.qa,we.N=xe.ra+Fa,we.ea=xe.Ha,we.W=xe.Ia+Fa):(Mt-=Xt,we.y=nt,we.O=_t,we.f=it,we.N=Re,we.ea=ar,we.W=lr),Zt||(cr-=Xt),cr>we.o&&(cr=we.o),we.F=null,we.J=null,xe.Fa!=null&&0<xe.Fa.length&&Mt<cr&&(we.J=X0(xe,we,Mt,cr-Mt),we.F=xe.mb,we.F==null&&we.F.length==0)){Oe=Jr(xe,3,"Could not decode alpha data.");break e}Mt<we.j&&(Xt=we.j-Mt,Mt=we.j,t(!(1&Xt)),we.O+=xe.R*Xt,we.N+=xe.B*(Xt>>1),we.W+=xe.B*(Xt>>1),we.F!=null&&(we.J+=we.width*Xt)),Mt<cr&&(we.O+=we.v,we.N+=we.v>>1,we.W+=we.v>>1,we.F!=null&&(we.J+=we.v),we.ka=Mt-we.j,we.U=we.va-we.v,we.T=cr-Mt,Oe=we.put(we))}Le+1!=xe.Ic||Zt||(n(xe.sa,xe.ta-We,nt,_t+16*xe.R,We),n(xe.qa,xe.ra-ut,it,Re+8*xe.B,ut),n(xe.Ha,xe.Ia-ut,ar,lr+8*xe.B,ut))}if(!Oe)return Jr(be,6,"Output aborted.")}return 1}(g,_)),_.bc!=null&&_.bc(_),A&=1}return A?(g.cb=0,A):0}function Ui(g,_,A,I,q){q=g[_+A+32*I]+(q>>3),g[_+A+32*I]=-256&q?0>q?0:255:q}function Kc(g,_,A,I,q,K){Ui(g,_,0,A,I+q),Ui(g,_,1,A,I+K),Ui(g,_,2,A,I-K),Ui(g,_,3,A,I-q)}function Aa(g){return(20091*g>>16)+g}function R0(g,_,A,I){var q,K=0,Z=i(16);for(q=0;4>q;++q){var ee=g[_+0]+g[_+8],te=g[_+0]-g[_+8],se=(35468*g[_+4]>>16)-Aa(g[_+12]),ve=Aa(g[_+4])+(35468*g[_+12]>>16);Z[K+0]=ee+ve,Z[K+1]=te+se,Z[K+2]=te-se,Z[K+3]=ee-ve,K+=4,_++}for(q=K=0;4>q;++q)ee=(g=Z[K+0]+4)+Z[K+8],te=g-Z[K+8],se=(35468*Z[K+4]>>16)-Aa(Z[K+12]),Ui(A,I,0,0,ee+(ve=Aa(Z[K+4])+(35468*Z[K+12]>>16))),Ui(A,I,1,0,te+se),Ui(A,I,2,0,te-se),Ui(A,I,3,0,ee-ve),K++,I+=32}function yh(g,_,A,I){var q=g[_+0]+4,K=35468*g[_+4]>>16,Z=Aa(g[_+4]),ee=35468*g[_+1]>>16;Kc(A,I,0,q+Z,g=Aa(g[_+1]),ee),Kc(A,I,1,q+K,g,ee),Kc(A,I,2,q-K,g,ee),Kc(A,I,3,q-Z,g,ee)}function Yg(g,_,A,I,q){R0(g,_,A,I),q&&R0(g,_+16,A,I+4)}function wh(g,_,A,I){Gs(g,_+0,A,I,1),Gs(g,_+32,A,I+128,1)}function Jg(g,_,A,I){var q;for(g=g[_+0]+4,q=0;4>q;++q)for(_=0;4>_;++_)Ui(A,I,_,q,g)}function bh(g,_,A,I){g[_+0]&&pa(g,_+0,A,I),g[_+16]&&pa(g,_+16,A,I+4),g[_+32]&&pa(g,_+32,A,I+128),g[_+48]&&pa(g,_+48,A,I+128+4)}function Zg(g,_,A,I){var q,K=i(16);for(q=0;4>q;++q){var Z=g[_+0+q]+g[_+12+q],ee=g[_+4+q]+g[_+8+q],te=g[_+4+q]-g[_+8+q],se=g[_+0+q]-g[_+12+q];K[0+q]=Z+ee,K[8+q]=Z-ee,K[4+q]=se+te,K[12+q]=se-te}for(q=0;4>q;++q)Z=(g=K[0+4*q]+3)+K[3+4*q],ee=K[1+4*q]+K[2+4*q],te=K[1+4*q]-K[2+4*q],se=g-K[3+4*q],A[I+0]=Z+ee>>3,A[I+16]=se+te>>3,A[I+32]=Z-ee>>3,A[I+48]=se-te>>3,I+=64}function M0(g,_,A){var I,q=_-32,K=Ga,Z=255-g[q-1];for(I=0;I<A;++I){var ee,te=K,se=Z+g[_-1];for(ee=0;ee<A;++ee)g[_+ee]=te[se+g[q+ee]];_+=32}}function Qg(g,_){M0(g,_,4)}function em(g,_){M0(g,_,8)}function tm(g,_){M0(g,_,16)}function Hs(g,_){var A;for(A=0;16>A;++A)n(g,_+32*A,g,_-32,16)}function Yc(g,_){var A;for(A=16;0<A;--A)a(g,_,g[_-1],16),_+=32}function Jc(g,_,A){var I;for(I=0;16>I;++I)a(_,A+32*I,g,16)}function _h(g,_){var A,I=16;for(A=0;16>A;++A)I+=g[_-1+32*A]+g[_+A-32];Jc(I>>5,g,_)}function qn(g,_){var A,I=8;for(A=0;16>A;++A)I+=g[_-1+32*A];Jc(I>>4,g,_)}function rm(g,_){var A,I=8;for(A=0;16>A;++A)I+=g[_+A-32];Jc(I>>4,g,_)}function kh(g,_){Jc(128,g,_)}function jt(g,_,A){return g+2*_+A+2>>2}function nm(g,_){var A,I=_-32;for(I=new Uint8Array([jt(g[I-1],g[I+0],g[I+1]),jt(g[I+0],g[I+1],g[I+2]),jt(g[I+1],g[I+2],g[I+3]),jt(g[I+2],g[I+3],g[I+4])]),A=0;4>A;++A)n(g,_+32*A,I,0,I.length)}function am(g,_){var A=g[_-1],I=g[_-1+32],q=g[_-1+64],K=g[_-1+96];ye(g,_+0,16843009*jt(g[_-1-32],A,I)),ye(g,_+32,16843009*jt(A,I,q)),ye(g,_+64,16843009*jt(I,q,K)),ye(g,_+96,16843009*jt(q,K,K))}function ps(g,_){var A,I=4;for(A=0;4>A;++A)I+=g[_+A-32]+g[_-1+32*A];for(I>>=3,A=0;4>A;++A)a(g,_+32*A,I,4)}function Sh(g,_){var A=g[_-1+0],I=g[_-1+32],q=g[_-1+64],K=g[_-1-32],Z=g[_+0-32],ee=g[_+1-32],te=g[_+2-32],se=g[_+3-32];g[_+0+96]=jt(I,q,g[_-1+96]),g[_+1+96]=g[_+0+64]=jt(A,I,q),g[_+2+96]=g[_+1+64]=g[_+0+32]=jt(K,A,I),g[_+3+96]=g[_+2+64]=g[_+1+32]=g[_+0+0]=jt(Z,K,A),g[_+3+64]=g[_+2+32]=g[_+1+0]=jt(ee,Z,K),g[_+3+32]=g[_+2+0]=jt(te,ee,Z),g[_+3+0]=jt(se,te,ee)}function Eh(g,_){var A=g[_+1-32],I=g[_+2-32],q=g[_+3-32],K=g[_+4-32],Z=g[_+5-32],ee=g[_+6-32],te=g[_+7-32];g[_+0+0]=jt(g[_+0-32],A,I),g[_+1+0]=g[_+0+32]=jt(A,I,q),g[_+2+0]=g[_+1+32]=g[_+0+64]=jt(I,q,K),g[_+3+0]=g[_+2+32]=g[_+1+64]=g[_+0+96]=jt(q,K,Z),g[_+3+32]=g[_+2+64]=g[_+1+96]=jt(K,Z,ee),g[_+3+64]=g[_+2+96]=jt(Z,ee,te),g[_+3+96]=jt(ee,te,te)}function Zc(g,_){var A=g[_-1+0],I=g[_-1+32],q=g[_-1+64],K=g[_-1-32],Z=g[_+0-32],ee=g[_+1-32],te=g[_+2-32],se=g[_+3-32];g[_+0+0]=g[_+1+64]=K+Z+1>>1,g[_+1+0]=g[_+2+64]=Z+ee+1>>1,g[_+2+0]=g[_+3+64]=ee+te+1>>1,g[_+3+0]=te+se+1>>1,g[_+0+96]=jt(q,I,A),g[_+0+64]=jt(I,A,K),g[_+0+32]=g[_+1+96]=jt(A,K,Z),g[_+1+32]=g[_+2+96]=jt(K,Z,ee),g[_+2+32]=g[_+3+96]=jt(Z,ee,te),g[_+3+32]=jt(ee,te,se)}function B0(g,_){var A=g[_+0-32],I=g[_+1-32],q=g[_+2-32],K=g[_+3-32],Z=g[_+4-32],ee=g[_+5-32],te=g[_+6-32],se=g[_+7-32];g[_+0+0]=A+I+1>>1,g[_+1+0]=g[_+0+64]=I+q+1>>1,g[_+2+0]=g[_+1+64]=q+K+1>>1,g[_+3+0]=g[_+2+64]=K+Z+1>>1,g[_+0+32]=jt(A,I,q),g[_+1+32]=g[_+0+96]=jt(I,q,K),g[_+2+32]=g[_+1+96]=jt(q,K,Z),g[_+3+32]=g[_+2+96]=jt(K,Z,ee),g[_+3+64]=jt(Z,ee,te),g[_+3+96]=jt(ee,te,se)}function im(g,_){var A=g[_-1+0],I=g[_-1+32],q=g[_-1+64],K=g[_-1+96];g[_+0+0]=A+I+1>>1,g[_+2+0]=g[_+0+32]=I+q+1>>1,g[_+2+32]=g[_+0+64]=q+K+1>>1,g[_+1+0]=jt(A,I,q),g[_+3+0]=g[_+1+32]=jt(I,q,K),g[_+3+32]=g[_+1+64]=jt(q,K,K),g[_+3+64]=g[_+2+64]=g[_+0+96]=g[_+1+96]=g[_+2+96]=g[_+3+96]=K}function sm(g,_){var A=g[_-1+0],I=g[_-1+32],q=g[_-1+64],K=g[_-1+96],Z=g[_-1-32],ee=g[_+0-32],te=g[_+1-32],se=g[_+2-32];g[_+0+0]=g[_+2+32]=A+Z+1>>1,g[_+0+32]=g[_+2+64]=I+A+1>>1,g[_+0+64]=g[_+2+96]=q+I+1>>1,g[_+0+96]=K+q+1>>1,g[_+3+0]=jt(ee,te,se),g[_+2+0]=jt(Z,ee,te),g[_+1+0]=g[_+3+32]=jt(A,Z,ee),g[_+1+32]=g[_+3+64]=jt(I,A,Z),g[_+1+64]=g[_+3+96]=jt(q,I,A),g[_+1+96]=jt(K,q,I)}function om(g,_){var A;for(A=0;8>A;++A)n(g,_+32*A,g,_-32,8)}function U0(g,_){var A;for(A=0;8>A;++A)a(g,_,g[_-1],8),_+=32}function Wl(g,_,A){var I;for(I=0;8>I;++I)a(_,A+32*I,g,8)}function Ao(g,_){var A,I=8;for(A=0;8>A;++A)I+=g[_+A-32]+g[_-1+32*A];Wl(I>>4,g,_)}function lm(g,_){var A,I=4;for(A=0;8>A;++A)I+=g[_+A-32];Wl(I>>3,g,_)}function Hl(g,_){var A,I=4;for(A=0;8>A;++A)I+=g[_-1+32*A];Wl(I>>3,g,_)}function z0(g,_){Wl(128,g,_)}function Qc(g,_,A){var I=g[_-A],q=g[_+0],K=3*(q-I)+pm[1020+g[_-2*A]-g[_+A]],Z=Mh[112+(K+4>>3)];g[_-A]=Ga[255+I+Mh[112+(K+3>>3)]],g[_+0]=Ga[255+q-Z]}function Nh(g,_,A,I){var q=g[_+0],K=g[_+A];return xi[255+g[_-2*A]-g[_-A]]>I||xi[255+K-q]>I}function Ah(g,_,A,I){return 4*xi[255+g[_-A]-g[_+0]]+xi[255+g[_-2*A]-g[_+A]]<=I}function Ch(g,_,A,I,q){var K=g[_-3*A],Z=g[_-2*A],ee=g[_-A],te=g[_+0],se=g[_+A],ve=g[_+2*A],Ee=g[_+3*A];return 4*xi[255+ee-te]+xi[255+Z-se]>I?0:xi[255+g[_-4*A]-K]<=q&&xi[255+K-Z]<=q&&xi[255+Z-ee]<=q&&xi[255+Ee-ve]<=q&&xi[255+ve-se]<=q&&xi[255+se-te]<=q}function Th(g,_,A,I){var q=2*I+1;for(I=0;16>I;++I)Ah(g,_+I,A,q)&&Qc(g,_+I,A)}function gs(g,_,A,I){var q=2*I+1;for(I=0;16>I;++I)Ah(g,_+I*A,1,q)&&Qc(g,_+I*A,1)}function $s(g,_,A,I){var q;for(q=3;0<q;--q)Th(g,_+=4*A,A,I)}function cm(g,_,A,I){var q;for(q=3;0<q;--q)gs(g,_+=4,A,I)}function Co(g,_,A,I,q,K,Z,ee){for(K=2*K+1;0<q--;){if(Ch(g,_,A,K,Z))if(Nh(g,_,A,ee))Qc(g,_,A);else{var te=g,se=_,ve=A,Ee=te[se-2*ve],Ne=te[se-ve],be=te[se+0],Me=te[se+ve],Le=te[se+2*ve],xe=27*(Oe=pm[1020+3*(be-Ne)+pm[1020+Ee-Me]])+63>>7,we=18*Oe+63>>7,Oe=9*Oe+63>>7;te[se-3*ve]=Ga[255+te[se-3*ve]+Oe],te[se-2*ve]=Ga[255+Ee+we],te[se-ve]=Ga[255+Ne+xe],te[se+0]=Ga[255+be-xe],te[se+ve]=Ga[255+Me-we],te[se+2*ve]=Ga[255+Le-Oe]}_+=I}}function zi(g,_,A,I,q,K,Z,ee){for(K=2*K+1;0<q--;){if(Ch(g,_,A,K,Z))if(Nh(g,_,A,ee))Qc(g,_,A);else{var te=g,se=_,ve=A,Ee=te[se-ve],Ne=te[se+0],be=te[se+ve],Me=Mh[112+((Le=3*(Ne-Ee))+4>>3)],Le=Mh[112+(Le+3>>3)],xe=Me+1>>1;te[se-2*ve]=Ga[255+te[se-2*ve]+xe],te[se-ve]=Ga[255+Ee+Le],te[se+0]=Ga[255+Ne-Me],te[se+ve]=Ga[255+be-xe]}_+=I}}function W0(g,_,A,I,q,K){Co(g,_,A,1,16,I,q,K)}function $l(g,_,A,I,q,K){Co(g,_,1,A,16,I,q,K)}function um(g,_,A,I,q,K){var Z;for(Z=3;0<Z;--Z)zi(g,_+=4*A,A,1,16,I,q,K)}function eu(g,_,A,I,q,K){var Z;for(Z=3;0<Z;--Z)zi(g,_+=4,1,A,16,I,q,K)}function fm(g,_,A,I,q,K,Z,ee){Co(g,_,q,1,8,K,Z,ee),Co(A,I,q,1,8,K,Z,ee)}function H0(g,_,A,I,q,K,Z,ee){Co(g,_,1,q,8,K,Z,ee),Co(A,I,1,q,8,K,Z,ee)}function $0(g,_,A,I,q,K,Z,ee){zi(g,_+4*q,q,1,8,K,Z,ee),zi(A,I+4*q,q,1,8,K,Z,ee)}function Ph(g,_,A,I,q,K,Z,ee){zi(g,_+4,1,q,8,K,Z,ee),zi(A,I+4,1,q,8,K,Z,ee)}function tu(){this.ba=new Ha,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new xr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function V0(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function q0(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Fh(){this.ua=0,this.Wa=new oe,this.vb=new oe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new W,this.yc=new T}function dm(){this.xb=this.a=0,this.l=new hs,this.ca=new Ha,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new C,this.Pb=0,this.wd=new C,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Fh,this.ab=0,this.gc=s(4,q0),this.Oc=0}function ru(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new hs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Vl(g,_,A,I,q,K,Z){for(g=g==null?0:g[_+0],_=0;_<Z;++_)q[K+_]=g+A[I+_]&255,g=q[K+_]}function G0(g,_,A,I,q,K,Z){var ee;if(g==null)Vl(null,null,A,I,q,K,Z);else for(ee=0;ee<Z;++ee)q[K+ee]=g[_+ee]+A[I+ee]&255}function To(g,_,A,I,q,K,Z){if(g==null)Vl(null,null,A,I,q,K,Z);else{var ee,te=g[_+0],se=te,ve=te;for(ee=0;ee<Z;++ee)se=ve+(te=g[_+ee])-se,ve=A[I+ee]+(-256&se?0>se?0:255:se)&255,se=te,q[K+ee]=ve}}function X0(g,_,A,I){var q=_.width,K=_.o;if(t(g!=null&&_!=null),0>A||0>=I||A+I>K)return null;if(!g.Cc){if(g.ga==null){var Z;if(g.ga=new ru,(Z=g.ga==null)||(Z=_.width*_.o,t(g.Gb.length==0),g.Gb=i(Z),g.Uc=0,g.Gb==null?Z=0:(g.mb=g.Gb,g.nb=g.Uc,g.rc=null,Z=1),Z=!Z),!Z){Z=g.ga;var ee=g.Fa,te=g.P,se=g.qc,ve=g.mb,Ee=g.nb,Ne=te+1,be=se-1,Me=Z.l;if(t(ee!=null&&ve!=null&&_!=null),Do[0]=null,Do[1]=Vl,Do[2]=G0,Do[3]=To,Z.ca=ve,Z.tb=Ee,Z.c=_.width,Z.i=_.height,t(0<Z.c&&0<Z.i),1>=se)_=0;else if(Z.$a=ee[te+0]>>0&3,Z.Z=ee[te+0]>>2&3,Z.Lc=ee[te+0]>>4&3,te=ee[te+0]>>6&3,0>Z.$a||1<Z.$a||4<=Z.Z||1<Z.Lc||te)_=0;else if(Me.put=di,Me.ac=xn,Me.bc=hi,Me.ma=Z,Me.width=_.width,Me.height=_.height,Me.Da=_.Da,Me.v=_.v,Me.va=_.va,Me.j=_.j,Me.o=_.o,Z.$a)e:{t(Z.$a==1),_=Fe();t:for(;;){if(_==null){_=0;break e}if(t(Z!=null),Z.mc=_,_.c=Z.c,_.i=Z.i,_.l=Z.l,_.l.ma=Z,_.l.width=Z.c,_.l.height=Z.i,_.a=0,X(_.m,ee,Ne,be),!ke(Z.c,Z.i,1,_,null)||(_.ab==1&&_.gc[0].hc==3&&ae(_.s)?(Z.ic=1,ee=_.c*_.i,_.Ta=null,_.Ua=0,_.V=i(ee),_.Ba=0,_.V==null?(_.a=1,_=0):_=1):(Z.ic=0,_=Ae(_,Z.c)),!_))break t;_=1;break e}Z.mc=null,_=0}else _=be>=Z.c*Z.i;Z=!_}if(Z)return null;g.ga.Lc!=1?g.Ga=0:I=K-A}t(g.ga!=null),t(A+I<=K);e:{if(_=(ee=g.ga).c,K=ee.l.o,ee.$a==0){if(Ne=g.rc,be=g.Vc,Me=g.Fa,te=g.P+1+A*_,se=g.mb,ve=g.nb+A*_,t(te<=g.P+g.qc),ee.Z!=0)for(t(Do[ee.Z]!=null),Z=0;Z<I;++Z)Do[ee.Z](Ne,be,Me,te,se,ve,_),Ne=se,be=ve,ve+=_,te+=_;else for(Z=0;Z<I;++Z)n(se,ve,Me,te,_),Ne=se,be=ve,ve+=_,te+=_;g.rc=Ne,g.Vc=be}else{if(t(ee.mc!=null),_=A+I,t((Z=ee.mc)!=null),t(_<=Z.i),Z.C>=_)_=1;else if(ee.ic||_e(),ee.ic){ee=Z.V,Ne=Z.Ba,be=Z.c;var Le=Z.i,xe=(Me=1,te=Z.$/be,se=Z.$%be,ve=Z.m,Ee=Z.s,Z.$),we=be*Le,Oe=be*_,We=Ee.wc,Re=xe<Oe?Wr(Ee,se,te):null;t(xe<=we),t(_<=Le),t(ae(Ee));t:for(;;){for(;!ve.h&&xe<Oe;){if(se&We||(Re=Wr(Ee,se,te)),t(Re!=null),Y(ve),256>(Le=Vn(Re.G[0],Re.H[0],ve)))ee[Ne+xe]=Le,++xe,++se>=be&&(se=0,++te<=_&&!(te%16)&&le(Z,te));else{if(!(280>Le)){Me=0;break t}Le=$a(Le-256,ve);var ut,nt=Vn(Re.G[4],Re.H[4],ve);if(Y(ve),!(xe>=(nt=Na(be,nt=$a(nt,ve)))&&we-xe>=Le)){Me=0;break t}for(ut=0;ut<Le;++ut)ee[Ne+xe+ut]=ee[Ne+xe+ut-nt];for(xe+=Le,se+=Le;se>=be;)se-=be,++te<=_&&!(te%16)&&le(Z,te);xe<Oe&&se&We&&(Re=Wr(Ee,se,te))}t(ve.h==B(ve))}le(Z,te>_?_:te);break t}!Me||ve.h&&xe<we?(Me=0,Z.a=ve.h?5:3):Z.$=xe,_=Me}else _=fe(Z,Z.V,Z.Ba,Z.c,Z.i,_,Te);if(!_){I=0;break e}}A+I>=K&&(g.Cc=1),I=1}if(!I)return null;if(g.Cc&&((I=g.ga)!=null&&(I.mc=null),g.ga=null,0<g.Ga))return alert("todo:WebPDequantizeLevels"),null}return g.nb+A*q}function k(g,_,A,I,q,K){for(;0<q--;){var Z,ee=g,te=_+(A?1:0),se=g,ve=_+(A?0:3);for(Z=0;Z<I;++Z){var Ee=se[ve+4*Z];Ee!=255&&(Ee*=32897,ee[te+4*Z+0]=ee[te+4*Z+0]*Ee>>23,ee[te+4*Z+1]=ee[te+4*Z+1]*Ee>>23,ee[te+4*Z+2]=ee[te+4*Z+2]*Ee>>23)}_+=K}}function G(g,_,A,I,q){for(;0<I--;){var K;for(K=0;K<A;++K){var Z=g[_+2*K+0],ee=15&(se=g[_+2*K+1]),te=4369*ee,se=(240&se|se>>4)*te>>16;g[_+2*K+0]=(240&Z|Z>>4)*te>>16&240|(15&Z|Z<<4)*te>>16>>4&15,g[_+2*K+1]=240&se|ee}_+=q}}function de(g,_,A,I,q,K,Z,ee){var te,se,ve=255;for(se=0;se<q;++se){for(te=0;te<I;++te){var Ee=g[_+te];K[Z+4*te]=Ee,ve&=Ee}_+=A,Z+=ee}return ve!=255}function me(g,_,A,I,q){var K;for(K=0;K<q;++K)A[I+K]=g[_+K]>>8}function _e(){vi=k,kr=G,Sr=de,Qr=me}function je(g,_,A){E[g]=function(I,q,K,Z,ee,te,se,ve,Ee,Ne,be,Me,Le,xe,we,Oe,We){var Re,ut=We-1>>1,nt=ee[te+0]|se[ve+0]<<16,_t=Ee[Ne+0]|be[Me+0]<<16;t(I!=null);var it=3*nt+_t+131074>>2;for(_(I[q+0],255&it,it>>16,Le,xe),K!=null&&(it=3*_t+nt+131074>>2,_(K[Z+0],255&it,it>>16,we,Oe)),Re=1;Re<=ut;++Re){var ar=ee[te+Re]|se[ve+Re]<<16,lr=Ee[Ne+Re]|be[Me+Re]<<16,Zt=nt+ar+_t+lr+524296,Xt=Zt+2*(ar+_t)>>3;it=Xt+nt>>1,nt=(Zt=Zt+2*(nt+lr)>>3)+ar>>1,_(I[q+2*Re-1],255&it,it>>16,Le,xe+(2*Re-1)*A),_(I[q+2*Re-0],255&nt,nt>>16,Le,xe+(2*Re-0)*A),K!=null&&(it=Zt+_t>>1,nt=Xt+lr>>1,_(K[Z+2*Re-1],255&it,it>>16,we,Oe+(2*Re-1)*A),_(K[Z+2*Re+0],255&nt,nt>>16,we,Oe+(2*Re+0)*A)),nt=ar,_t=lr}1&We||(it=3*nt+_t+131074>>2,_(I[q+We-1],255&it,it>>16,Le,xe+(We-1)*A),K!=null&&(it=3*_t+nt+131074>>2,_(K[Z+We-1],255&it,it>>16,we,Oe+(We-1)*A)))}}function $e(){yi[Bh]=d8,yi[Uh]=t5,yi[Yw]=h8,yi[zh]=r5,yi[Wh]=n5,yi[gm]=a5,yi[Jw]=p8,yi[mm]=t5,yi[vm]=r5,yi[Hh]=n5,yi[xm]=a5}function lt(g){return g&~g8?0>g?0:255:g>>i5}function xt(g,_){return lt((19077*g>>8)+(26149*_>>8)-14234)}function Rt(g,_,A){return lt((19077*g>>8)-(6419*_>>8)-(13320*A>>8)+8708)}function Dt(g,_){return lt((19077*g>>8)+(33050*_>>8)-17685)}function Yt(g,_,A,I,q){I[q+0]=xt(g,A),I[q+1]=Rt(g,_,A),I[q+2]=Dt(g,_)}function Or(g,_,A,I,q){I[q+0]=Dt(g,_),I[q+1]=Rt(g,_,A),I[q+2]=xt(g,A)}function Hr(g,_,A,I,q){var K=Rt(g,_,A);_=K<<3&224|Dt(g,_)>>3,I[q+0]=248&xt(g,A)|K>>5,I[q+1]=_}function cn(g,_,A,I,q){var K=240&Dt(g,_)|15;I[q+0]=240&xt(g,A)|Rt(g,_,A)>>4,I[q+1]=K}function Gn(g,_,A,I,q){I[q+0]=255,Yt(g,_,A,I,q+1)}function En(g,_,A,I,q){Or(g,_,A,I,q),I[q+3]=255}function Wi(g,_,A,I,q){Yt(g,_,A,I,q),I[q+3]=255}function qa(g,_){return 0>g?0:g>_?_:g}function ms(g,_,A){E[g]=function(I,q,K,Z,ee,te,se,ve,Ee){for(var Ne=ve+(-2&Ee)*A;ve!=Ne;)_(I[q+0],K[Z+0],ee[te+0],se,ve),_(I[q+1],K[Z+0],ee[te+0],se,ve+A),q+=2,++Z,++te,ve+=2*A;1&Ee&&_(I[q+0],K[Z+0],ee[te+0],se,ve)}}function Lh(g,_,A){return A==0?g==0?_==0?6:5:_==0?4:0:A}function K0(g,_,A,I,q){switch(g>>>30){case 3:Gs(_,A,I,q,0);break;case 2:Zr(_,A,I,q);break;case 1:pa(_,A,I,q)}}function Y0(g,_){var A,I,q=_.M,K=_.Nb,Z=g.oc,ee=g.pc+40,te=g.oc,se=g.pc+584,ve=g.oc,Ee=g.pc+600;for(A=0;16>A;++A)Z[ee+32*A-1]=129;for(A=0;8>A;++A)te[se+32*A-1]=129,ve[Ee+32*A-1]=129;for(0<q?Z[ee-1-32]=te[se-1-32]=ve[Ee-1-32]=129:(a(Z,ee-32-1,127,21),a(te,se-32-1,127,9),a(ve,Ee-32-1,127,9)),I=0;I<g.za;++I){var Ne=_.ya[_.aa+I];if(0<I){for(A=-1;16>A;++A)n(Z,ee+32*A-4,Z,ee+32*A+12,4);for(A=-1;8>A;++A)n(te,se+32*A-4,te,se+32*A+4,4),n(ve,Ee+32*A-4,ve,Ee+32*A+4,4)}var be=g.Gd,Me=g.Hd+I,Le=Ne.ad,xe=Ne.Hc;if(0<q&&(n(Z,ee-32,be[Me].y,0,16),n(te,se-32,be[Me].f,0,8),n(ve,Ee-32,be[Me].ea,0,8)),Ne.Za){var we=Z,Oe=ee-32+16;for(0<q&&(I>=g.za-1?a(we,Oe,be[Me].y[15],4):n(we,Oe,be[Me+1].y,0,4)),A=0;4>A;A++)we[Oe+128+A]=we[Oe+256+A]=we[Oe+384+A]=we[Oe+0+A];for(A=0;16>A;++A,xe<<=2)we=Z,Oe=ee+o5[A],Hi[Ne.Ob[A]](we,Oe),K0(xe,Le,16*+A,we,Oe)}else if(we=Lh(I,q,Ne.Ob[0]),Io[we](Z,ee),xe!=0)for(A=0;16>A;++A,xe<<=2)K0(xe,Le,16*+A,Z,ee+o5[A]);for(A=Ne.Gc,we=Lh(I,q,Ne.Dd),Ks[we](te,se),Ks[we](ve,Ee),xe=Le,we=te,Oe=se,255&(Ne=A>>0)&&(170&Ne?tf(xe,256,we,Oe):gi(xe,256,we,Oe)),Ne=ve,xe=Ee,255&(A>>=8)&&(170&A?tf(Le,320,Ne,xe):gi(Le,320,Ne,xe)),q<g.Ub-1&&(n(be[Me].y,0,Z,ee+480,16),n(be[Me].f,0,te,se+224,8),n(be[Me].ea,0,ve,Ee+224,8)),A=8*K*g.B,be=g.sa,Me=g.ta+16*I+16*K*g.R,Le=g.qa,Ne=g.ra+8*I+A,xe=g.Ha,we=g.Ia+8*I+A,A=0;16>A;++A)n(be,Me+A*g.R,Z,ee+32*A,16);for(A=0;8>A;++A)n(Le,Ne+A*g.B,te,se+32*A,8),n(xe,we+A*g.B,ve,Ee+32*A,8)}}function nu(g,_,A,I,q,K,Z,ee,te){var se=[0],ve=[0],Ee=0,Ne=te!=null?te.kd:0,be=te??new V0;if(g==null||12>A)return 7;be.data=g,be.w=_,be.ha=A,_=[_],A=[A],be.gb=[be.gb];e:{var Me=_,Le=A,xe=be.gb;if(t(g!=null),t(Le!=null),t(xe!=null),xe[0]=0,12<=Le[0]&&!r(g,Me[0],"RIFF")){if(r(g,Me[0]+8,"WEBP")){xe=3;break e}var we=Ue(g,Me[0]+4);if(12>we||4294967286<we){xe=3;break e}if(Ne&&we>Le[0]-8){xe=7;break e}xe[0]=we,Me[0]+=12,Le[0]-=12}xe=0}if(xe!=0)return xe;for(we=0<be.gb[0],A=A[0];;){e:{var Oe=g;Le=_,xe=A;var We=se,Re=ve,ut=Me=[0];if((it=Ee=[Ee])[0]=0,8>xe[0])xe=7;else{if(!r(Oe,Le[0],"VP8X")){if(Ue(Oe,Le[0]+4)!=10){xe=3;break e}if(18>xe[0]){xe=7;break e}var nt=Ue(Oe,Le[0]+8),_t=1+re(Oe,Le[0]+12);if(2147483648<=_t*(Oe=1+re(Oe,Le[0]+15))){xe=3;break e}ut!=null&&(ut[0]=nt),We!=null&&(We[0]=_t),Re!=null&&(Re[0]=Oe),Le[0]+=18,xe[0]-=18,it[0]=1}xe=0}}if(Ee=Ee[0],Me=Me[0],xe!=0)return xe;if(Le=!!(2&Me),!we&&Ee)return 3;if(K!=null&&(K[0]=!!(16&Me)),Z!=null&&(Z[0]=Le),ee!=null&&(ee[0]=0),Z=se[0],Me=ve[0],Ee&&Le&&te==null){xe=0;break}if(4>A){xe=7;break}if(we&&Ee||!we&&!Ee&&!r(g,_[0],"ALPH")){A=[A],be.na=[be.na],be.P=[be.P],be.Sa=[be.Sa];e:{nt=g,xe=_,we=A;var it=be.gb;We=be.na,Re=be.P,ut=be.Sa,_t=22,t(nt!=null),t(we!=null),Oe=xe[0];var ar=we[0];for(t(We!=null),t(ut!=null),We[0]=null,Re[0]=null,ut[0]=0;;){if(xe[0]=Oe,we[0]=ar,8>ar){xe=7;break e}var lr=Ue(nt,Oe+4);if(4294967286<lr){xe=3;break e}var Zt=8+lr+1&-2;if(_t+=Zt,0<it&&_t>it){xe=3;break e}if(!r(nt,Oe,"VP8 ")||!r(nt,Oe,"VP8L")){xe=0;break e}if(ar[0]<Zt){xe=7;break e}r(nt,Oe,"ALPH")||(We[0]=nt,Re[0]=Oe+8,ut[0]=lr),Oe+=Zt,ar-=Zt}}if(A=A[0],be.na=be.na[0],be.P=be.P[0],be.Sa=be.Sa[0],xe!=0)break}A=[A],be.Ja=[be.Ja],be.xa=[be.xa];e:if(it=g,xe=_,we=A,We=be.gb[0],Re=be.Ja,ut=be.xa,nt=xe[0],Oe=!r(it,nt,"VP8 "),_t=!r(it,nt,"VP8L"),t(it!=null),t(we!=null),t(Re!=null),t(ut!=null),8>we[0])xe=7;else{if(Oe||_t){if(it=Ue(it,nt+4),12<=We&&it>We-12){xe=3;break e}if(Ne&&it>we[0]-8){xe=7;break e}Re[0]=it,xe[0]+=8,we[0]-=8,ut[0]=_t}else ut[0]=5<=we[0]&&it[nt+0]==47&&!(it[nt+4]>>5),Re[0]=we[0];xe=0}if(A=A[0],be.Ja=be.Ja[0],be.xa=be.xa[0],_=_[0],xe!=0)break;if(4294967286<be.Ja)return 3;if(ee==null||Le||(ee[0]=be.xa?2:1),Z=[Z],Me=[Me],be.xa){if(5>A){xe=7;break}ee=Z,Ne=Me,Le=K,g==null||5>A?g=0:5<=A&&g[_+0]==47&&!(g[_+4]>>5)?(we=[0],it=[0],We=[0],X(Re=new C,g,_,A),bt(Re,we,it,We)?(ee!=null&&(ee[0]=we[0]),Ne!=null&&(Ne[0]=it[0]),Le!=null&&(Le[0]=We[0]),g=1):g=0):g=0}else{if(10>A){xe=7;break}ee=Me,g==null||10>A||!mh(g,_+3,A-3)?g=0:(Ne=g[_+0]|g[_+1]<<8|g[_+2]<<16,Le=16383&(g[_+7]<<8|g[_+6]),g=16383&(g[_+9]<<8|g[_+8]),1&Ne||3<(Ne>>1&7)||!(Ne>>4&1)||Ne>>5>=be.Ja||!Le||!g?g=0:(Z&&(Z[0]=Le),ee&&(ee[0]=g),g=1))}if(!g||(Z=Z[0],Me=Me[0],Ee&&(se[0]!=Z||ve[0]!=Me)))return 3;te!=null&&(te[0]=be,te.offset=_-te.w,t(4294967286>_-te.w),t(te.offset==te.ha-A));break}return xe==0||xe==7&&Ee&&te==null?(K!=null&&(K[0]|=be.na!=null&&0<be.na.length),I!=null&&(I[0]=Z),q!=null&&(q[0]=Me),0):xe}function J0(g,_,A){var I=_.width,q=_.height,K=0,Z=0,ee=I,te=q;if(_.Da=g!=null&&0<g.Da,_.Da&&(ee=g.cd,te=g.bd,K=g.v,Z=g.j,11>A||(K&=-2,Z&=-2),0>K||0>Z||0>=ee||0>=te||K+ee>I||Z+te>q))return 0;if(_.v=K,_.j=Z,_.va=K+ee,_.o=Z+te,_.U=ee,_.T=te,_.da=g!=null&&0<g.da,_.da){if(!De(ee,te,A=[g.ib],K=[g.hb]))return 0;_.ib=A[0],_.hb=K[0]}return _.ob=g!=null&&g.ob,_.Kb=g==null||!g.Sd,_.da&&(_.ob=_.ib<3*I/4&&_.hb<3*q/4,_.Kb=0),1}function Z0(g){if(g==null)return 2;if(11>g.S){var _=g.f.RGBA;_.fb+=(g.height-1)*_.A,_.A=-_.A}else _=g.f.kb,g=g.height,_.O+=(g-1)*_.fa,_.fa=-_.fa,_.N+=(g-1>>1)*_.Ab,_.Ab=-_.Ab,_.W+=(g-1>>1)*_.Db,_.Db=-_.Db,_.F!=null&&(_.J+=(g-1)*_.lb,_.lb=-_.lb);return 0}function au(g,_,A,I){if(I==null||0>=g||0>=_)return 2;if(A!=null){if(A.Da){var q=A.cd,K=A.bd,Z=-2&A.v,ee=-2&A.j;if(0>Z||0>ee||0>=q||0>=K||Z+q>g||ee+K>_)return 2;g=q,_=K}if(A.da){if(!De(g,_,q=[A.ib],K=[A.hb]))return 2;g=q[0],_=K[0]}}I.width=g,I.height=_;e:{var te=I.width,se=I.height;if(g=I.S,0>=te||0>=se||!(g>=Bh&&13>g))g=2;else{if(0>=I.Rd&&I.sd==null){Z=K=q=_=0;var ve=(ee=te*l5[g])*se;if(11>g||(K=(se+1)/2*(_=(te+1)/2),g==12&&(Z=(q=te)*se)),(se=i(ve+2*K+Z))==null){g=1;break e}I.sd=se,11>g?((te=I.f.RGBA).eb=se,te.fb=0,te.A=ee,te.size=ve):((te=I.f.kb).y=se,te.O=0,te.fa=ee,te.Fd=ve,te.f=se,te.N=0+ve,te.Ab=_,te.Cd=K,te.ea=se,te.W=0+ve+K,te.Db=_,te.Ed=K,g==12&&(te.F=se,te.J=0+ve+2*K),te.Tc=Z,te.lb=q)}if(_=1,q=I.S,K=I.width,Z=I.height,q>=Bh&&13>q)if(11>q)g=I.f.RGBA,_&=(ee=Math.abs(g.A))*(Z-1)+K<=g.size,_&=ee>=K*l5[q],_&=g.eb!=null;else{g=I.f.kb,ee=(K+1)/2,ve=(Z+1)/2,te=Math.abs(g.fa),se=Math.abs(g.Ab);var Ee=Math.abs(g.Db),Ne=Math.abs(g.lb),be=Ne*(Z-1)+K;_&=te*(Z-1)+K<=g.Fd,_&=se*(ve-1)+ee<=g.Cd,_=(_&=Ee*(ve-1)+ee<=g.Ed)&te>=K&se>=ee&Ee>=ee,_&=g.y!=null,_&=g.f!=null,_&=g.ea!=null,q==12&&(_&=Ne>=K,_&=be<=g.Tc,_&=g.F!=null)}else _=0;g=_?0:2}}return g!=0||A!=null&&A.fd&&(g=Z0(I)),g}var Dn=64,iu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],su=24,ou=32,Q0=8,Ca=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ke("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(g){return g},E.Predictor2=function(g,_,A){return _[A+0]},E.Predictor3=function(g,_,A){return _[A+1]},E.Predictor4=function(g,_,A){return _[A-1]},E.Predictor5=function(g,_,A){return rt(rt(g,_[A+1]),_[A+0])},E.Predictor6=function(g,_,A){return rt(g,_[A-1])},E.Predictor7=function(g,_,A){return rt(g,_[A+0])},E.Predictor8=function(g,_,A){return rt(_[A-1],_[A+0])},E.Predictor9=function(g,_,A){return rt(_[A+0],_[A+1])},E.Predictor10=function(g,_,A){return rt(rt(g,_[A-1]),rt(_[A+0],_[A+1]))},E.Predictor11=function(g,_,A){var I=_[A+0];return 0>=St(I>>24&255,g>>24&255,(_=_[A-1])>>24&255)+St(I>>16&255,g>>16&255,_>>16&255)+St(I>>8&255,g>>8&255,_>>8&255)+St(255&I,255&g,255&_)?I:g},E.Predictor12=function(g,_,A){var I=_[A+0];return(ht((g>>24&255)+(I>>24&255)-((_=_[A-1])>>24&255))<<24|ht((g>>16&255)+(I>>16&255)-(_>>16&255))<<16|ht((g>>8&255)+(I>>8&255)-(_>>8&255))<<8|ht((255&g)+(255&I)-(255&_)))>>>0},E.Predictor13=function(g,_,A){var I=_[A-1];return(gt((g=rt(g,_[A+0]))>>24&255,I>>24&255)<<24|gt(g>>16&255,I>>16&255)<<16|gt(g>>8&255,I>>8&255)<<8|gt(g>>0&255,I>>0&255))>>>0};var hm=E.PredictorAdd0;E.PredictorAdd1=Tt,Ke("Predictor2","PredictorAdd2"),Ke("Predictor3","PredictorAdd3"),Ke("Predictor4","PredictorAdd4"),Ke("Predictor5","PredictorAdd5"),Ke("Predictor6","PredictorAdd6"),Ke("Predictor7","PredictorAdd7"),Ke("Predictor8","PredictorAdd8"),Ke("Predictor9","PredictorAdd9"),Ke("Predictor10","PredictorAdd10"),Ke("Predictor11","PredictorAdd11"),Ke("Predictor12","PredictorAdd12"),Ke("Predictor13","PredictorAdd13");var ef=E.PredictorAdd2;at("ColorIndexInverseTransform","MapARGB","32b",function(g){return g>>8&255},function(g){return g}),at("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(g){return g},function(g){return g>>8&255});var jh,pi=E.ColorIndexInverseTransform,lu=E.MapARGB,Ih=E.VP8LColorIndexInverseTransformAlpha,Dh=E.MapAlpha,Po=E.VP8LPredictorsAdd=[];Po.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var ql,Ta,ha,Fo,Vs,qs,cu,Gs,Zr,tf,pa,gi,uu,Oh,rf,Gl,Xl,Lo,Kl,fu,Yl,jo,nf,mi,vi,kr,Sr,Qr,yn=i(511),Xs=i(2041),af=i(225),du=i(767),Rh=0,pm=Xs,Mh=af,Ga=du,xi=yn,Bh=0,Uh=1,Yw=2,zh=3,Wh=4,gm=5,Jw=6,mm=7,vm=8,Hh=9,xm=10,ZC=[2,3,7],QC=[3,3,11],Zw=[280,256,256,256,40],e8=[0,1,1,1,0],t8=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],r8=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],n8=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],a8=8,ym=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],wm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],sf=null,i8=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],s8=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Qw=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],o8=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],l8=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],c8=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],u8=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Io=[],Hi=[],Ks=[],f8=1,e5=2,Do=[],yi=[];je("UpsampleRgbLinePair",Yt,3),je("UpsampleBgrLinePair",Or,3),je("UpsampleRgbaLinePair",Wi,4),je("UpsampleBgraLinePair",En,4),je("UpsampleArgbLinePair",Gn,4),je("UpsampleRgba4444LinePair",cn,2),je("UpsampleRgb565LinePair",Hr,2);var d8=E.UpsampleRgbLinePair,h8=E.UpsampleBgrLinePair,t5=E.UpsampleRgbaLinePair,r5=E.UpsampleBgraLinePair,n5=E.UpsampleArgbLinePair,a5=E.UpsampleRgba4444LinePair,p8=E.UpsampleRgb565LinePair,$h=16,Vh=1<<$h-1,of=-227,bm=482,i5=6,g8=(256<<i5)-1,s5=0,m8=i(256),v8=i(256),x8=i(256),y8=i(256),w8=i(bm-of),b8=i(bm-of);ms("YuvToRgbRow",Yt,3),ms("YuvToBgrRow",Or,3),ms("YuvToRgbaRow",Wi,4),ms("YuvToBgraRow",En,4),ms("YuvToArgbRow",Gn,4),ms("YuvToRgba4444Row",cn,2),ms("YuvToRgb565Row",Hr,2);var o5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],qh=[0,2,8],_8=[8,7,6,4,4,2,2,2,1,1,1,1],k8=1;this.WebPDecodeRGBA=function(g,_,A,I,q){var K=Uh,Z=new tu,ee=new Ha;Z.ba=ee,ee.S=K,ee.width=[ee.width],ee.height=[ee.height];var te=ee.width,se=ee.height,ve=new Ri;if(ve==null||g==null)var Ee=2;else t(ve!=null),Ee=nu(g,_,A,ve.width,ve.height,ve.Pd,ve.Qd,ve.format,null);if(Ee!=0?te=0:(te!=null&&(te[0]=ve.width[0]),se!=null&&(se[0]=ve.height[0]),te=1),te){ee.width=ee.width[0],ee.height=ee.height[0],I!=null&&(I[0]=ee.width),q!=null&&(q[0]=ee.height);e:{if(I=new hs,(q=new V0).data=g,q.w=_,q.ha=A,q.kd=1,_=[0],t(q!=null),((g=nu(q.data,q.w,q.ha,null,null,null,_,null,q))==0||g==7)&&_[0]&&(g=4),(_=g)==0){if(t(Z!=null),I.data=q.data,I.w=q.w+q.offset,I.ha=q.ha-q.offset,I.put=di,I.ac=xn,I.bc=hi,I.ma=Z,q.xa){if((g=Fe())==null){Z=1;break e}if(function(Ne,be){var Me=[0],Le=[0],xe=[0];t:for(;;){if(Ne==null)return 0;if(be==null)return Ne.a=2,0;if(Ne.l=be,Ne.a=0,X(Ne.m,be.data,be.w,be.ha),!bt(Ne.m,Me,Le,xe)){Ne.a=3;break t}if(Ne.xb=e5,be.width=Me[0],be.height=Le[0],!ke(Me[0],Le[0],1,Ne,null))break t;return 1}return t(Ne.a!=0),0}(g,I)){if(I=(_=au(I.width,I.height,Z.Oa,Z.ba))==0){t:{I=g;r:for(;;){if(I==null){I=0;break t}if(t(I.s.yc!=null),t(I.s.Ya!=null),t(0<I.s.Wb),t((A=I.l)!=null),t((q=A.ma)!=null),I.xb!=0){if(I.ca=q.ba,I.tb=q.tb,t(I.ca!=null),!J0(q.Oa,A,zh)){I.a=2;break r}if(!Ae(I,A.width)||A.da)break r;if((A.da||Jt(I.ca.S))&&_e(),11>I.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),I.ca.f.kb.F!=null&&_e()),I.Pb&&0<I.s.ua&&I.s.vb.X==null&&!Ye(I.s.vb,I.s.Wa.Xa)){I.a=1;break r}I.xb=0}if(!fe(I,I.V,I.Ba,I.c,I.i,A.o,ce))break r;q.Dc=I.Ma,I=1;break t}t(I.a!=0),I=0}I=!I}I&&(_=g.a)}else _=g.a}else{if((g=new Va)==null){Z=1;break e}if(g.Fa=q.na,g.P=q.P,g.qc=q.Sa,vh(g,I)){if((_=au(I.width,I.height,Z.Oa,Z.ba))==0){if(g.Aa=0,A=Z.Oa,t((q=g)!=null),A!=null){if(0<(te=0>(te=A.Md)?0:100<te?255:255*te/100)){for(se=ve=0;4>se;++se)12>(Ee=q.pb[se]).lc&&(Ee.ia=te*_8[0>Ee.lc?0:Ee.lc]>>3),ve|=Ee.ia;ve&&(alert("todo:VP8InitRandom"),q.ia=1)}q.Ga=A.Id,100<q.Ga?q.Ga=100:0>q.Ga&&(q.Ga=0)}Kg(g,I)||(_=g.a)}}else _=g.a}_==0&&Z.Oa!=null&&Z.Oa.fd&&(_=Z0(Z.ba))}Z=_}K=Z!=0?null:11>K?ee.f.RGBA.eb:ee.f.kb.y}else K=null;return K};var l5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(E,P){for(var M="",F=0;F<4;F++)M+=String.fromCharCode(E[P++]);return M}function u(E,P){return(E[P+0]<<0|E[P+1]<<8|E[P+2]<<16)>>>0}function f(E,P){return(E[P+0]<<0|E[P+1]<<8|E[P+2]<<16|E[P+3]<<24)>>>0}new l;var d=[0],h=[0],v=[],m=new l,y=e,x=function(E,P){var M={},F=0,T=!1,H=0,W=0;if(M.frames=[],!function(R,B,U,Y){for(var ue=0;ue<Y;ue++)if(R[B+ue]!=U.charCodeAt(ue))return!0;return!1}(E,P,"RIFF",4)){var Q,V;for(f(E,P+=4),P+=8;P<E.length;){var z=c(E,P),X=f(E,P+=4);P+=4;var D=X+(1&X);switch(z){case"VP8 ":case"VP8L":M.frames[F]===void 0&&(M.frames[F]={}),(C=M.frames[F]).src_off=T?W:P-8,C.src_size=H+X+8,F++,T&&(T=!1,H=0,W=0);break;case"VP8X":(C=M.header={}).feature_flags=E[P];var ne=P+4;C.canvas_width=1+u(E,ne),ne+=3,C.canvas_height=1+u(E,ne),ne+=3;break;case"ALPH":T=!0,H=D+8,W=P-8;break;case"ANIM":(C=M.header).bgcolor=f(E,P),ne=P+4,C.loop_count=(Q=E)[(V=ne)+0]<<0|Q[V+1]<<8,ne+=2;break;case"ANMF":var ge,C;(C=M.frames[F]={}).offset_x=2*u(E,P),P+=3,C.offset_y=2*u(E,P),P+=3,C.width=1+u(E,P),P+=3,C.height=1+u(E,P),P+=3,C.duration=u(E,P),P+=3,ge=E[P++],C.dispose=1&ge,C.blend=ge>>1&1}z!="ANMF"&&(P+=D)}return M}}(y,0);x.response=y,x.rgbaoutput=!0,x.dataurl=!1;var b=x.header?x.header:null,w=x.frames?x.frames:null;if(b){b.loop_counter=b.loop_count,d=[b.canvas_height],h=[b.canvas_width];for(var S=0;S<w.length&&w[S].blend!=0;S++);}var L=w[0],j=m.WebPDecodeRGBA(y,L.src_off,L.src_size,h,d);L.rgba=j,L.imgwidth=h[0],L.imgheight=d[0];for(var N=0;N<h[0]*d[0]*4;N++)v[N]=j[N];return this.width=h,this.height=d,this.data=v,this}(function(e){var t=function(){return typeof l2=="function"},r=function(d,h,v,m){var y=4,x=s;switch(m){case e.image_compression.FAST:y=1,x=i;break;case e.image_compression.MEDIUM:y=6,x=o;break;case e.image_compression.SLOW:y=9,x=l}d=n(d,h,v,x);var b=l2(d,{level:y});return e.__addimage__.arrayBufferToBinaryString(b)},n=function(d,h,v,m){for(var y,x,b,w=d.length/h,S=new Uint8Array(d.length+w),L=u(),j=0;j<w;j+=1){if(b=j*h,y=d.subarray(b,b+h),m)S.set(m(y,v,x),b+j);else{for(var N,E=L.length,P=[];N<E;N+=1)P[N]=L[N](y,v,x);var M=f(P.concat());S.set(P[M],b+j)}x=y}return S},a=function(d){var h=Array.apply([],d);return h.unshift(0),h},i=function(d,h){var v,m=[],y=d.length;m[0]=1;for(var x=0;x<y;x+=1)v=d[x-h]||0,m[x+1]=d[x]-v+256&255;return m},s=function(d,h,v){var m,y=[],x=d.length;y[0]=2;for(var b=0;b<x;b+=1)m=v&&v[b]||0,y[b+1]=d[b]-m+256&255;return y},o=function(d,h,v){var m,y,x=[],b=d.length;x[0]=3;for(var w=0;w<b;w+=1)m=d[w-h]||0,y=v&&v[w]||0,x[w+1]=d[w]+256-(m+y>>>1)&255;return x},l=function(d,h,v){var m,y,x,b,w=[],S=d.length;w[0]=4;for(var L=0;L<S;L+=1)m=d[L-h]||0,y=v&&v[L]||0,x=v&&v[L-h]||0,b=c(m,y,x),w[L+1]=d[L]-b+256&255;return w},c=function(d,h,v){if(d===h&&h===v)return d;var m=Math.abs(h-v),y=Math.abs(d-v),x=Math.abs(d+h-v-v);return m<=y&&m<=x?d:y<=x?h:v},u=function(){return[a,i,s,o,l]},f=function(d){var h=d.map(function(v){return v.reduce(function(m,y){return m+Math.abs(y)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(d,h,v,m){var y,x,b,w,S,L,j,N,E,P,M,F,T,H,W,Q=this.decode.FLATE_DECODE,V="";if(this.__addimage__.isArrayBuffer(d)&&(d=new Uint8Array(d)),this.__addimage__.isArrayBufferView(d)){if(d=(b=new GD(d)).imgData,x=b.bits,y=b.colorSpace,S=b.colors,[4,6].indexOf(b.colorType)!==-1){if(b.bits===8){E=(N=b.pixelBitlength==32?new Uint32Array(b.decodePixels().buffer):b.pixelBitlength==16?new Uint16Array(b.decodePixels().buffer):new Uint8Array(b.decodePixels().buffer)).length,M=new Uint8Array(E*b.colors),P=new Uint8Array(E);var z,X=b.pixelBitlength-b.bits;for(H=0,W=0;H<E;H++){for(T=N[H],z=0;z<X;)M[W++]=T>>>z&255,z+=b.bits;P[H]=T>>>z&255}}if(b.bits===16){E=(N=new Uint32Array(b.decodePixels().buffer)).length,M=new Uint8Array(E*(32/b.pixelBitlength)*b.colors),P=new Uint8Array(E*(32/b.pixelBitlength)),F=b.colors>1,H=0,W=0;for(var D=0;H<E;)T=N[H++],M[W++]=T>>>0&255,F&&(M[W++]=T>>>16&255,T=N[H++],M[W++]=T>>>0&255),P[D++]=T>>>16&255;x=8}m!==e.image_compression.NONE&&t()?(d=r(M,b.width*b.colors,b.colors,m),j=r(P,b.width,1,m)):(d=M,j=P,Q=void 0)}if(b.colorType===3&&(y=this.color_spaces.INDEXED,L=b.palette,b.transparency.indexed)){var ne=b.transparency.indexed,ge=0;for(H=0,E=ne.length;H<E;++H)ge+=ne[H];if((ge/=255)===E-1&&ne.indexOf(0)!==-1)w=[ne.indexOf(0)];else if(ge!==E){for(N=b.decodePixels(),P=new Uint8Array(N.length),H=0,E=N.length;H<E;H++)P[H]=ne[N[H]];j=r(P,b.width,1)}}var C=function(R){var B;switch(R){case e.image_compression.FAST:B=11;break;case e.image_compression.MEDIUM:B=13;break;case e.image_compression.SLOW:B=14;break;default:B=12}return B}(m);return Q===this.decode.FLATE_DECODE&&(V="/Predictor "+C+" "),V+="/Colors "+S+" /BitsPerComponent "+x+" /Columns "+b.width,(this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),(j&&this.__addimage__.isArrayBuffer(j)||this.__addimage__.isArrayBufferView(j))&&(j=this.__addimage__.arrayBufferToBinaryString(j)),{alias:v,data:d,index:h,filter:Q,decodeParameters:V,transparency:w,palette:L,sMask:j,predictor:C,width:b.width,height:b.height,bitsPerComponent:x,colorSpace:y}}}})(kt.API),function(e){e.processGIF89A=function(t,r,n,a){var i=new XD(t),s=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},u=new Sv(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)},e.processGIF87A=e.processGIF89A}(kt.API),Gi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Gi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){wr.log("bit decode error:"+r)}},Gi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Gi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Gi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Gi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,l=(i>>10&t)/t*255|0,c=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=c}this.pos+=e}},Gi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,c=(s>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},Gi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Gi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},Gi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new Gi(t,!1),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new Sv(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(kt.API),R_.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new R_(t),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new Sv(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(kt.API),kt.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var u=n[c],f=n[c+1],d=n[c+2],h=n[c+3];i[o++]=u,i[o++]=f,i[o++]=d,s[l++]=h}var v=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},kt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},_u=kt.API,A1=_u.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=c.fof?c.fof:1,f=t.doKerning!==!1,d=0,h=e.length,v=0,m=o[0]||l,y=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?y.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(d=f&&dr(c[n])==="object"&&!isNaN(parseInt(c[n][v],10))?c[n][v]/u:0,y.push((o[n]||m)/l+d)),v=n;return y},j_=_u.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return _u.processArabic&&(e=_u.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:A1.apply(this,arguments).reduce(function(i,s){return i+s},0)},I_=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var l=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(l,i)),o=0,l=i),o+=t[i],i++;return l!==i&&a.push(e.slice(l,i)),a},D_=function(e,t,r){r||(r={});var n,a,i,s,o,l,c,u=[],f=[u],d=r.textIndent||0,h=0,v=0,m=e.split(" "),y=A1.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var x=Array(l).join(" "),b=[];m.map(function(S){(S=S.split(/\s*\n/)).length>1?b=b.concat(S.map(function(L,j){return(j&&L.length?`
`:"")+L})):b.push(S[0])}),m=b,l=j_.apply(this,[x,r])}for(i=0,s=m.length;i<s;i++){var w=0;if(n=m[i],l&&n[0]==`
`&&(n=n.substr(1),w=1),d+h+(v=(a=A1.apply(this,[n,r])).reduce(function(S,L){return S+L},0))>t||w){if(v>t){for(o=I_.apply(this,[n,a,t-(d+h),t]),u.push(o.shift()),u=[o.pop()];o.length;)f.push([o.shift()]);v=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(S,L){return S+L},0)}else u=[n];f.push(u),d=v+l,h=y}else u.push(n),d+=h+v,h=y}return c=l?function(S,L){return(L?x:"")+S.join(" ")}:function(S){return S.join(" ")},f.map(c)},_u.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(D_.apply(this,[n[o],s,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},a=0;a<t.length;a++)r[t[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=t[a];var i=function(f){return"0x"+parseInt(f,10).toString(16)},s=e.__fontmetrics__.compress=function(f){var d,h,v,m,y=["{"];for(var x in f){if(d=f[x],isNaN(parseInt(x,10))?h="'"+x+"'":(x=parseInt(x,10),h=(h=i(x).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof d=="number")d<0?(v=i(d).slice(3),m="-"):(v=i(d).slice(2),m=""),v=m+v.slice(0,-1)+n[v.slice(-1)];else{if(dr(d)!=="object")throw new Error("Don't know what to do with value type "+dr(d)+".");v=s(d)}y.push(h+v)}return y.push("}"),y.join("")},o=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,h,v,m,y={},x=1,b=y,w=[],S="",L="",j=f.length-1,N=1;N<j;N+=1)(m=f[N])=="'"?d?(v=d.join(""),d=void 0):d=[]:d?d.push(m):m=="{"?(w.push([b,v]),b={},v=void 0):m=="}"?((h=w.pop())[0][h[1]]=b,v=void 0,b=h[0]):m=="-"?x=-1:v===void 0?r.hasOwnProperty(m)?(S+=r[m],v=parseInt(S,16)*x,x=1,S=""):S+=m:r.hasOwnProperty(m)?(L+=r[m],b[v]=parseInt(L,16)*x,x=1,v=void 0,L=""):L+=m;return y},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var d=f.font,h=u.Unicode[d.postScriptName];h&&(d.metadata.Unicode={},d.metadata.Unicode.widths=h.widths,d.metadata.Unicode.kerning=h.kerning);var v=c.Unicode[d.postScriptName];v&&(d.metadata.Unicode.encoding=v,d.encoding=v.codePages[0])}])}(kt.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Gf(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(kt),function(e){function t(){return(Nt.canvg?Promise.resolve(Nt.canvg):vo(()=>import("./index.es-24016cb4.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}kt.API.addSvgAsImage=function(r,n,a,i,s,o,l,c){if(isNaN(n)||isNaN(a))throw wr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw wr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=s;var f=u.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,u.width,u.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(v){return v.fromString(f,r,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(d)}).then(function(){h.addImage(u.toDataURL("image/jpeg",1),n,a,i,s,l,c)})}}(),kt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},kt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,u=0,f=0;function d(v,m){var y,x=!1;for(y=0;y<v.length;y+=1)v[y]===m&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(f=0;f<h;f+=1)r[o[f]].value=r[o[f]].defaultValue,r[o[f]].explicitSet=!1}if(dr(e)==="object"){for(a in e)if(i=e[a],d(o,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&d(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(c=0;c<i.length;c+=1)if(n=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(u=0;u<i[c].length;u+=1)typeof i[c][u]!="number"&&(n=!1);n===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}r[a].value="["+l.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,m=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?m.push("/"+v+" /"+r[v].value):m.push("/"+v+" "+r[v].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+s.length+o.length+a.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(kt.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var o,l=s.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],f=0,d=i.length;f<d;++f){if(o=s.metadata.characterToGlyph(i.charCodeAt(f)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(i){var s,o,l,c,u,f,d;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,d=(o=Object.keys(i).sort(function(h,v){return h-v})).length;f<d;f++)s=o[f],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(c=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,d=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",v=0;v<d.length;v++)h+=String.fromCharCode(d[v]);var m=c();u({data:h,addLength1:!0,objectId:m}),l("endobj");var y=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var x=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Lu(o.fontName)),l("/FontFile2 "+m+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var b=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Lu(o.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+e.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+y+" 0 R"),l("/BaseFont /"+Lu(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+b+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,d="",h=0;h<f.length;h++)d+=String.fromCharCode(f[h]);var v=c();u({data:d,addLength1:!0,objectId:v}),l("endobj");var m=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var y=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+v+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Lu(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Lu(o.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",l=i.x,c=i.y,u=i.options||{},f=i.mutex||{},d=f.pdfEscape,h=f.activeFontKey,v=f.fonts,m=h,y="",x=0,b="",w=v[m].encoding;if(v[m].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:f};for(b=o,m=h,Array.isArray(o)&&(b=o[0]),x=0;x<b.length;x+=1)v[m].metadata.hasOwnProperty("cmap")&&(s=v[m].metadata.cmap.unicode.codeMap[b[x].charCodeAt(0)]),s||b[x].charCodeAt(0)<256&&v[m].metadata.hasOwnProperty("Unicode")?y+=b[x]:y+="";var S="";return parseInt(m.slice(1))<14||w==="WinAnsiEncoding"?S=d(y,m).split("").map(function(L){return L.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(S=r(y,v[m])),f.isHex=!0,{text:S,x:l,y:c,options:u,mutex:f}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],l={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([a(Object.assign({},l,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(a(Object.assign({},l,{text:s[c]})).text);i.text=o}else i.text=a(Object.assign({},l,{text:s})).text}])}(kt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(kt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,o,l,c,u,f=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var S=function(F){var T=F.charCodeAt(),H=T>>8,W=m[H];return W!==void 0?f[256*W+(255&T)]:H===252||H===253?"AL":x.test(H)?"L":H===8?"R":"N"},L=function(F){for(var T,H=0;H<F.length;H++){if((T=S(F.charAt(H)))==="L")return!1;if(T==="R")return!0}return!1},j=function(F,T,H,W){var Q,V,z,X,D=T[W];switch(D){case"L":case"R":b=!1;break;case"N":case"AN":break;case"EN":b&&(D="AN");break;case"AL":b=!0,D="R";break;case"WS":D="N";break;case"CS":W<1||W+1>=T.length||(Q=H[W-1])!=="EN"&&Q!=="AN"||(V=T[W+1])!=="EN"&&V!=="AN"?D="N":b&&(V="AN"),D=V===Q?V:"N";break;case"ES":D=(Q=W>0?H[W-1]:"B")==="EN"&&W+1<T.length&&T[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&H[W-1]==="EN"){D="EN";break}if(b){D="N";break}for(z=W+1,X=T.length;z<X&&T[z]==="ET";)z++;D=z<X&&T[z]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(X=T.length,z=W+1;z<X&&T[z]==="NSM";)z++;if(z<X){var ne=F[W],ge=ne>=1425&&ne<=2303||ne===64286;if(Q=T[z],ge&&(Q==="R"||Q==="AL")){D="R";break}}}D=W<1||(Q=T[W-1])==="B"?"N":H[W-1];break;case"B":b=!1,a=!0,D=w;break;case"S":i=!0,D="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"BN":D="N"}return D},N=function(F,T,H){var W=F.split("");return H&&E(W,H,{hiLevel:w}),W.reverse(),T&&T.reverse(),W.join("")},E=function(F,T,H){var W,Q,V,z,X,D=-1,ne=F.length,ge=0,C=[],R=w?h:d,B=[];for(b=!1,a=!1,i=!1,Q=0;Q<ne;Q++)B[Q]=S(F[Q]);for(V=0;V<ne;V++){if(X=ge,C[V]=j(F,B,C,V),W=240&(ge=R[X][v[C[V]]]),ge&=15,T[V]=z=R[ge][5],W>0)if(W===16){for(Q=D;Q<V;Q++)T[Q]=1;D=-1}else D=-1;if(R[ge][6])D===-1&&(D=V);else if(D>-1){for(Q=D;Q<V;Q++)T[Q]=z;D=-1}B[V]==="B"&&(T[V]=0),H.hiLevel|=z}i&&function(U,Y,ue){for(var pe=0;pe<ue;pe++)if(U[pe]==="S"){Y[pe]=w;for(var he=pe-1;he>=0&&U[he]==="WS";he--)Y[he]=w}}(B,T,ne)},P=function(F,T,H,W,Q){if(!(Q.hiLevel<F)){if(F===1&&w===1&&!a)return T.reverse(),void(H&&H.reverse());for(var V,z,X,D,ne=T.length,ge=0;ge<ne;){if(W[ge]>=F){for(X=ge+1;X<ne&&W[X]>=F;)X++;for(D=ge,z=X-1;D<z;D++,z--)V=T[D],T[D]=T[z],T[z]=V,H&&(V=H[D],H[D]=H[z],H[z]=V);ge=X}ge++}}},M=function(F,T,H){var W=F.split(""),Q={hiLevel:w};return H||(H=[]),E(W,H,Q),function(V,z,X){if(X.hiLevel!==0&&u)for(var D,ne=0;ne<V.length;ne++)z[ne]===1&&(D=y.indexOf(V[ne]))>=0&&(V[ne]=y[D+1])}(W,H,Q),P(2,W,T,H,Q),P(1,W,T,H,Q),W.join("")};return this.__bidiEngine__.doBidiReorder=function(F,T,H){if(function(Q,V){if(V)for(var z=0;z<Q.length;z++)V[z]=z;o===void 0&&(o=L(Q)),c===void 0&&(c=L(Q))}(F,T),s||!l||c)if(s&&l&&o^c)w=o?1:0,F=N(F,T,H);else if(!s&&l&&c)w=o?1:0,F=M(F,T,H),F=N(F,T);else if(!s||o||l||c){if(s&&!l&&o^c)F=N(F,T),o?(w=0,F=M(F,T,H)):(w=1,F=M(F,T,H),F=N(F,T));else if(s&&o&&!l&&c)w=1,F=M(F,T,H),F=N(F,T);else if(!s&&!l&&o^c){var W=u;o?(w=1,F=M(F,T,H),w=0,u=!1,F=M(F,T,H),u=W):(w=0,F=M(F,T,H),F=N(F,T),w=1,u=!1,F=M(F,T,H),u=W,F=N(F,T))}}else w=0,F=M(F,T,H);else w=o?1:0,F=M(F,T,H);return F},this.__bidiEngine__.setOptions=function(F){F&&(s=F.isInputVisual,l=F.isOutputVisual,o=F.isInputRtl,c=F.isOutputRtl,u=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text,i=(n.x,n.y,n.options||{}),s=(n.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([r.doBidiReorder(a[o])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(kt),kt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new kl(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new cO(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new KD(this.contents),this.head=new JD(this),this.name=new rO(this),this.cmap=new i6(this),this.toUnicode={},this.hhea=new ZD(this),this.maxp=new nO(this),this.hmtx=new aO(this),this.post=new eO(this),this.os2=new QD(this),this.loca=new lO(this),this.glyf=new iO(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,c;for(c=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var us,kl=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),KD=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,o,l,c,u,f,d,h,v,m;for(m in h=Object.keys(r).length,l=Math.log(2),f=16*Math.floor(Math.log(h)/l),s=Math.floor(f/l),u=16*h-f,(a=new kl).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(s),a.writeShort(u),i=16*h,c=a.pos+i,o=null,v=[],r)for(d=r[m],a.writeString(m),a.writeInt(e(d)),a.writeInt(c),a.writeInt(d.length),v=v.concat(d),m==="head"&&(o=c),c+=d.length;c%4;)v.push(0),c++;return a.write(v),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=s6.call(r);r.length%4;)r.push(0);for(i=new kl(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),YD={}.hasOwnProperty,Rs=function(e,t){for(var r in t)YD.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};us=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var JD=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new kl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),M_=function(){function e(t,r){var n,a,i,s,o,l,c,u,f,d,h,v,m,y,x,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(h=t.readUInt16(),d=h/2,t.pos+=6,i=function(){var S,L;for(L=[],l=S=0;0<=d?S<d:S>d;l=0<=d?++S:--S)L.push(t.readUInt16());return L}(),t.pos+=2,m=function(){var S,L;for(L=[],l=S=0;0<=d?S<d:S>d;l=0<=d?++S:--S)L.push(t.readUInt16());return L}(),c=function(){var S,L;for(L=[],l=S=0;0<=d?S<d:S>d;l=0<=d?++S:--S)L.push(t.readUInt16());return L}(),u=function(){var S,L;for(L=[],l=S=0;0<=d?S<d:S>d;l=0<=d?++S:--S)L.push(t.readUInt16());return L}(),a=(this.length-t.pos+this.offset)/2,o=function(){var S,L;for(L=[],l=S=0;0<=a?S<a:S>a;l=0<=a?++S:--S)L.push(t.readUInt16());return L}(),l=x=0,w=i.length;x<w;l=++x)for(y=i[l],n=b=v=m[l];v<=y?b<=y:b>=y;n=v<=y?++b:--b)u[l]===0?s=n+c[l]:(s=o[u[l]/2+(n-v)-(d-l)]||0)!==0&&(s+=c[l]),this.codeMap[n]=65535&s}t.pos=f}return e.encode=function(t,r){var n,a,i,s,o,l,c,u,f,d,h,v,m,y,x,b,w,S,L,j,N,E,P,M,F,T,H,W,Q,V,z,X,D,ne,ge,C,R,B,U,Y,ue,pe,he,ye,Pe,re;switch(W=new kl,s=Object.keys(t).sort(function(Ue,Ye){return Ue-Ye}),r){case"macroman":for(m=0,y=function(){var Ue=[];for(v=0;v<256;++v)Ue.push(0);return Ue}(),b={0:0},i={},Q=0,D=s.length;Q<D;Q++)b[he=t[a=s[Q]]]==null&&(b[he]=++m),i[a]={old:t[a],new:b[t[a]]},y[a]=b[t[a]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(y),{charMap:i,subtable:W.data,maxGlyphID:m+1};case"unicode":for(T=[],f=[],w=0,b={},n={},x=c=null,V=0,ne=s.length;V<ne;V++)b[L=t[a=s[V]]]==null&&(b[L]=++w),n[a]={old:L,new:b[L]},o=b[L]-a,x!=null&&o===c||(x&&f.push(x),T.push(a),c=o),x=a;for(x&&f.push(x),f.push(65535),T.push(65535),M=2*(P=T.length),E=2*Math.pow(Math.log(P)/Math.LN2,2),d=Math.log(E/2)/Math.LN2,N=2*P-E,l=[],j=[],h=[],v=z=0,ge=T.length;z<ge;v=++z){if(F=T[v],u=f[v],F===65535){l.push(0),j.push(0);break}if(F-(H=n[F].new)>=32768)for(l.push(0),j.push(2*(h.length+P-v)),a=X=F;F<=u?X<=u:X>=u;a=F<=u?++X:--X)h.push(n[a].new);else l.push(H-F),j.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*P+2*h.length),W.writeUInt16(0),W.writeUInt16(M),W.writeUInt16(E),W.writeUInt16(d),W.writeUInt16(N),ue=0,C=f.length;ue<C;ue++)a=f[ue],W.writeUInt16(a);for(W.writeUInt16(0),pe=0,R=T.length;pe<R;pe++)a=T[pe],W.writeUInt16(a);for(ye=0,B=l.length;ye<B;ye++)o=l[ye],W.writeUInt16(o);for(Pe=0,U=j.length;Pe<U;Pe++)S=j[Pe],W.writeUInt16(S);for(re=0,Y=h.length;re<Y;re++)m=h[re],W.writeUInt16(m);return{charMap:n,subtable:W.data,maxGlyphID:w+1}}},e}(),i6=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,a,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new M_(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var a,i;return n==null&&(n="macroman"),a=M_.encode(r,n),(i=new kl).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},t}(),ZD=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),QD=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(r.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(r.readInt());return a}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(r.readInt());return a}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),eO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="post",t.prototype.parse=function(r){var n,a,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(a=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return a=r.readUInt16(),this.offsets=r.read(a);case 196608:break;case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(r.readUInt32());return c}).call(this)}},t}(),tO=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},rO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="name",t.prototype.parse=function(r){var n,a,i,s,o,l,c,u,f,d,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),a=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)a.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(c={},s=f=0,d=a.length;f<d;s=++f)i=a[s],r.pos=i.offset,u=r.readString(i.length),o=new tO(u,i),c[h=i.nameID]==null&&(c[h]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),nO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),aO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,a,i,s,o,l,c;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)f.push(r.readInt16());return f}(),this.widths=(function(){var u,f,d,h;for(h=[],u=0,f=(d=this.metrics).length;u<f;u++)s=d[u],h.push(s.advance);return h}).call(this),a=this.widths[this.widths.length-1],c=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)c.push(this.widths.push(a));return c},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),s6=[].slice,iO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,a,i,s,o,l,c,u,f,d;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,a=s.indexOf(r),(i=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+a,o=(l=new kl(n.read(i))).readShort(),u=l.readShort(),d=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[r]=o===-1?new oO(l,u,d,c,f):new sO(l,o,u,d,c,f),this.cache[r]))},t.prototype.encode=function(r,n,a){var i,s,o,l,c;for(o=[],s=[],l=0,c=n.length;l<c;l++)i=r[n[l]],s.push(o.length),i&&(o=o.concat(i.encode(a)));return s.push(o.length),{table:o,offsets:s}},t}(),sO=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),oO=function(){function e(t,r,n,a,i){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new kl(s6.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),lO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Rs(t,us),t.prototype.tag="loca",t.prototype.parse=function(r){var n,a;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=2)s.push(2*r.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=4)s.push(r.readUInt32());return s}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var a=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<a.length;++o)if(a[o]=i,s<n.length&&n[s]==o){++s,a[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*a.length),f=0;f<a.length;++f)u[4*f+3]=255&a[f],u[4*f+2]=(65280&a[f])>>8,u[4*f+1]=(16711680&a[f])>>16,u[4*f]=(4278190080&a[f])>>24;return u},t}(),cO=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,o,l;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in l=this.glyphsFor(r))n=l[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,o,l,c,u,f,d,h,v,m,y,x;for(a in n=i6.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),h={0:0},x=n.charMap)h[(l=x[a]).old]=l.new;for(v in d=n.maxGlyphID,s)v in h||(h[v]=d++);return u=function(b){var w,S;for(w in S={},b)S[b[w]]=w;return S}(h),f=Object.keys(u).sort(function(b,w){return b-w}),m=function(){var b,w,S;for(S=[],b=0,w=f.length;b<w;b++)o=f[b],S.push(u[o]);return S}(),i=this.font.glyf.encode(s,m,h),c=this.font.loca.encode(i.offsets,m),y={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();kt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var o,l,c;for(c=[],o=0,l=r.length;o<l;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();const uO=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:zD,AcroFormAppearance:dt,AcroFormButton:bn,AcroFormCheckBox:Yf,AcroFormChoiceField:hc,AcroFormComboBox:gc,AcroFormEditBox:Xf,AcroFormListBox:pc,AcroFormPasswordField:Jf,AcroFormPushButton:Kf,AcroFormRadioButton:mc,AcroFormTextField:yl,GState:Cd,ShadingPattern:rl,TilingPattern:lc,default:kt,jsPDF:kt},Symbol.toStringTag,{value:"Module"}));var o6={exports:{}};const fO=_k(uO);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(n,a){e.exports=a(function(){try{return fO}catch{}}())})(typeof globalThis<"u"?globalThis:typeof wa<"u"?wa:typeof window<"u"?window:typeof self<"u"?self:wa,function(r){return function(){var n={172:function(o,l){var c=this&&this.__extends||function(){var d=function(h,v){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var x in y)Object.prototype.hasOwnProperty.call(y,x)&&(m[x]=y[x])},d(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");d(h,v);function m(){this.constructor=h}h.prototype=v===null?Object.create(v):(m.prototype=v.prototype,new m)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.CellHookData=l.HookData=void 0;var u=function(){function d(h,v,m){this.table=v,this.pageNumber=v.pageNumber,this.pageCount=this.pageNumber,this.settings=v.settings,this.cursor=m,this.doc=h.getDocument()}return d}();l.HookData=u;var f=function(d){c(h,d);function h(v,m,y,x,b,w){var S=d.call(this,v,m,w)||this;return S.cell=y,S.row=x,S.column=b,S.section=x.section,S}return h}(u);l.CellHookData=f},340:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0});var u=c(4),f=c(136),d=c(744),h=c(776),v=c(664),m=c(972);function y(x){x.API.autoTable=function(){for(var b=[],w=0;w<arguments.length;w++)b[w]=arguments[w];var S;b.length===1?S=b[0]:(console.error("Use of deprecated autoTable initiation"),S=b[2]||{},S.columns=b[0],S.body=b[1]);var L=(0,h.parseInput)(this,S),j=(0,m.createTable)(this,L);return(0,v.drawTable)(this,j),this},x.API.lastAutoTable=!1,x.API.previousAutoTable=!1,x.API.autoTable.previous=!1,x.API.autoTableText=function(b,w,S,L){(0,f.default)(b,w,S,L,this)},x.API.autoTableSetDefaults=function(b){return d.DocHandler.setDefaults(b,this),this},x.autoTableSetDefaults=function(b,w){d.DocHandler.setDefaults(b,w)},x.API.autoTableHtmlToJson=function(b,w){var S;if(w===void 0&&(w=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var L=new d.DocHandler(this),j=(0,u.parseHtml)(L,b,window,w,!1),N=j.head,E=j.body,P=((S=N[0])===null||S===void 0?void 0:S.map(function(M){return M.content}))||[];return{columns:P,rows:E,data:E}},x.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var b=this.lastAutoTable;return b&&b.finalY?b.finalY:0},x.API.autoTableAddPageContent=function(b){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),x.API.autoTable.globalDefaults||(x.API.autoTable.globalDefaults={}),x.API.autoTable.globalDefaults.addPageContent=b,this},x.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}l.default=y},136:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function c(u,f,d,h,v){h=h||{};var m=1.15,y=v.internal.scaleFactor,x=v.internal.getFontSize()/y,b=v.getLineHeightFactor?v.getLineHeightFactor():m,w=x*b,S=/\r\n|\r|\n/g,L="",j=1;if((h.valign==="middle"||h.valign==="bottom"||h.halign==="center"||h.halign==="right")&&(L=typeof u=="string"?u.split(S):u,j=L.length||1),d+=x*(2-m),h.valign==="middle"?d-=j/2*w:h.valign==="bottom"&&(d-=j*w),h.halign==="center"||h.halign==="right"){var N=x;if(h.halign==="center"&&(N*=.5),L&&j>=1){for(var E=0;E<L.length;E++)v.text(L[E],f-v.getStringUnitWidth(L[E])*N,d),d+=w;return v}f-=v.getStringUnitWidth(u)*N}return h.halign==="justify"?v.text(u,f,d,{maxWidth:h.maxWidth||100,align:"justify"}):v.text(u,f,d),v}l.default=c},420:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.getPageAvailableWidth=l.parseSpacing=l.getFillStyle=l.addTableBorder=l.getStringWidth=void 0;function c(v,m,y){y.applyStyles(m,!0);var x=Array.isArray(v)?v:[v],b=x.map(function(w){return y.getTextWidth(w)}).reduce(function(w,S){return Math.max(w,S)},0);return b}l.getStringWidth=c;function u(v,m,y,x){var b=m.settings.tableLineWidth,w=m.settings.tableLineColor;v.applyStyles({lineWidth:b,lineColor:w});var S=f(b,!1);S&&v.rect(y.x,y.y,m.getWidth(v.pageSize().width),x.y-y.y,S)}l.addTableBorder=u;function f(v,m){var y=v>0,x=m||m===0;return y&&x?"DF":y?"S":x?"F":null}l.getFillStyle=f;function d(v,m){var y,x,b,w;if(v=v||m,Array.isArray(v)){if(v.length>=4)return{top:v[0],right:v[1],bottom:v[2],left:v[3]};if(v.length===3)return{top:v[0],right:v[1],bottom:v[2],left:v[1]};if(v.length===2)return{top:v[0],right:v[1],bottom:v[0],left:v[1]};v.length===1?v=v[0]:v=m}return typeof v=="object"?(typeof v.vertical=="number"&&(v.top=v.vertical,v.bottom=v.vertical),typeof v.horizontal=="number"&&(v.right=v.horizontal,v.left=v.horizontal),{left:(y=v.left)!==null&&y!==void 0?y:m,top:(x=v.top)!==null&&x!==void 0?x:m,right:(b=v.right)!==null&&b!==void 0?b:m,bottom:(w=v.bottom)!==null&&w!==void 0?w:m}):(typeof v!="number"&&(v=m),{top:v,right:v,bottom:v,left:v})}l.parseSpacing=d;function h(v,m){var y=d(m.settings.margin,0);return v.pageSize().width-(y.left+y.right)}l.getPageAvailableWidth=h},796:function(o,l){var c=this&&this.__extends||function(){var h=function(v,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,x){y.__proto__=x}||function(y,x){for(var b in x)Object.prototype.hasOwnProperty.call(x,b)&&(y[b]=x[b])},h(v,m)};return function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(v,m);function y(){this.constructor=v}v.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.getTheme=l.defaultStyles=l.HtmlRowInput=void 0;var u=function(h){c(v,h);function v(m){var y=h.call(this)||this;return y._element=m,y}return v}(Array);l.HtmlRowInput=u;function f(h){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/h,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}l.defaultStyles=f;function d(h){var v={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return v[h]}l.getTheme=d},903:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.parseCss=void 0;var u=c(420);function f(y,x,b,w,S){var L={},j=1.3333333333333333,N=h(x,function(D){return S.getComputedStyle(D).backgroundColor});N!=null&&(L.fillColor=N);var E=h(x,function(D){return S.getComputedStyle(D).color});E!=null&&(L.textColor=E);var P=m(w,b);P&&(L.cellPadding=P);var M="borderTopColor",F=j*b,T=w.borderTopWidth;if(w.borderBottomWidth===T&&w.borderRightWidth===T&&w.borderLeftWidth===T){var H=(parseFloat(T)||0)/F;H&&(L.lineWidth=H)}else L.lineWidth={top:(parseFloat(w.borderTopWidth)||0)/F,right:(parseFloat(w.borderRightWidth)||0)/F,bottom:(parseFloat(w.borderBottomWidth)||0)/F,left:(parseFloat(w.borderLeftWidth)||0)/F},L.lineWidth.top||(L.lineWidth.right?M="borderRightColor":L.lineWidth.bottom?M="borderBottomColor":L.lineWidth.left&&(M="borderLeftColor"));var W=h(x,function(D){return S.getComputedStyle(D)[M]});W!=null&&(L.lineColor=W);var Q=["left","right","center","justify"];Q.indexOf(w.textAlign)!==-1&&(L.halign=w.textAlign),Q=["middle","bottom","top"],Q.indexOf(w.verticalAlign)!==-1&&(L.valign=w.verticalAlign);var V=parseInt(w.fontSize||"");isNaN(V)||(L.fontSize=V/j);var z=d(w);z&&(L.fontStyle=z);var X=(w.fontFamily||"").toLowerCase();return y.indexOf(X)!==-1&&(L.font=X),L}l.parseCss=f;function d(y){var x="";return(y.fontWeight==="bold"||y.fontWeight==="bolder"||parseInt(y.fontWeight)>=700)&&(x="bold"),(y.fontStyle==="italic"||y.fontStyle==="oblique")&&(x+="italic"),x}function h(y,x){var b=v(y,x);if(!b)return null;var w=b.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!w||!Array.isArray(w))return null;var S=[parseInt(w[1]),parseInt(w[2]),parseInt(w[3])],L=parseInt(w[4]);return L===0||isNaN(S[0])||isNaN(S[1])||isNaN(S[2])?null:S}function v(y,x){var b=x(y);return b==="rgba(0, 0, 0, 0)"||b==="transparent"||b==="initial"||b==="inherit"?y.parentElement==null?null:v(y.parentElement,x):b}function m(y,x){var b=[y.paddingTop,y.paddingRight,y.paddingBottom,y.paddingLeft],w=96/(72/x),S=(parseInt(y.lineHeight)-parseInt(y.fontSize))/x/2,L=b.map(function(N){return parseInt(N||"0")/w}),j=(0,u.parseSpacing)(L,0);return S>j.top&&(j.top=S),S>j.bottom&&(j.bottom=S),j}},744:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.DocHandler=void 0;var c={},u=function(){function f(d){this.jsPDFDocument=d,this.userStyles={textColor:d.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:d.internal.getFontSize(),fontStyle:d.internal.getFont().fontStyle,font:d.internal.getFont().fontName,lineWidth:d.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:d.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return f.setDefaults=function(d,h){h===void 0&&(h=null),h?h.__autoTableDocumentDefaults=d:c=d},f.unifyColor=function(d){return Array.isArray(d)?d:typeof d=="number"?[d,d,d]:typeof d=="string"?[d]:null},f.prototype.applyStyles=function(d,h){var v,m,y;h===void 0&&(h=!1),d.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(d.fontStyle);var x=this.jsPDFDocument.internal.getFont(),b=x.fontStyle,w=x.fontName;if(d.font&&(w=d.font),d.fontStyle){b=d.fontStyle;var S=this.getFontList()[w];S&&S.indexOf(b)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(S[0]),b=S[0])}if(this.jsPDFDocument.setFont(w,b),d.fontSize&&this.jsPDFDocument.setFontSize(d.fontSize),!h){var L=f.unifyColor(d.fillColor);L&&(v=this.jsPDFDocument).setFillColor.apply(v,L),L=f.unifyColor(d.textColor),L&&(m=this.jsPDFDocument).setTextColor.apply(m,L),L=f.unifyColor(d.lineColor),L&&(y=this.jsPDFDocument).setDrawColor.apply(y,L),typeof d.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(d.lineWidth)}},f.prototype.splitTextToSize=function(d,h,v){return this.jsPDFDocument.splitTextToSize(d,h,v)},f.prototype.rect=function(d,h,v,m,y){return this.jsPDFDocument.rect(d,h,v,m,y)},f.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},f.prototype.getTextWidth=function(d){return this.jsPDFDocument.getTextWidth(d)},f.prototype.getDocument=function(){return this.jsPDFDocument},f.prototype.setPage=function(d){this.jsPDFDocument.setPage(d)},f.prototype.addPage=function(){return this.jsPDFDocument.addPage()},f.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},f.prototype.getGlobalOptions=function(){return c||{}},f.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},f.prototype.pageSize=function(){var d=this.jsPDFDocument.internal.pageSize;return d.width==null&&(d={width:d.getWidth(),height:d.getHeight()}),d},f.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},f.prototype.getLineHeightFactor=function(){var d=this.jsPDFDocument;return d.getLineHeightFactor?d.getLineHeightFactor():1.15},f.prototype.getLineHeight=function(d){return d/this.scaleFactor()*this.getLineHeightFactor()},f.prototype.pageNumber=function(){var d=this.jsPDFDocument.internal.getCurrentPageInfo();return d?d.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},f}();l.DocHandler=u},4:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.parseHtml=void 0;var u=c(903),f=c(796);function d(m,y,x,b,w){var S,L;b===void 0&&(b=!1),w===void 0&&(w=!1);var j;typeof y=="string"?j=x.document.querySelector(y):j=y;var N=Object.keys(m.getFontList()),E=m.scaleFactor(),P=[],M=[],F=[];if(!j)return console.error("Html table could not be found with input: ",y),{head:P,body:M,foot:F};for(var T=0;T<j.rows.length;T++){var H=j.rows[T],W=(L=(S=H==null?void 0:H.parentElement)===null||S===void 0?void 0:S.tagName)===null||L===void 0?void 0:L.toLowerCase(),Q=h(N,E,x,H,b,w);Q&&(W==="thead"?P.push(Q):W==="tfoot"?F.push(Q):M.push(Q))}return{head:P,body:M,foot:F}}l.parseHtml=d;function h(m,y,x,b,w,S){for(var L=new f.HtmlRowInput(b),j=0;j<b.cells.length;j++){var N=b.cells[j],E=x.getComputedStyle(N);if(w||E.display!=="none"){var P=void 0;S&&(P=(0,u.parseCss)(m,N,y,E,x)),L.push({rowSpan:N.rowSpan,colSpan:N.colSpan,styles:P,_element:N,content:v(N)})}}var M=x.getComputedStyle(b);if(L.length>0&&(w||M.display!=="none"))return L}function v(m){var y=m.cloneNode(!0);return y.innerHTML=y.innerHTML.replace(/\n/g,"").replace(/ +/g," "),y.innerHTML=y.innerHTML.split(/<br.*?>/).map(function(x){return x.trim()}).join(`
`),y.innerText||y.textContent||""}},776:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.parseInput=void 0;var u=c(4),f=c(356),d=c(420),h=c(744),v=c(792);function m(j,N){var E=new h.DocHandler(j),P=E.getDocumentOptions(),M=E.getGlobalOptions();(0,v.default)(E,M,P,N);var F=(0,f.assign)({},M,P,N),T;typeof window<"u"&&(T=window);var H=y(M,P,N),W=x(M,P,N),Q=b(E,F),V=S(E,F,T);return{id:N.tableId,content:V,hooks:W,styles:H,settings:Q}}l.parseInput=m;function y(j,N,E){for(var P={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},M=function(W){if(W==="columnStyles"){var Q=j[W],V=N[W],z=E[W];P.columnStyles=(0,f.assign)({},Q,V,z)}else{var X=[j,N,E],D=X.map(function(ne){return ne[W]||{}});P[W]=(0,f.assign)({},D[0],D[1],D[2])}},F=0,T=Object.keys(P);F<T.length;F++){var H=T[F];M(H)}return P}function x(j,N,E){for(var P=[j,N,E],M={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},F=0,T=P;F<T.length;F++){var H=T[F];H.didParseCell&&M.didParseCell.push(H.didParseCell),H.willDrawCell&&M.willDrawCell.push(H.willDrawCell),H.didDrawCell&&M.didDrawCell.push(H.didDrawCell),H.willDrawPage&&M.willDrawPage.push(H.willDrawPage),H.didDrawPage&&M.didDrawPage.push(H.didDrawPage)}return M}function b(j,N){var E,P,M,F,T,H,W,Q,V,z,X,D,ne=(0,d.parseSpacing)(N.margin,40/j.scaleFactor()),ge=(E=w(j,N.startY))!==null&&E!==void 0?E:ne.top,C;N.showFoot===!0?C="everyPage":N.showFoot===!1?C="never":C=(P=N.showFoot)!==null&&P!==void 0?P:"everyPage";var R;N.showHead===!0?R="everyPage":N.showHead===!1?R="never":R=(M=N.showHead)!==null&&M!==void 0?M:"everyPage";var B=(F=N.useCss)!==null&&F!==void 0?F:!1,U=N.theme||(B?"plain":"striped"),Y=!!N.horizontalPageBreak,ue=(T=N.horizontalPageBreakRepeat)!==null&&T!==void 0?T:null;return{includeHiddenHtml:(H=N.includeHiddenHtml)!==null&&H!==void 0?H:!1,useCss:B,theme:U,startY:ge,margin:ne,pageBreak:(W=N.pageBreak)!==null&&W!==void 0?W:"auto",rowPageBreak:(Q=N.rowPageBreak)!==null&&Q!==void 0?Q:"auto",tableWidth:(V=N.tableWidth)!==null&&V!==void 0?V:"auto",showHead:R,showFoot:C,tableLineWidth:(z=N.tableLineWidth)!==null&&z!==void 0?z:0,tableLineColor:(X=N.tableLineColor)!==null&&X!==void 0?X:200,horizontalPageBreak:Y,horizontalPageBreakRepeat:ue,horizontalPageBreakBehaviour:(D=N.horizontalPageBreakBehaviour)!==null&&D!==void 0?D:"afterAllRows"}}function w(j,N){var E=j.getLastAutoTable(),P=j.scaleFactor(),M=j.pageNumber(),F=!1;if(E&&E.startPageNumber){var T=E.startPageNumber+E.pageNumber-1;F=T===M}return typeof N=="number"?N:(N==null||N===!1)&&F&&(E==null?void 0:E.finalY)!=null?E.finalY+20/P:null}function S(j,N,E){var P=N.head||[],M=N.body||[],F=N.foot||[];if(N.html){var T=N.includeHiddenHtml;if(E){var H=(0,u.parseHtml)(j,N.html,E,T,N.useCss)||{};P=H.head||P,M=H.body||P,F=H.foot||P}else console.error("Cannot parse html in non browser environment")}var W=N.columns||L(P,M,F);return{columns:W,head:P,body:M,foot:F}}function L(j,N,E){var P=j[0]||N[0]||E[0]||[],M=[];return Object.keys(P).filter(function(F){return F!=="_element"}).forEach(function(F){var T=1,H;Array.isArray(P)?H=P[parseInt(F)]:H=P[F],typeof H=="object"&&!Array.isArray(H)&&(T=(H==null?void 0:H.colSpan)||1);for(var W=0;W<T;W++){var Q=void 0;Array.isArray(P)?Q=M.length:Q=F+(W>0?"_".concat(W):"");var V={dataKey:Q};M.push(V)}}),M}},792:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function c(f,d,h,v){for(var m=function(w){w&&typeof w!="object"&&console.error("The options parameter should be of type object, is: "+typeof w),typeof w.extendWidth<"u"&&(w.tableWidth=w.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof w.margins<"u"&&(typeof w.margin>"u"&&(w.margin=w.margins),console.error("Use of deprecated option: margins, use margin instead.")),w.startY&&typeof w.startY!="number"&&(console.error("Invalid value for startY option",w.startY),delete w.startY),!w.didDrawPage&&(w.afterPageContent||w.beforePageContent||w.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),w.didDrawPage=function(F){f.applyStyles(f.userStyles),w.beforePageContent&&w.beforePageContent(F),f.applyStyles(f.userStyles),w.afterPageContent&&w.afterPageContent(F),f.applyStyles(f.userStyles),w.afterPageAdd&&F.pageNumber>1&&F.afterPageAdd(F),f.applyStyles(f.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(F){w[F]&&console.error('The "'.concat(F,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(F){var T=F[0],H=F[1];w[H]&&(console.error("Use of deprecated option ".concat(H,". Use ").concat(T," instead")),w[T]=w[H])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(F){var T=typeof F=="string"?F:F[0],H=typeof F=="string"?F:F[1];typeof w[T]<"u"&&(typeof w.styles[H]>"u"&&(w.styles[H]=w[T]),console.error("Use of deprecated option: "+T+", use the style "+H+" instead."))});for(var S=0,L=["styles","bodyStyles","headStyles","footStyles"];S<L.length;S++){var j=L[S];u(w[j]||{})}for(var N=w.columnStyles||{},E=0,P=Object.keys(N);E<P.length;E++){var M=P[E];u(N[M]||{})}},y=0,x=[d,h,v];y<x.length;y++){var b=x[y];m(b)}}l.default=c;function u(f){f.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),f.minCellHeight||(f.minCellHeight=f.rowHeight)):f.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),f.cellWidth||(f.cellWidth=f.columnWidth))}},260:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.Column=l.Cell=l.Row=l.Table=void 0;var u=c(796),f=c(172),d=c(420),h=function(){function x(b,w){this.pageNumber=1,this.pageCount=1,this.id=b.id,this.settings=b.settings,this.styles=b.styles,this.hooks=b.hooks,this.columns=w.columns,this.head=w.head,this.body=w.body,this.foot=w.foot}return x.prototype.getHeadHeight=function(b){return this.head.reduce(function(w,S){return w+S.getMaxCellHeight(b)},0)},x.prototype.getFootHeight=function(b){return this.foot.reduce(function(w,S){return w+S.getMaxCellHeight(b)},0)},x.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},x.prototype.callCellHooks=function(b,w,S,L,j,N){for(var E=0,P=w;E<P.length;E++){var M=P[E],F=new f.CellHookData(b,this,S,L,j,N),T=M(F)===!1;if(S.text=Array.isArray(S.text)?S.text:[S.text],T)return!1}return!0},x.prototype.callEndPageHooks=function(b,w){b.applyStyles(b.userStyles);for(var S=0,L=this.hooks.didDrawPage;S<L.length;S++){var j=L[S];j(new f.HookData(b,this,w))}},x.prototype.callWillDrawPageHooks=function(b,w){for(var S=0,L=this.hooks.willDrawPage;S<L.length;S++){var j=L[S];j(new f.HookData(b,this,w))}},x.prototype.getWidth=function(b){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var w=this.columns.reduce(function(L,j){return L+j.wrappedWidth},0);return w}else{var S=this.settings.margin;return b-S.left-S.right}},x}();l.Table=h;var v=function(){function x(b,w,S,L,j){j===void 0&&(j=!1),this.height=0,this.raw=b,b instanceof u.HtmlRowInput&&(this.raw=b._element,this.element=b._element),this.index=w,this.section=S,this.cells=L,this.spansMultiplePages=j}return x.prototype.getMaxCellHeight=function(b){var w=this;return b.reduce(function(S,L){var j;return Math.max(S,((j=w.cells[L.index])===null||j===void 0?void 0:j.height)||0)},0)},x.prototype.hasRowSpan=function(b){var w=this;return b.filter(function(S){var L=w.cells[S.index];return L?L.rowSpan>1:!1}).length>0},x.prototype.canEntireRowFit=function(b,w){return this.getMaxCellHeight(w)<=b},x.prototype.getMinimumRowHeight=function(b,w){var S=this;return b.reduce(function(L,j){var N=S.cells[j.index];if(!N)return 0;var E=w.getLineHeight(N.styles.fontSize),P=N.padding("vertical"),M=P+E;return M>L?M:L},0)},x}();l.Row=v;var m=function(){function x(b,w,S){var L,j;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=w,this.section=S,this.raw=b;var N=b;b!=null&&typeof b=="object"&&!Array.isArray(b)?(this.rowSpan=b.rowSpan||1,this.colSpan=b.colSpan||1,N=(j=(L=b.content)!==null&&L!==void 0?L:b.title)!==null&&j!==void 0?j:b,b._element&&(this.raw=b._element)):(this.rowSpan=1,this.colSpan=1);var E=N!=null?""+N:"",P=/\r\n|\r|\n/g;this.text=E.split(P)}return x.prototype.getTextPos=function(){var b;if(this.styles.valign==="top")b=this.y+this.padding("top");else if(this.styles.valign==="bottom")b=this.y+this.height-this.padding("bottom");else{var w=this.height-this.padding("vertical");b=this.y+w/2+this.padding("top")}var S;if(this.styles.halign==="right")S=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var L=this.width-this.padding("horizontal");S=this.x+L/2+this.padding("left")}else S=this.x+this.padding("left");return{x:S,y:b}},x.prototype.getContentHeight=function(b,w){w===void 0&&(w=1.15);var S=Array.isArray(this.text)?this.text.length:1,L=this.styles.fontSize/b*w,j=S*L+this.padding("vertical");return Math.max(j,this.styles.minCellHeight)},x.prototype.padding=function(b){var w=(0,d.parseSpacing)(this.styles.cellPadding,0);return b==="vertical"?w.top+w.bottom:b==="horizontal"?w.left+w.right:w[b]},x}();l.Cell=m;var y=function(){function x(b,w,S){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=b,this.raw=w,this.index=S}return x.prototype.getMaxCustomCellWidth=function(b){for(var w=0,S=0,L=b.allRows();S<L.length;S++){var j=L[S],N=j.cells[this.index];N&&typeof N.styles.cellWidth=="number"&&(w=Math.max(w,N.styles.cellWidth))}return w},x}();l.Column=y},356:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.assign=void 0;function c(u,f,d,h,v){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var m=Object(u),y=1;y<arguments.length;y++){var x=arguments[y];if(x!=null)for(var b in x)Object.prototype.hasOwnProperty.call(x,b)&&(m[b]=x[b])}return m}l.assign=c},972:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.createTable=void 0;var u=c(744),f=c(260),d=c(324),h=c(796),v=c(356);function m(j,N){var E=new u.DocHandler(j),P=y(N,E.scaleFactor()),M=new f.Table(N,P);return(0,d.calculateWidths)(E,M),E.applyStyles(E.userStyles),M}l.createTable=m;function y(j,N){var E=j.content,P=S(E.columns);if(E.head.length===0){var M=b(P,"head");M&&E.head.push(M)}if(E.foot.length===0){var M=b(P,"foot");M&&E.foot.push(M)}var F=j.settings.theme,T=j.styles;return{columns:P,head:x("head",E.head,P,T,F,N),body:x("body",E.body,P,T,F,N),foot:x("foot",E.foot,P,T,F,N)}}function x(j,N,E,P,M,F){var T={},H=N.map(function(W,Q){for(var V=0,z={},X=0,D=0,ne=0,ge=E;ne<ge.length;ne++){var C=ge[ne];if(T[C.index]==null||T[C.index].left===0)if(D===0){var R=void 0;Array.isArray(W)?R=W[C.index-X-V]:R=W[C.dataKey];var B={};typeof R=="object"&&!Array.isArray(R)&&(B=(R==null?void 0:R.styles)||{});var U=L(j,C,Q,M,P,F,B),Y=new f.Cell(R,U,j);z[C.dataKey]=Y,z[C.index]=Y,D=Y.colSpan-1,T[C.index]={left:Y.rowSpan-1,times:D}}else D--,X++;else T[C.index].left--,D=T[C.index].times,V++}return new f.Row(W,Q,j,z)});return H}function b(j,N){var E={};return j.forEach(function(P){if(P.raw!=null){var M=w(N,P.raw);M!=null&&(E[P.dataKey]=M)}}),Object.keys(E).length>0?E:null}function w(j,N){if(j==="head"){if(typeof N=="object")return N.header||N.title||null;if(typeof N=="string"||typeof N=="number")return N}else if(j==="foot"&&typeof N=="object")return N.footer;return null}function S(j){return j.map(function(N,E){var P,M,F;return typeof N=="object"?F=(M=(P=N.dataKey)!==null&&P!==void 0?P:N.key)!==null&&M!==void 0?M:E:F=E,new f.Column(F,N,E)})}function L(j,N,E,P,M,F,T){var H=(0,h.getTheme)(P),W;j==="head"?W=M.headStyles:j==="body"?W=M.bodyStyles:j==="foot"&&(W=M.footStyles);var Q=(0,v.assign)({},H.table,H[j],M.styles,W),V=M.columnStyles[N.dataKey]||M.columnStyles[N.index]||{},z=j==="body"?V:{},X=j==="body"&&E%2===0?(0,v.assign)({},H.alternateRow,M.alternateRowStyles):{},D=(0,h.defaultStyles)(F),ne=(0,v.assign)({},D,Q,X,z);return(0,v.assign)(ne,T)}},664:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.addPage=l.drawTable=void 0;var u=c(420),f=c(260),d=c(744),h=c(356),v=c(136),m=c(224);function y(V,z){var X=z.settings,D=X.startY,ne=X.margin,ge={x:ne.left,y:D},C=z.getHeadHeight(z.columns)+z.getFootHeight(z.columns),R=D+ne.bottom+C;if(X.pageBreak==="avoid"){var B=z.body,U=B.reduce(function(pe,he){return pe+he.height},0);R+=U}var Y=new d.DocHandler(V);(X.pageBreak==="always"||X.startY!=null&&R>Y.pageSize().height)&&(Q(Y),ge.y=ne.top),z.callWillDrawPageHooks(Y,ge);var ue=(0,h.assign)({},ge);z.startPageNumber=Y.pageNumber(),X.horizontalPageBreak?x(Y,z,ue,ge):(Y.applyStyles(Y.userStyles),(X.showHead==="firstPage"||X.showHead==="everyPage")&&z.head.forEach(function(pe){return M(Y,z,pe,ge,z.columns)}),Y.applyStyles(Y.userStyles),z.body.forEach(function(pe,he){var ye=he===z.body.length-1;P(Y,z,pe,ye,ue,ge,z.columns)}),Y.applyStyles(Y.userStyles),(X.showFoot==="lastPage"||X.showFoot==="everyPage")&&z.foot.forEach(function(pe){return M(Y,z,pe,ge,z.columns)})),(0,u.addTableBorder)(Y,z,ue,ge),z.callEndPageHooks(Y,ge),z.finalY=ge.y,V.lastAutoTable=z,V.previousAutoTable=z,V.autoTable&&(V.autoTable.previous=z),Y.applyStyles(Y.userStyles)}l.drawTable=y;function x(V,z,X,D){var ne=(0,m.calculateAllColumnsCanFitInPage)(V,z),ge=z.settings;if(ge.horizontalPageBreakBehaviour==="afterAllRows")ne.forEach(function(U,Y){V.applyStyles(V.userStyles),Y>0?W(V,z,X,D,U.columns,!0):b(V,z,D,U.columns),w(V,z,X,D,U.columns),L(V,z,D,U.columns)});else for(var C=-1,R=ne[0],B=function(){var U=C;if(R){V.applyStyles(V.userStyles);var Y=R.columns;C>=0?W(V,z,X,D,Y,!0):b(V,z,D,Y),U=S(V,z,C+1,D,Y),L(V,z,D,Y)}var ue=U-C;ne.slice(1).forEach(function(pe){V.applyStyles(V.userStyles),W(V,z,X,D,pe.columns,!0),S(V,z,C+1,D,pe.columns,ue),L(V,z,D,pe.columns)}),C=U};C<z.body.length-1;)B()}function b(V,z,X,D){var ne=z.settings;V.applyStyles(V.userStyles),(ne.showHead==="firstPage"||ne.showHead==="everyPage")&&z.head.forEach(function(ge){return M(V,z,ge,X,D)})}function w(V,z,X,D,ne){V.applyStyles(V.userStyles),z.body.forEach(function(ge,C){var R=C===z.body.length-1;P(V,z,ge,R,X,D,ne)})}function S(V,z,X,D,ne,ge){V.applyStyles(V.userStyles),ge=ge??z.body.length;var C=Math.min(X+ge,z.body.length),R=-1;return z.body.slice(X,C).forEach(function(B,U){var Y=X+U===z.body.length-1,ue=H(V,z,Y,D);B.canEntireRowFit(ue,ne)&&(M(V,z,B,D,ne),R=X+U)}),R}function L(V,z,X,D){var ne=z.settings;V.applyStyles(V.userStyles),(ne.showFoot==="lastPage"||ne.showFoot==="everyPage")&&z.foot.forEach(function(ge){return M(V,z,ge,X,D)})}function j(V,z,X){var D=X.getLineHeight(V.styles.fontSize),ne=V.padding("vertical"),ge=Math.floor((z-ne)/D);return Math.max(0,ge)}function N(V,z,X,D){var ne={};V.spansMultiplePages=!0,V.height=0;for(var ge=0,C=0,R=X.columns;C<R.length;C++){var B=R[C],U=V.cells[B.index];if(U){Array.isArray(U.text)||(U.text=[U.text]);var Y=new f.Cell(U.raw,U.styles,U.section);Y=(0,h.assign)(Y,U),Y.text=[];var ue=j(U,z,D);U.text.length>ue&&(Y.text=U.text.splice(ue,U.text.length));var pe=D.scaleFactor(),he=D.getLineHeightFactor();U.contentHeight=U.getContentHeight(pe,he),U.contentHeight>=z&&(U.contentHeight=z,Y.styles.minCellHeight-=z),U.contentHeight>V.height&&(V.height=U.contentHeight),Y.contentHeight=Y.getContentHeight(pe,he),Y.contentHeight>ge&&(ge=Y.contentHeight),ne[B.index]=Y}}var ye=new f.Row(V.raw,-1,V.section,ne,!0);ye.height=ge;for(var Pe=0,re=X.columns;Pe<re.length;Pe++){var B=re[Pe],Y=ye.cells[B.index];Y&&(Y.height=ye.height);var U=V.cells[B.index];U&&(U.height=V.height)}return ye}function E(V,z,X,D){var ne=V.pageSize().height,ge=D.settings.margin,C=ge.top+ge.bottom,R=ne-C;z.section==="body"&&(R-=D.getHeadHeight(D.columns)+D.getFootHeight(D.columns));var B=z.getMinimumRowHeight(D.columns,V),U=B<X;if(B>R)return console.error("Will not be able to print row ".concat(z.index," correctly since it's minimum height is larger than page height")),!0;if(!U)return!1;var Y=z.hasRowSpan(D.columns),ue=z.getMaxCellHeight(D.columns)>R;return ue?(Y&&console.error("The content of row ".concat(z.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(Y||D.settings.rowPageBreak==="avoid")}function P(V,z,X,D,ne,ge,C){var R=H(V,z,D,ge);if(X.canEntireRowFit(R,C))M(V,z,X,ge,C);else if(E(V,X,R,z)){var B=N(X,R,z,V);M(V,z,X,ge,C),W(V,z,ne,ge,C),P(V,z,B,D,ne,ge,C)}else W(V,z,ne,ge,C),P(V,z,X,D,ne,ge,C)}function M(V,z,X,D,ne){D.x=z.settings.margin.left;for(var ge=0,C=ne;ge<C.length;ge++){var R=C[ge],B=X.cells[R.index];if(!B){D.x+=R.width;continue}V.applyStyles(B.styles),B.x=D.x,B.y=D.y;var U=z.callCellHooks(V,z.hooks.willDrawCell,B,X,R,D);if(U===!1){D.x+=R.width;continue}F(V,B,D);var Y=B.getTextPos();(0,v.default)(B.text,Y.x,Y.y,{halign:B.styles.halign,valign:B.styles.valign,maxWidth:Math.ceil(B.width-B.padding("left")-B.padding("right"))},V.getDocument()),z.callCellHooks(V,z.hooks.didDrawCell,B,X,R,D),D.x+=R.width}D.y+=X.height}function F(V,z,X){var D=z.styles;if(V.getDocument().setFillColor(V.getDocument().getFillColor()),typeof D.lineWidth=="number"){var ne=(0,u.getFillStyle)(D.lineWidth,D.fillColor);ne&&V.rect(z.x,X.y,z.width,z.height,ne)}else typeof D.lineWidth=="object"&&(D.fillColor&&V.rect(z.x,X.y,z.width,z.height,"F"),T(V,z,X,D.lineWidth))}function T(V,z,X,D){var ne,ge,C,R;D.top&&(ne=X.x,ge=X.y,C=X.x+z.width,R=X.y,D.right&&(C+=.5*D.right),D.left&&(ne-=.5*D.left),B(D.top,ne,ge,C,R)),D.bottom&&(ne=X.x,ge=X.y+z.height,C=X.x+z.width,R=X.y+z.height,D.right&&(C+=.5*D.right),D.left&&(ne-=.5*D.left),B(D.bottom,ne,ge,C,R)),D.left&&(ne=X.x,ge=X.y,C=X.x,R=X.y+z.height,D.top&&(ge-=.5*D.top),D.bottom&&(R+=.5*D.bottom),B(D.left,ne,ge,C,R)),D.right&&(ne=X.x+z.width,ge=X.y,C=X.x+z.width,R=X.y+z.height,D.top&&(ge-=.5*D.top),D.bottom&&(R+=.5*D.bottom),B(D.right,ne,ge,C,R));function B(U,Y,ue,pe,he){V.getDocument().setLineWidth(U),V.getDocument().line(Y,ue,pe,he,"S")}}function H(V,z,X,D){var ne=z.settings.margin.bottom,ge=z.settings.showFoot;return(ge==="everyPage"||ge==="lastPage"&&X)&&(ne+=z.getFootHeight(z.columns)),V.pageSize().height-D.y-ne}function W(V,z,X,D,ne,ge){ne===void 0&&(ne=[]),ge===void 0&&(ge=!1),V.applyStyles(V.userStyles),z.settings.showFoot==="everyPage"&&!ge&&z.foot.forEach(function(R){return M(V,z,R,D,ne)}),z.callEndPageHooks(V,D);var C=z.settings.margin;(0,u.addTableBorder)(V,z,X,D),Q(V),z.pageNumber++,z.pageCount++,D.x=C.left,D.y=C.top,X.y=C.top,z.callWillDrawPageHooks(V,D),z.settings.showHead==="everyPage"&&(z.head.forEach(function(R){return M(V,z,R,D,ne)}),V.applyStyles(V.userStyles))}l.addPage=W;function Q(V){var z=V.pageNumber();V.setPage(z+1);var X=V.pageNumber();return X===z?(V.addPage(),!0):!1}},224:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.calculateAllColumnsCanFitInPage=void 0;var u=c(420);function f(h,v,m){var y;m===void 0&&(m={});var x=(0,u.getPageAvailableWidth)(h,v),b=new Map,w=[],S=[],L=[];v.settings.horizontalPageBreakRepeat,Array.isArray(v.settings.horizontalPageBreakRepeat)?L=v.settings.horizontalPageBreakRepeat:(typeof v.settings.horizontalPageBreakRepeat=="string"||typeof v.settings.horizontalPageBreakRepeat=="number")&&(L=[v.settings.horizontalPageBreakRepeat]),L.forEach(function(P){var M=v.columns.find(function(F){return F.dataKey===P||F.index===P});M&&!b.has(M.index)&&(b.set(M.index,!0),w.push(M.index),S.push(v.columns[M.index]),x-=M.wrappedWidth)});for(var j=!0,N=(y=m==null?void 0:m.start)!==null&&y!==void 0?y:0;N<v.columns.length;){if(b.has(N)){N++;continue}var E=v.columns[N].wrappedWidth;if(j||x>=E)j=!1,w.push(N),S.push(v.columns[N]),x-=E;else break;N++}return{colIndexes:w,columns:S,lastIndex:N-1}}function d(h,v){for(var m=[],y=0;y<v.columns.length;y++){var x=f(h,v,{start:y});x.columns.length&&(m.push(x),y=x.lastIndex)}return m}l.calculateAllColumnsCanFitInPage=d},324:function(o,l,c){Object.defineProperty(l,"__esModule",{value:!0}),l.ellipsize=l.resizeColumns=l.calculateWidths=void 0;var u=c(420);function f(w,S){d(w,S);var L=[],j=0;S.columns.forEach(function(E){var P=E.getMaxCustomCellWidth(S);P?E.width=P:(E.width=E.wrappedWidth,L.push(E)),j+=E.width});var N=S.getWidth(w.pageSize().width)-j;N&&(N=h(L,N,function(E){return Math.max(E.minReadableWidth,E.minWidth)})),N&&(N=h(L,N,function(E){return E.minWidth})),N=Math.abs(N),!S.settings.horizontalPageBreak&&N>.1/w.scaleFactor()&&(N=N<1?N:Math.round(N),console.warn("Of the table content, ".concat(N," units width could not fit page"))),m(S),y(S,w),v(S)}l.calculateWidths=f;function d(w,S){var L=w.scaleFactor(),j=S.settings.horizontalPageBreak,N=(0,u.getPageAvailableWidth)(w,S);S.allRows().forEach(function(E){for(var P=0,M=S.columns;P<M.length;P++){var F=M[P],T=E.cells[F.index];if(T){var H=S.hooks.didParseCell;S.callCellHooks(w,H,T,E,F,null);var W=T.padding("horizontal");T.contentWidth=(0,u.getStringWidth)(T.text,T.styles,w)+W;var Q=(0,u.getStringWidth)(T.text.join(" ").split(/[^\S\u00A0]+/),T.styles,w);if(T.minReadableWidth=Q+T.padding("horizontal"),typeof T.styles.cellWidth=="number")T.minWidth=T.styles.cellWidth,T.wrappedWidth=T.styles.cellWidth;else if(T.styles.cellWidth==="wrap"||j===!0)T.contentWidth>N?(T.minWidth=N,T.wrappedWidth=N):(T.minWidth=T.contentWidth,T.wrappedWidth=T.contentWidth);else{var V=10/L;T.minWidth=T.styles.minCellWidth||V,T.wrappedWidth=T.contentWidth,T.minWidth>T.wrappedWidth&&(T.wrappedWidth=T.minWidth)}}}}),S.allRows().forEach(function(E){for(var P=0,M=S.columns;P<M.length;P++){var F=M[P],T=E.cells[F.index];if(T&&T.colSpan===1)F.wrappedWidth=Math.max(F.wrappedWidth,T.wrappedWidth),F.minWidth=Math.max(F.minWidth,T.minWidth),F.minReadableWidth=Math.max(F.minReadableWidth,T.minReadableWidth);else{var H=S.styles.columnStyles[F.dataKey]||S.styles.columnStyles[F.index]||{},W=H.cellWidth||H.minCellWidth;W&&typeof W=="number"&&(F.minWidth=W,F.wrappedWidth=W)}T&&(T.colSpan>1&&!F.minWidth&&(F.minWidth=T.minWidth),T.colSpan>1&&!F.wrappedWidth&&(F.wrappedWidth=T.minWidth))}})}function h(w,S,L){for(var j=S,N=w.reduce(function(V,z){return V+z.wrappedWidth},0),E=0;E<w.length;E++){var P=w[E],M=P.wrappedWidth/N,F=j*M,T=P.width+F,H=L(P),W=T<H?H:T;S-=W-P.width,P.width=W}if(S=Math.round(S*1e10)/1e10,S){var Q=w.filter(function(V){return S<0?V.width>L(V):!0});Q.length&&(S=h(Q,S,L))}return S}l.resizeColumns=h;function v(w){for(var S={},L=1,j=w.allRows(),N=0;N<j.length;N++)for(var E=j[N],P=0,M=w.columns;P<M.length;P++){var F=M[P],T=S[F.index];if(L>1)L--,delete E.cells[F.index];else if(T)T.cell.height+=E.height,L=T.cell.colSpan,delete E.cells[F.index],T.left--,T.left<=1&&delete S[F.index];else{var H=E.cells[F.index];if(!H)continue;if(H.height=E.height,H.rowSpan>1){var W=j.length-N,Q=H.rowSpan>W?W:H.rowSpan;S[F.index]={cell:H,left:Q,row:E}}}}}function m(w){for(var S=w.allRows(),L=0;L<S.length;L++)for(var j=S[L],N=null,E=0,P=0,M=0;M<w.columns.length;M++){var F=w.columns[M];if(P-=1,P>1&&w.columns[M+1])E+=F.width,delete j.cells[F.index];else if(N){var T=N;delete j.cells[F.index],N=null,T.width=F.width+E}else{var T=j.cells[F.index];if(!T)continue;if(P=T.colSpan,E=0,T.colSpan>1){N=T,E+=F.width;continue}T.width=F.width+E}}}function y(w,S){for(var L={count:0,height:0},j=0,N=w.allRows();j<N.length;j++){for(var E=N[j],P=0,M=w.columns;P<M.length;P++){var F=M[P],T=E.cells[F.index];if(T){S.applyStyles(T.styles,!0);var H=T.width-T.padding("horizontal");if(T.styles.overflow==="linebreak")T.text=S.splitTextToSize(T.text,H+1/S.scaleFactor(),{fontSize:T.styles.fontSize});else if(T.styles.overflow==="ellipsize")T.text=x(T.text,H,T.styles,S,"...");else if(T.styles.overflow==="hidden")T.text=x(T.text,H,T.styles,S,"");else if(typeof T.styles.overflow=="function"){var W=T.styles.overflow(T.text,H);typeof W=="string"?T.text=[W]:T.text=W}T.contentHeight=T.getContentHeight(S.scaleFactor(),S.getLineHeightFactor());var Q=T.contentHeight/T.rowSpan;T.rowSpan>1&&L.count*L.height<Q*T.rowSpan?L={height:Q,count:T.rowSpan}:L&&L.count>0&&L.height>Q&&(Q=L.height),Q>E.height&&(E.height=Q)}}L.count--}}function x(w,S,L,j,N){return w.map(function(E){return b(E,S,L,j,N)})}l.ellipsize=x;function b(w,S,L,j,N){var E=1e4*j.scaleFactor();if(S=Math.ceil(S*E)/E,S>=(0,u.getStringWidth)(w,L,j))return w;for(;S<(0,u.getStringWidth)(w+N,L,j)&&!(w.length<=1);)w=w.substring(0,w.length-1);return w.trim()+N}},964:function(o){if(typeof r>"u"){var l=new Error("Cannot find module 'undefined'");throw l.code="MODULE_NOT_FOUND",l}o.exports=r}},a={};function i(o){var l=a[o];if(l!==void 0)return l.exports;var c=a[o]={exports:{}};return n[o].call(c.exports,c,c.exports,i),c.exports}var s={};return function(){var o=s;Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=o.Column=o.Row=o.Table=o.CellHookData=o.__drawTable=o.__createTable=o.applyPlugin=void 0;var l=i(340),c=i(776),u=i(664),f=i(972),d=i(260);Object.defineProperty(o,"Table",{enumerable:!0,get:function(){return d.Table}});var h=i(172);Object.defineProperty(o,"CellHookData",{enumerable:!0,get:function(){return h.CellHookData}});var v=i(260);Object.defineProperty(o,"Cell",{enumerable:!0,get:function(){return v.Cell}}),Object.defineProperty(o,"Column",{enumerable:!0,get:function(){return v.Column}}),Object.defineProperty(o,"Row",{enumerable:!0,get:function(){return v.Row}});function m(S){(0,l.default)(S)}o.applyPlugin=m;function y(S,L){var j=(0,c.parseInput)(S,L),N=(0,f.createTable)(S,j);(0,u.drawTable)(S,N)}function x(S,L){var j=(0,c.parseInput)(S,L);return(0,f.createTable)(S,j)}o.__createTable=x;function b(S,L){(0,u.drawTable)(S,L)}o.__drawTable=b;try{var w=i(964);w.jsPDF&&(w=w.jsPDF),m(w)}catch{}o.default=y}(),s}()})})(o6);var dO=o6.exports;const hO=qd(dO);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var jp={};jp.version="0.18.5";var l6=1252,pO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Wy=function(e){pO.indexOf(e)!=-1&&(l6=zy[0]=e)};function gO(){Wy(1252)}var es=function(e){Wy(e)};function Hy(){es(1200),gO()}function B_(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function mO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function c6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ff=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?mO(e.slice(2)):t==254&&r==255?c6(e.slice(2)):t==65279?e.slice(1):e},C1=function(t){return String.fromCharCode(t)},U_=function(t){return String.fromCharCode(t)},nl,cl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Td(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=cl.charAt(i)+cl.charAt(s)+cl.charAt(o)+cl.charAt(l);return t}function li(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=cl.indexOf(e.charAt(c++)),s=cl.indexOf(e.charAt(c++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=cl.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=cl.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var $t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),So=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Sl(e){return $t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function z_(e){return $t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ti=function(t){return $t?So(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Fg(e){if(typeof ArrayBuffer>"u")return ti(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ml(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function vO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function $y(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return $y(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Fn=$t?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:So(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function xO(e){for(var t=[],r=0,n=e.length+250,a=Sl(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Sl(65535),n=65530)}return t.push(a.slice(0,r)),Fn(t)}var _a=/\u0000/g,Lf=/[\u0001-\u0006]/g;function r0(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ts(e,t){var r=""+e;return r.length>=t?r:Gr("0",t-r.length)+r}function Vy(e,t){var r=""+e;return r.length>=t?r:Gr(" ",t-r.length)+r}function Ip(e,t){var r=""+e;return r.length>=t?r:r+Gr(" ",t-r.length)}function yO(e,t){var r=""+Math.round(e);return r.length>=t?r:Gr("0",t-r.length)+r}function wO(e,t){var r=""+e;return r.length>=t?r:Gr("0",t-r.length)+r}var W_=Math.pow(2,32);function ku(e,t){if(e>W_||e<-W_)return yO(e,t);var r=Math.round(e);return wO(r,t)}function Dp(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var H_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ev=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},$_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},_O={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Op(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*s+i,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function cc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=CO(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var u6=new Date(1899,11,31,0,0,0),kO=u6.getTime(),SO=new Date(1900,2,1,0,0,0);function f6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=SO&&(r+=24*60*60*1e3),(r-(kO+(e.getTimezoneOffset()-u6.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function qy(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function EO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NO(e){var t=e<0?12:11,r=qy(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function AO(e){var t=qy(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Pd(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=NO(e):t===10?r=e.toFixed(10).substr(0,12):r=AO(e),qy(EO(r.toUpperCase()))}function Nc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Pd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Di(14,f6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function CO(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function TO(e,t,r,n){var a="",i=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Ev[r.m-1][1];case 5:return Ev[r.m-1][0];default:return Ev[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return H_[r.q][0];default:return H_[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ts(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=ts(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ts(l,c):"";return u}function ul(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var d6=/%/g;function PO(e,t,r){var n=t.replace(d6,""),a=t.length-n.length;return lo(e,n,r*Math.pow(10,2*a))+Gr("%",a)}function FO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return lo(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function h6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+h6(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var p6=/# (\?+)( ?)\/( ?)(\d+)/;function LO(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Gr(" ",e[1].length+1+e[4].length):Vy(s,e[1].length)+e[2]+"/"+e[3]+ts(o,e[4].length))}function jO(e,t,r){return r+(t===0?"":""+t)+Gr(" ",e[1].length+2+e[4].length)}var g6=/^#*0*\.([0#]+)/,m6=/\).*[0#]/,v6=/\(###\) ###\\?-####/;function va(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function V_(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function q_(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function IO(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function DO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function _i(e,t,r){if(e.charCodeAt(0)===40&&!t.match(m6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_i("n",n,r):"("+_i("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return FO(e,t,r);if(t.indexOf("%")!==-1)return PO(e,t,r);if(t.indexOf("E")!==-1)return h6(t,r);if(t.charCodeAt(0)===36)return"$"+_i(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ku(l,t.length);if(t.match(/^[#?]+$/))return a=ku(r,0),a==="0"&&(a=""),a.length>t.length?a:va(t.substr(0,t.length-a.length))+a;if(i=t.match(p6))return LO(i,l,c);if(t.match(/^#+0+$/))return c+ku(l,t.length-t.indexOf("0"));if(i=t.match(g6))return a=V_(r,i[1].length).replace(/^([^\.]+)$/,"$1."+va(i[1])).replace(/\.$/,"."+va(i[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+Gr("0",va(i[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+V_(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+ul(ku(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_i(e,t,-r):ul(""+(Math.floor(r)+IO(r,i[1].length)))+"."+ts(q_(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return _i(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=r0(_i(e,t.replace(/[\\-]/g,""),r)),s=0,r0(r0(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(t.match(v6))return a=_i(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Op(l,Math.pow(10,s)-1,!1),a=""+c,u=lo("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Ip(o[2],s),u.length<i[4].length&&(u=va(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Op(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Vy(o[1],s)+i[2]+"/"+i[3]+Ip(o[2],s):Gr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=ku(r,0),t.length<=a.length?a:va(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,d=t.length-a.length-f;return va(t.substr(0,f)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=q_(r,i[1].length),r<0?"-"+_i(e,t,-r):ul(DO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ts(0,3-v.length):"")+v})+"."+ts(s,i[1].length);switch(t){case"###,##0.00":return _i(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ul(ku(l,0));return h!=="0"?c+h:"";case"###,###.00":return _i(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return _i(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function OO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return lo(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function RO(e,t,r){var n=t.replace(d6,""),a=t.length-n.length;return lo(e,n,r*Math.pow(10,2*a))+Gr("%",a)}function x6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+x6(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function _s(e,t,r){if(e.charCodeAt(0)===40&&!t.match(m6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?_s("n",n,r):"("+_s("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return OO(e,t,r);if(t.indexOf("%")!==-1)return RO(e,t,r);if(t.indexOf("E")!==-1)return x6(t,r);if(t.charCodeAt(0)===36)return"$"+_s(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ts(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:va(t.substr(0,t.length-a.length))+a;if(i=t.match(p6))return jO(i,l,c);if(t.match(/^#+0+$/))return c+ts(l,t.length-t.indexOf("0"));if(i=t.match(g6))return a=(""+r).replace(/^([^\.]+)$/,"$1."+va(i[1])).replace(/\.$/,"."+va(i[1])),a=a.replace(/\.(\d*)$/,function(v,m){return"."+m+Gr("0",va(i[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+ul(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+_s(e,t,-r):ul(""+r)+"."+Gr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return _s(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=r0(_s(e,t.replace(/[\\-]/g,""),r)),s=0,r0(r0(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(t.match(v6))return a=_s(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Op(l,Math.pow(10,s)-1,!1),a=""+c,u=lo("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=Ip(o[2],s),u.length<i[4].length&&(u=va(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Op(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Vy(o[1],s)+i[2]+"/"+i[3]+Ip(o[2],s):Gr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:va(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,d=t.length-a.length-f;return va(t.substr(0,f)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+_s(e,t,-r):ul(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ts(0,3-v.length):"")+v})+"."+ts(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ul(""+l);return h!=="0"?c+h:"";default:if(t.match(/\.[0#?]*$/))return _s(e,t.slice(0,t.lastIndexOf(".")),r)+va(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function lo(e,t,r){return(r|0)===r?_s(e,t,r):_i(e,t,r)}function MO(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var y6=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function T0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Dp(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(y6))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function BO(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",c,u,f,d="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Dp(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),v=h==="("||h===")"?h:"t";a[a.length]={t:v,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=cc(t,r,e.charAt(s+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=cc(t,r),c==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=cc(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",s+=5,d="h"):e.substr(s,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",s+=5,d="h"):(m.t="t",++s),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(y6)){if(c==null&&(c=cc(t,r),c==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",T0(e)||(a[a.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var y=0,x=0,b;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=d,l="h",y<1&&(y=1);break;case"s":(b=a[s].v.match(/\.0+$/))&&(x=Math.max(x,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[s].v.match(/[Hh]/)&&(y=1),y<2&&a[s].v.match(/[Mm]/)&&(y=2),y<3&&a[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",S;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=TO(a[s].t.charCodeAt(0),a[s].v,c,x),a[s].t="t";break;case"n":case"?":for(S=s+1;a[S]!=null&&((o=a[S].t)==="?"||o==="D"||(o===" "||o==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[s].v+=a[S].v,a[S]={v:"",t:";"},++S;w+=a[s].v,s=S-1;break;case"G":a[s].t="t",a[s].v=Nc(t,r);break}var L="",j,N;if(w.length>0){w.charCodeAt(0)==40?(j=t<0&&w.charCodeAt(0)===45?-t:t,N=lo("n",w,j)):(j=t<0&&n>1?-t:t,N=lo("n",w,j),j<0&&a[0]&&a[0].t=="t"&&(N=N.substr(1),a[0].v="-"+a[0].v)),S=N.length-1;var E=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){E=s;break}var P=a.length;if(E===a.length&&N.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(S>=a[s].v.length-1?(S-=a[s].v.length,a[s].v=N.substr(S+1,a[s].v.length)):S<0?a[s].v="":(a[s].v=N.substr(0,S+1),S=-1),a[s].t="t",P=s);S>=0&&P<a.length&&(a[P].v=N.substr(0,S+1)+a[P].v)}else if(E!==a.length&&N.indexOf("E")===-1){for(S=N.indexOf(".")-1,s=E;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===E?a[s].v.indexOf(".")-1:a[s].v.length-1,L=a[s].v.substr(u+1);u>=0;--u)S>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(L=N.charAt(S--)+L);a[s].v=L,a[s].t="t",P=s}for(S>=0&&P<a.length&&(a[P].v=N.substr(0,S+1)+a[P].v),S=N.indexOf(".")+1,s=E;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==E)){for(u=a[s].v.indexOf(".")>-1&&s===E?a[s].v.indexOf(".")+1:0,L=a[s].v.substr(0,u);u<a[s].v.length;++u)S<N.length&&(L+=N.charAt(S++));a[s].v=L,a[s].t="t",P=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(j=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=lo(a[s].t,a[s].v,j),a[s].t="t");var M="";for(s=0;s!==a.length;++s)a[s]!=null&&(M+=a[s].v);return M}var G_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function X_(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function UO(e,t){var r=MO(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(G_),o=r[1].match(G_);return X_(t,s)?[n,r[0]]:X_(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Di(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Et)[e],n==null&&(n=r.table&&r.table[$_[e]]||Et[$_[e]]),n==null&&(n=_O[e]||"General");break}if(Dp(n,0))return Nc(t,r);t instanceof Date&&(t=f6(t,r.date1904));var a=UO(n,t);if(Dp(a[1]))return Nc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return BO(a[1],t,r,a[0])}function co(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Et[r]==null){t<0&&(t=r);continue}if(Et[r]==e){t=r;break}}t<0&&(t=391)}return Et[t]=e,t}function Lg(e){for(var t=0;t!=392;++t)e[t]!==void 0&&co(e[t],t)}function P0(){Et=bO()}var zO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},w6=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function WO(e){var t=typeof e=="number"?Et[e]:e;return t=t.replace(w6,"(\\d+)"),new RegExp("^"+t+"$")}function HO(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(w6)||[]).forEach(function(f,d){var h=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":l=h;break;case"m":s>=0?o=h:a=h;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&i==-1?u:c+"T"+u}var $O=function(){var e={};e.version="1.2.0";function t(){for(var N=0,E=new Array(256),P=0;P!=256;++P)N=P,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,E[P]=N;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(N){var E=0,P=0,M=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)F[M]=N[M];for(M=0;M!=256;++M)for(P=N[M],E=256+M;E<4096;E+=256)P=F[E]=P>>>8^N[P&255];var T=[];for(M=1;M!=16;++M)T[M-1]=typeof Int32Array<"u"?F.subarray(M*256,M*256+256):F.slice(M*256,M*256+256);return T}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],d=a[7],h=a[8],v=a[9],m=a[10],y=a[11],x=a[12],b=a[13],w=a[14];function S(N,E){for(var P=E^-1,M=0,F=N.length;M<F;)P=P>>>8^r[(P^N.charCodeAt(M++))&255];return~P}function L(N,E){for(var P=E^-1,M=N.length-15,F=0;F<M;)P=w[N[F++]^P&255]^b[N[F++]^P>>8&255]^x[N[F++]^P>>16&255]^y[N[F++]^P>>>24]^m[N[F++]]^v[N[F++]]^h[N[F++]]^d[N[F++]]^f[N[F++]]^u[N[F++]]^c[N[F++]]^l[N[F++]]^o[N[F++]]^s[N[F++]]^i[N[F++]]^r[N[F++]];for(M+=15;F<M;)P=P>>>8^r[(P^N[F++])&255];return~P}function j(N,E){for(var P=E^-1,M=0,F=N.length,T=0,H=0;M<F;)T=N.charCodeAt(M++),T<128?P=P>>>8^r[(P^T)&255]:T<2048?(P=P>>>8^r[(P^(192|T>>6&31))&255],P=P>>>8^r[(P^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,H=N.charCodeAt(M++)&1023,P=P>>>8^r[(P^(240|T>>8&7))&255],P=P>>>8^r[(P^(128|T>>2&63))&255],P=P>>>8^r[(P^(128|H>>6&15|(T&3)<<4))&255],P=P>>>8^r[(P^(128|H&63))&255]):(P=P>>>8^r[(P^(224|T>>12&15))&255],P=P>>>8^r[(P^(128|T>>6&63))&255],P=P>>>8^r[(P^(128|T&63))&255]);return~P}return e.table=r,e.bstr=S,e.buf=L,e.str=j,e}(),yt=function(){var t={};t.version="1.2.1";function r(J,ce){for(var ae=J.split("/"),ie=ce.split("/"),le=0,fe=0,Se=Math.min(ae.length,ie.length);le<Se;++le){if(fe=ae[le].length-ie[le].length)return fe;if(ae[le]!=ie[le])return ae[le]<ie[le]?-1:1}return ae.length-ie.length}function n(J){if(J.charAt(J.length-1)=="/")return J.slice(0,-1).indexOf("/")===-1?J:n(J.slice(0,-1));var ce=J.lastIndexOf("/");return ce===-1?J:J.slice(0,ce+1)}function a(J){if(J.charAt(J.length-1)=="/")return a(J.slice(0,-1));var ce=J.lastIndexOf("/");return ce===-1?J:J.slice(ce+1)}function i(J,ce){typeof ce=="string"&&(ce=new Date(ce));var ae=ce.getHours();ae=ae<<6|ce.getMinutes(),ae=ae<<5|ce.getSeconds()>>>1,J.write_shift(2,ae);var ie=ce.getFullYear()-1980;ie=ie<<4|ce.getMonth()+1,ie=ie<<5|ce.getDate(),J.write_shift(2,ie)}function s(J){var ce=J.read_shift(2)&65535,ae=J.read_shift(2)&65535,ie=new Date,le=ae&31;ae>>>=5;var fe=ae&15;ae>>>=4,ie.setMilliseconds(0),ie.setFullYear(ae+1980),ie.setMonth(fe-1),ie.setDate(le);var Se=ce&31;ce>>>=5;var Fe=ce&63;return ce>>>=6,ie.setHours(ce),ie.setMinutes(Fe),ie.setSeconds(Se<<1),ie}function o(J){Un(J,0);for(var ce={},ae=0;J.l<=J.length-4;){var ie=J.read_shift(2),le=J.read_shift(2),fe=J.l+le,Se={};switch(ie){case 21589:ae=J.read_shift(1),ae&1&&(Se.mtime=J.read_shift(4)),le>5&&(ae&2&&(Se.atime=J.read_shift(4)),ae&4&&(Se.ctime=J.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}J.l=fe,ce[ie]=Se}return ce}var l;function c(){return l||(l={})}function u(J,ce){if(J[0]==80&&J[1]==75)return Ar(J,ce);if((J[0]|32)==109&&(J[1]|32)==105)return hi(J,ce);if(J.length<512)throw new Error("CFB file size "+J.length+" < 512");var ae=3,ie=512,le=0,fe=0,Se=0,Fe=0,ke=0,Ae=[],Te=J.slice(0,512);Un(Te,0);var Ve=f(Te);switch(ae=Ve[0],ae){case 3:ie=512;break;case 4:ie=4096;break;case 0:if(Ve[1]==0)return Ar(J,ce);default:throw new Error("Major Version: Expected 3 or 4 saw "+ae)}ie!==512&&(Te=J.slice(0,ie),Un(Te,28));var Je=J.slice(0,ie);d(Te,ae);var ot=Te.read_shift(4,"i");if(ae===3&&ot!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ot);Te.l+=4,Se=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Fe=Te.read_shift(4,"i"),le=Te.read_shift(4,"i"),ke=Te.read_shift(4,"i"),fe=Te.read_shift(4,"i");for(var Xe=-1,st=0;st<109&&(Xe=Te.read_shift(4,"i"),!(Xe<0));++st)Ae[st]=Xe;var Pt=h(J,ie);y(ke,fe,Pt,ie,Ae);var sr=b(Pt,Se,Ae,ie);sr[Se].name="!Directory",le>0&&Fe!==H&&(sr[Fe].name="!MiniFAT"),sr[Ae[0]].name="!FAT",sr.fat_addrs=Ae,sr.ssz=ie;var gr={},ln=[],Mi=[],Ws=[];w(Se,sr,Pt,ln,le,gr,Mi,Fe),v(Mi,Ws,ln),ln.shift();var ds={FileIndex:Mi,FullPaths:Ws};return ce&&ce.raw&&(ds.raw={header:Je,sectors:Pt}),ds}function f(J){if(J[J.l]==80&&J[J.l+1]==75)return[0,0];J.chk(W,"Header Signature: "),J.l+=16;var ce=J.read_shift(2,"u");return[J.read_shift(2,"u"),ce]}function d(J,ce){var ae=9;switch(J.l+=2,ae=J.read_shift(2)){case 9:if(ce!=3)throw new Error("Sector Shift: Expected 9 saw "+ae);break;case 12:if(ce!=4)throw new Error("Sector Shift: Expected 12 saw "+ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ae)}J.chk("0600","Mini Sector Shift: "),J.chk("000000000000","Reserved: ")}function h(J,ce){for(var ae=Math.ceil(J.length/ce)-1,ie=[],le=1;le<ae;++le)ie[le-1]=J.slice(le*ce,(le+1)*ce);return ie[ae-1]=J.slice(ae*ce),ie}function v(J,ce,ae){for(var ie=0,le=0,fe=0,Se=0,Fe=0,ke=ae.length,Ae=[],Te=[];ie<ke;++ie)Ae[ie]=Te[ie]=ie,ce[ie]=ae[ie];for(;Fe<Te.length;++Fe)ie=Te[Fe],le=J[ie].L,fe=J[ie].R,Se=J[ie].C,Ae[ie]===ie&&(le!==-1&&Ae[le]!==le&&(Ae[ie]=Ae[le]),fe!==-1&&Ae[fe]!==fe&&(Ae[ie]=Ae[fe])),Se!==-1&&(Ae[Se]=ie),le!==-1&&ie!=Ae[ie]&&(Ae[le]=Ae[ie],Te.lastIndexOf(le)<Fe&&Te.push(le)),fe!==-1&&ie!=Ae[ie]&&(Ae[fe]=Ae[ie],Te.lastIndexOf(fe)<Fe&&Te.push(fe));for(ie=1;ie<ke;++ie)Ae[ie]===ie&&(fe!==-1&&Ae[fe]!==fe?Ae[ie]=Ae[fe]:le!==-1&&Ae[le]!==le&&(Ae[ie]=Ae[le]));for(ie=1;ie<ke;++ie)if(J[ie].type!==0){if(Fe=ie,Fe!=Ae[Fe])do Fe=Ae[Fe],ce[ie]=ce[Fe]+"/"+ce[ie];while(Fe!==0&&Ae[Fe]!==-1&&Fe!=Ae[Fe]);Ae[ie]=-1}for(ce[0]+="/",ie=1;ie<ke;++ie)J[ie].type!==2&&(ce[ie]+="/")}function m(J,ce,ae){for(var ie=J.start,le=J.size,fe=[],Se=ie;ae&&le>0&&Se>=0;)fe.push(ce.slice(Se*T,Se*T+T)),le-=T,Se=ac(ae,Se*4);return fe.length===0?Ie(0):Fn(fe).slice(0,J.size)}function y(J,ce,ae,ie,le){var fe=H;if(J===H){if(ce!==0)throw new Error("DIFAT chain shorter than expected")}else if(J!==-1){var Se=ae[J],Fe=(ie>>>2)-1;if(!Se)return;for(var ke=0;ke<Fe&&(fe=ac(Se,ke*4))!==H;++ke)le.push(fe);y(ac(Se,ie-4),ce-1,ae,ie,le)}}function x(J,ce,ae,ie,le){var fe=[],Se=[];le||(le=[]);var Fe=ie-1,ke=0,Ae=0;for(ke=ce;ke>=0;){le[ke]=!0,fe[fe.length]=ke,Se.push(J[ke]);var Te=ae[Math.floor(ke*4/ie)];if(Ae=ke*4&Fe,ie<4+Ae)throw new Error("FAT boundary crossed: "+ke+" 4 "+ie);if(!J[Te])break;ke=ac(J[Te],Ae)}return{nodes:fe,data:s4([Se])}}function b(J,ce,ae,ie){var le=J.length,fe=[],Se=[],Fe=[],ke=[],Ae=ie-1,Te=0,Ve=0,Je=0,ot=0;for(Te=0;Te<le;++Te)if(Fe=[],Je=Te+ce,Je>=le&&(Je-=le),!Se[Je]){ke=[];var Xe=[];for(Ve=Je;Ve>=0;){Xe[Ve]=!0,Se[Ve]=!0,Fe[Fe.length]=Ve,ke.push(J[Ve]);var st=ae[Math.floor(Ve*4/ie)];if(ot=Ve*4&Ae,ie<4+ot)throw new Error("FAT boundary crossed: "+Ve+" 4 "+ie);if(!J[st]||(Ve=ac(J[st],ot),Xe[Ve]))break}fe[Je]={nodes:Fe,data:s4([ke])}}return fe}function w(J,ce,ae,ie,le,fe,Se,Fe){for(var ke=0,Ae=ie.length?2:0,Te=ce[J].data,Ve=0,Je=0,ot;Ve<Te.length;Ve+=128){var Xe=Te.slice(Ve,Ve+128);Un(Xe,64),Je=Xe.read_shift(2),ot=Qy(Xe,0,Je-Ae),ie.push(ot);var st={name:ot,type:Xe.read_shift(1),color:Xe.read_shift(1),L:Xe.read_shift(4,"i"),R:Xe.read_shift(4,"i"),C:Xe.read_shift(4,"i"),clsid:Xe.read_shift(16),state:Xe.read_shift(4,"i"),start:0,size:0},Pt=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);Pt!==0&&(st.ct=S(Xe,Xe.l-8));var sr=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);sr!==0&&(st.mt=S(Xe,Xe.l-8)),st.start=Xe.read_shift(4,"i"),st.size=Xe.read_shift(4,"i"),st.size<0&&st.start<0&&(st.size=st.type=0,st.start=H,st.name=""),st.type===5?(ke=st.start,le>0&&ke!==H&&(ce[ke].name="!StreamData")):st.size>=4096?(st.storage="fat",ce[st.start]===void 0&&(ce[st.start]=x(ae,st.start,ce.fat_addrs,ce.ssz)),ce[st.start].name=st.name,st.content=ce[st.start].data.slice(0,st.size)):(st.storage="minifat",st.size<0?st.size=0:ke!==H&&st.start!==H&&ce[ke]&&(st.content=m(st,ce[ke].data,(ce[Fe]||{}).data))),st.content&&Un(st.content,0),fe[ot]=st,Se.push(st)}}function S(J,ce){return new Date((Qa(J,ce+4)/1e7*Math.pow(2,32)+Qa(J,ce)/1e7-11644473600)*1e3)}function L(J,ce){return c(),u(l.readFileSync(J),ce)}function j(J,ce){var ae=ce&&ce.type;switch(ae||$t&&Buffer.isBuffer(J)&&(ae="buffer"),ae||"base64"){case"file":return L(J,ce);case"base64":return u(ti(li(J)),ce);case"binary":return u(ti(J),ce)}return u(J,ce)}function N(J,ce){var ae=ce||{},ie=ae.root||"Root Entry";if(J.FullPaths||(J.FullPaths=[]),J.FileIndex||(J.FileIndex=[]),J.FullPaths.length!==J.FileIndex.length)throw new Error("inconsistent CFB structure");J.FullPaths.length===0&&(J.FullPaths[0]=ie+"/",J.FileIndex[0]={name:ie,type:5}),ae.CLSID&&(J.FileIndex[0].clsid=ae.CLSID),E(J)}function E(J){var ce="Sh33tJ5";if(!yt.find(J,"/"+ce)){var ae=Ie(4);ae[0]=55,ae[1]=ae[3]=50,ae[2]=54,J.FileIndex.push({name:ce,type:2,content:ae,size:4,L:69,R:69,C:69}),J.FullPaths.push(J.FullPaths[0]+ce),P(J)}}function P(J,ce){N(J);for(var ae=!1,ie=!1,le=J.FullPaths.length-1;le>=0;--le){var fe=J.FileIndex[le];switch(fe.type){case 0:ie?ae=!0:(J.FileIndex.pop(),J.FullPaths.pop());break;case 1:case 2:case 5:ie=!0,isNaN(fe.R*fe.L*fe.C)&&(ae=!0),fe.R>-1&&fe.L>-1&&fe.R==fe.L&&(ae=!0);break;default:ae=!0;break}}if(!(!ae&&!ce)){var Se=new Date(1987,1,19),Fe=0,ke=Object.create?Object.create(null):{},Ae=[];for(le=0;le<J.FullPaths.length;++le)ke[J.FullPaths[le]]=!0,J.FileIndex[le].type!==0&&Ae.push([J.FullPaths[le],J.FileIndex[le]]);for(le=0;le<Ae.length;++le){var Te=n(Ae[le][0]);ie=ke[Te],ie||(Ae.push([Te,{name:a(Te).replace("/",""),type:1,clsid:V,ct:Se,mt:Se,content:null}]),ke[Te]=!0)}for(Ae.sort(function(ot,Xe){return r(ot[0],Xe[0])}),J.FullPaths=[],J.FileIndex=[],le=0;le<Ae.length;++le)J.FullPaths[le]=Ae[le][0],J.FileIndex[le]=Ae[le][1];for(le=0;le<Ae.length;++le){var Ve=J.FileIndex[le],Je=J.FullPaths[le];if(Ve.name=a(Je).replace("/",""),Ve.L=Ve.R=Ve.C=-(Ve.color=1),Ve.size=Ve.content?Ve.content.length:0,Ve.start=0,Ve.clsid=Ve.clsid||V,le===0)Ve.C=Ae.length>1?1:-1,Ve.size=0,Ve.type=5;else if(Je.slice(-1)=="/"){for(Fe=le+1;Fe<Ae.length&&n(J.FullPaths[Fe])!=Je;++Fe);for(Ve.C=Fe>=Ae.length?-1:Fe,Fe=le+1;Fe<Ae.length&&n(J.FullPaths[Fe])!=n(Je);++Fe);Ve.R=Fe>=Ae.length?-1:Fe,Ve.type=1}else n(J.FullPaths[le+1]||"")==n(Je)&&(Ve.R=le+1),Ve.type=2}}}function M(J,ce){var ae=ce||{};if(ae.fileType=="mad")return bt(J,ae);switch(P(J),ae.fileType){case"zip":return Ri(J,ae)}var ie=function(ot){for(var Xe=0,st=0,Pt=0;Pt<ot.FileIndex.length;++Pt){var sr=ot.FileIndex[Pt];if(sr.content){var gr=sr.content.length;gr>0&&(gr<4096?Xe+=gr+63>>6:st+=gr+511>>9)}}for(var ln=ot.FullPaths.length+3>>2,Mi=Xe+7>>3,Ws=Xe+127>>7,ds=Mi+st+ln+Ws,Bi=ds+127>>7,hs=Bi<=109?0:Math.ceil((Bi-109)/127);ds+Bi+hs+127>>7>Bi;)hs=++Bi<=109?0:Math.ceil((Bi-109)/127);var Va=[1,hs,Bi,Ws,ln,st,Xe,0];return ot.FileIndex[0].size=Xe<<6,Va[7]=(ot.FileIndex[0].start=Va[0]+Va[1]+Va[2]+Va[3]+Va[4]+Va[5])+(Va[6]+7>>3),Va}(J),le=Ie(ie[7]<<9),fe=0,Se=0;{for(fe=0;fe<8;++fe)le.write_shift(1,Q[fe]);for(fe=0;fe<8;++fe)le.write_shift(2,0);for(le.write_shift(2,62),le.write_shift(2,3),le.write_shift(2,65534),le.write_shift(2,9),le.write_shift(2,6),fe=0;fe<3;++fe)le.write_shift(2,0);for(le.write_shift(4,0),le.write_shift(4,ie[2]),le.write_shift(4,ie[0]+ie[1]+ie[2]+ie[3]-1),le.write_shift(4,0),le.write_shift(4,4096),le.write_shift(4,ie[3]?ie[0]+ie[1]+ie[2]-1:H),le.write_shift(4,ie[3]),le.write_shift(-4,ie[1]?ie[0]-1:H),le.write_shift(4,ie[1]),fe=0;fe<109;++fe)le.write_shift(-4,fe<ie[2]?ie[1]+fe:-1)}if(ie[1])for(Se=0;Se<ie[1];++Se){for(;fe<236+Se*127;++fe)le.write_shift(-4,fe<ie[2]?ie[1]+fe:-1);le.write_shift(-4,Se===ie[1]-1?H:Se+1)}var Fe=function(ot){for(Se+=ot;fe<Se-1;++fe)le.write_shift(-4,fe+1);ot&&(++fe,le.write_shift(-4,H))};for(Se=fe=0,Se+=ie[1];fe<Se;++fe)le.write_shift(-4,z.DIFSECT);for(Se+=ie[2];fe<Se;++fe)le.write_shift(-4,z.FATSECT);Fe(ie[3]),Fe(ie[4]);for(var ke=0,Ae=0,Te=J.FileIndex[0];ke<J.FileIndex.length;++ke)Te=J.FileIndex[ke],Te.content&&(Ae=Te.content.length,!(Ae<4096)&&(Te.start=Se,Fe(Ae+511>>9)));for(Fe(ie[6]+7>>3);le.l&511;)le.write_shift(-4,z.ENDOFCHAIN);for(Se=fe=0,ke=0;ke<J.FileIndex.length;++ke)Te=J.FileIndex[ke],Te.content&&(Ae=Te.content.length,!(!Ae||Ae>=4096)&&(Te.start=Se,Fe(Ae+63>>6)));for(;le.l&511;)le.write_shift(-4,z.ENDOFCHAIN);for(fe=0;fe<ie[4]<<2;++fe){var Ve=J.FullPaths[fe];if(!Ve||Ve.length===0){for(ke=0;ke<17;++ke)le.write_shift(4,0);for(ke=0;ke<3;++ke)le.write_shift(4,-1);for(ke=0;ke<12;++ke)le.write_shift(4,0);continue}Te=J.FileIndex[fe],fe===0&&(Te.start=Te.size?Te.start-1:H);var Je=fe===0&&ae.root||Te.name;if(Ae=2*(Je.length+1),le.write_shift(64,Je,"utf16le"),le.write_shift(2,Ae),le.write_shift(1,Te.type),le.write_shift(1,Te.color),le.write_shift(-4,Te.L),le.write_shift(-4,Te.R),le.write_shift(-4,Te.C),Te.clsid)le.write_shift(16,Te.clsid,"hex");else for(ke=0;ke<4;++ke)le.write_shift(4,0);le.write_shift(4,Te.state||0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,Te.start),le.write_shift(4,Te.size),le.write_shift(4,0)}for(fe=1;fe<J.FileIndex.length;++fe)if(Te=J.FileIndex[fe],Te.size>=4096)if(le.l=Te.start+1<<9,$t&&Buffer.isBuffer(Te.content))Te.content.copy(le,le.l,0,Te.size),le.l+=Te.size+511&-512;else{for(ke=0;ke<Te.size;++ke)le.write_shift(1,Te.content[ke]);for(;ke&511;++ke)le.write_shift(1,0)}for(fe=1;fe<J.FileIndex.length;++fe)if(Te=J.FileIndex[fe],Te.size>0&&Te.size<4096)if($t&&Buffer.isBuffer(Te.content))Te.content.copy(le,le.l,0,Te.size),le.l+=Te.size+63&-64;else{for(ke=0;ke<Te.size;++ke)le.write_shift(1,Te.content[ke]);for(;ke&63;++ke)le.write_shift(1,0)}if($t)le.l=le.length;else for(;le.l<le.length;)le.write_shift(1,0);return le}function F(J,ce){var ae=J.FullPaths.map(function(ke){return ke.toUpperCase()}),ie=ae.map(function(ke){var Ae=ke.split("/");return Ae[Ae.length-(ke.slice(-1)=="/"?2:1)]}),le=!1;ce.charCodeAt(0)===47?(le=!0,ce=ae[0].slice(0,-1)+ce):le=ce.indexOf("/")!==-1;var fe=ce.toUpperCase(),Se=le===!0?ae.indexOf(fe):ie.indexOf(fe);if(Se!==-1)return J.FileIndex[Se];var Fe=!fe.match(Lf);for(fe=fe.replace(_a,""),Fe&&(fe=fe.replace(Lf,"!")),Se=0;Se<ae.length;++Se)if((Fe?ae[Se].replace(Lf,"!"):ae[Se]).replace(_a,"")==fe||(Fe?ie[Se].replace(Lf,"!"):ie[Se]).replace(_a,"")==fe)return J.FileIndex[Se];return null}var T=64,H=-2,W="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],V="00000000000000000000000000000000",z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:V,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function X(J,ce,ae){c();var ie=M(J,ae);l.writeFileSync(ce,ie)}function D(J){for(var ce=new Array(J.length),ae=0;ae<J.length;++ae)ce[ae]=String.fromCharCode(J[ae]);return ce.join("")}function ne(J,ce){var ae=M(J,ce);switch(ce&&ce.type||"buffer"){case"file":return c(),l.writeFileSync(ce.filename,ae),ae;case"binary":return typeof ae=="string"?ae:D(ae);case"base64":return Td(typeof ae=="string"?ae:D(ae));case"buffer":if($t)return Buffer.isBuffer(ae)?ae:So(ae);case"array":return typeof ae=="string"?ti(ae):ae}return ae}var ge;function C(J){try{var ce=J.InflateRaw,ae=new ce;if(ae._processChunk(new Uint8Array([3,0]),ae._finishFlushFlag),ae.bytesRead)ge=J;else throw new Error("zlib does not expose bytesRead")}catch(ie){console.error("cannot use native zlib: "+(ie.message||ie))}}function R(J,ce){if(!ge)return Jt(J,ce);var ae=ge.InflateRaw,ie=new ae,le=ie._processChunk(J.slice(J.l),ie._finishFlushFlag);return J.l+=ie.bytesRead,le}function B(J){return ge?ge.deflateRawSync(J):at(J)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(J){var ce=(J<<1|J<<11)&139536|(J<<5|J<<15)&558144;return(ce>>16|ce>>8|ce)&255}for(var he=typeof Uint8Array<"u",ye=he?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)ye[Pe]=pe(Pe);function re(J,ce){var ae=ye[J&255];return ce<=8?ae>>>8-ce:(ae=ae<<8|ye[J>>8&255],ce<=16?ae>>>16-ce:(ae=ae<<8|ye[J>>16&255],ae>>>24-ce))}function Ue(J,ce){var ae=ce&7,ie=ce>>>3;return(J[ie]|(ae<=6?0:J[ie+1]<<8))>>>ae&3}function Ye(J,ce){var ae=ce&7,ie=ce>>>3;return(J[ie]|(ae<=5?0:J[ie+1]<<8))>>>ae&7}function Ce(J,ce){var ae=ce&7,ie=ce>>>3;return(J[ie]|(ae<=4?0:J[ie+1]<<8))>>>ae&15}function oe(J,ce){var ae=ce&7,ie=ce>>>3;return(J[ie]|(ae<=3?0:J[ie+1]<<8))>>>ae&31}function De(J,ce){var ae=ce&7,ie=ce>>>3;return(J[ie]|(ae<=1?0:J[ie+1]<<8))>>>ae&127}function Qe(J,ce,ae){var ie=ce&7,le=ce>>>3,fe=(1<<ae)-1,Se=J[le]>>>ie;return ae<8-ie||(Se|=J[le+1]<<8-ie,ae<16-ie)||(Se|=J[le+2]<<16-ie,ae<24-ie)||(Se|=J[le+3]<<24-ie),Se&fe}function Be(J,ce,ae){var ie=ce&7,le=ce>>>3;return ie<=5?J[le]|=(ae&7)<<ie:(J[le]|=ae<<ie&255,J[le+1]=(ae&7)>>8-ie),ce+3}function Ke(J,ce,ae){var ie=ce&7,le=ce>>>3;return ae=(ae&1)<<ie,J[le]|=ae,ce+1}function tt(J,ce,ae){var ie=ce&7,le=ce>>>3;return ae<<=ie,J[le]|=ae&255,ae>>>=8,J[le+1]=ae,ce+8}function rt(J,ce,ae){var ie=ce&7,le=ce>>>3;return ae<<=ie,J[le]|=ae&255,ae>>>=8,J[le+1]=ae&255,J[le+2]=ae>>>8,ce+16}function ht(J,ce){var ae=J.length,ie=2*ae>ce?2*ae:ce+5,le=0;if(ae>=ce)return J;if($t){var fe=z_(ie);if(J.copy)J.copy(fe);else for(;le<J.length;++le)fe[le]=J[le];return fe}else if(he){var Se=new Uint8Array(ie);if(Se.set)Se.set(J);else for(;le<ae;++le)Se[le]=J[le];return Se}return J.length=ie,J}function gt(J){for(var ce=new Array(J),ae=0;ae<J;++ae)ce[ae]=0;return ce}function St(J,ce,ae){var ie=1,le=0,fe=0,Se=0,Fe=0,ke=J.length,Ae=he?new Uint16Array(32):gt(32);for(fe=0;fe<32;++fe)Ae[fe]=0;for(fe=ke;fe<ae;++fe)J[fe]=0;ke=J.length;var Te=he?new Uint16Array(ke):gt(ke);for(fe=0;fe<ke;++fe)Ae[le=J[fe]]++,ie<le&&(ie=le),Te[fe]=0;for(Ae[0]=0,fe=1;fe<=ie;++fe)Ae[fe+16]=Fe=Fe+Ae[fe-1]<<1;for(fe=0;fe<ke;++fe)Fe=J[fe],Fe!=0&&(Te[fe]=Ae[Fe+16]++);var Ve=0;for(fe=0;fe<ke;++fe)if(Ve=J[fe],Ve!=0)for(Fe=re(Te[fe],ie)>>ie-Ve,Se=(1<<ie+4-Ve)-1;Se>=0;--Se)ce[Fe|Se<<Ve]=Ve&15|fe<<4;return ie}var Tt=he?new Uint16Array(512):gt(512),Ht=he?new Uint16Array(32):gt(32);if(!he){for(var It=0;It<512;++It)Tt[It]=0;for(It=0;It<32;++It)Ht[It]=0}(function(){for(var J=[],ce=0;ce<32;ce++)J.push(5);St(J,Ht,32);var ae=[];for(ce=0;ce<=143;ce++)ae.push(8);for(;ce<=255;ce++)ae.push(9);for(;ce<=279;ce++)ae.push(7);for(;ce<=287;ce++)ae.push(8);St(ae,Tt,288)})();var mt=function(){for(var ce=he?new Uint8Array(32768):[],ae=0,ie=0;ae<ue.length-1;++ae)for(;ie<ue[ae+1];++ie)ce[ie]=ae;for(;ie<32768;++ie)ce[ie]=29;var le=he?new Uint8Array(259):[];for(ae=0,ie=0;ae<Y.length-1;++ae)for(;ie<Y[ae+1];++ie)le[ie]=ae;function fe(Fe,ke){for(var Ae=0;Ae<Fe.length;){var Te=Math.min(65535,Fe.length-Ae),Ve=Ae+Te==Fe.length;for(ke.write_shift(1,+Ve),ke.write_shift(2,Te),ke.write_shift(2,~Te&65535);Te-- >0;)ke[ke.l++]=Fe[Ae++]}return ke.l}function Se(Fe,ke){for(var Ae=0,Te=0,Ve=he?new Uint16Array(32768):[];Te<Fe.length;){var Je=Math.min(65535,Fe.length-Te);if(Je<10){for(Ae=Be(ke,Ae,+(Te+Je==Fe.length)),Ae&7&&(Ae+=8-(Ae&7)),ke.l=Ae/8|0,ke.write_shift(2,Je),ke.write_shift(2,~Je&65535);Je-- >0;)ke[ke.l++]=Fe[Te++];Ae=ke.l*8;continue}Ae=Be(ke,Ae,+(Te+Je==Fe.length)+2);for(var ot=0;Je-- >0;){var Xe=Fe[Te];ot=(ot<<5^Xe)&32767;var st=-1,Pt=0;if((st=Ve[ot])&&(st|=Te&-32768,st>Te&&(st-=32768),st<Te))for(;Fe[st+Pt]==Fe[Te+Pt]&&Pt<250;)++Pt;if(Pt>2){Xe=le[Pt],Xe<=22?Ae=tt(ke,Ae,ye[Xe+1]>>1)-1:(tt(ke,Ae,3),Ae+=5,tt(ke,Ae,ye[Xe-23]>>5),Ae+=3);var sr=Xe<8?0:Xe-4>>2;sr>0&&(rt(ke,Ae,Pt-Y[Xe]),Ae+=sr),Xe=ce[Te-st],Ae=tt(ke,Ae,ye[Xe]>>3),Ae-=3;var gr=Xe<4?0:Xe-2>>1;gr>0&&(rt(ke,Ae,Te-st-ue[Xe]),Ae+=gr);for(var ln=0;ln<Pt;++ln)Ve[ot]=Te&32767,ot=(ot<<5^Fe[Te])&32767,++Te;Je-=Pt-1}else Xe<=143?Xe=Xe+48:Ae=Ke(ke,Ae,1),Ae=tt(ke,Ae,ye[Xe]),Ve[ot]=Te&32767,++Te}Ae=tt(ke,Ae,0)-1}return ke.l=(Ae+7)/8|0,ke.l}return function(ke,Ae){return ke.length<8?fe(ke,Ae):Se(ke,Ae)}}();function at(J){var ce=Ie(50+Math.floor(J.length*1.1)),ae=mt(J,ce);return ce.slice(0,ae)}var qe=he?new Uint16Array(32768):gt(32768),or=he?new Uint16Array(32768):gt(32768),wt=he?new Uint16Array(128):gt(128),vn=1,ir=1;function _r(J,ce){var ae=oe(J,ce)+257;ce+=5;var ie=oe(J,ce)+1;ce+=5;var le=Ce(J,ce)+4;ce+=4;for(var fe=0,Se=he?new Uint8Array(19):gt(19),Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,Ae=he?new Uint8Array(8):gt(8),Te=he?new Uint8Array(8):gt(8),Ve=Se.length,Je=0;Je<le;++Je)Se[U[Je]]=fe=Ye(J,ce),ke<fe&&(ke=fe),Ae[fe]++,ce+=3;var ot=0;for(Ae[0]=0,Je=1;Je<=ke;++Je)Te[Je]=ot=ot+Ae[Je-1]<<1;for(Je=0;Je<Ve;++Je)(ot=Se[Je])!=0&&(Fe[Je]=Te[ot]++);var Xe=0;for(Je=0;Je<Ve;++Je)if(Xe=Se[Je],Xe!=0){ot=ye[Fe[Je]]>>8-Xe;for(var st=(1<<7-Xe)-1;st>=0;--st)wt[ot|st<<Xe]=Xe&7|Je<<3}var Pt=[];for(ke=1;Pt.length<ae+ie;)switch(ot=wt[De(J,ce)],ce+=ot&7,ot>>>=3){case 16:for(fe=3+Ue(J,ce),ce+=2,ot=Pt[Pt.length-1];fe-- >0;)Pt.push(ot);break;case 17:for(fe=3+Ye(J,ce),ce+=3;fe-- >0;)Pt.push(0);break;case 18:for(fe=11+De(J,ce),ce+=7;fe-- >0;)Pt.push(0);break;default:Pt.push(ot),ke<ot&&(ke=ot);break}var sr=Pt.slice(0,ae),gr=Pt.slice(ae);for(Je=ae;Je<286;++Je)sr[Je]=0;for(Je=ie;Je<30;++Je)gr[Je]=0;return vn=St(sr,qe,286),ir=St(gr,or,30),ce}function fi(J,ce){if(J[0]==3&&!(J[1]&3))return[Sl(ce),2];for(var ae=0,ie=0,le=z_(ce||1<<18),fe=0,Se=le.length>>>0,Fe=0,ke=0;!(ie&1);){if(ie=Ye(J,ae),ae+=3,ie>>>1)ie>>1==1?(Fe=9,ke=5):(ae=_r(J,ae),Fe=vn,ke=ir);else{ae&7&&(ae+=8-(ae&7));var Ae=J[ae>>>3]|J[(ae>>>3)+1]<<8;if(ae+=32,Ae>0)for(!ce&&Se<fe+Ae&&(le=ht(le,fe+Ae),Se=le.length);Ae-- >0;)le[fe++]=J[ae>>>3],ae+=8;continue}for(;;){!ce&&Se<fe+32767&&(le=ht(le,fe+32767),Se=le.length);var Te=Qe(J,ae,Fe),Ve=ie>>>1==1?Tt[Te]:qe[Te];if(ae+=Ve&15,Ve>>>=4,!(Ve>>>8&255))le[fe++]=Ve;else{if(Ve==256)break;Ve-=257;var Je=Ve<8?0:Ve-4>>2;Je>5&&(Je=0);var ot=fe+Y[Ve];Je>0&&(ot+=Qe(J,ae,Je),ae+=Je),Te=Qe(J,ae,ke),Ve=ie>>>1==1?Ht[Te]:or[Te],ae+=Ve&15,Ve>>>=4;var Xe=Ve<4?0:Ve-2>>1,st=ue[Ve];for(Xe>0&&(st+=Qe(J,ae,Xe),ae+=Xe),!ce&&Se<ot&&(le=ht(le,ot+100),Se=le.length);fe<ot;)le[fe]=le[fe-st],++fe}}}return ce?[le,ae+7>>>3]:[le.slice(0,fe),ae+7>>>3]}function Jt(J,ce){var ae=J.slice(J.l||0),ie=fi(ae,ce);return J.l+=ie[1],ie[0]}function fs(J,ce){if(J)typeof console<"u"&&console.error(ce);else throw new Error(ce)}function Ar(J,ce){var ae=J;Un(ae,0);var ie=[],le=[],fe={FileIndex:ie,FullPaths:le};N(fe,{root:ce.root});for(var Se=ae.length-4;(ae[Se]!=80||ae[Se+1]!=75||ae[Se+2]!=5||ae[Se+3]!=6)&&Se>=0;)--Se;ae.l=Se+4,ae.l+=4;var Fe=ae.read_shift(2);ae.l+=6;var ke=ae.read_shift(4);for(ae.l=ke,Se=0;Se<Fe;++Se){ae.l+=20;var Ae=ae.read_shift(4),Te=ae.read_shift(4),Ve=ae.read_shift(2),Je=ae.read_shift(2),ot=ae.read_shift(2);ae.l+=8;var Xe=ae.read_shift(4),st=o(ae.slice(ae.l+Ve,ae.l+Ve+Je));ae.l+=Ve+Je+ot;var Pt=ae.l;ae.l=Xe+4,Ha(ae,Ae,Te,fe,st),ae.l=Pt}return fe}function Ha(J,ce,ae,ie,le){J.l+=2;var fe=J.read_shift(2),Se=J.read_shift(2),Fe=s(J);if(fe&8257)throw new Error("Unsupported ZIP encryption");for(var ke=J.read_shift(4),Ae=J.read_shift(4),Te=J.read_shift(4),Ve=J.read_shift(2),Je=J.read_shift(2),ot="",Xe=0;Xe<Ve;++Xe)ot+=String.fromCharCode(J[J.l++]);if(Je){var st=o(J.slice(J.l,J.l+Je));(st[21589]||{}).mt&&(Fe=st[21589].mt),((le||{})[21589]||{}).mt&&(Fe=le[21589].mt)}J.l+=Je;var Pt=J.slice(J.l,J.l+Ae);switch(Se){case 8:Pt=R(J,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var sr=!1;fe&8&&(ke=J.read_shift(4),ke==134695760&&(ke=J.read_shift(4),sr=!0),Ae=J.read_shift(4),Te=J.read_shift(4)),Ae!=ce&&fs(sr,"Bad compressed size: "+ce+" != "+Ae),Te!=ae&&fs(sr,"Bad uncompressed size: "+ae+" != "+Te),Na(ie,ot,Pt,{unsafe:!0,mt:Fe})}function Ri(J,ce){var ae=ce||{},ie=[],le=[],fe=Ie(1),Se=ae.compression?8:0,Fe=0,ke=0,Ae=0,Te=0,Ve=0,Je=J.FullPaths[0],ot=Je,Xe=J.FileIndex[0],st=[],Pt=0;for(ke=1;ke<J.FullPaths.length;++ke)if(ot=J.FullPaths[ke].slice(Je.length),Xe=J.FileIndex[ke],!(!Xe.size||!Xe.content||ot=="Sh33tJ5")){var sr=Te,gr=Ie(ot.length);for(Ae=0;Ae<ot.length;++Ae)gr.write_shift(1,ot.charCodeAt(Ae)&127);gr=gr.slice(0,gr.l),st[Ve]=$O.buf(Xe.content,0);var ln=Xe.content;Se==8&&(ln=B(ln)),fe=Ie(30),fe.write_shift(4,67324752),fe.write_shift(2,20),fe.write_shift(2,Fe),fe.write_shift(2,Se),Xe.mt?i(fe,Xe.mt):fe.write_shift(4,0),fe.write_shift(-4,st[Ve]),fe.write_shift(4,ln.length),fe.write_shift(4,Xe.content.length),fe.write_shift(2,gr.length),fe.write_shift(2,0),Te+=fe.length,ie.push(fe),Te+=gr.length,ie.push(gr),Te+=ln.length,ie.push(ln),fe=Ie(46),fe.write_shift(4,33639248),fe.write_shift(2,0),fe.write_shift(2,20),fe.write_shift(2,Fe),fe.write_shift(2,Se),fe.write_shift(4,0),fe.write_shift(-4,st[Ve]),fe.write_shift(4,ln.length),fe.write_shift(4,Xe.content.length),fe.write_shift(2,gr.length),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(4,0),fe.write_shift(4,sr),Pt+=fe.l,le.push(fe),Pt+=gr.length,le.push(gr),++Ve}return fe=Ie(22),fe.write_shift(4,101010256),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,Ve),fe.write_shift(2,Ve),fe.write_shift(4,Pt),fe.write_shift(4,Te),fe.write_shift(2,0),Fn([Fn(ie),Fn(le),fe])}var xr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ft(J,ce){if(J.ctype)return J.ctype;var ae=J.name||"",ie=ae.match(/\.([^\.]+)$/);return ie&&xr[ie[1]]||ce&&(ie=(ae=ce).match(/[\.\\]([^\.\\])+$/),ie&&xr[ie[1]])?xr[ie[1]]:"application/octet-stream"}function rr(J){for(var ce=Td(J),ae=[],ie=0;ie<ce.length;ie+=76)ae.push(ce.slice(ie,ie+76));return ae.join(`\r
`)+`\r
`}function zs(J){var ce=J.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var Te=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});ce=ce.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ce.charAt(0)==`
`&&(ce="=0D"+ce.slice(1)),ce=ce.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ae=[],ie=ce.split(`\r
`),le=0;le<ie.length;++le){var fe=ie[le];if(fe.length==0){ae.push("");continue}for(var Se=0;Se<fe.length;){var Fe=76,ke=fe.slice(Se,Se+Fe);ke.charAt(Fe-1)=="="?Fe--:ke.charAt(Fe-2)=="="?Fe-=2:ke.charAt(Fe-3)=="="&&(Fe-=3),ke=fe.slice(Se,Se+Fe),Se+=Fe,Se<fe.length&&(ke+="="),ae.push(ke)}}return ae.join(`\r
`)}function xn(J){for(var ce=[],ae=0;ae<J.length;++ae){for(var ie=J[ae];ae<=J.length&&ie.charAt(ie.length-1)=="=";)ie=ie.slice(0,ie.length-1)+J[++ae];ce.push(ie)}for(var le=0;le<ce.length;++le)ce[le]=ce[le].replace(/[=][0-9A-Fa-f]{2}/g,function(fe){return String.fromCharCode(parseInt(fe.slice(1),16))});return ti(ce.join(`\r
`))}function di(J,ce,ae){for(var ie="",le="",fe="",Se,Fe=0;Fe<10;++Fe){var ke=ce[Fe];if(!ke||ke.match(/^\s*$/))break;var Ae=ke.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":ie=Ae[2].trim();break;case"content-type":fe=Ae[2].trim();break;case"content-transfer-encoding":le=Ae[2].trim();break}}switch(++Fe,le.toLowerCase()){case"base64":Se=ti(li(ce.slice(Fe).join("")));break;case"quoted-printable":Se=xn(ce.slice(Fe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+le)}var Te=Na(J,ie.slice(ae.length),Se,{unsafe:!0});fe&&(Te.ctype=fe)}function hi(J,ce){if(D(J.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ae=ce&&ce.root||"",ie=($t&&Buffer.isBuffer(J)?J.toString("binary"):D(J)).split(`\r
`),le=0,fe="";for(le=0;le<ie.length;++le)if(fe=ie[le],!!/^Content-Location:/i.test(fe)&&(fe=fe.slice(fe.indexOf("file")),ae||(ae=fe.slice(0,fe.lastIndexOf("/")+1)),fe.slice(0,ae.length)!=ae))for(;ae.length>0&&(ae=ae.slice(0,ae.length-1),ae=ae.slice(0,ae.lastIndexOf("/")+1),fe.slice(0,ae.length)!=ae););var Se=(ie[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Fe="--"+(Se[1]||""),ke=[],Ae=[],Te={FileIndex:ke,FullPaths:Ae};N(Te);var Ve,Je=0;for(le=0;le<ie.length;++le){var ot=ie[le];ot!==Fe&&ot!==Fe+"--"||(Je++&&di(Te,ie.slice(Ve,le),ae),Ve=le)}return Te}function bt(J,ce){var ae=ce||{},ie=ae.boundary||"SheetJS";ie="------="+ie;for(var le=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ie.slice(2)+'"',"","",""],fe=J.FullPaths[0],Se=fe,Fe=J.FileIndex[0],ke=1;ke<J.FullPaths.length;++ke)if(Se=J.FullPaths[ke].slice(fe.length),Fe=J.FileIndex[ke],!(!Fe.size||!Fe.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pt){return"_x"+Pt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pt){return"_u"+Pt.charCodeAt(0).toString(16)+"_"});for(var Ae=Fe.content,Te=$t&&Buffer.isBuffer(Ae)?Ae.toString("binary"):D(Ae),Ve=0,Je=Math.min(1024,Te.length),ot=0,Xe=0;Xe<=Je;++Xe)(ot=Te.charCodeAt(Xe))>=32&&ot<128&&++Ve;var st=Ve>=Je*4/5;le.push(ie),le.push("Content-Location: "+(ae.root||"file:///C:/SheetJS/")+Se),le.push("Content-Transfer-Encoding: "+(st?"quoted-printable":"base64")),le.push("Content-Type: "+Ft(Fe,Se)),le.push(""),le.push(st?zs(Te):rr(Te))}return le.push(ie+`--\r
`),le.join(`\r
`)}function $a(J){var ce={};return N(ce,J),ce}function Na(J,ce,ae,ie){var le=ie&&ie.unsafe;le||N(J);var fe=!le&&yt.find(J,ce);if(!fe){var Se=J.FullPaths[0];ce.slice(0,Se.length)==Se?Se=ce:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+ce).replace("//","/")),fe={name:a(ce),type:2},J.FileIndex.push(fe),J.FullPaths.push(Se),le||yt.utils.cfb_gc(J)}return fe.content=ae,fe.size=ae?ae.length:0,ie&&(ie.CLSID&&(fe.clsid=ie.CLSID),ie.mt&&(fe.mt=ie.mt),ie.ct&&(fe.ct=ie.ct)),fe}function Vn(J,ce){N(J);var ae=yt.find(J,ce);if(ae){for(var ie=0;ie<J.FileIndex.length;++ie)if(J.FileIndex[ie]==ae)return J.FileIndex.splice(ie,1),J.FullPaths.splice(ie,1),!0}return!1}function Yr(J,ce,ae){N(J);var ie=yt.find(J,ce);if(ie){for(var le=0;le<J.FileIndex.length;++le)if(J.FileIndex[le]==ie)return J.FileIndex[le].name=a(ae),J.FullPaths[le]=ae,!0}return!1}function Wr(J){P(J,!0)}return t.find=F,t.read=j,t.parse=u,t.write=ne,t.writeFile=X,t.utils={cfb_new:$a,cfb_add:Na,cfb_del:Vn,cfb_mov:Yr,cfb_gc:Wr,ReadShift:Zf,CheckField:H6,prep_blob:Un,bconcat:Fn,use_zlib:C,_deflateRaw:at,_inflateRaw:Jt,consts:z},t}();function VO(e){return typeof e=="string"?Fg(e):Array.isArray(e)?vO(e):e}function nh(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Fg(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Cs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([VO(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ml(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function qO(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Kr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function K_(e,t){for(var r=[],n=Kr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function jg(e){for(var t=[],r=Kr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Ig(e){for(var t=[],r=Kr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function GO(e){for(var t=[],r=Kr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Rp=new Date(1899,11,30,0,0,0);function Sn(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Rp.getTime()+(e.getTimezoneOffset()-Rp.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var b6=new Date,XO=Rp.getTime()+(b6.getTimezoneOffset()-Rp.getTimezoneOffset())*6e4,Y_=b6.getTimezoneOffset();function Dg(e){var t=new Date;return t.setTime(e*24*60*60*1e3+XO),t.getTimezoneOffset()!==Y_&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Y_)*6e4),t}function KO(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var J_=new Date("2017-02-19T19:06:09.000Z"),_6=isNaN(J_.getFullYear())?new Date("2/19/17"):J_,YO=_6.getFullYear()==2017;function jr(e,t){var r=new Date(e);if(YO)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(_6.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ac(e,t){if($t&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Cs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Cs(c6(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Cs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Cs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ir(e[r]));return t}function Gr(e,t){for(var r="";r.length<t;)r+=e;return r}function as(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var JO=["january","february","march","april","may","june","july","august","september","october","november","december"];function v0(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&JO.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var ZO=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function k6(e){return e?e.content&&e.type?Ac(e.content,!0):e.data?Ff(e.data):e.asNodeBuffer&&$t?Ff(e.asNodeBuffer().toString("binary")):e.asBinary?Ff(e.asBinary()):e._data&&e._data.getContent?Ff(Ac(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function S6(e){if(!e)return null;if(e.data)return B_(e.data);if(e.asNodeBuffer&&$t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?B_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function QO(e){return e&&e.name.slice(-4)===".bin"?S6(e):k6(e)}function Ei(e,t){for(var r=e.FullPaths||Kr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Gy(e,t){var r=Ei(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function hn(e,t,r){if(!r)return QO(Gy(e,t));if(!t)return null;try{return hn(e,t)}catch{return null}}function ri(e,t,r){if(!r)return k6(Gy(e,t));if(!t)return null;try{return ri(e,t)}catch{return null}}function E6(e,t,r){if(!r)return S6(Gy(e,t));if(!t)return null;try{return E6(e,t)}catch{return null}}function Z_(e){for(var t=e.FullPaths||Kr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Wt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return $t?n=So(r):n=xO(r),yt.utils.cfb_add(e,t,n)}yt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Xy(){return yt.utils.cfb_new()}function N6(e,t){switch(t.type){case"base64":return yt.read(e,{type:"base64"});case"binary":return yt.read(e,{type:"binary"});case"buffer":case"array":return yt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function jf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var on=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Q_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tR=/<[^>]*>/g,da=on.match(Q_)?Q_:tR,rR=/<\w*:/,nR=/<(\/?)\w+:/;function Ct(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(eR),o=0,l="",c=0,u="",f="",d=1;if(s)for(c=0;c!=s.length;++c){for(f=s[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(d=(a=f.charCodeAt(i+1))==34||a==39?1:0,l=f.slice(i+1+d,f.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var h=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[h]&&u.slice(o-3,o)=="ext")continue;n[h]=l,r||(n[h.toLowerCase()]=l)}}return n}function Ms(e){return e.replace(nR,"<$1")}var A6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ky=jg(A6),er=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,l){return A6[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),Yy=/[&<>'"]/g,aR=/[\u0000-\u0008\u000b-\u001f]/g;function hr(e){var t=e+"";return t.replace(Yy,function(r){return Ky[r]}).replace(aR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function e4(e){return hr(e).replace(/ /g,"_x0020_")}var C6=/[\u0000-\u001f]/g;function Jy(e){var t=e+"";return t.replace(Yy,function(r){return Ky[r]}).replace(/\n/g,"<br/>").replace(C6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function iR(e){var t=e+"";return t.replace(Yy,function(r){return Ky[r]}).replace(C6,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var t4=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function sR(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Pr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nv(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function r4(e){var t=Sl(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function n4(e){return So(e,"binary").toString("utf8")}var T1="foo bar baz",vr=$t&&(n4(T1)==Nv(T1)&&n4||r4(T1)==Nv(T1)&&r4)||Nv,Cs=$t?function(e){return So(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Fd=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),T6=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),oR=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),lR=/<\/?(?:vt:)?variant>/g,cR=/<(?:vt:)([^>]*)>([\s\S]*)</;function a4(e,t){var r=Ct(e),n=e.match(oR(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(lR,"").match(cR);s&&a.push({v:vr(s[2]),t:s[1]})}),a}var P6=/(^\s|\s$|\n)/;function zn(e,t){return"<"+e+(t.match(P6)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ld(e){return Kr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ze(e,t,r){return"<"+e+(r!=null?Ld(r):"")+(t!=null?(t.match(P6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function g2(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function uR(e,t){switch(typeof e){case"string":var r=Ze("vt:lpwstr",hr(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Ze((e|0)==e?"vt:i4":"vt:r8",hr(String(e)));case"boolean":return Ze("vt:bool",e?"true":"false")}if(e instanceof Date)return Ze("vt:filetime",g2(e));throw new Error("Unable to serialize "+e)}function Zy(e){if($t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return vr(Ml($y(e)));throw new Error("Bad input format: expected Buffer or string")}var jd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_n={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Uc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Za={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function fR(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function dR(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var i4=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},s4=$t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:So(t)})):i4(e)}:i4,o4=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(so(e,a)));return n.join("").replace(_a,"")},Qy=$t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(_a,""):o4(e,t,r)}:o4,l4=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},F6=$t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):l4(e,t,r)}:l4,c4=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ju(e,a)));return n.join("")},ah=$t?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):c4(t,r,n)}:c4,L6=function(e,t){var r=Qa(e,t);return r>0?ah(e,t+4,t+4+r-1):""},j6=L6,I6=function(e,t){var r=Qa(e,t);return r>0?ah(e,t+4,t+4+r-1):""},D6=I6,O6=function(e,t){var r=2*Qa(e,t);return r>0?ah(e,t+4,t+4+r-1):""},R6=O6,M6=function(t,r){var n=Qa(t,r);return n>0?Qy(t,r+4,r+4+n):""},B6=M6,U6=function(e,t){var r=Qa(e,t);return r>0?ah(e,t+4,t+4+r):""},z6=U6,W6=function(e,t){return fR(e,t)},Mp=W6,ew=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};$t&&(j6=function(t,r){if(!Buffer.isBuffer(t))return L6(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},D6=function(t,r){if(!Buffer.isBuffer(t))return I6(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},R6=function(t,r){if(!Buffer.isBuffer(t))return O6(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},B6=function(t,r){if(!Buffer.isBuffer(t))return M6(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},z6=function(t,r){if(!Buffer.isBuffer(t))return U6(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Mp=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):W6(t,r)},ew=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ju=function(e,t){return e[t]},so=function(e,t){return e[t+1]*256+e[t]},hR=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ac=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},pR=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Zf(e,t){var r="",n,a,i=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,$t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(so(this,c)),c+=2;e*=2;break;case"utf8":r=ah(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Qy(this,this.l,this.l+e);break;case"wstr":return Zf.call(this,e,"dbcs");case"lpstr-ansi":r=j6(this,this.l),e=4+Qa(this,this.l);break;case"lpstr-cp":r=D6(this,this.l),e=4+Qa(this,this.l);break;case"lpwstr":r=R6(this,this.l),e=4+2*Qa(this,this.l);break;case"lpp4":e=4+Qa(this,this.l),r=B6(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qa(this,this.l),r=z6(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=ju(this,this.l+e++))!==0;)i.push(C1(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=so(this,this.l+e))!==0;)i.push(C1(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=ju(this,c),this.l=c+1,o=Zf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(C1(so(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=ju(this,c),this.l=c+1,o=Zf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(C1(ju(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=ju(this,this.l),this.l++,n;case 2:return n=(t==="i"?hR:so)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ac:pR)(this,this.l),this.l+=4,n):(a=Qa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Mp(this,this.l):a=Mp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=F6(this,this.l,e);break}}return this.l+=e,r}var gR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},mR=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},vR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function xR(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)vR(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,gR(this,t,this.l);break;case 8:if(n=8,r==="f"){dR(this,t,this.l);break}case 16:break;case-4:n=4,mR(this,t,this.l);break}return this.l+=n,this}function H6(e,t){var r=F6(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Un(e,t){e.l=t,e.read_shift=Zf,e.chk=H6,e.write_shift=xR}function ua(e,t){e.l+=t}function Ie(e){var t=Sl(e);return Un(t,0),t}function Eo(e,t,r){if(e){var n,a,i;Un(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=Bd[o]||Bd[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,o))return}}}function Ua(){var e=[],t=$t?256:2048,r=function(c){var u=Ie(c);return Un(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},s=function(){return a(),Fn(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function ze(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Bd[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&ew(r)&&e.push(r)}}function Qf(e,t,r){var n=Ir(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function u4(e,t,r){var n=Ir(e);return n.s=Qf(n.s,t.s,r),n.e=Qf(n.e,t.s,r),n}function ed(e,t){if(e.cRel&&e.c<0)for(e=Ir(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ir(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=At(e);return!e.cRel&&e.cRel!=null&&(r=bR(r)),!e.rRel&&e.rRel!=null&&(r=yR(r)),r}function Av(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mr(e.s.c)+":"+(e.e.cRel?"":"$")+Mr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+sn(e.s.r)+":"+(e.e.rRel?"":"$")+sn(e.e.r):ed(e.s,t.biff)+":"+ed(e.e,t.biff)}function tw(e){return parseInt(wR(e),10)-1}function sn(e){return""+(e+1)}function yR(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function wR(e){return e.replace(/\$(\d+)$/,"$1")}function rw(e){for(var t=_R(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Mr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function bR(e){return e.replace(/^([A-Z])/,"$$$1")}function _R(e){return e.replace(/^\$([A-Z])/,"$1")}function kR(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Br(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function At(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function za(e){var t=e.indexOf(":");return t==-1?{s:Br(e),e:Br(e)}:{s:Br(e.slice(0,t)),e:Br(e.slice(t+1))}}function Bt(e,t){return typeof t>"u"||typeof t=="number"?Bt(e.s,e.e):(typeof e!="string"&&(e=At(e)),typeof t!="string"&&(t=At(t)),e==t?e:e+":"+t)}function tr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function f4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Di(e.z,r?Sn(t):t)}catch{}try{return e.w=Di((e.XF||{}).numFmtId||(r?14:0),r?Sn(t):t)}catch{return""+t}}function xo(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?No[e.v]||e.v:t==null?f4(e,e.v):f4(e,t))}function Bl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function $6(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Br(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=tr(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[f].length;++d)if(!(typeof t[f][d]>"u")){var h={v:t[f][d]},v=s+f,m=o+d;if(c.s.r>v&&(c.s.r=v),c.s.c>m&&(c.s.c=m),c.e.r<v&&(c.e.r=v),c.e.c<m&&(c.e.c=m),t[f][d]&&typeof t[f][d]=="object"&&!Array.isArray(t[f][d])&&!(t[f][d]instanceof Date))h=t[f][d];else if(Array.isArray(h.v)&&(h.f=t[f][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Et[14],n.cellDates?(h.t="d",h.w=Di(h.z,Sn(h.v))):(h.t="n",h.v=Sn(h.v),h.w=Di(h.z,h.v))):h.t="s";if(a)i[v]||(i[v]=[]),i[v][m]&&i[v][m].z&&(h.z=i[v][m].z),i[v][m]=h;else{var y=At({c:m,r:v});i[y]&&i[y].z&&(h.z=i[y].z),i[y]=h}}}return c.s.c<1e7&&(i["!ref"]=Bt(c)),i}function F0(e,t){return $6(null,e,t)}function SR(e){return e.read_shift(4,"i")}function is(e,t){return t||(t=Ie(4)),t.write_shift(4,e),t}function oa(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function jn(e,t){var r=!1;return t==null&&(r=!0,t=Ie(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function ER(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function NR(e,t){return t||(t=Ie(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function nw(e,t){var r=e.l,n=e.read_shift(1),a=oa(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(ER(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function AR(e,t){var r=!1;return t==null&&(r=!0,t=Ie(15+4*e.t.length)),t.write_shift(1,0),jn(e.t,t),r?t.slice(0,t.l):t}var CR=nw;function TR(e,t){var r=!1;return t==null&&(r=!0,t=Ie(23+4*e.t.length)),t.write_shift(1,1),jn(e.t,t),t.write_shift(4,1),NR({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Oi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function zc(e,t){return t==null&&(t=Ie(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Wc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Hc(e,t){return t==null&&(t=Ie(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var PR=oa,V6=jn;function aw(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Bp(e,t){var r=!1;return t==null&&(r=!0,t=Ie(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var FR=oa,m2=aw,iw=Bp;function sw(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Mp([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ac(t,0)>>2;return r?a/100:a}function q6(e,t){t==null&&(t=Ie(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function G6(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function LR(e,t){return t||(t=Ie(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var $c=G6,L0=LR;function sa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Cc(e,t){return(t||Ie(8)).write_shift(8,e,"f")}function jR(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=vc[a];c&&(t.rgb=Dd(c));break;case 2:t.rgb=Dd([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Up(e,t){if(t||(t=Ie(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function IR(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function DR(e,t){t||(t=Ie(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function X6(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function OR(e){return X6(e,1)}function RR(e){return X6(e,2)}var ow=2,ja=3,P1=11,d4=12,zp=19,F1=64,MR=65,BR=71,UR=4108,zR=4126,Tn=80,K6=81,WR=[Tn,K6],v2={1:{n:"CodePage",t:ow},2:{n:"Category",t:Tn},3:{n:"PresentationFormat",t:Tn},4:{n:"ByteCount",t:ja},5:{n:"LineCount",t:ja},6:{n:"ParagraphCount",t:ja},7:{n:"SlideCount",t:ja},8:{n:"NoteCount",t:ja},9:{n:"HiddenCount",t:ja},10:{n:"MultimediaClipCount",t:ja},11:{n:"ScaleCrop",t:P1},12:{n:"HeadingPairs",t:UR},13:{n:"TitlesOfParts",t:zR},14:{n:"Manager",t:Tn},15:{n:"Company",t:Tn},16:{n:"LinksUpToDate",t:P1},17:{n:"CharacterCount",t:ja},19:{n:"SharedDoc",t:P1},22:{n:"HyperlinksChanged",t:P1},23:{n:"AppVersion",t:ja,p:"version"},24:{n:"DigSig",t:MR},26:{n:"ContentType",t:Tn},27:{n:"ContentStatus",t:Tn},28:{n:"Language",t:Tn},29:{n:"Version",t:Tn},255:{},2147483648:{n:"Locale",t:zp},2147483651:{n:"Behavior",t:zp},1919054434:{}},x2={1:{n:"CodePage",t:ow},2:{n:"Title",t:Tn},3:{n:"Subject",t:Tn},4:{n:"Author",t:Tn},5:{n:"Keywords",t:Tn},6:{n:"Comments",t:Tn},7:{n:"Template",t:Tn},8:{n:"LastAuthor",t:Tn},9:{n:"RevNumber",t:Tn},10:{n:"EditTime",t:F1},11:{n:"LastPrinted",t:F1},12:{n:"CreatedDate",t:F1},13:{n:"ModifiedDate",t:F1},14:{n:"PageCount",t:ja},15:{n:"WordCount",t:ja},16:{n:"CharCount",t:ja},17:{n:"Thumbnail",t:BR},18:{n:"Application",t:Tn},19:{n:"DocSecurity",t:ja},255:{},2147483648:{n:"Locale",t:zp},2147483651:{n:"Behavior",t:zp},1919054434:{}},h4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},HR=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $R(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var VR=$R([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vc=Ir(VR),No={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Y6={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},y2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},L1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function lw(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function qR(e){var t=lw();if(!e||!e.match)return t;var r={};if((e.match(da)||[]).forEach(function(n){var a=Ct(n);switch(a[0].replace(rR,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[y2[a.ContentType]]!==void 0&&t[y2[a.ContentType]].push(a.PartName);break}}),t.xmlns!==_n.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function J6(e,t){var r=GO(y2),n=[],a;n[n.length]=on,n[n.length]=Ze("Types",null,{xmlns:_n.CT,"xmlns:xsd":_n.xsd,"xmlns:xsi":_n.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ze("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Ze("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:L1[l][t.bookType]||L1[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Ze("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:L1[l][t.bookType]||L1[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Ze("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var qt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Id(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function td(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(da)||[]).forEach(function(a){var i=Ct(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:jf(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function n0(e){var t=[on,Ze("Relationships",null,{xmlns:_n.RELS})];return Kr(e["!id"]).forEach(function(r){t[t.length]=Ze("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function fr(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,i?a.TargetMode=i:[qt.HLINK,qt.XPATH,qt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var GR="application/vnd.oasis.opendocument.spreadsheet";function XR(e,t){for(var r=Zy(e),n,a;n=jd.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ct(n[0],!1),a.path=="/"&&a.type!==GR)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function KR(e){var t=[on];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function p4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function YR(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function JR(e){var t=[on];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(p4(e[r][0],e[r][1])),t.push(YR("",e[r][0]));return t.push(p4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Z6(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+jp.version+"</meta:generator></office:meta></office:document-meta>"}var Fi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ZR=function(){for(var e=new Array(Fi.length),t=0;t<Fi.length;++t){var r=Fi[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Q6(e){var t={};e=vr(e);for(var r=0;r<Fi.length;++r){var n=Fi[r],a=e.match(ZR[r]);a!=null&&a.length>0&&(t[n[1]]=er(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=jr(t[n[1]]))}return t}function Cv(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=hr(t),n[n.length]=r?Ze(e,t,r):zn(e,t))}function eN(e,t){var r=t||{},n=[on,Ze("cp:coreProperties",null,{"xmlns:cp":_n.CORE_PROPS,"xmlns:dc":_n.dc,"xmlns:dcterms":_n.dcterms,"xmlns:dcmitype":_n.dcmitype,"xmlns:xsi":_n.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Cv("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:g2(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Cv("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:g2(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Fi.length;++i){var s=Fi[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Cv(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var xc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],tN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function rN(e,t,r,n){var a=[];if(typeof e=="string")a=a4(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(u){return{v:u}}));var s=typeof t=="string"?a4(t,n).map(function(u){return u.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function QR(e,t,r){var n={};return t||(t={}),e=vr(e),xc.forEach(function(a){var i=(e.match(Fd(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=er(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&rN(n.HeadingPairs,n.TitlesOfParts,t,r),t}function nN(e){var t=[],r=Ze;return e||(e={}),e.Application="SheetJS",t[t.length]=on,t[t.length]=Ze("Properties",null,{xmlns:_n.EXT_PROPS,"xmlns:vt":_n.vt}),xc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=hr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+hr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var e9=/<[^>]+>[^<]*/g;function t9(e,t){var r={},n="",a=e.match(e9);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Ct(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=er(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=er(u);break;case"bool":r[n]=Pr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=jr(u);break;case"cy":case"error":r[n]=er(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function aN(e){var t=[on,Ze("Properties",null,{xmlns:_n.CUST_PROPS,"xmlns:vt":_n.vt})];if(!e)return t.join("");var r=1;return Kr(e).forEach(function(a){++r,t[t.length]=Ze("property",uR(e[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:hr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var w2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Tv;function r9(e,t,r){Tv||(Tv=jg(w2)),t=Tv[t]||t,e[t]=r}function n9(e,t){var r=[];return Kr(w2).map(function(n){for(var a=0;a<Fi.length;++a)if(Fi[a][1]==n)return Fi[a];for(a=0;a<xc.length;++a)if(xc[a][1]==n)return xc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(zn(w2[n[1]]||n[1],a))}}),Ze("DocumentProperties",r.join(""),{xmlns:Za.o})}function a9(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Kr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Fi.length;++s)if(i==Fi[s][1])return;for(s=0;s<xc.length;++s)if(i==xc[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(Ze(e4(i),o,{"dt:dt":l}))}}),t&&Kr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ze(e4(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Za.o+'">'+a.join("")+"</"+n+">"}function cw(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function i9(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=Ie(8);return s.write_shift(4,n),s.write_shift(4,a),s}function iN(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function sN(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function oN(e,t,r){return t===31?sN(e):iN(e,t,r)}function b2(e,t,r){return oN(e,t,r===!1?0:4)}function s9(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return oN(e,t,0)}function o9(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(_a,""),e.l-a&2&&(e.l+=2)}return r}function l9(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(_a,"");return r}function c9(e){var t=e.l,r=Wp(e,K6);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Wp(e,ja);return[r,n]}function u9(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(c9(e));return r}function g4(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(_a,"").replace(Lf,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function lN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function f9(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Wp(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==d4&&n!==t&&WR.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===d4?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return iN(e,n,4).replace(_a,"");case 31:return sN(e);case 64:return cw(e);case 65:return lN(e);case 71:return f9(e);case 80:return b2(e,n,!i.raw).replace(_a,"");case 81:return s9(e,n).replace(_a,"");case 4108:return u9(e);case 4126:case 4127:return n==4127?o9(e):l9(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function m4(e,t){var r=Ie(4),n=Ie(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ie(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=i9(t);break;case 31:case 80:for(n=Ie(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Fn([r,n])}function v4(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),f=e.read_shift(4);i[s]=[u,f+r]}i.sort(function(b,w){return b[1]-w[1]});var d={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var v=t[i[s][0]];if(d[v.n]=Wp(e,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:es(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(i[s][0]===1){if(o=d.CodePage=Wp(e,ow),es(o),l!==-1){var m=e.l;e.l=i[l][1],c=g4(e,o),e.l=m}}else if(i[s][0]===0){if(o===0){l=s,e.l=i[s+1][1];continue}c=g4(e,o)}else{var y=c[i[s][0]],x;switch(e[e.l]){case 65:e.l+=4,x=lN(e);break;case 30:e.l+=4,x=b2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=b2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=en(e,4);break;case 64:e.l+=4,x=jr(cw(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[y]=x}}return e.l=r+n,d}var cN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function d9(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function x4(e,t,r){var n=Ie(8),a=[],i=[],s=8,o=0,l=Ie(8),c=Ie(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){c=Ie(8),c.write_shift(4,0),a.unshift(c);var u=[Ie(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(l=Ie(4+4+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Fn(u),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(cN.indexOf(e[o][0])>-1||tN.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],h=0;if(t){h=+t[e[o][0]];var v=r[h];if(v.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=m4(v.t,d)}else{var y=d9(d);y==-1&&(y=31,d=String(d)),l=m4(y,d)}i.push(l),c=Ie(8),c.write_shift(4,t?h:2+o),a.push(c),s+=8+l.length}var x=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,x),x+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),Fn([n].concat(a).concat(i))}function y4(e,t,r){var n=e.content;if(!n)return{};Un(n,0);var a,i,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==yt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),l=n.read_shift(4));var f=v4(n,t),d={SystemIdentifier:c};for(var h in f)d[h]=f[h];if(d.FMTID=i,a===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=v4(n,null)}catch{}for(h in v)d[h]=v[h];return d.FMTID=[i,s],d}function w4(e,t,r,n,a,i){var s=Ie(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,yt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=x4(e,r,n);if(o.push(l),a){var c=x4(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return Fn(o)}function qo(e,t){return e.read_shift(t),null}function h9(e,t){t||(t=Ie(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function p9(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function en(e,t){return e.read_shift(t)===1}function xa(e,t){return t||(t=Ie(2)),t.write_shift(2,+!!e),t}function pn(e){return e.read_shift(2,"u")}function Ni(e,t){return t||(t=Ie(2)),t.write_shift(2,e),t}function uN(e,t){return p9(e,t,pn)}function g9(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function fN(e,t,r){return r||(r=Ie(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ih(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function m9(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,l={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*s),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function v9(e){var t=e.t||"",r=Ie(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ie(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Fn(a)}function Tc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function sh(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Tc(e,n,r)}function Vc(e,t,r){if(r.biff>5)return sh(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function dN(e,t,r){return r||(r=Ie(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function x9(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function y9(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(_a,"");return n&&(e.l+=24),a}function w9(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(_a,"");return r+s}function b9(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return y9(e);case"0303000000000000c000000000000046":return w9(e);default:throw new Error("Unsupported Moniker "+r)}}function j1(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(_a,""):"";return r}function b4(e,t){t||(t=Ie(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function _9(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c="",u,f;a&16&&(i=j1(e,r-e.l)),a&128&&(s=j1(e,r-e.l)),(a&257)===257&&(o=j1(e,r-e.l)),(a&257)===1&&(l=b9(e,r-e.l)),a&8&&(c=j1(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=cw(e)),e.l=r;var d=s||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return u&&(h.guid=u),f&&(h.time=f),i&&(h.Tooltip=i),h}function k9(e){var t=Ie(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),b4(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&b4(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function hN(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function pN(e,t){var r=hN(e);return r[3]=0,r}function Bs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Pc(e,t,r,n){return n||(n=Ie(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function S9(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function E9(e,t,r){return t===0?"":Vc(e,t,r)}function N9(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function gN(e){var t=e.read_shift(2),r=sw(e);return[t,r]}function A9(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=ih(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Og(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function mN(e,t){return t||(t=Ie(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function vN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var C9=vN;function xN(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function T9(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function P9(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ea(e){e.l+=2,e.l+=e.read_shift(2)}var F9={0:ea,4:ea,5:ea,6:ea,7:P9,8:ea,9:ea,10:ea,11:ea,12:ea,13:T9,14:ea,15:ea,16:ea,17:ea,18:ea,19:ea,20:ea,21:xN};function L9(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(F9[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function I1(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function uw(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ie(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function j9(e,t){return t===0||e.read_shift(2),1200}function I9(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Vc(e,0,r);return e.read_shift(t+n-e.l),a}function D9(e,t){var r=!t||t.biff==8,n=Ie(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function O9(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function R9(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=ih(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function M9(e,t){var r=!t||t.biff>=8?2:1,n=Ie(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function B9(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(m9(e));return i.Count=n,i.Unique=a,i}function U9(e,t){var r=Ie(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=v9(e[a]);var i=Fn([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function z9(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function W9(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function H9(e){var t=S9(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function $9(e){return e.read_shift(2),e.read_shift(4)}function _4(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function V9(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function q9(){var e=Ie(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function G9(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function X9(e){var t=Ie(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function K9(){}function Y9(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ih(e,0,r),n}function J9(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Ie(a);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Z9(e){var t=Bs(e);return t.isst=e.read_shift(4),t}function Q9(e,t,r,n){var a=Ie(10);return Pc(e,t,n,a),a.write_shift(4,r),a}function eM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Bs(e);r.biff==2&&e.l++;var i=sh(e,n-e.l,r);return a.val=i,a}function tM(e,t,r,n,a){var i=!a||a.biff==8,s=Ie(6+2+ +i+(1+i)*r.length);return Pc(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function rM(e,t,r){var n=e.read_shift(2),a=Vc(e,0,r);return[n,a]}function nM(e,t,r,n){var a=r&&r.biff==5;n||(n=Ie(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var aM=Vc;function k4(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c:l}}}function iM(e,t){var r=t.biff==8||!t.biff?4:2,n=Ie(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function sM(e){var t=e.read_shift(2),r=e.read_shift(2),n=gN(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function oM(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(gN(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function lM(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function cM(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=HR[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function uM(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=cM(e,t,n.fStyle,r),n}function S4(e,t,r,n){var a=r&&r.biff==5;n||(n=Ie(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function fM(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function dM(e){var t=Ie(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function E4(e,t,r){var n=Bs(e);(r.biff==2||t==9)&&++e.l;var a=g9(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function hM(e,t,r,n,a,i){var s=Ie(8);return Pc(e,t,n,s),fN(r,i,s),s}function pM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Bs(e),a=sa(e);return n.val=a,n}function gM(e,t,r,n){var a=Ie(14);return Pc(e,t,n,a),Cc(r,a),a}var N4=E9;function mM(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Tc(e,i),o=[];n>e.l;)o.push(sh(e));return[i,a,s,o]}function A4(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=A9(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var vM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function C4(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Tc(e,s,r);a&32&&(c=vM[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:LW(e,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function yN(e,t,r){if(r.biff<8)return xM(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(N9(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function xM(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ih(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function yM(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Tc(e,n,r),s=Tc(e,a,r);return[i,s]}function wM(e,t,r){var n=vN(e);e.l++;var a=e.read_shift(1);return t-=8,[jW(e,t,r),a,n]}function T4(e,t,r){var n=C9(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,PW(e,t,r)]}function bM(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function _M(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Vc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function kM(e,t,r){return _M(e,t,r)}function SM(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Og(e));return r}function EM(e){var t=Ie(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)mN(e[r],t);return t}function NM(e,t,r){if(r&&r.biff<8)return CM(e,t,r);var n=xN(e),a=L9(e,t-22,n[1]);return{cmo:n,ft:a}}var AM={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function CM(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((AM[n]||ua)(e,t,r)),{cmo:[a,n,i],ft:s}}function TM(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=x9(e,6,r);var o=e.read_shift(2);e.read_shift(2),pn(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=Tc(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function PM(e,t){var r=Og(e);e.l+=16;var n=_9(e,t-24);return[r,n]}function FM(e){var t=Ie(24),r=Br(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Fn([t,k9(e[1])])}function LM(e,t){e.read_shift(2);var r=Og(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(_a,""),[r,n]}function jM(e){var t=e[1].Tooltip,r=Ie(10+2*(t.length+1));r.write_shift(2,2048);var n=Br(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function IM(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=h4[r]||r,r=e.read_shift(2),t[1]=h4[r]||r,t}function DM(e){return e||(e=Ie(4)),e.write_shift(2,1),e.write_shift(2,1),e}function OM(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(pN(e));return r}function RM(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(pN(e));return r}function MM(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function wN(e,t,r){if(!r.cellStyles)return ua(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function BM(e,t){var r=Ie(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function UM(e,t){var r={};return t<32||(e.l+=16,r.header=sa(e),r.footer=sa(e),e.l+=2),r}function zM(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function WM(e){for(var t=Ie(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var HM=Bs,$M=uN,VM=sh;function qM(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function GM(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Bs(e);++e.l;var a=Vc(e,t-7,r);return n.t="str",n.val=a,n}function XM(e){var t=Bs(e);++e.l;var r=sa(e);return t.t="n",t.val=r,t}function KM(e,t,r){var n=Ie(15);return uh(n,e,t),n.write_shift(8,r,"f"),n}function YM(e){var t=Bs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function JM(e,t,r){var n=Ie(9);return uh(n,e,t),n.write_shift(2,r),n}function ZM(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function QM(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function eB(e,t,r){var n=e.l+t,a=Bs(e),i=e.read_shift(2),s=Tc(e,i,r);return e.l=n,a.t="str",a.val=s,a}var tB=[2,3,48,49,131,139,140,245],_2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=jg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Sl(1);switch(l.type){case"base64":u=ti(li(o));break;case"binary":u=ti(o);break;case"buffer":case"array":u=o;break}Un(u,0);var f=u.read_shift(1),d=!!(f&136),h=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,y=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(y=u.read_shift(2));var x=u.read_shift(2),b=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var w=[],S={},L=Math.min(u.length,f==2?521:y-10-(h?264:0)),j=v?32:11;u.l<L&&u[u.l]!=13;)switch(S={},S.name=nl.utils.decode(b,u.slice(u.l,u.l+j)).replace(/[\u0000\r\n].*$/g,""),u.l+=j,S.type=String.fromCharCode(u.read_shift(1)),f!=2&&!v&&(S.offset=u.read_shift(4)),S.len=u.read_shift(1),f==2&&(S.offset=u.read_shift(2)),S.dec=u.read_shift(1),S.name.length&&w.push(S),f!=2&&(u.l+=v?13:14),S.type){case"B":(!h||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var N=0,E=0;for(c[0]=[],E=0;E!=w.length;++E)c[0][E]=w[E].name;for(;m-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++N]=[],E=0,E=0;E!=w.length;++E){var P=u.slice(u.l,u.l+w[E].len);u.l+=w[E].len,Un(P,0);var M=nl.utils.decode(b,P);switch(w[E].type){case"C":M.trim().length&&(c[N][E]=M.replace(/\s+$/,""));break;case"D":M.length===8?c[N][E]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):c[N][E]=M;break;case"F":c[N][E]=parseFloat(M.trim());break;case"+":case"I":c[N][E]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":c[N][E]=!0;break;case"N":case"F":c[N][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[N][E]="##MEMO##"+(v?parseInt(M.trim(),10):P.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(c[N][E]=+M||0);break;case"@":c[N][E]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":c[N][E]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":c[N][E]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[N][E]=-P.read_shift(-8,"f");break;case"B":if(h&&w[E].len==8){c[N][E]=P.read_shift(8,"f");break}case"G":case"P":P.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=F0(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return Bl(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&es(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ua(),f=qp(o,{header:1,raw:!0,cellDates:!0}),d=f[0],h=f.slice(1),v=o["!cols"]||[],m=0,y=0,x=0,b=1;for(m=0;m<d.length;++m){if(((v[m]||{}).DBF||{}).name){d[m]=v[m].DBF.name,++x;continue}if(d[m]!=null){if(++x,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(y=0;y<1024;++y)if(d.indexOf(d[m]+"_"+y)==-1){d[m]+="_"+y;break}}}}var w=tr(o["!ref"]),S=[],L=[],j=[];for(m=0;m<=w.e.c-w.s.c;++m){var N="",E="",P=0,M=[];for(y=0;y<h.length;++y)h[y][m]!=null&&M.push(h[y][m]);if(M.length==0||d[m]==null){S[m]="?";continue}for(y=0;y<M.length;++y){switch(typeof M[y]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=M[y]instanceof Date?"D":"C";break;default:E="C"}P=Math.max(P,String(M[y]).length),N=N&&N!=E?"C":E}P>250&&(P=250),E=((v[m]||{}).DBF||{}).type,E=="C"&&v[m].DBF.len>P&&(P=v[m].DBF.len),N=="B"&&E=="N"&&(N="N",j[m]=v[m].DBF.dec,P=v[m].DBF.len),L[m]=N=="C"||E=="N"?P:i[N]||0,b+=L[m],S[m]=N}var F=u.next(32);for(F.write_shift(4,318902576),F.write_shift(4,h.length),F.write_shift(2,296+32*x),F.write_shift(2,b),m=0;m<4;++m)F.write_shift(4,0);for(F.write_shift(4,0|(+t[l6]||3)<<8),m=0,y=0;m<d.length;++m)if(d[m]!=null){var T=u.next(32),H=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,H,"sbcs"),T.write_shift(1,S[m]=="?"?"C":S[m],"sbcs"),T.write_shift(4,y),T.write_shift(1,L[m]||i[S[m]]||0),T.write_shift(1,j[m]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),y+=L[m]||i[S[m]]||0}var W=u.next(264);for(W.write_shift(4,13),m=0;m<65;++m)W.write_shift(4,0);for(m=0;m<h.length;++m){var Q=u.next(b);for(Q.write_shift(1,0),y=0;y<d.length;++y)if(d[y]!=null)switch(S[y]){case"L":Q.write_shift(1,h[m][y]==null?63:h[m][y]?84:70);break;case"B":Q.write_shift(8,h[m][y]||0,"f");break;case"N":var V="0";for(typeof h[m][y]=="number"&&(V=h[m][y].toFixed(j[y]||0)),x=0;x<L[y]-V.length;++x)Q.write_shift(1,32);Q.write_shift(1,V,"sbcs");break;case"D":h[m][y]?(Q.write_shift(4,("0000"+h[m][y].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(h[m][y].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+h[m][y].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var z=String(h[m][y]!=null?h[m][y]:"").slice(0,L[y]);for(Q.write_shift(1,z,"sbcs"),x=0;x<L[y]-z.length;++x)Q.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),bN=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Kr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,h){var v=e[h];return typeof v=="number"?U_(v):v},n=function(d,h,v){var m=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?d:U_(m)};e["|"]=254;function a(d,h){switch(h.type){case"base64":return i(li(d),h);case"binary":return i(d,h);case"buffer":return i($t&&Buffer.isBuffer(d)?d.toString("binary"):Ml(d),h);case"array":return i(Ac(d),h)}throw new Error("Unrecognized type "+h.type)}function i(d,h){var v=d.split(/[\n\r]+/),m=-1,y=-1,x=0,b=0,w=[],S=[],L=null,j={},N=[],E=[],P=[],M=0,F;for(+h.codepage>=0&&es(+h.codepage);x!==v.length;++x){M=0;var T=v[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),H=T.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),W=H[0],Q;if(T.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&S.push(T.slice(3).replace(/;;/g,";"));break;case"C":var V=!1,z=!1,X=!1,D=!1,ne=-1,ge=-1;for(b=1;b<H.length;++b)switch(H[b].charAt(0)){case"A":break;case"X":y=parseInt(H[b].slice(1))-1,z=!0;break;case"Y":for(m=parseInt(H[b].slice(1))-1,z||(y=0),F=w.length;F<=m;++F)w[F]=[];break;case"K":Q=H[b].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(as(Q))?isNaN(v0(Q).getDate())||(Q=jr(Q)):(Q=as(Q),L!==null&&T0(L)&&(Q=Dg(Q))),V=!0;break;case"E":D=!0;var C=a0(H[b].slice(1),{r:m,c:y});w[m][y]=[w[m][y],C];break;case"S":X=!0,w[m][y]=[w[m][y],"S5S"];break;case"G":break;case"R":ne=parseInt(H[b].slice(1))-1;break;case"C":ge=parseInt(H[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(V&&(w[m][y]&&w[m][y].length==2?w[m][y][0]=Q:w[m][y]=Q,L=null),X){if(D)throw new Error("SYLK shared formula cannot have own formula");var R=ne>-1&&w[ne][ge];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");w[m][y][1]=BN(R[1],{r:m-ne,c:y-ge})}break;case"F":var B=0;for(b=1;b<H.length;++b)switch(H[b].charAt(0)){case"X":y=parseInt(H[b].slice(1))-1,++B;break;case"Y":for(m=parseInt(H[b].slice(1))-1,F=w.length;F<=m;++F)w[F]=[];break;case"M":M=parseInt(H[b].slice(1))/20;break;case"F":break;case"G":break;case"P":L=S[parseInt(H[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=H[b].slice(1).split(" "),F=parseInt(P[0],10);F<=parseInt(P[1],10);++F)M=parseInt(P[2],10),E[F-1]=M===0?{hidden:!0}:{wch:M},El(E[F-1]);break;case"C":y=parseInt(H[b].slice(1))-1,E[y]||(E[y]={});break;case"R":m=parseInt(H[b].slice(1))-1,N[m]||(N[m]={}),M>0?(N[m].hpt=M,N[m].hpx=y0(M)):M===0&&(N[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}B<1&&(L=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return N.length>0&&(j["!rows"]=N),E.length>0&&(j["!cols"]=E),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,j]}function s(d,h){var v=a(d,h),m=v[0],y=v[1],x=F0(m,h);return Kr(y).forEach(function(b){x[b]=y[b]}),x}function o(d,h){return Bl(s(d,h),h)}function l(d,h,v,m){var y="C;Y"+(v+1)+";X"+(m+1)+";K";switch(d.t){case"n":y+=d.v||0,d.f&&!d.F&&(y+=";E"+mw(d.f,{r:v,c:m}));break;case"b":y+=d.v?"TRUE":"FALSE";break;case"e":y+=d.w||d.v;break;case"d":y+='"'+(d.w||d.v)+'"';break;case"s":y+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(d,h){h.forEach(function(v,m){var y="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Od(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Rd(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&d.push(y)})}function u(d,h){h.forEach(function(v,m){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*Md(v.hpx)+";"),y.length>2&&d.push(y+"R"+(m+1))})}function f(d,h){var v=["ID;PWXL;N;E"],m=[],y=tr(d["!ref"]),x,b=Array.isArray(d),w=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&c(v,d["!cols"]),d["!rows"]&&u(v,d["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var L=y.s.c;L<=y.e.c;++L){var j=At({r:S,c:L});x=b?(d[S]||[])[L]:d[j],!(!x||x.v==null&&(!x.f||x.F))&&m.push(l(x,d,S,L))}return v.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),_N=function(){function e(i,s){switch(s.type){case"base64":return t(li(i),s);case"binary":return t(i,s);case"buffer":return t($t&&Buffer.isBuffer(i)?i.toString("binary"):Ml(i),s);case"array":return t(Ac(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),h=d[0],v=d[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+h){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN(as(v))?isNaN(v0(v).getDate())?f[l][c]=v:f[l][c]=jr(v):f[l][c]=as(v),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(i,s){return F0(e(i,s),s)}function n(i,s){return Bl(r(i,s),s)}var a=function(){var i=function(l,c,u,f,d){l.push(c),l.push(u+","+f),l.push('"'+d.replace(/"/g,'""')+'"')},s=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=tr(l["!ref"]),f,d=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){s(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var m=At({r:h,c:v});if(f=d?(l[h]||[])[v]:l[m],!f){s(c,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?s(c,1,0,"="+f.f):s(c,1,0,""):s(c,0,y,"V");break;case"b":s(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Di(f.z||Et[14],Sn(jr(f.v)))),s(c,0,f.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var x=`\r
`,b=c.join(x);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),kN=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var h=f.split(`
`),v=-1,m=-1,y=0,x=[];y!==h.length;++y){var b=h[y].trim().split(":");if(b[0]==="cell"){var w=Br(b[1]);if(x.length<=w.r)for(v=x.length;v<=w.r;++v)x[v]||(x[v]=[]);switch(v=w.r,m=w.c,b[2]){case"t":x[v][m]=e(b[3]);break;case"v":x[v][m]=+b[3];break;case"vtf":var S=b[b.length-1];case"vtc":switch(b[3]){case"nl":x[v][m]=!!+b[4];break;default:x[v][m]=+b[4];break}b[2]=="vtf"&&(x[v][m]=[x[v][m],S])}}}return d&&d.sheetRows&&(x=x.slice(0,d.sheetRows)),x}function n(f,d){return F0(r(f,d),d)}function a(f,d){return Bl(n(f,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var d=[],h=[],v,m="",y=za(f["!ref"]),x=Array.isArray(f),b=y.s.r;b<=y.e.r;++b)for(var w=y.s.c;w<=y.e.c;++w)if(m=At({r:b,c:w}),v=x?(f[b]||[])[w]:f[m],!(!v||v.v==null||v.t==="z")){switch(h=["cell",m,"t"],v.t){case"s":case"str":h.push(t(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=t(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var S=Sn(jr(v.v));h[2]="vtc",h[3]="nd",h[4]=""+S,h[5]=v.w||Di(v.z||Et[14],S);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[i,s,o,s,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),x0=function(){function e(u,f,d,h,v){v.raw?f[d][h]=u:u===""||(u==="TRUE"?f[d][h]=!0:u==="FALSE"?f[d][h]=!1:isNaN(as(u))?isNaN(v0(u).getDate())?f[d][h]=u:f[d][h]=jr(u):f[d][h]=as(u))}function t(u,f){var d=f||{},h=[];if(!u||u.length===0)return h;for(var v=u.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var y=10,x=0,b=0;b<=m;++b)x=v[b].indexOf(" "),x==-1?x=v[b].length:x++,y=Math.max(y,x);for(b=0;b<=m;++b){h[b]=[];var w=0;for(e(v[b].slice(0,y).trim(),h,b,w,d),w=1;w<=(v[b].length-y)/10+1;++w)e(v[b].slice(y+(w-1)*10,y+w*10).trim(),h,b,w,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},d=!1,h=0,v=0;h<u.length;++h)(v=u.charCodeAt(h))==34?d=!d:!d&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&v.push([f[h],h]);if(!v.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&v.push([f[h],h])}return v.sort(function(m,y){return m[0]-y[0]||n[m[1]]-n[y[1]]}),r[v.pop()[1]]||44}function i(u,f){var d=f||{},h="",v=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):d&&d.FS?h=d.FS:h=a(u.slice(0,1024));var y=0,x=0,b=0,w=0,S=0,L=h.charCodeAt(0),j=!1,N=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var P=d.dateNF!=null?WO(d.dateNF):null;function M(){var F=u.slice(w,S),T={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)T.t="z";else if(d.raw)T.t="s",T.v=F;else if(F.trim().length===0)T.t="s",T.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(T.t="s",T.v=F.slice(2,-1).replace(/""/g,'"')):mz(F)?(T.t="n",T.f=F.slice(1)):(T.t="s",T.v=F);else if(F=="TRUE")T.t="b",T.v=!0;else if(F=="FALSE")T.t="b",T.v=!1;else if(!isNaN(b=as(F)))T.t="n",d.cellText!==!1&&(T.w=F),T.v=b;else if(!isNaN(v0(F).getDate())||P&&F.match(P)){T.z=d.dateNF||Et[14];var H=0;P&&F.match(P)&&(F=HO(F,d.dateNF,F.match(P)||[]),H=1),d.cellDates?(T.t="d",T.v=jr(F,H)):(T.t="n",T.v=Sn(jr(F,H))),d.cellText!==!1&&(T.w=Di(T.z,T.v instanceof Date?Sn(T.v):T.v)),d.cellNF||delete T.z}else T.t="s",T.v=F;if(T.t=="z"||(d.dense?(v[y]||(v[y]=[]),v[y][x]=T):v[At({c:x,r:y})]=T),w=S+1,E=u.charCodeAt(w),m.e.c<x&&(m.e.c=x),m.e.r<y&&(m.e.r=y),N==L)++x;else if(x=0,++y,d.sheetRows&&d.sheetRows<=y)return!0}e:for(;S<u.length;++S)switch(N=u.charCodeAt(S)){case 34:E===34&&(j=!j);break;case L:case 10:case 13:if(!j&&M())break e;break}return S-w>0&&M(),v["!ref"]=Bt(m),v}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):F0(t(u,f),f)}function o(u,f){var d="",h=f.type=="string"?[0,0,0,0]:Sw(u,f);switch(f.type){case"base64":d=li(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof nl<"u"?d=nl.utils.decode(f.codepage,u):d=$t&&Buffer.isBuffer(u)?u.toString("binary"):Ml(u);break;case"array":d=Ac(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=vr(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=vr(d):f.type=="binary"&&typeof nl<"u"&&f.codepage&&(d=nl.utils.decode(f.codepage,nl.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?kN.to_sheet(f.type=="string"?d:vr(d),f):s(d,f)}function l(u,f){return Bl(o(u,f),f)}function c(u){for(var f=[],d=tr(u["!ref"]),h,v=Array.isArray(u),m=d.s.r;m<=d.e.r;++m){for(var y=[],x=d.s.c;x<=d.e.c;++x){var b=At({r:m,c:x});if(h=v?(u[m]||[])[x]:u[b],!h||h.v==null){y.push("          ");continue}for(var w=(h.w||(xo(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(x===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function rB(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=bN.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return x0.to_workbook(e,t)}}var yc=function(){function e(C,R,B){if(C){Un(C,C.l||0);for(var U=B.Enum||ne;C.l<C.length;){var Y=C.read_shift(2),ue=U[Y]||U[65535],pe=C.read_shift(2),he=C.l+pe,ye=ue.f&&ue.f(C,pe,B);if(C.l=he,R(ye,ue,Y))return}}}function t(C,R){switch(R.type){case"base64":return r(ti(li(C)),R);case"binary":return r(ti(C),R);case"buffer":case"array":return r(C,R)}throw"Unsupported type "+R.type}function r(C,R){if(!C)return C;var B=R||{},U=B.dense?[]:{},Y="Sheet1",ue="",pe=0,he={},ye=[],Pe=[],re={s:{r:0,c:0},e:{r:0,c:0}},Ue=B.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)B.Enum=ne,e(C,function(De,Qe,Be){switch(Be){case 0:B.vers=De,De>=4096&&(B.qpro=!0);break;case 6:re=De;break;case 204:De&&(ue=De);break;case 222:ue=De;break;case 15:case 51:B.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:Be==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=B.dateNF||Et[14],B.cellDates&&(De[1].t="d",De[1].v=Dg(De[1].v))),B.qpro&&De[3]>pe&&(U["!ref"]=Bt(re),he[Y]=U,ye.push(Y),U=B.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},pe=De[3],Y=ue||"Sheet"+(pe+1),ue="");var Ke=B.dense?(U[De[0].r]||[])[De[0].c]:U[At(De[0])];if(Ke){Ke.t=De[1].t,Ke.v=De[1].v,De[1].z!=null&&(Ke.z=De[1].z),De[1].f!=null&&(Ke.f=De[1].f);break}B.dense?(U[De[0].r]||(U[De[0].r]=[]),U[De[0].r][De[0].c]=De[1]):U[At(De[0])]=De[1];break}},B);else if(C[2]==26||C[2]==14)B.Enum=ge,C[2]==14&&(B.qpro=!0,C.l=0),e(C,function(De,Qe,Be){switch(Be){case 204:Y=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>pe&&(U["!ref"]=Bt(re),he[Y]=U,ye.push(Y),U=B.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},pe=De[3],Y="Sheet"+(pe+1)),Ue>0&&De[0].r>=Ue)break;B.dense?(U[De[0].r]||(U[De[0].r]=[]),U[De[0].r][De[0].c]=De[1]):U[At(De[0])]=De[1],re.e.c<De[0].c&&(re.e.c=De[0].c),re.e.r<De[0].r&&(re.e.r=De[0].r);break;case 27:De[14e3]&&(Pe[De[14e3][0]]=De[14e3][1]);break;case 1537:Pe[De[0]]=De[1],De[0]==pe&&(Y=De[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(U["!ref"]=Bt(re),he[ue||Y]=U,ye.push(ue||Y),!Pe.length)return{SheetNames:ye,Sheets:he};for(var Ye={},Ce=[],oe=0;oe<Pe.length;++oe)he[ye[oe]]?(Ce.push(Pe[oe]||ye[oe]),Ye[Pe[oe]]=he[Pe[oe]]||he[ye[oe]]):(Ce.push(Pe[oe]),Ye[Pe[oe]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:Ye}}function n(C,R){var B=R||{};if(+B.codepage>=0&&es(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Ua(),Y=tr(C["!ref"]),ue=Array.isArray(C),pe=[];et(U,0,i(1030)),et(U,6,l(Y));for(var he=Math.min(Y.e.r,8191),ye=Y.s.r;ye<=he;++ye)for(var Pe=sn(ye),re=Y.s.c;re<=Y.e.c;++re){ye===Y.s.r&&(pe[re]=Mr(re));var Ue=pe[re]+Pe,Ye=ue?(C[ye]||[])[re]:C[Ue];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?et(U,13,h(ye,re,Ye.v)):et(U,14,m(ye,re,Ye.v));else{var Ce=xo(Ye);et(U,15,f(ye,re,Ce.slice(0,239)))}}return et(U,1),U.end()}function a(C,R){var B=R||{};if(+B.codepage>=0&&es(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Ua();et(U,0,s(C));for(var Y=0,ue=0;Y<C.SheetNames.length;++Y)(C.Sheets[C.SheetNames[Y]]||{})["!ref"]&&et(U,27,D(C.SheetNames[Y],ue++));var pe=0;for(Y=0;Y<C.SheetNames.length;++Y){var he=C.Sheets[C.SheetNames[Y]];if(!(!he||!he["!ref"])){for(var ye=tr(he["!ref"]),Pe=Array.isArray(he),re=[],Ue=Math.min(ye.e.r,8191),Ye=ye.s.r;Ye<=Ue;++Ye)for(var Ce=sn(Ye),oe=ye.s.c;oe<=ye.e.c;++oe){Ye===ye.s.r&&(re[oe]=Mr(oe));var De=re[oe]+Ce,Qe=Pe?(he[Ye]||[])[oe]:he[De];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")et(U,23,M(Ye,oe,pe,Qe.v));else{var Be=xo(Qe);et(U,22,N(Ye,oe,pe,Be.slice(0,239)))}}++pe}}return et(U,1),U.end()}function i(C){var R=Ie(2);return R.write_shift(2,C),R}function s(C){var R=Ie(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var B=0,U=0,Y=0,ue=0;ue<C.SheetNames.length;++ue){var pe=C.SheetNames[ue],he=C.Sheets[pe];if(!(!he||!he["!ref"])){++Y;var ye=za(he["!ref"]);B<ye.e.r&&(B=ye.e.r),U<ye.e.c&&(U=ye.e.c)}}return B>8191&&(B=8191),R.write_shift(2,B),R.write_shift(1,Y),R.write_shift(1,U),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function o(C,R,B){var U={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&B.qpro?(U.s.c=C.read_shift(1),C.l++,U.s.r=C.read_shift(2),U.e.c=C.read_shift(1),C.l++,U.e.r=C.read_shift(2),U):(U.s.c=C.read_shift(2),U.s.r=C.read_shift(2),R==12&&B.qpro&&(C.l+=2),U.e.c=C.read_shift(2),U.e.r=C.read_shift(2),R==12&&B.qpro&&(C.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(C){var R=Ie(8);return R.write_shift(2,C.s.c),R.write_shift(2,C.s.r),R.write_shift(2,C.e.c),R.write_shift(2,C.e.r),R}function c(C,R,B){var U=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(U[0].c=C.read_shift(1),U[3]=C.read_shift(1),U[0].r=C.read_shift(2),C.l+=2):(U[2]=C.read_shift(1),U[0].c=C.read_shift(2),U[0].r=C.read_shift(2)),U}function u(C,R,B){var U=C.l+R,Y=c(C,R,B);if(Y[1].t="s",B.vers==20768){C.l++;var ue=C.read_shift(1);return Y[1].v=C.read_shift(ue,"utf8"),Y}return B.qpro&&C.l++,Y[1].v=C.read_shift(U-C.l,"cstr"),Y}function f(C,R,B){var U=Ie(7+B.length);U.write_shift(1,255),U.write_shift(2,R),U.write_shift(2,C),U.write_shift(1,39);for(var Y=0;Y<U.length;++Y){var ue=B.charCodeAt(Y);U.write_shift(1,ue>=128?95:ue)}return U.write_shift(1,0),U}function d(C,R,B){var U=c(C,R,B);return U[1].v=C.read_shift(2,"i"),U}function h(C,R,B){var U=Ie(7);return U.write_shift(1,255),U.write_shift(2,R),U.write_shift(2,C),U.write_shift(2,B,"i"),U}function v(C,R,B){var U=c(C,R,B);return U[1].v=C.read_shift(8,"f"),U}function m(C,R,B){var U=Ie(13);return U.write_shift(1,255),U.write_shift(2,R),U.write_shift(2,C),U.write_shift(8,B,"f"),U}function y(C,R,B){var U=C.l+R,Y=c(C,R,B);if(Y[1].v=C.read_shift(8,"f"),B.qpro)C.l=U;else{var ue=C.read_shift(2);S(C.slice(C.l,C.l+ue),Y),C.l+=ue}return Y}function x(C,R,B){var U=R&32768;return R&=-32769,R=(U?C:0)+(R>=8192?R-16384:R),(U?"":"$")+(B?Mr(R):sn(R))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(C,R){Un(C,0);for(var B=[],U=0,Y="",ue="",pe="",he="";C.l<C.length;){var ye=C[C.l++];switch(ye){case 0:B.push(C.read_shift(8,"f"));break;case 1:ue=x(R[0].c,C.read_shift(2),!0),Y=x(R[0].r,C.read_shift(2),!1),B.push(ue+Y);break;case 2:{var Pe=x(R[0].c,C.read_shift(2),!0),re=x(R[0].r,C.read_shift(2),!1);ue=x(R[0].c,C.read_shift(2),!0),Y=x(R[0].r,C.read_shift(2),!1),B.push(Pe+re+":"+ue+Y)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(C.read_shift(2));break;case 6:{for(var Ue="";ye=C[C.l++];)Ue+=String.fromCharCode(ye);B.push('"'+Ue.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:he=B.pop(),pe=B.pop(),B.push(["AND","OR"][ye-20]+"("+pe+","+he+")");break;default:if(ye<32&&w[ye])he=B.pop(),pe=B.pop(),B.push(pe+w[ye]+he);else if(b[ye]){if(U=b[ye][1],U==69&&(U=C[C.l++]),U>B.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+B.join("|")+"|");return}var Ye=B.slice(-U);B.length-=U,B.push(b[ye][0]+"("+Ye.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}B.length==1?R[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function L(C){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=C.read_shift(2),R[3]=C[C.l++],R[0].c=C[C.l++],R}function j(C,R){var B=L(C);return B[1].t="s",B[1].v=C.read_shift(R-4,"cstr"),B}function N(C,R,B,U){var Y=Ie(6+U.length);Y.write_shift(2,C),Y.write_shift(1,B),Y.write_shift(1,R),Y.write_shift(1,39);for(var ue=0;ue<U.length;++ue){var pe=U.charCodeAt(ue);Y.write_shift(1,pe>=128?95:pe)}return Y.write_shift(1,0),Y}function E(C,R){var B=L(C);B[1].v=C.read_shift(2);var U=B[1].v>>1;if(B[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return B[1].v=U,B}function P(C,R){var B=L(C),U=C.read_shift(4),Y=C.read_shift(4),ue=C.read_shift(2);if(ue==65535)return U===0&&Y===3221225472?(B[1].t="e",B[1].v=15):U===0&&Y===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var pe=ue&32768;return ue=(ue&32767)-16446,B[1].v=(1-pe*2)*(Y*Math.pow(2,ue+32)+U*Math.pow(2,ue)),B}function M(C,R,B,U){var Y=Ie(14);if(Y.write_shift(2,C),Y.write_shift(1,B),Y.write_shift(1,R),U==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var ue=0,pe=0,he=0,ye=0;return U<0&&(ue=1,U=-U),pe=Math.log2(U)|0,U/=Math.pow(2,pe-31),ye=U>>>0,ye&2147483648||(U/=2,++pe,ye=U>>>0),U-=ye,ye|=2147483648,ye>>>=0,U*=Math.pow(2,32),he=U>>>0,Y.write_shift(4,he),Y.write_shift(4,ye),pe+=16383+(ue?32768:0),Y.write_shift(2,pe),Y}function F(C,R){var B=P(C);return C.l+=R-14,B}function T(C,R){var B=L(C),U=C.read_shift(4);return B[1].v=U>>6,B}function H(C,R){var B=L(C),U=C.read_shift(8,"f");return B[1].v=U,B}function W(C,R){var B=H(C);return C.l+=R-10,B}function Q(C,R){return C[C.l+R-1]==0?C.read_shift(R,"cstr"):""}function V(C,R){var B=C[C.l++];B>R-1&&(B=R-1);for(var U="";U.length<B;)U+=String.fromCharCode(C[C.l++]);return U}function z(C,R,B){if(!(!B.qpro||R<21)){var U=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var Y=C.read_shift(R-21,"cstr");return[U,Y]}}function X(C,R){for(var B={},U=C.l+R;C.l<U;){var Y=C.read_shift(2);if(Y==14e3){for(B[Y]=[0,""],B[Y][0]=C.read_shift(2);C[C.l];)B[Y][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return B}function D(C,R){var B=Ie(5+C.length);B.write_shift(2,14e3),B.write_shift(2,R);for(var U=0;U<C.length;++U){var Y=C.charCodeAt(U);B[B.l++]=Y>127?95:Y}return B[B.l++]=0,B}var ne={0:{n:"BOF",f:pn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:V},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:X},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function nB(e){var t={},r=e.match(da),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Ct(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=zy[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var aB=function(){var e=Fd("t"),t=Fd("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:er(s[1])},l=i.match(t);return l&&(o.s=nB(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),iB=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),sB=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,oB=/<(?:\w+:)?r>/,lB=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fw(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=er(vr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=vr(e),r&&(n.h=Jy(n.t))):e.match(oB)&&(n.r=vr(e),n.t=er(vr((e.replace(lB,"").match(sB)||[]).join("").replace(da,""))),r&&(n.h=iB(aB(n.r)))),n):{t:""}}var cB=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,uB=/<(?:\w+:)?(?:si|sstItem)>/g,fB=/<\/(?:\w+:)?(?:si|sstItem)>/;function dB(e,t){var r=[],n="";if(!e)return r;var a=e.match(cB);if(a){n=a[2].replace(uB,"").split(fB);for(var i=0;i!=n.length;++i){var s=fw(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=Ct(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var hB=/^\s|\s$|[\t\n\r]/;function SN(e,t){if(!t.bookSST)return"";var r=[on];r[r.length]=Ze("sst",null,{xmlns:Uc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(hB)&&(i+=' xml:space="preserve"'),i+=">"+hr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function pB(e){return[e.read_shift(4),e.read_shift(4)]}function gB(e,t){var r=[],n=!1;return Eo(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function mB(e,t){return t||(t=Ie(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var vB=AR;function xB(e){var t=Ua();ze(t,159,mB(e));for(var r=0;r<e.length;++r)ze(t,19,vB(e[r]));return ze(t,160),t.end()}function EN(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function uo(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function yB(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=uo(e,4),t.U=uo(e,4),t.W=uo(e,4),t}function wB(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function bB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(wB(e));return t}function _B(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function kB(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=uo(e,4),t.U=uo(e,4),t.W=uo(e,4),t}function SB(e){var t=kB(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function NN(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function AN(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function EB(e){var t=uo(e);switch(t.Minor){case 2:return[t.Minor,NB(e)];case 3:return[t.Minor,AB()];case 4:return[t.Minor,CB(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function NB(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=NN(e,r),a=AN(e,e.length-e.l);return{t:"Std",h:n,v:a}}function AB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function CB(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(da,function(i){var s=Ct(i);switch(Ms(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function TB(e,t){var r={},n=r.EncryptionVersionInfo=uo(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=NN(e,a),t-=a,r.EncryptionVerifier=AN(e,t),r}function PB(e){var t={},r=t.EncryptionVersionInfo=uo(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function dw(e){var t=0,r,n=EN(e),a=n.length+1,i,s,o,l,c;for(r=Sl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var CN=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=EN(s),l=i(o),c=o.length,u=Sl(16),f=0;f!=16;++f)u[f]=0;var d,h,v;for((c&1)===1&&(d=l>>8,u[c]=a(e[0],d),--c,d=l&255,h=o[o.length-1],u[c]=a(h,d));c>0;)--c,d=l>>8,u[c]=a(o[c],d),--c,d=l&255,u[c]=a(o[c],d);for(c=15,v=15-o.length;v>0;)d=l>>8,u[c]=a(e[v],d),--c,--v,d=l&255,u[c]=a(o[c],d),--c,--v;return u}}(),FB=function(e,t,r,n,a){a||(a=t),n||(n=CN(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},LB=function(e){var t=0,r=CN(e);return function(n){var a=FB("",n,t,r);return t=a[1],a[0]}};function jB(e,t,r,n){var a={key:pn(e),verificationBytes:pn(e)};return r.password&&(a.verifier=dw(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=LB(r.password)),a}function IB(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=PB(e):n.Data=TB(e,t),n}function DB(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?IB(e,t-2,n):jB(e,r.biff>=8?t:t-2,r,n),n}var TN=function(){function e(a,i){switch(i.type){case"base64":return t(li(a),i);case"binary":return t(a,i);case"buffer":return t($t&&Buffer.isBuffer(a)?a.toString("binary"):Ml(a),i);case"array":return t(Ac(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,h=0,v,m=-1;v=d.exec(u);){switch(v[0]){case"\\cell":var y=u.slice(h,d.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++m,y.length){var x={v:y,t:"s"};Array.isArray(o)?o[f][m]=x:o[At({r:f,c:m})]=x}break}h=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Bt(c),o}function r(a,i){return Bl(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=tr(a["!ref"]),o,l=Array.isArray(a),c=s.s.r;c<=s.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var f=At({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(xo(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function OB(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Dd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function RB(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,l=0,c=a+i;switch(l=s/(c>1?2-c:c),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,l,c/2]}function MB(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,s[0]+=a,s[1]+=l;break;case 1:l=a*(2-o),s[0]+=l,s[1]+=a;break;case 2:l=a*(o-2),s[1]+=a,s[2]+=l;break;case 3:l=a*(4-o),s[1]+=l,s[2]+=a;break;case 4:l=a*(o-4),s[2]+=a,s[0]+=l;break;case 5:l=a*(6-o),s[2]+=l,s[0]+=a;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function Hp(e,t){if(t===0)return e;var r=RB(OB(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Dd(MB(r))}var PN=6,BB=15,UB=1,aa=PN;function Od(e){return Math.floor((e+Math.round(128/aa)/256)*aa)}function Rd(e){return Math.floor((e-5)/aa*100+.5)/100}function $p(e){return Math.round((e*aa+5)/aa*256)/256}function Pv(e){return $p(Rd(Od(e)))}function hw(e){var t=Math.abs(e-Pv(e)),r=aa;if(t>.005)for(aa=UB;aa<BB;++aa)Math.abs(e-Pv(e))<=t&&(t=Math.abs(e-Pv(e)),r=aa);aa=r}function El(e){e.width?(e.wpx=Od(e.width),e.wch=Rd(e.wpx),e.MDW=aa):e.wpx?(e.wch=Rd(e.wpx),e.width=$p(e.wch),e.MDW=aa):typeof e.wch=="number"&&(e.width=$p(e.wch),e.wpx=Od(e.width),e.MDW=aa),e.customWidth&&delete e.customWidth}var zB=96,FN=zB;function Md(e){return e*96/FN}function y0(e){return e*FN/96}var WB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function HB(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(da)||[]).forEach(function(s){var o=Ct(s);switch(Ms(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Pr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Pr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function $B(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(da)||[]).forEach(function(s){var o=Ct(s);switch(Ms(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function VB(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(da)||[]).forEach(function(s){var o=Ct(s);switch(Ms(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=vr(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Pr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Pr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Pr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Pr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Pr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Pr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Pr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=zy[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Pr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=vc[a.color.index];a.color.index==81&&(l=vc[1]),l||(l=vc[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Hp(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function qB(e,t,r){t.NumberFmt=[];for(var n=Kr(Et),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Et[n[a]];var i=e[0].match(da);if(i)for(a=0;a<i.length;++a){var s=Ct(i[a]);switch(Ms(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=er(vr(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}co(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function GB(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ze("numFmt",null,{numFmtId:n,formatCode:hr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ze("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var D1=["numFmtId","fillId","fontId","borderId","xfId"],O1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function XB(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(da)||[]).forEach(function(i){var s=Ct(i),o=0;switch(Ms(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<D1.length;++o)n[D1[o]]&&(n[D1[o]]=parseInt(n[D1[o]],10));for(o=0;o<O1.length;++o)n[O1[o]]&&(n[O1[o]]=Pr(n[O1[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Pr(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function KB(e){var t=[];return t[t.length]=Ze("cellXfs",null),e.forEach(function(r){t[t.length]=Ze("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ze("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var YB=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&qB(f,u,c),(f=o.match(a))&&VB(f,u,l,c),(f=o.match(n))&&$B(f,u,l,c),(f=o.match(i))&&HB(f,u,l,c),(f=o.match(r))&&XB(f,u,c),u}}();function LN(e,t){var r=[on,Ze("styleSheet",null,{xmlns:Uc[0],"xmlns:vt":_n.vt})],n;return e.SSF&&(n=GB(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=KB(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function JB(e,t){var r=e.read_shift(2),n=oa(e);return[r,n]}function ZB(e,t,r){r||(r=Ie(6+4*t.length)),r.write_shift(2,e),jn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function QB(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=IR(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=jR(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=oa(e),n}function eU(e,t){t||(t=Ie(25+4*32)),t.write_shift(2,e.sz*20),DR(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Up(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),jn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var tU=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Fv,rU=ua;function P4(e,t){t||(t=Ie(4*3+8*7+16*1)),Fv||(Fv=jg(tU));var r=Fv[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Up({auto:1},t),Up({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function nU(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function jN(e,t,r){r||(r=Ie(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ef(e,t){return t||(t=Ie(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var aU=ua;function iU(e,t){return t||(t=Ie(51)),t.write_shift(1,0),Ef(null,t),Ef(null,t),Ef(null,t),Ef(null,t),Ef(null,t),t.length>t.l?t.slice(0,t.l):t}function sU(e,t){return t||(t=Ie(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Bp(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function oU(e,t,r){var n=Ie(2052);return n.write_shift(4,e),Bp(t,n),Bp(r,n),n.length>n.l?n.slice(0,n.l):n}function lU(e,t,r){var n={};n.NumberFmt=[];for(var a in Et)n.NumberFmt[a]=Et[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Eo(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],co(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Hp(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(u),s=!0;break;case 38:i.pop(),s=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function cU(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ze(e,615,is(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ze(e,44,ZB(a,t[a]))}),ze(e,616))}}function uU(e){var t=1;ze(e,611,is(t)),ze(e,43,eU({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ze(e,612)}function fU(e){var t=2;ze(e,603,is(t)),ze(e,45,P4({patternType:"none"})),ze(e,45,P4({patternType:"gray125"})),ze(e,604)}function dU(e){var t=1;ze(e,613,is(t)),ze(e,46,iU()),ze(e,614)}function hU(e){var t=1;ze(e,626,is(t)),ze(e,47,jN({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ze(e,627)}function pU(e,t){ze(e,617,is(t.length)),t.forEach(function(r){ze(e,47,jN(r,0))}),ze(e,618)}function gU(e){var t=1;ze(e,619,is(t)),ze(e,48,sU({xfId:0,builtinId:0,name:"Normal"})),ze(e,620)}function mU(e){var t=0;ze(e,505,is(t)),ze(e,506)}function vU(e){var t=0;ze(e,508,oU(t,"TableStyleMedium9","PivotStyleMedium4")),ze(e,509)}function xU(e,t){var r=Ua();return ze(r,278),cU(r,e.SSF),uU(r),fU(r),dU(r),hU(r),pU(r,t.cellXfs),gU(r),mU(r),vU(r),ze(r,279),r.end()}var yU=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function wU(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(da)||[]).forEach(function(a){var i=Ct(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[yU.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function bU(){}function _U(){}var kU=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,SU=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,EU=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function NU(e,t,r){t.themeElements={};var n;[["clrScheme",kU,wU],["fontScheme",SU,bU],["fmtScheme",EU,_U]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var AU=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function IN(e,t){(!e||e.length===0)&&(e=pw());var r,n={};if(!(r=e.match(AU)))throw new Error("themeElements not found in theme");return NU(r[0],n,t),n.raw=e,n}function pw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[on];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function CU(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=N6(i,{type:"array"})}catch{return}var o=ri(s,"theme/theme/theme1.xml",!0);if(o)return IN(o,r)}}function TU(e){return e.read_shift(4)}function PU(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=FU(e,4);break;case 2:t.xclrValue=hN(e);break;case 3:t.xclrValue=TU(e);break;case 4:e.l+=4;break}return e.l+=8,t}function FU(e,t){return ua(e,t)}function LU(e,t){return ua(e,t)}function jU(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=PU(e);break;case 6:n[1]=LU(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function IU(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(jU(e,r-e.l));return{ixfe:n,ext:i}}function DU(e,t){t.forEach(function(r){switch(r[0]){}})}function OU(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:oa(e)}}function RU(e){var t=Ie(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),jn(e.name,t),t.slice(0,t.l)}function MU(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function BU(e){var t=Ie(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function UU(e,t){var r=Ie(8+2*t.length);return r.write_shift(4,e),jn(t,r),r.slice(0,r.l)}function zU(e){return e.l+=4,e.read_shift(4)!=0}function WU(e,t){var r=Ie(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function HU(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return Eo(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!c.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function $U(){var e=Ua();return ze(e,332),ze(e,334,is(1)),ze(e,335,RU({name:"XLDAPR",version:12e4,flags:3496657072})),ze(e,336),ze(e,339,UU(1,"XLDAPR")),ze(e,52),ze(e,35,is(514)),ze(e,4096,is(0)),ze(e,4097,Ni(1)),ze(e,36),ze(e,53),ze(e,340),ze(e,337,WU(1,!0)),ze(e,51,BU([[1,0]])),ze(e,338),ze(e,333),e.end()}function VU(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(da,function(o){var l=Ct(o);switch(Ms(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function DN(){var e=[on];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function qU(e){var t=[];if(!e)return t;var r=1;return(e.match(da)||[]).forEach(function(n){var a=Ct(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function GU(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=At(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function XU(e,t,r){var n=[];return Eo(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function KU(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Eo(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function YU(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Gu=1024;function ON(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ze("xml",null,{"xmlns:v":Za.v,"xmlns:o":Za.o,"xmlns:x":Za.x,"xmlns:mv":Za.mv}).replace(/\/>/,">"),Ze("o:shapelayout",Ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ze("v:shapetype",[Ze("v:stroke",null,{joinstyle:"miter"}),Ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gu<e*1e3;)Gu+=1e3;return t.forEach(function(i){var s=Br(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ze("v:fill",l,o),u={on:"t",obscured:"t"};++Gu,a=a.concat(["<v:shape"+Ld({id:"_x0000_s"+Gu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ze("v:shadow",null,u),Ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),zn("x:AutoFill","False"),zn("x:Row",String(s.r)),zn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function F4(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=Br(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var l=tr(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Bt(l);c!==e["!ref"]&&(e["!ref"]=c)}i.c||(i.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function JU(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ct(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Br(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&fw(f[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function RN(e){var t=[on,Ze("comments",null,{xmlns:Uc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=hr(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(hr(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(zn("t",hr(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(zn("t",hr(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function ZU(e,t){var r=[],n=!1,a={},i=0;return e.replace(da,function(o,l){var c=Ct(o);switch(Ms(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":a.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function QU(e,t,r){var n=[on,Ze("ThreadedComments",null,{xmlns:_n.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ze("threadedComment",zn("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function ez(e,t){var r=[],n=!1;return e.replace(da,function(i){var s=Ct(i);switch(Ms(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function tz(e){var t=[on,Ze("personList",null,{xmlns:_n.TCMNT,"xmlns:x":Uc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function rz(e){var t={};t.iauthor=e.read_shift(4);var r=$c(e);return t.rfx=r.s,t.ref=At(r.s),e.l+=16,t}function nz(e,t){return t==null&&(t=Ie(36)),t.write_shift(4,e[1].iauthor),L0(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var az=oa;function iz(e){return jn(e.slice(0,54))}function sz(e,t){var r=[],n=[],a={},i=!1;return Eo(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function oz(e){var t=Ua(),r=[];return ze(t,628),ze(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ze(t,632,iz(a.a)))})}),ze(t,631),ze(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Br(n[0]),e:Br(n[0])};ze(t,635,nz([i,a])),a.t&&a.t.length>0&&ze(t,637,TR(a)),ze(t,636),delete a.iauthor})}),ze(t,634),ze(t,629),t.end()}var lz="application/vnd.ms-office.vbaProject";function cz(e){var t=yt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");yt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),yt.write(t)}function uz(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&yt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var MN=["xlsb","xlsm","xlam","biff8","xla"];function fz(){return{"!type":"dialog"}}function dz(){return{"!type":"dialog"}}function hz(){return{"!type":"macro"}}function pz(){return{"!type":"macro"}}var a0=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+Mr(u)+(l?"":"$")+sn(c)}return function(a,i){return t=i,a.replace(e,r)}}(),gw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,mw=function(){return function(t,r){return t.replace(gw,function(n,a,i,s,o,l){var c=rw(s)-(i?0:r.c),u=tw(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",d=c==0?"":i?c+1:"["+c+"]";return a+"R"+f+"C"+d})}}();function BN(e,t){return e.replace(gw,function(r,n,a,i,s,o){return n+(a=="$"?a+i:Mr(rw(i)+t.c))+(s=="$"?s+o:sn(tw(o)+t.r))})}function gz(e,t,r){var n=za(t),a=n.s,i=Br(r),s={r:i.r-a.r,c:i.c-a.c};return BN(e,s)}function mz(e){return e.length!=1}function L4(e){return e.replace(/_xlfn\./g,"")}function dn(e){e.l+=1}function Nl(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function UN(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return zN(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Nl(e,2),o=Nl(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function zN(e){var t=Nl(e,2),r=Nl(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function vz(e,t,r){if(r.biff<8)return zN(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Nl(e,2),s=Nl(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function WN(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return xz(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Nl(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function xz(e){var t=Nl(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function yz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function wz(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return bz(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function bz(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function _z(e,t,r){var n=(e[e.l++]&96)>>5,a=UN(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function kz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=UN(e,i,r);return[n,a,s]}function Sz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Ez(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Nz(e,t,r){var n=(e[e.l++]&96)>>5,a=vz(e,t-1,r);return[n,a]}function Az(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function j4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Cz(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Tz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Pz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Fz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Lz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function HN(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function jz(e){return e.read_shift(2),HN(e)}function Iz(e){return e.read_shift(2),HN(e)}function Dz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=WN(e,0,r);return[n,a]}function Oz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=wz(e,0,r);return[n,a]}function Rz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=WN(e,0,r);return[n,a,i]}function Mz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[zW[a],qN[a],n]}function Bz(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Uz(e);return[a,(i[0]===0?qN:UW)[i[1]]]}function Uz(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function zz(e,t,r){e.l+=r&&r.biff==2?3:4}function Wz(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Hz(e){return e.l++,No[e.read_shift(1)]}function $z(e){return e.l++,e.read_shift(2)}function Vz(e){return e.l++,e.read_shift(1)!==0}function qz(e){return e.l++,sa(e)}function Gz(e,t,r){return e.l++,ih(e,t-1,r)}function Xz(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=en(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=No[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=sa(e);break;case 2:r[1]=Vc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Kz(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?$c:Og)(e));return a}function Yz(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=Xz(e,r.biff);return s}function Jz(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Zz(e,t,r){if(r.biff==5)return Qz(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Qz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function eW(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function tW(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function rW(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function nW(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var aW=ua,iW=ua,sW=ua;function oh(e,t,r){return e.l+=2,[yz(e)]}function vw(e){return e.l+=6,[]}var oW=oh,lW=vw,cW=vw,uW=oh;function $N(e){return e.l+=2,[pn(e),e.read_shift(2)&1]}var fW=oh,dW=$N,hW=vw,pW=oh,gW=oh,mW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vW(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=mW[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function xW(e){return e.l+=2,[e.read_shift(4)]}function yW(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function wW(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function bW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _W(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function kW(e){return e.l+=4,[0,0]}var I4={1:{n:"PtgExp",f:Wz},2:{n:"PtgTbl",f:sW},3:{n:"PtgAdd",f:dn},4:{n:"PtgSub",f:dn},5:{n:"PtgMul",f:dn},6:{n:"PtgDiv",f:dn},7:{n:"PtgPower",f:dn},8:{n:"PtgConcat",f:dn},9:{n:"PtgLt",f:dn},10:{n:"PtgLe",f:dn},11:{n:"PtgEq",f:dn},12:{n:"PtgGe",f:dn},13:{n:"PtgGt",f:dn},14:{n:"PtgNe",f:dn},15:{n:"PtgIsect",f:dn},16:{n:"PtgUnion",f:dn},17:{n:"PtgRange",f:dn},18:{n:"PtgUplus",f:dn},19:{n:"PtgUminus",f:dn},20:{n:"PtgPercent",f:dn},21:{n:"PtgParen",f:dn},22:{n:"PtgMissArg",f:dn},23:{n:"PtgStr",f:Gz},26:{n:"PtgSheet",f:yW},27:{n:"PtgEndSheet",f:wW},28:{n:"PtgErr",f:Hz},29:{n:"PtgBool",f:Vz},30:{n:"PtgInt",f:$z},31:{n:"PtgNum",f:qz},32:{n:"PtgArray",f:Az},33:{n:"PtgFunc",f:Mz},34:{n:"PtgFuncVar",f:Bz},35:{n:"PtgName",f:Jz},36:{n:"PtgRef",f:Dz},37:{n:"PtgArea",f:_z},38:{n:"PtgMemArea",f:eW},39:{n:"PtgMemErr",f:aW},40:{n:"PtgMemNoMem",f:iW},41:{n:"PtgMemFunc",f:tW},42:{n:"PtgRefErr",f:rW},43:{n:"PtgAreaErr",f:Sz},44:{n:"PtgRefN",f:Oz},45:{n:"PtgAreaN",f:Nz},46:{n:"PtgMemAreaN",f:bW},47:{n:"PtgMemNoMemN",f:_W},57:{n:"PtgNameX",f:Zz},58:{n:"PtgRef3d",f:Rz},59:{n:"PtgArea3d",f:kz},60:{n:"PtgRefErr3d",f:nW},61:{n:"PtgAreaErr3d",f:Ez},255:{}},SW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},EW={1:{n:"PtgElfLel",f:$N},2:{n:"PtgElfRw",f:pW},3:{n:"PtgElfCol",f:oW},6:{n:"PtgElfRwV",f:gW},7:{n:"PtgElfColV",f:uW},10:{n:"PtgElfRadical",f:fW},11:{n:"PtgElfRadicalS",f:hW},13:{n:"PtgElfColS",f:lW},15:{n:"PtgElfColSV",f:cW},16:{n:"PtgElfRadicalLel",f:dW},25:{n:"PtgList",f:vW},29:{n:"PtgSxName",f:xW},255:{}},NW={0:{n:"PtgAttrNoop",f:kW},1:{n:"PtgAttrSemi",f:Lz},2:{n:"PtgAttrIf",f:Pz},4:{n:"PtgAttrChoose",f:Cz},8:{n:"PtgAttrGoto",f:Tz},16:{n:"PtgAttrSum",f:zz},32:{n:"PtgAttrBaxcel",f:j4},33:{n:"PtgAttrBaxcel",f:j4},64:{n:"PtgAttrSpace",f:jz},65:{n:"PtgAttrSpaceSemi",f:Iz},128:{n:"PtgAttrIfError",f:Fz},255:{}};function lh(e,t,r,n){if(n.biff<8)return ua(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=Yz(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=Kz(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(ua(e,t)),i}function ch(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=I4[i]||I4[SW[i]],(i===24||i===25)&&(a=(i===24?EW:NW)[e[e.l+1]]),!a||!a.f?ua(e,t):s.push([a.n,a.f(e,t,r)]);return s}function AW(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var CW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function TW(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function VN(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function D4(e,t,r){var n=VN(e,t,r);return n=="#REF"?n:TW(n,r)}function ra(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,d=0,h,v="";if(!e[0]||!e[0][0])return"";for(var m=-1,y="",x=0,b=e[0].length;x<b;++x){var w=e[0][x];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:y=Gr(" ",e[0][m][1][1]);break;case 1:y=Gr("\r",e[0][m][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+y,m=-1}o.push(c+CW[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Qf(w[1][1],s,a),o.push(ed(u,i));break;case"PtgRefN":u=r?Qf(w[1][1],r,a):w[1][1],o.push(ed(u,i));break;case"PtgRef3d":f=w[1][1],u=Qf(w[1][2],s,a),v=D4(n,f,a),o.push(v+"!"+ed(u,i));break;case"PtgFunc":case"PtgFuncVar":var S=w[1][0],L=w[1][1];S||(S=0),S&=127;var j=S==0?[]:o.slice(-S);o.length-=S,L==="User"&&(L=j.shift()),o.push(L+"("+j.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":h=u4(w[1][1],r?{s:r}:s,a),o.push(Av(h,a));break;case"PtgArea":h=u4(w[1][1],s,a),o.push(Av(h,a));break;case"PtgArea3d":f=w[1][1],h=w[1][2],v=D4(n,f,a),o.push(v+"!"+Av(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var N=(n.names||[])[d-1]||(n[0]||[])[d],E=N?N.Name:"SH33TJSNAME"+String(d);E&&E.slice(0,6)=="_xlfn."&&!a.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var P=w[1][1];d=w[1][2];var M;if(a.biff<=5)P<0&&(P=-P),n[P]&&(M=n[P][d]);else{var F="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][d]&&n[P][d].itab>0&&(F=n.SheetNames[n[P][d].itab-1]+"!"):F=n.SheetNames[d-1]+"!"),n[P]&&n[P][d])F+=n[P][d].Name;else if(n[0]&&n[0][d])F+=n[0][d].Name;else{var T=(VN(n,P,a)||"").split(";;");T[d-1]?F=T[d-1]:F+="SH33TJSERRX"}o.push(F);break}M||(M={Name:"SH33TJSERRY"}),o.push(M.Name);break;case"PtgParen":var H="(",W=")";if(m>=0){switch(y="",e[0][m][1][0]){case 2:H=Gr(" ",e[0][m][1][1])+H;break;case 3:H=Gr("\r",e[0][m][1][1])+H;break;case 4:W=Gr(" ",e[0][m][1][1])+W;break;case 5:W=Gr("\r",e[0][m][1][1])+W;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(H+o.pop()+W);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var Q={c:r.c,r:r.r};if(n.sharedf[At(u)]){var V=n.sharedf[At(u)];o.push(ra(V,s,Q,n,a))}else{var z=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(ra(c[1],s,Q,n,a)),z=!0;break}z||o.push(w[1])}break;case"PtgArray":o.push("{"+AW(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var X=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&X.indexOf(e[0][x][0])==-1){w=e[0][m];var D=!0;switch(w[1][0]){case 4:D=!1;case 0:y=Gr(" ",w[1][1]);break;case 5:D=!1;case 1:y=Gr("\r",w[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((D?y:"")+o.pop()+(D?"":y)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function PW(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],ua(e,t-2)];var o=ch(e,s,r);return t!==s+a&&(i=lh(e,t-s-a,o,r)),e.l=n,[o,i]}function FW(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],ua(e,t-2)];var o=ch(e,s,r);return t!==s+a&&(i=lh(e,t-s-a,o,r)),e.l=n,[o,i]}function LW(e,t,r,n){var a=e.l+t,i=ch(e,n,r),s;return a!==e.l&&(s=lh(e,a-e.l,i,r)),[i,s]}function jW(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=ch(e,i,r);return i==65535?[[],ua(e,t-2)]:(t!==i+2&&(a=lh(e,n-i-2,s,r)),[s,a])}function IW(e){var t;if(so(e,e.l+6)!==65535)return[sa(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function DW(e){if(e==null){var t=Ie(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Cc(e);return Cc(0)}function Lv(e,t,r){var n=e.l+t,a=Bs(e);r.biff==2&&++e.l;var i=IW(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=FW(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function OW(e,t,r,n,a){var i=Pc(t,r,a),s=DW(e.v),o=Ie(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Ie(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var f=Fn([i,s,o,c]);return f}function Rg(e,t,r){var n=e.read_shift(4),a=ch(e,n,r),i=e.read_shift(4),s=i>0?lh(e,i,a,r):null;return[a,s]}var RW=Rg,Mg=Rg,MW=Rg,BW=Rg,UW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},qN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},zW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function O4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function WW(e){var t="of:="+e.replace(gw,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function jv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function HW(e){return e.replace(/\./,"!")}var rd={},i0={},nd=typeof Map<"u";function xw(e,t,r){var n=0,a=e.length;if(r){if(nd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=nd?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(nd?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Bg(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(aa=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Rd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=$p(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function wc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ul(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){co(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function GN(e,t,r,n,a,i){try{n.cellNF&&(e.z=Et[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=jr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Et[t]==null&&co(zO[t]||"General",t),e.t==="e")e.w=e.w||No[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pd(e.v);else if(e.t==="d"){var s=Sn(e.v);(s|0)===s?e.w=s.toString(10):e.w=Pd(s)}else{if(e.v===void 0)return"";e.w=Nc(e.v,i0)}else e.t==="d"?e.w=Di(t,Sn(e.v),i0):e.w=Di(t,e.v,i0)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Hp(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Hp(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function $W(e,t,r){if(e&&e["!ref"]){var n=tr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function VW(e,t){var r=tr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Bt(r))}var qW=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,GW=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,XW=/<(?:\w:)?hyperlink [^>]*>/mg,KW=/"(\w*:\w*)"/,YW=/<(?:\w:)?col\b[^>]*[\/]?>/g,JW=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,ZW=/<(?:\w:)?pageMargins[^>]*\/>/g,XN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,QW=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,eH=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tH(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(GW);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var d=c.match(XN);d?yw(d[0],o,a,r):(d=c.match(QW))&&nH(d[0],d[1]||"",o,a,r);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var v=c.slice(h,h+50).match(KW);v&&VW(o,v[1])}var m=c.match(eH);m&&m[1]&&mH(m[1],a);var y=[];if(t.cellStyles){var x=c.match(YW);x&&fH(y,x)}f&&yH(f[1],o,t,l,i,s);var b=u.match(JW);b&&(o["!autofilter"]=hH(b[0]));var w=[],S=u.match(qW);if(S)for(h=0;h!=S.length;++h)w[h]=tr(S[h].slice(S[h].indexOf('"')+1));var L=u.match(XW);L&&lH(o,L,n);var j=u.match(ZW);if(j&&(o["!margins"]=cH(Ct(j[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Bt(l)),t.sheetRows>0&&o["!ref"]){var N=tr(o["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>l.e.r&&(N.e.r=l.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>l.e.c&&(N.e.c=l.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Bt(N))}return y.length>0&&(o["!cols"]=y),w.length>0&&(o["!merges"]=w),o}function rH(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Bt(e[r])+'"/>';return t+"</mergeCells>"}function yw(e,t,r,n){var a=Ct(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=er(vr(a.codeName)))}function nH(e,t,r,n,a){yw(e.slice(0,e.indexOf(">")),r,n,a)}function aH(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,s.codeName=Cs(hr(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Ze("outlinePr",null,c)}!i&&!o||(a[a.length]=Ze("sheetPr",o,s))}var iH=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sH=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function oH(e){var t={sheet:1};return iH.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),sH.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=dw(e.password).toString(16).toUpperCase()),Ze("sheetProtection",null,t)}function lH(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Ct(vr(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+er(i.location))):(i.Target="#"+er(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=tr(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=At({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function cH(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function uH(e){return wc(e),Ze("pageMargins",null,e)}function fH(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ct(t[n],!0);a.hidden&&(a.hidden=Pr(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,hw(a.width)),El(a);i<=s;)e[i++]=Ir(a)}}function dH(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ze("col",null,Bg(a,n)));return r[r.length]="</cols>",r.join("")}function hH(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function pH(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Bt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=za(a);s.s.r==s.e.r&&(s.e.r=za(t["!ref"]).e.r,a=Bt(s));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ze("autoFilter",null,{ref:a})}var gH=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mH(e,t){t.Views||(t.Views=[{}]),(e.match(gH)||[]).forEach(function(r,n){var a=Ct(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Pr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function vH(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ze("sheetViews",Ze("sheetView",null,a),{})}function xH(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=No[e.v];break;case"d":n&&n.cellDates?a=jr(e.v,-1).toISOString():(e=Ir(e),e.t="n",a=""+(e.v=Sn(jr(e.v)))),typeof e.z>"u"&&(e.z=Et[14]);break;default:a=e.v;break}var o=zn("v",hr(a)),l={r:t},c=Ul(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=zn("v",""+xw(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ze("f",hr(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Ze("c",o,l)}var yH=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Fd("v"),s=Fd("f");return function(l,c,u,f,d,h){for(var v=0,m="",y=[],x=[],b=0,w=0,S=0,L="",j,N,E=0,P=0,M,F,T=0,H=0,W=Array.isArray(h.CellXf),Q,V=[],z=[],X=Array.isArray(c),D=[],ne={},ge=!1,C=!!u.sheetStubs,R=l.split(t),B=0,U=R.length;B!=U;++B){m=R[B].trim();var Y=m.length;if(Y!==0){var ue=0;e:for(v=0;v<Y;++v)switch(m[v]){case">":if(m[v-1]!="/"){++v;break e}if(u&&u.cellStyles){if(N=Ct(m.slice(ue,v),!0),E=N.r!=null?parseInt(N.r,10):E+1,P=-1,u.sheetRows&&u.sheetRows<E)continue;ne={},ge=!1,N.ht&&(ge=!0,ne.hpt=parseFloat(N.ht),ne.hpx=y0(ne.hpt)),N.hidden=="1"&&(ge=!0,ne.hidden=!0),N.outlineLevel!=null&&(ge=!0,ne.level=+N.outlineLevel),ge&&(D[E-1]=ne)}break;case"<":ue=v;break}if(ue>=v)break;if(N=Ct(m.slice(ue,v),!0),E=N.r!=null?parseInt(N.r,10):E+1,P=-1,!(u.sheetRows&&u.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),u&&u.cellStyles&&(ne={},ge=!1,N.ht&&(ge=!0,ne.hpt=parseFloat(N.ht),ne.hpx=y0(ne.hpt)),N.hidden=="1"&&(ge=!0,ne.hidden=!0),N.outlineLevel!=null&&(ge=!0,ne.level=+N.outlineLevel),ge&&(D[E-1]=ne)),y=m.slice(v).split(e);for(var pe=0;pe!=y.length&&y[pe].trim().charAt(0)=="<";++pe);for(y=y.slice(pe),v=0;v!=y.length;++v)if(m=y[v].trim(),m.length!==0){if(x=m.match(r),b=v,w=0,S=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(b=0,L=x[1],w=0;w!=L.length&&!((S=L.charCodeAt(w)-64)<1||S>26);++w)b=26*b+S;--b,P=b}else++P;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,N=Ct(m.slice(0,w),!0),N.r||(N.r=At({r:E-1,c:P})),L=m.slice(w),j={t:""},(x=L.match(i))!=null&&x[1]!==""&&(j.v=er(x[1])),u.cellFormula){if((x=L.match(s))!=null&&x[1]!==""){if(j.f=er(vr(x[1])).replace(/\r\n/g,`
`),u.xlfn||(j.f=L4(j.f)),x[0].indexOf('t="array"')>-1)j.F=(L.match(a)||[])[1],j.F.indexOf(":")>-1&&V.push([tr(j.F),j.F]);else if(x[0].indexOf('t="shared"')>-1){F=Ct(x[0]);var he=er(vr(x[1]));u.xlfn||(he=L4(he)),z[parseInt(F.si,10)]=[F,he,N.r]}}else(x=L.match(/<f[^>]*\/>/))&&(F=Ct(x[0]),z[F.si]&&(j.f=gz(z[F.si][1],z[F.si][2],N.r)));var ye=Br(N.r);for(w=0;w<V.length;++w)ye.r>=V[w][0].s.r&&ye.r<=V[w][0].e.r&&ye.c>=V[w][0].s.c&&ye.c<=V[w][0].e.c&&(j.F=V[w][1])}if(N.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(C)j.t="z";else continue;else j.t=N.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),j.t){case"n":if(j.v==""||j.v==null){if(!C)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!C)continue;j.t="z"}else M=rd[parseInt(j.v,10)],j.v=M.t,j.r=M.r,u.cellHTML&&(j.h=M.h);break;case"str":j.t="s",j.v=j.v!=null?vr(j.v):"",u.cellHTML&&(j.h=Jy(j.v));break;case"inlineStr":x=L.match(n),j.t="s",x!=null&&(M=fw(x[1]))?(j.v=M.t,u.cellHTML&&(j.h=M.h)):j.v="";break;case"b":j.v=Pr(j.v);break;case"d":u.cellDates?j.v=jr(j.v,1):(j.v=Sn(jr(j.v,1)),j.t="n");break;case"e":(!u||u.cellText!==!1)&&(j.w=j.v),j.v=Y6[j.v];break}if(T=H=0,Q=null,W&&N.s!==void 0&&(Q=h.CellXf[N.s],Q!=null&&(Q.numFmtId!=null&&(T=Q.numFmtId),u.cellStyles&&Q.fillId!=null&&(H=Q.fillId))),GN(j,T,H,u,d,h),u.cellDates&&W&&j.t=="n"&&T0(Et[T])&&(j.t="d",j.v=Dg(j.v)),N.cm&&u.xlmeta){var Pe=(u.xlmeta.Cell||[])[+N.cm-1];Pe&&Pe.type=="XLDAPR"&&(j.D=!0)}if(X){var re=Br(N.r);c[re.r]||(c[re.r]=[]),c[re.r][re.c]=j}else c[N.r]=j}}}}D.length>0&&(c["!rows"]=D)}}();function wH(e,t,r,n){var a=[],i=[],s=tr(e["!ref"]),o="",l,c="",u=[],f=0,d=0,h=e["!rows"],v=Array.isArray(e),m={r:c},y,x=-1;for(d=s.s.c;d<=s.e.c;++d)u[d]=Mr(d);for(f=s.s.r;f<=s.e.r;++f){for(i=[],c=sn(f),d=s.s.c;d<=s.e.c;++d){l=u[d]+c;var b=v?(e[f]||[])[d]:e[l];b!==void 0&&(o=xH(b,l,e,t))!=null&&i.push(o)}(i.length>0||h&&h[f])&&(m={r:c},h&&h[f]&&(y=h[f],y.hidden&&(m.hidden=1),x=-1,y.hpx?x=Md(y.hpx):y.hpt&&(x=y.hpt),x>-1&&(m.ht=x,m.customHeight=1),y.level&&(m.outlineLevel=y.level)),a[a.length]=Ze("row",i.join(""),m))}if(h)for(;f<h.length;++f)h&&h[f]&&(m={r:f+1},y=h[f],y.hidden&&(m.hidden=1),x=-1,y.hpx?x=Md(y.hpx):y.hpt&&(x=y.hpt),x>-1&&(m.ht=x,m.customHeight=1),y.level&&(m.outlineLevel=y.level),a[a.length]=Ze("row","",m));return a.join("")}function KN(e,t,r,n){var a=[on,Ze("worksheet",null,{xmlns:Uc[0],"xmlns:r":_n.r})],i=r.SheetNames[e],s=0,o="",l=r.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",u=tr(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Bt(u)}n||(n={}),l["!comments"]=[];var f=[];aH(l,r,e,t,a),a[a.length]=Ze("dimension",null,{ref:c}),a[a.length]=vH(l,t,e,r),t.sheetFormat&&(a[a.length]=Ze("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=dH(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=wH(l,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=oH(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=pH(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=rH(l["!merges"]));var d=-1,h,v=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(h={ref:m[0]},m[1].Target.charAt(0)!="#"&&(v=fr(n,-1,hr(m[1].Target).replace(/#.*$/,""),qt.HLINK),h["r:id"]="rId"+v),(d=m[1].Target.indexOf("#"))>-1&&(h.location=hr(m[1].Target.slice(d+1))),m[1].Tooltip&&(h.tooltip=hr(m[1].Tooltip)),a[a.length]=Ze("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=uH(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=zn("ignoredErrors",Ze("ignoredError",null,{numberStoredAsText:1,sqref:c}))),f.length>0&&(v=fr(n,-1,"../drawings/drawing"+(e+1)+".xml",qt.DRAW),a[a.length]=Ze("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=f),l["!comments"].length>0&&(v=fr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",qt.VML),a[a.length]=Ze("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function bH(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function _H(e,t,r){var n=Ie(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Md(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,d=-1,h=u<<10;h<u+1<<10;++h){c.c=h;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[At(c)];v&&(f<0&&(f=h),d=h)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,d))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function kH(e,t,r,n){var a=_H(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ze(e,0,a)}var SH=$c,EH=L0;function NH(){}function AH(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=PR(e),r}function CH(e,t,r){r==null&&(r=Ie(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Up({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),V6(e,r),r.slice(0,r.l)}function TH(e){var t=Oi(e);return[t]}function PH(e,t,r){return r==null&&(r=Ie(8)),zc(t,r)}function FH(e){var t=Wc(e);return[t]}function LH(e,t,r){return r==null&&(r=Ie(4)),Hc(t,r)}function jH(e){var t=Oi(e),r=e.read_shift(1);return[t,r,"b"]}function IH(e,t,r){return r==null&&(r=Ie(9)),zc(t,r),r.write_shift(1,e.v?1:0),r}function DH(e){var t=Wc(e),r=e.read_shift(1);return[t,r,"b"]}function OH(e,t,r){return r==null&&(r=Ie(5)),Hc(t,r),r.write_shift(1,e.v?1:0),r}function RH(e){var t=Oi(e),r=e.read_shift(1);return[t,r,"e"]}function MH(e,t,r){return r==null&&(r=Ie(9)),zc(t,r),r.write_shift(1,e.v),r}function BH(e){var t=Wc(e),r=e.read_shift(1);return[t,r,"e"]}function UH(e,t,r){return r==null&&(r=Ie(8)),Hc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function zH(e){var t=Oi(e),r=e.read_shift(4);return[t,r,"s"]}function WH(e,t,r){return r==null&&(r=Ie(12)),zc(t,r),r.write_shift(4,t.v),r}function HH(e){var t=Wc(e),r=e.read_shift(4);return[t,r,"s"]}function $H(e,t,r){return r==null&&(r=Ie(8)),Hc(t,r),r.write_shift(4,t.v),r}function VH(e){var t=Oi(e),r=sa(e);return[t,r,"n"]}function qH(e,t,r){return r==null&&(r=Ie(16)),zc(t,r),Cc(e.v,r),r}function YN(e){var t=Wc(e),r=sa(e);return[t,r,"n"]}function GH(e,t,r){return r==null&&(r=Ie(12)),Hc(t,r),Cc(e.v,r),r}function XH(e){var t=Oi(e),r=sw(e);return[t,r,"n"]}function KH(e,t,r){return r==null&&(r=Ie(12)),zc(t,r),q6(e.v,r),r}function YH(e){var t=Wc(e),r=sw(e);return[t,r,"n"]}function JH(e,t,r){return r==null&&(r=Ie(8)),Hc(t,r),q6(e.v,r),r}function ZH(e){var t=Oi(e),r=nw(e);return[t,r,"is"]}function QH(e){var t=Oi(e),r=oa(e);return[t,r,"str"]}function e$(e,t,r){return r==null&&(r=Ie(12+4*e.v.length)),zc(t,r),jn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function t$(e){var t=Wc(e),r=oa(e);return[t,r,"str"]}function r$(e,t,r){return r==null&&(r=Ie(8+4*e.v.length)),Hc(t,r),jn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function n$(e,t,r){var n=e.l+t,a=Oi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Mg(e,n-e.l,r);s[3]=ra(o,null,a,r.supbooks,r)}else e.l=n;return s}function a$(e,t,r){var n=e.l+t,a=Oi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Mg(e,n-e.l,r);s[3]=ra(o,null,a,r.supbooks,r)}else e.l=n;return s}function i$(e,t,r){var n=e.l+t,a=Oi(e);a.r=r["!row"];var i=sa(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Mg(e,n-e.l,r);s[3]=ra(o,null,a,r.supbooks,r)}else e.l=n;return s}function s$(e,t,r){var n=e.l+t,a=Oi(e);a.r=r["!row"];var i=oa(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Mg(e,n-e.l,r);s[3]=ra(o,null,a,r.supbooks,r)}else e.l=n;return s}var o$=$c,l$=L0;function c$(e,t){return t==null&&(t=Ie(4)),t.write_shift(4,e),t}function u$(e,t){var r=e.l+t,n=$c(e),a=aw(e),i=oa(e),s=oa(e),o=oa(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function f$(e,t){var r=Ie(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));L0({s:Br(e[0]),e:Br(e[0])},r),iw("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return jn(a||"",r),jn(e[1].Tooltip||"",r),jn("",r),r.slice(0,r.l)}function d$(){}function h$(e,t,r){var n=e.l+t,a=G6(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=RW(e,n-e.l,r);s[1]=o}else e.l=n;return s}function p$(e,t,r){var n=e.l+t,a=$c(e),i=[a];if(r.cellFormula){var s=BW(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function g$(e,t,r){r==null&&(r=Ie(18));var n=Bg(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var JN=["left","right","top","bottom","header","footer"];function m$(e){var t={};return JN.forEach(function(r){t[r]=sa(e)}),t}function v$(e,t){return t==null&&(t=Ie(6*8)),wc(e),JN.forEach(function(r){Cc(e[r],t)}),t}function x$(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function y$(e,t,r){r==null&&(r=Ie(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function w$(e){var t=Ie(24);return t.write_shift(4,4),t.write_shift(4,1),L0(e,t),t}function b$(e,t){return t==null&&(t=Ie(16*4+2)),t.write_shift(2,e.password?dw(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function _$(){}function k$(){}function S$(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,d=!1,h,v,m,y,x,b,w,S,L,j=[];o.biff=12,o["!row"]=0;var N=0,E=!1,P=[],M={},F=o.supbooks||a.supbooks||[[]];if(F.sharedf=M,F.arrayf=P,F.SheetNames=a.SheetNames||a.Sheets.map(function(X){return X.name}),!o.supbooks&&(o.supbooks=F,a.Names))for(var T=0;T<a.Names.length;++T)F[0][T+1]=a.Names[T];var H=[],W=[],Q=!1;Bd[16]={n:"BrtShortReal",f:YN};var V;if(Eo(e,function(D,ne,ge){if(!d)switch(ge){case 148:c=D;break;case 0:h=D,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),S=sn(y=h.r),o["!row"]=h.r,(D.hidden||D.hpt||D.level!=null)&&(D.hpt&&(D.hpx=y0(D.hpt)),W[D.r]=D);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:D[2]},D[2]){case"n":v.v=D[1];break;case"s":w=rd[D[1]],v.v=w.t,v.r=w.r;break;case"b":v.v=!!D[1];break;case"e":v.v=D[1],o.cellText!==!1&&(v.w=No[v.v]);break;case"str":v.t="s",v.v=D[1];break;case"is":v.t="s",v.v=D[1].t;break}if((m=s.CellXf[D[0].iStyleRef])&&GN(v,m.numFmtId,null,o,i,s),x=D[0].c==-1?x+1:D[0].c,o.dense?(l[y]||(l[y]=[]),l[y][x]=v):l[Mr(x)+S]=v,o.cellFormula){for(E=!1,N=0;N<P.length;++N){var C=P[N];h.r>=C[0].s.r&&h.r<=C[0].e.r&&x>=C[0].s.c&&x<=C[0].e.c&&(v.F=Bt(C[0]),E=!0)}!E&&D.length>3&&(v.f=D[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),o.cellDates&&m&&v.t=="n"&&T0(Et[m.numFmtId])){var R=cc(v.v);R&&(v.t="d",v.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}V&&(V.type=="XLDAPR"&&(v.D=!0),V=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;v={t:"z",v:void 0},x=D[0].c==-1?x+1:D[0].c,o.dense?(l[y]||(l[y]=[]),l[y][x]=v):l[Mr(x)+S]=v,u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),V&&(V.type=="XLDAPR"&&(v.D=!0),V=void 0);break;case 176:j.push(D);break;case 49:V=((o.xlmeta||{}).Cell||[])[D-1];break;case 494:var B=n["!id"][D.relId];for(B?(D.Target=B.Target,D.loc&&(D.Target+="#"+D.loc),D.Rel=B):D.relId==""&&(D.Target="#"+D.loc),y=D.rfx.s.r;y<=D.rfx.e.r;++y)for(x=D.rfx.s.c;x<=D.rfx.e.c;++x)o.dense?(l[y]||(l[y]=[]),l[y][x]||(l[y][x]={t:"z",v:void 0}),l[y][x].l=D):(b=At({c:x,r:y}),l[b]||(l[b]={t:"z",v:void 0}),l[b].l=D);break;case 426:if(!o.cellFormula)break;P.push(D),L=o.dense?l[y][x]:l[Mr(x)+S],L.f=ra(D[1],u,{r:h.r,c:x},F,o),L.F=Bt(D[0]);break;case 427:if(!o.cellFormula)break;M[At(D[0].s)]=D[1],L=o.dense?l[y][x]:l[Mr(x)+S],L.f=ra(D[1],u,{r:h.r,c:x},F,o);break;case 60:if(!o.cellStyles)break;for(;D.e>=D.s;)H[D.e--]={width:D.w/256,hidden:!!(D.flags&1),level:D.level},Q||(Q=!0,hw(D.w/256)),El(H[D.e+1]);break;case 161:l["!autofilter"]={ref:Bt(D)};break;case 476:l["!margins"]=D;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),D.name&&(a.Sheets[r].CodeName=D.name),(D.above||D.left)&&(l["!outline"]={above:D.above,left:D.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),D.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ne.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Bt(c||u)),o.sheetRows&&l["!ref"]){var z=tr(l["!ref"]);o.sheetRows<=+z.e.r&&(z.e.r=o.sheetRows-1,z.e.r>u.e.r&&(z.e.r=u.e.r),z.e.r<z.s.r&&(z.s.r=z.e.r),z.e.c>u.e.c&&(z.e.c=u.e.c),z.e.c<z.s.c&&(z.s.c=z.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Bt(z))}return j.length>0&&(l["!merges"]=j),H.length>0&&(l["!cols"]=H),W.length>0&&(l["!rows"]=W),l}function E$(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Ir(t),t.z=t.z||Et[14],t.v=Sn(jr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Ul(a.cellXfs,t,a),t.l&&i["!links"].push([At(l),t.l]),t.c&&i["!comments"].push([At(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=xw(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?ze(e,18,$H(t,l)):ze(e,7,WH(t,l))):(l.t="str",s?ze(e,17,r$(t,l)):ze(e,6,e$(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?ze(e,13,JH(t,l)):ze(e,2,KH(t,l)):s?ze(e,16,GH(t,l)):ze(e,5,qH(t,l)),!0;case"b":return l.t="b",s?ze(e,15,OH(t,l)):ze(e,4,IH(t,l)),!0;case"e":return l.t="e",s?ze(e,14,UH(t,l)):ze(e,3,MH(t,l)),!0}return s?ze(e,12,LH(t,l)):ze(e,1,PH(t,l)),!0}function N$(e,t,r,n){var a=tr(t["!ref"]||"A1"),i,s="",o=[];ze(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=c;++u){s=sn(u),kH(e,t,a,u);var f=!1;if(u<=a.e.r)for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(o[d]=Mr(d)),i=o[d]+s;var h=l?(t[u]||[])[d]:t[i];if(!h){f=!1;continue}f=E$(e,h,u,d,n,t,f)}}ze(e,146)}function A$(e,t){!t||!t["!merges"]||(ze(e,177,c$(t["!merges"].length)),t["!merges"].forEach(function(r){ze(e,176,l$(r))}),ze(e,178))}function C$(e,t){!t||!t["!cols"]||(ze(e,390),t["!cols"].forEach(function(r,n){r&&ze(e,60,g$(n,r))}),ze(e,391))}function T$(e,t){!t||!t["!ref"]||(ze(e,648),ze(e,649,w$(tr(t["!ref"]))),ze(e,650))}function P$(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=fr(r,-1,n[1].Target.replace(/#.*$/,""),qt.HLINK);ze(e,494,f$(n,a))}}),delete t["!links"]}function F$(e,t,r,n){if(t["!comments"].length>0){var a=fr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",qt.VML);ze(e,551,iw("rId"+a)),t["!legacy"]=a}}function L$(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Bt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=za(i);o.s.r==o.e.r&&(o.e.r=za(t["!ref"]).e.r,i=Bt(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ze(e,161,L0(tr(i))),ze(e,162)}}function j$(e,t,r){ze(e,133),ze(e,137,y$(t,r)),ze(e,138),ze(e,134)}function I$(e,t){t["!protect"]&&ze(e,535,b$(t["!protect"]))}function D$(e,t,r,n){var a=Ua(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=tr(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],ze(a,129),(r.vbaraw||s["!outline"])&&ze(a,147,CH(o,s["!outline"])),ze(a,148,EH(l)),j$(a,s,r.Workbook),C$(a,s),N$(a,s,e,t),I$(a,s),L$(a,s,r,e),A$(a,s),P$(a,s,n),s["!margins"]&&ze(a,476,v$(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&T$(a,s),F$(a,s,e,n),ze(a,130),a.end()}function O$(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=er((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function R$(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=O$(f);u.s.r=u.s.c=0,u.e.c=o,c=Mr(o),d[0].forEach(function(h,v){s[c+sn(v)]={t:"n",v:h,z:d[1]},l=v}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=Bt(u)),s}function M$(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(XN);return o&&yw(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function B$(e,t){e.l+=10;var r=oa(e);return{name:r}}function U$(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Eo(e,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var ww=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],z$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],W$=[],H$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function R4(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Pr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function M4(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Pr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ZN(e){M4(e.WBProps,ww),M4(e.CalcPr,H$),R4(e.WBView,z$),R4(e.Sheets,W$),i0.date1904=Pr(e.WBProps.date1904)}function $$(e){return!e.Workbook||!e.Workbook.WBProps?"false":Pr(e.Workbook.WBProps.date1904)?"true":"false"}var V$="][*?/\\".split("");function QN(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return V$.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function q$(e,t,r){e.forEach(function(n,a){QN(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function G$(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];q$(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)$W(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var X$=/<\w+:workbook/;function K$(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(da,function(l,c){var u=Ct(l);switch(Ms(u[0])){case"<?xml":break;case"<workbook":l.match(X$)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ww.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Pr(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=vr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=er(vr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=vr(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Pr(u.hidden||"0")&&(i.Hidden=!0),s=c+l.length;break;case"</definedName>":i.Ref=er(vr(e.slice(s,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Uc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ZN(r),r}function eA(e){var t=[on];t[t.length]=Ze("workbook",null,{xmlns:Uc[0],"xmlns:r":_n.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ww.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ze("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:hr(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ze("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Ze("definedName",hr(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Y$(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=m2(e),r.name=oa(e),r}function J$(e,t){return t||(t=Ie(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),iw(e.strRelID,t),jn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Z$(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?oa(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Q$(e,t){t||(t=Ie(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),V6(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function eV(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function tV(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=FR(e),s=MW(e,0,r),o=aw(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function rV(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Bd[16]={n:"BrtFRTArchID$",f:eV},Eo(e,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=ra(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),ZN(r),r.Names=i,r.supbooks=s,r}function nV(e,t){ze(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ze(e,156,J$(a))}ze(e,144)}function aV(e,t){t||(t=Ie(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return jn("SheetJS",t),jn(jp.version,t),jn(jp.version,t),jn("7262",t),t.length>t.l?t.slice(0,t.l):t}function iV(e,t){t||(t=Ie(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function sV(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(ze(e,135),ze(e,158,iV(a)),ze(e,136))}}function oV(e,t){var r=Ua();return ze(r,131),ze(r,128,aV()),ze(r,153,Q$(e.Workbook&&e.Workbook.WBProps||null)),sV(r,e),nV(r,e),ze(r,132),r.end()}function lV(e,t,r){return t.slice(-4)===".bin"?rV(e,r):K$(e,r)}function cV(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?S$(e,n,r,a,i,s,o):tH(e,n,r,a,i,s,o)}function uV(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?U$(e,n,r,a,i):M$(e,n,r,a,i)}function fV(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?hz():pz()}function dV(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?fz():dz()}function hV(e,t,r,n){return t.slice(-4)===".bin"?lU(e,r,n):YB(e,r,n)}function pV(e,t,r){return IN(e,r)}function gV(e,t,r){return t.slice(-4)===".bin"?gB(e,r):dB(e,r)}function mV(e,t,r){return t.slice(-4)===".bin"?sz(e,r):JU(e,r)}function vV(e,t,r){return t.slice(-4)===".bin"?XU(e):qU(e)}function xV(e,t,r,n){return r.slice(-4)===".bin"?KU(e,t,r,n):void 0}function yV(e,t,r){return t.slice(-4)===".bin"?HU(e,t,r):VU(e,t,r)}function wV(e,t,r){return(t.slice(-4)===".bin"?oV:eA)(e)}function bV(e,t,r,n,a){return(t.slice(-4)===".bin"?D$:KN)(e,r,n,a)}function _V(e,t,r){return(t.slice(-4)===".bin"?xU:LN)(e,r)}function kV(e,t,r){return(t.slice(-4)===".bin"?xB:SN)(e,r)}function SV(e,t,r){return(t.slice(-4)===".bin"?oz:RN)(e)}function EV(e){return(e.slice(-4)===".bin"?$U:DN)()}var tA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,rA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Xi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var a=e.match(tA),i,s,o,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(rA),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function NV(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(tA),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(rA),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var ad;function AV(e,t){var r=ad[e]||er(e);return r==="General"?Nc(t):Di(r,t)}function CV(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Pr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=jr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[er(t)]=a}function TV(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||No[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pd(e.v):e.w=Nc(e.v):e.w=AV(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=ad[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&T0(n)){var a=cc(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function PV(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=WB[n.Pattern]||n.Pattern)}e[t.ID]=t}function FV(e,t,r,n,a,i,s,o,l,c){var u="General",f=n.StyleID,d={};c=c||{};var h=[],v=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Pr(e);break;case"String":n.t="s",n.r=t4(er(e)),n.v=e.indexOf("<")>-1?er(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(jr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=er(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Y6[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=t4(t||e));break}if(TV(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=er(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=a0(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=a0("RC:RC",a):n.ArrayRange&&(n.F=a0(n.ArrayRange,a),l.push([tr(n.F),n.F]))}else for(v=0;v<l.length;++v)a.r>=l[v][0].s.r&&a.r<=l[v][0].e.r&&a.c>=l[v][0].s.c&&a.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(h.forEach(function(y){!d.patternType&&y.patternType&&(d.patternType=y.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function LV(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Iv(e,t){var r=t||{};P0();var n=Ff(Zy(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=vr(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Ir(r);return s.type="string",x0.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Qe){a.indexOf("<"+Qe)>=0&&(i=!0)}),i)return vq(n,r);ad={"General Number":"General","General Date":Et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Et[15],"Short Date":Et[14],"Long Time":Et[19],"Medium Time":Et[18],"Short Time":Et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Et[2],Standard:Et[4],Percent:Et[10],Scientific:Et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],d=r.dense?[]:{},h="",v={},m={},y=Xi('<Data ss:Type="String">'),x=0,b=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},j={},N="",E=0,P=[],M={},F={},T=0,H=[],W=[],Q={},V=[],z,X=!1,D=[],ne=[],ge={},C=0,R=0,B={Sheets:[],WBProps:{date1904:!1}},U={};jd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";o=jd.exec(n);)switch(o[3]=(Y=o[3]).toLowerCase()){case"data":if(Y=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?FV(n.slice(x,o.index),N,y,l[l.length-1][0]=="comment"?Q:v,{c:b,r:w},L,V[b],m,D,r):(N="",y=Xi(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(W.length>0&&(v.c=W),(!r.sheetRows||r.sheetRows>w)&&v.v!==void 0&&(r.dense?(d[w]||(d[w]=[]),d[w][b]=v):d[Mr(b)+sn(w)]=v),v.HRef&&(v.l={Target:er(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(C=b+(parseInt(v.MergeAcross,10)|0),R=w+(parseInt(v.MergeDown,10)|0),P.push({s:{c:b,r:w},e:{c:C,r:R}})),!r.sheetStubs)v.MergeAcross?b=C+1:++b;else if(v.MergeAcross||v.MergeDown){for(var ue=b;ue<=C;++ue)for(var pe=w;pe<=R;++pe)(ue>b||pe>w)&&(r.dense?(d[pe]||(d[pe]=[]),d[pe][ue]={t:"z"}):d[Mr(ue)+sn(pe)]={t:"z"});b=C+1}else++b;else v=NV(o[0]),v.Index&&(b=+v.Index-1),b<S.s.c&&(S.s.c=b),b>S.e.c&&(S.e.c=b),o[0].slice(-2)==="/>"&&++b,W=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),o[0].slice(-2)==="/>"&&(m=Xi(o[0]),m.Index&&(w=+m.Index-1)),b=0,++w):(m=Xi(o[0]),m.Index&&(w=+m.Index-1),ge={},(m.AutoFitHeight=="0"||m.Height)&&(ge.hpx=parseInt(m.Height,10),ge.hpt=Md(ge.hpx),ne[w]=ge),m.Hidden=="1"&&(ge.hidden=!0,ne[w]=ge));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(h),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(d["!ref"]=Bt(S),r.sheetRows&&r.sheetRows<=S.e.r&&(d["!fullref"]=d["!ref"],S.e.r=r.sheetRows-1,d["!ref"]=Bt(S))),P.length&&(d["!merges"]=P),V.length>0&&(d["!cols"]=V),ne.length>0&&(d["!rows"]=ne),u[h]=d}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,l.push([o[3],!1]),c=Xi(o[0]),h=er(c.Name),d=r.dense?[]:{},P=[],D=[],ne=[],U={name:h,Hidden:0},B.Sheets.push(U);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),V=[],X=!1}break;case"style":o[1]==="/"?PV(L,j,r):j=Xi(o[0]);break;case"numberformat":j.nf=er(Xi(o[0]).Format||"General"),ad[j.nf]&&(j.nf=ad[j.nf]);for(var he=0;he!=392&&Et[he]!=j.nf;++he);if(he==392){for(he=57;he!=392;++he)if(Et[he]==null){co(j.nf,he);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(z=Xi(o[0]),z.Hidden&&(z.hidden=!0,delete z.Hidden),z.Width&&(z.wpx=parseInt(z.Width,10)),!X&&z.wpx>10){X=!0,aa=PN;for(var ye=0;ye<V.length;++ye)V[ye]&&El(V[ye])}X&&El(z),V[z.Index-1||V.length]=z;for(var Pe=0;Pe<+z.Span;++Pe)V[V.length]=Ir(z);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var re=Ct(o[0]),Ue={Name:re.Name,Ref:a0(re.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Ue.Sheet=B.Sheets.length-1),B.Names.push(Ue);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?N+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Xi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?r9(M,Y,n.slice(T,o.index)):T=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));LV(Q),W.push(Q)}else l.push([o[3],!1]),c=Xi(o[0]),Q={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ye=Xi(o[0]);d["!autofilter"]={ref:a0(Ye.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return H4(n,r);var Ce=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ce=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ce=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ce=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ce=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(T,o.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else T=o.index+o[0].length;break;case"header":d["!margins"]||wc(d["!margins"]={},"xlml"),isNaN(+Ct(o[0]).Margin)||(d["!margins"].header=+Ct(o[0]).Margin);break;case"footer":d["!margins"]||wc(d["!margins"]={},"xlml"),isNaN(+Ct(o[0]).Margin)||(d["!margins"].footer=+Ct(o[0]).Margin);break;case"pagemargins":var oe=Ct(o[0]);d["!margins"]||wc(d["!margins"]={},"xlml"),isNaN(+oe.Top)||(d["!margins"].top=+oe.Top),isNaN(+oe.Left)||(d["!margins"].left=+oe.Left),isNaN(+oe.Right)||(d["!margins"].right=+oe.Right),isNaN(+oe.Bottom)||(d["!margins"].bottom=+oe.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ce=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ce=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ce=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ce=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ce=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ce=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ce=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ce=!1}break;case"smarttags":break;default:Ce=!1;break}if(Ce||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?CV(F,Y,H,n.slice(T,o.index)):(H=o,T=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=u),De.SheetNames=f,De.Workbook=B,De.SSF=Ir(Et),De.Props=M,De.Custprops=F,De}function k2(e,t){switch(_w(t=t||{}),t.type||"base64"){case"base64":return Iv(li(e),t);case"binary":case"buffer":case"file":return Iv(e,t);case"array":return Iv(Ml(e),t)}}function jV(e,t){var r=[];return e.Props&&r.push(n9(e.Props,t)),e.Custprops&&r.push(a9(e.Props,e.Custprops)),r.join("")}function IV(){return""}function DV(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ze("NumberFormat",null,{"ss:Format":hr(Et[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Ze("Style",i.join(""),s))}),Ze("Styles",r.join(""))}function nA(e){return Ze("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+mw(e.Ref,{r:0,c:0})})}function OV(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(nA(a)))}return Ze("Names",r.join(""))}function RV(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(nA(o)))}return i.join("")}function MV(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ze("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ze("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(zn("ProtectContents","True")),e["!protect"].objects&&a.push(zn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(zn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(zn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(zn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ze("WorksheetOptions",a.join(""),{xmlns:Za.x})}function BV(e){return e.map(function(t){var r=sR(t.t||""),n=Ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ze("Comment",n,{"ss:Author":t.a})}).join("")}function UV(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+hr(mw(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Br(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=hr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=hr(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var f="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",d=String(e.v);break;case"b":f="Boolean",d=e.v?"1":"0";break;case"e":f="Error",d=No[e.v];break;case"d":f="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Et[14]);break;case"s":f="String",d=iR(e.v||"");break}var h=Ul(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var v=e.v!=null?d:"",m=e.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(e.c||[]).length>0&&(m+=BV(e.c)),Ze("Cell",m,o)}function zV(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=y0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function WV(e,t,r,n){if(!e["!ref"])return"";var a=tr(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,x){El(y);var b=!!y.width,w=Bg(x,y),S={"ss:Index":x+1};b&&(S["ss:Width"]=Od(w.width)),y.hidden&&(S["ss:Hidden"]="1"),o.push(Ze("Column",null,S))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var u=[zV(c,(e["!rows"]||[])[c])],f=a.s.c;f<=a.e.c;++f){var d=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>f)&&!(i[s].s.r>c)&&!(i[s].e.c<f)&&!(i[s].e.r<c)){(i[s].s.c!=f||i[s].s.r!=c)&&(d=!0);break}if(!d){var h={r:c,c:f},v=At(h),m=l?(e[c]||[])[f]:e[v];u.push(UV(m,v,e,t,r,n,h))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function HV(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?RV(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?WV(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(MV(i,t,e,r)),n.join("")}function $V(e,t){t||(t={}),e.SSF||(e.SSF=Ir(Et)),e.SSF&&(P0(),Lg(e.SSF),t.revssf=Ig(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(jV(e,t)),r.push(IV()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ze("Worksheet",HV(n,t,e),{"ss:Name":hr(e.SheetNames[n])}));return r[2]=DV(e,t),r[3]=OV(e),on+Ze("Workbook",r.join(""),{xmlns:Za.ss,"xmlns:o":Za.o,"xmlns:x":Za.x,"xmlns:ss":Za.ss,"xmlns:dt":Za.dt,"xmlns:html":Za.html})}function VV(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=OR(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=RR(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var qV=[60,1084,2066,2165,2175];function GV(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var l=so(r,r.l),c=S2[l],u=0;c!=null&&qV.indexOf(l)>-1;)i=so(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),s.push(o),r.l+=4+i,c=S2[l=so(r,r.l)];var f=Fn(s);Un(f,0);var d=0;f.lens=[];for(var h=0;h<s.length;++h)f.lens.push(d),d+=s[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function ys(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Et[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||No[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Pd(e.v):e.w=Nc(e.v):e.w=Di(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&T0(Et[n]||String(n))){var a=cc(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function R1(e,t,r){return{v:e,ixfe:t,t:r}}function XV(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,l=[],c="",u={},f,d="",h,v,m,y,x={},b=[],w,S,L=[],j=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},P=function(at){return at<8?vc[at]:at<64&&j[at-8]||vc[at]},M=function(at,qe,or){var wt=qe.XF.data;if(!(!wt||!wt.patternType||!or||!or.cellStyles)){qe.s={},qe.s.patternType=wt.patternType;var vn;(vn=Dd(P(wt.icvFore)))&&(qe.s.fgColor={rgb:vn}),(vn=Dd(P(wt.icvBack)))&&(qe.s.bgColor={rgb:vn})}},F=function(at,qe,or){if(!(ge>1)&&!(or.sheetRows&&at.r>=or.sheetRows)){if(or.cellStyles&&qe.XF&&qe.XF.data&&M(at,qe,or),delete qe.ixfe,delete qe.XF,f=at,d=At(at),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),at.r<s.s.r&&(s.s.r=at.r),at.c<s.s.c&&(s.s.c=at.c),at.r+1>s.e.r&&(s.e.r=at.r+1),at.c+1>s.e.c&&(s.e.c=at.c+1),or.cellFormula&&qe.f){for(var wt=0;wt<b.length;++wt)if(!(b[wt][0].s.c>at.c||b[wt][0].s.r>at.r)&&!(b[wt][0].e.c<at.c||b[wt][0].e.r<at.r)){qe.F=Bt(b[wt][0]),(b[wt][0].s.c!=at.c||b[wt][0].s.r!=at.r)&&delete qe.f,qe.f&&(qe.f=""+ra(b[wt][1],s,at,D,T));break}}or.dense?(a[at.r]||(a[at.r]=[]),a[at.r][at.c]=qe):a[d]=qe}},T={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var H,W=[],Q=[],V=[],z=[],X=!1,D=[];D.SheetNames=T.snames,D.sharedf=T.sharedf,D.arrayf=T.arrayf,D.names=[],D.XTI=[];var ne=0,ge=0,C=0,R=[],B=[],U;T.codepage=1200,es(1200);for(var Y=!1;e.l<e.length-1;){var ue=e.l,pe=e.read_shift(2);if(pe===0&&ne===10)break;var he=e.l===e.length?0:e.read_shift(2),ye=S2[pe];if(ye&&ye.f){if(t.bookSheets&&ne===133&&pe!==133)break;if(ne=pe,ye.r===2||ye.r==12){var Pe=e.read_shift(2);if(he-=2,!T.enc&&Pe!==pe&&((Pe&255)<<8|Pe>>8)!==pe)throw new Error("rt mismatch: "+Pe+"!="+pe);ye.r==12&&(e.l+=10,he-=10)}var re={};if(pe===10?re=ye.f(e,he,T):re=GV(pe,ye,e,he,T),ge==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(pe){case 34:r.opts.Date1904=N.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=re,!t.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=re;break;case 66:var Ue=Number(re);switch(Ue){case 21010:Ue=1200;break;case 32768:Ue=1e4;break;case 32769:Ue=1252;break}es(T.codepage=Ue),Y=!0;break;case 317:T.rrtabid=re;break;case 25:T.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:T.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(a["!type"]="dialog"),re.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),re.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:L.push(re);break;case 430:D.push([re]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(re);break;case 24:case 536:U={Name:re.Name,Ref:ra(re.rgce,s,null,D,T)},re.itab>0&&(U.Sheet=re.itab-1),D.names.push(U),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(B[re.itab-1]={ref:Bt(re.rgce[0][0][1][2])});break;case 22:T.ExternCount=re;break;case 23:D.length==0&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(re),D.XTI=D.XTI.concat(re);break;case 2196:if(T.biff<8)break;U!=null&&(U.Comment=re[1]);break;case 18:a["!protect"]=re;break;case 19:re!==0&&T.WTF&&console.error("Password verifier: "+re);break;case 133:i[re.pos]=re,T.snames.push(re.name);break;case 10:{if(--ge)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Bt(s),t.sheetRows&&t.sheetRows<=s.e.r){var Ye=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Bt(s),s.e.r=Ye}s.e.r++,s.e.c++}W.length>0&&(a["!merges"]=W),Q.length>0&&(a["!objects"]=Q),V.length>0&&(a["!cols"]=V),z.length>0&&(a["!rows"]=z),N.Sheets.push(E)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),T.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(T.biff=5,Y=!0,es(T.codepage=28591)),T.biff==8&&re.BIFFVer==0&&re.dt==16&&(T.biff=2),ge++)break;if(a=t.dense?[]:{},T.biff<8&&!Y&&(Y=!0,es(T.codepage=t.codepage||1252)),T.biff<5||re.BIFFVer==0&&re.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ce={pos:e.l-he,name:c};i[Ce.pos]=Ce,T.snames.push(c)}else c=(i[ue]||{name:""}).name;re.dt==32&&(a["!type"]="chart"),re.dt==64&&(a["!type"]="macro"),W=[],Q=[],T.arrayf=b=[],V=[],z=[],X=!1,E={Hidden:(i[ue]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[re.r]||[])[re.c]:a[At({c:re.c,r:re.r})])&&++re.c,w={ixfe:re.ixfe,XF:L[re.ixfe]||{},v:re.val,t:"n"},C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F({c:re.c,r:re.r},w,t);break;case 5:case 517:w={ixfe:re.ixfe,XF:L[re.ixfe],v:re.val,t:re.t},C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F({c:re.c,r:re.r},w,t);break;case 638:w={ixfe:re.ixfe,XF:L[re.ixfe],v:re.rknum,t:"n"},C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F({c:re.c,r:re.r},w,t);break;case 189:for(var oe=re.c;oe<=re.C;++oe){var De=re.rkrec[oe-re.c][0];w={ixfe:De,XF:L[De],v:re.rkrec[oe-re.c][1],t:"n"},C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F({c:oe,r:re.r},w,t)}break;case 6:case 518:case 1030:{if(re.val=="String"){o=re;break}if(w=R1(re.val,re.cell.ixfe,re.tt),w.XF=L[w.ixfe],t.cellFormula){var Qe=re.formula;if(Qe&&Qe[0]&&Qe[0][0]&&Qe[0][0][0]=="PtgExp"){var Be=Qe[0][0][1][0],Ke=Qe[0][0][1][1],tt=At({r:Be,c:Ke});x[tt]?w.f=""+ra(re.formula,s,re.cell,D,T):w.F=((t.dense?(a[Be]||[])[Ke]:a[tt])||{}).F}else w.f=""+ra(re.formula,s,re.cell,D,T)}C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F(re.cell,w,t),o=re}break;case 7:case 519:if(o)o.val=re,w=R1(re,o.cell.ixfe,"s"),w.XF=L[w.ixfe],t.cellFormula&&(w.f=""+ra(o.formula,s,o.cell,D,T)),C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(re);var rt=At(re[0].s);if(h=t.dense?(a[re[0].s.r]||[])[re[0].s.c]:a[rt],t.cellFormula&&h){if(!o||!rt||!h)break;h.f=""+ra(re[1],s,re[0],D,T),h.F=Bt(re[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;x[At(o.cell)]=re[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[At(o.cell)],(h||{}).f=""+ra(re[0],s,f,D,T)}}break;case 253:w=R1(l[re.isst].t,re.ixfe,"s"),l[re.isst].h&&(w.h=l[re.isst].h),w.XF=L[w.ixfe],C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F({c:re.c,r:re.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:re.ixfe,XF:L[re.ixfe],t:"z"},C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F({c:re.c,r:re.r},w,t));break;case 190:if(t.sheetStubs)for(var ht=re.c;ht<=re.C;++ht){var gt=re.ixfe[ht-re.c];w={ixfe:gt,XF:L[gt],t:"z"},C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F({c:ht,r:re.r},w,t)}break;case 214:case 516:case 4:w=R1(re.val,re.ixfe,"s"),w.XF=L[w.ixfe],C>0&&(w.z=R[w.ixfe>>8&63]),ys(w,t,r.opts.Date1904),F({c:re.c,r:re.r},w,t);break;case 0:case 512:ge===1&&(s=re);break;case 252:l=re;break;case 1054:if(T.biff==4){R[C++]=re[1];for(var St=0;St<C+163&&Et[St]!=re[1];++St);St>=163&&co(re[1],C+163)}else co(re[1],re[0]);break;case 30:{R[C++]=re;for(var Tt=0;Tt<C+163&&Et[Tt]!=re;++Tt);Tt>=163&&co(re,C+163)}break;case 229:W=W.concat(re);break;case 93:Q[re.cmo[0]]=T.lastobj=re;break;case 438:T.lastobj.TxO=re;break;case 127:T.lastobj.ImData=re;break;case 440:for(y=re[0].s.r;y<=re[0].e.r;++y)for(m=re[0].s.c;m<=re[0].e.c;++m)h=t.dense?(a[y]||[])[m]:a[At({c:m,r:y})],h&&(h.l=re[1]);break;case 2048:for(y=re[0].s.r;y<=re[0].e.r;++y)for(m=re[0].s.c;m<=re[0].e.c;++m)h=t.dense?(a[y]||[])[m]:a[At({c:m,r:y})],h&&h.l&&(h.l.Tooltip=re[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;h=t.dense?(a[re[0].r]||[])[re[0].c]:a[At(re[0])];var Ht=Q[re[2]];h||(t.dense?(a[re[0].r]||(a[re[0].r]=[]),h=a[re[0].r][re[0].c]={t:"z"}):h=a[At(re[0])]={t:"z"},s.e.r=Math.max(s.e.r,re[0].r),s.s.r=Math.min(s.s.r,re[0].r),s.e.c=Math.max(s.e.c,re[0].c),s.s.c=Math.min(s.s.c,re[0].c)),h.c||(h.c=[]),v={a:re[1],t:Ht.TxO.t},h.c.push(v)}break;case 2173:DU(L[re.ixfe],re.ext);break;case 125:{if(!T.cellStyles)break;for(;re.e>=re.s;)V[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},X||(X=!0,hw(re.w/256)),El(V[re.e+1])}break;case 520:{var It={};re.level!=null&&(z[re.r]=It,It.level=re.level),re.hidden&&(z[re.r]=It,It.hidden=!0),re.hpt&&(z[re.r]=It,It.hpt=re.hpt,It.hpx=y0(re.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||wc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=re;break;case 161:a["!margins"]||wc(a["!margins"]={}),a["!margins"].header=re.header,a["!margins"].footer=re.footer;break;case 574:re.RTL&&(N.Views[0].RTL=!0);break;case 146:j=re;break;case 2198:H=re;break;case 140:S=re;break;case 442:c?E.CodeName=re||E.name:N.WBProps.CodeName=re||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),e.l+=he}return r.SheetNames=Kr(i).sort(function(mt,at){return Number(mt)-Number(at)}).map(function(mt){return i[mt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&B.forEach(function(mt,at){r.Sheets[r.SheetNames[at]]["!autofilter"]=mt}),r.Strings=l,r.SSF=Ir(Et),T.enc&&(r.Encryption=T.enc),H&&(r.Themes=H),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),D.names.length>0&&(N.Names=D.names),r.Workbook=N,r}var id={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function KV(e,t,r){var n=yt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=y4(n,v2,id.DSI);for(var i in a)t[i]=a[i]}catch(c){if(r.WTF)throw c}var s=yt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=y4(s,x2,id.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(rN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function YV(e,t){var r=[],n=[],a=[],i=0,s,o=K_(v2,"n"),l=K_(x2,"n");if(e.Props)for(s=Kr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Kr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var c=[];for(i=0;i<a.length;++i)cN.indexOf(a[i][0])>-1||tN.indexOf(a[i][0])>-1||a[i][1]!=null&&c.push(a[i]);n.length&&yt.utils.cfb_add(t,"/SummaryInformation",w4(n,id.SI,l,x2)),(r.length||c.length)&&yt.utils.cfb_add(t,"/DocumentSummaryInformation",w4(r,id.DSI,o,v2,c.length?c:null,id.UDI))}function aA(e,t){t||(t={}),_w(t),Hy(),t.codepage&&Wy(t.codepage);var r,n;if(e.FullPaths){if(yt.find(e,"/encryption"))throw new Error("File is password-protected");r=yt.find(e,"!CompObj"),n=yt.find(e,"/Workbook")||yt.find(e,"/Book")}else{switch(t.type){case"base64":e=ti(li(e));break;case"binary":e=ti(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Un(e,0),n={content:e}}var a,i;if(r&&VV(r),t.bookProps&&!t.bookSheets)a={};else{var s=$t?"buffer":"array";if(n&&n.content)a=XV(n.content,t);else if((i=yt.find(e,"PerfectOffice_MAIN"))&&i.content)a=yc.to_workbook(i.content,(t.type=s,t));else if((i=yt.find(e,"NativeContent_MAIN"))&&i.content)a=yc.to_workbook(i.content,(t.type=s,t));else throw(i=yt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&yt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=cz(e))}var o={};return e.FullPaths&&KV(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function JV(e,t){var r=t||{},n=yt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return yt.utils.cfb_add(n,a,iA(e,r)),r.biff==8&&(e.Props||e.Custprops)&&YV(e,n),r.biff==8&&e.vbaraw&&uz(n,yt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Bd={0:{f:bH},1:{f:TH},2:{f:XH},3:{f:RH},4:{f:jH},5:{f:VH},6:{f:QH},7:{f:zH},8:{f:s$},9:{f:i$},10:{f:n$},11:{f:a$},12:{f:FH},13:{f:YH},14:{f:BH},15:{f:DH},16:{f:YN},17:{f:t$},18:{f:HH},19:{f:nw},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:tV},40:{},42:{},43:{f:QB},44:{f:JB},45:{f:rU},46:{f:aU},47:{f:nU},48:{},49:{f:SR},50:{},51:{f:MU},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:wN},62:{f:ZH},63:{f:GU},64:{f:_$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ua,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:x$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:AH},148:{f:SH,p:16},151:{f:d$},152:{},153:{f:Z$},154:{},155:{},156:{f:Y$},157:{},158:{},159:{T:1,f:pB},160:{T:-1},161:{T:1,f:$c},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:o$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:OU},336:{T:-1},337:{f:zU,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:m2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:yN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:h$},427:{f:p$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:m$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:NH},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:u$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:m2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:az},633:{T:1},634:{T:-1},635:{T:1,f:rz},636:{T:-1},637:{f:CR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:B$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:k$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},S2={6:{f:Lv},10:{f:qo},12:{f:pn},13:{f:pn},14:{f:en},15:{f:en},16:{f:sa},17:{f:en},18:{f:en},19:{f:pn},20:{f:N4},21:{f:N4},23:{f:yN},24:{f:C4},25:{f:en},26:{},27:{},28:{f:kM},29:{},34:{f:en},35:{f:A4},38:{f:sa},39:{f:sa},40:{f:sa},41:{f:sa},42:{f:en},43:{f:en},47:{f:DB},49:{f:Y9},51:{f:pn},60:{},61:{f:V9},64:{f:en},65:{f:K9},66:{f:pn},77:{},80:{},81:{},82:{},85:{f:pn},89:{},90:{},91:{},92:{f:I9},93:{f:NM},94:{},95:{f:en},96:{},97:{},99:{f:en},125:{f:wN},128:{f:fM},129:{f:O9},130:{f:pn},131:{f:en},132:{f:en},133:{f:R9},134:{},140:{f:IM},141:{f:pn},144:{},146:{f:RM},151:{},152:{},153:{},154:{},155:{},156:{f:pn},157:{},158:{},160:{f:$M},161:{f:UM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:oM},190:{f:lM},193:{f:qo},197:{},198:{},199:{},200:{},201:{},202:{f:en},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:pn},220:{},221:{f:en},222:{},224:{f:uM},225:{f:j9},226:{f:qo},227:{},229:{f:SM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:B9},253:{f:Z9},255:{f:z9},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:uN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:en},353:{f:qo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:mM},431:{f:en},432:{},433:{},434:{},437:{},438:{f:TM},439:{f:en},440:{f:PM},441:{},442:{f:sh},443:{},444:{f:pn},445:{},446:{},448:{f:qo},449:{f:$9,r:2},450:{f:qo},512:{f:k4},513:{f:HM},515:{f:pM},516:{f:eM},517:{f:E4},519:{f:VM},520:{f:W9},523:{},545:{f:T4},549:{f:_4},566:{},574:{f:G9},638:{f:sM},659:{},1048:{},1054:{f:rM},1084:{},1212:{f:wM},2048:{f:LM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:I1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:qo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:MM,r:12},2173:{f:IU,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:en,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yM,r:12},2197:{},2198:{f:CU,r:12},2199:{},2200:{},2201:{},2202:{f:bM,r:12},2203:{f:qo},2204:{},2205:{},2206:{},2207:{},2211:{f:H9},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:pn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:zM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:OM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:k4},1:{},2:{f:YM},3:{f:XM},4:{f:GM},5:{f:E4},7:{f:ZM},8:{},9:{f:I1},11:{},22:{f:pn},30:{f:aM},31:{},32:{},33:{f:T4},36:{},37:{f:_4},50:{f:QM},62:{},52:{},67:{},68:{f:pn},69:{},86:{},126:{},127:{f:qM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eB},223:{},234:{},354:{},421:{},518:{f:Lv},521:{f:I1},536:{f:C4},547:{f:A4},561:{},579:{},1030:{f:Lv},1033:{f:I1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function et(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&ew(r)&&e.push(r)}}function ZV(e,t,r,n){var a=n||(r||[]).length||0;if(a<=8224)return et(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function uh(e,t,r){return e||(e=Ie(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function QV(e,t,r,n){var a=Ie(9);return uh(a,e,t),fN(r,n||"b",a),a}function eq(e,t,r){var n=Ie(8+2*r.length);return uh(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function tq(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Sn(jr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?et(e,2,JM(r,n,a)):et(e,3,KM(r,n,a));return;case"b":case"e":et(e,5,QV(r,n,t.v,t.t));return;case"s":case"str":et(e,4,eq(r,n,(t.v||"").slice(0,255)));return}et(e,1,uh(null,r,n))}function rq(e,t,r,n){var a=Array.isArray(t),i=tr(t["!ref"]||"A1"),s,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Bt(i)}for(var c=i.s.r;c<=i.e.r;++c){o=sn(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=Mr(u)),s=l[u]+o;var f=a?(t[c]||[])[u]:t[s];f&&tq(e,f,c,u)}}}function nq(e,t){for(var r=t||{},n=Ua(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return et(n,r.biff==4?1033:r.biff==3?521:9,uw(e,16,r)),rq(n,e.Sheets[e.SheetNames[a]],a,r),et(n,10),n.end()}function aq(e,t,r){et(e,49,J9({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function iq(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&et(e,1054,nM(a,t[a],r))})}function sq(e,t){var r=Ie(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),et(e,2151,r),r=Ie(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),mN(tr(t["!ref"]||"A1"),r),r.write_shift(4,4),et(e,2152,r)}function oq(e,t){for(var r=0;r<16;++r)et(e,224,S4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){et(e,224,S4(n,0,t))})}function lq(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];et(e,440,FM(n)),n[1].Tooltip&&et(e,2048,jM(n))}delete t["!links"]}function cq(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&et(e,125,BM(Bg(a,n),a))})}}function uq(e,t,r,n,a){var i=16+Ul(a.cellXfs,t,a);if(t.v==null&&!t.bf){et(e,513,Pc(r,n,i));return}if(t.bf)et(e,6,OW(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Sn(jr(t.v)):t.v;et(e,515,gM(r,n,s,i));break;case"b":case"e":et(e,517,hM(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=xw(a.Strings,t.v,a.revStrings);et(e,253,Q9(r,n,o,i))}else et(e,516,tM(r,n,(t.v||"").slice(0,255),i,a));break;default:et(e,513,Pc(r,n,i))}}function fq(e,t,r){var n=Ua(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(i),c=t.biff==8,u,f="",d=[],h=tr(i["!ref"]||"A1"),v=c?65536:16384;if(h.e.c>255||h.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,v-1)}et(n,2057,uw(r,16,t)),et(n,13,Ni(1)),et(n,12,Ni(100)),et(n,15,xa(!0)),et(n,17,xa(!1)),et(n,16,Cc(.001)),et(n,95,xa(!0)),et(n,42,xa(!1)),et(n,43,xa(!1)),et(n,130,Ni(1)),et(n,128,dM([0,0])),et(n,131,xa(!1)),et(n,132,xa(!1)),c&&cq(n,i["!cols"]),et(n,512,iM(h,t)),c&&(i["!links"]=[]);for(var m=h.s.r;m<=h.e.r;++m){f=sn(m);for(var y=h.s.c;y<=h.e.c;++y){m===h.s.r&&(d[y]=Mr(y)),u=d[y]+f;var x=l?(i[m]||[])[y]:i[u];x&&(uq(n,x,m,y,t),c&&x.l&&i["!links"].push([u,x.l]))}}var b=o.CodeName||o.name||a;return c&&et(n,574,X9((s.Views||[])[0])),c&&(i["!merges"]||[]).length&&et(n,229,EM(i["!merges"])),c&&lq(n,i),et(n,442,dN(b)),c&&sq(n,i),et(n,10),n.end()}function dq(e,t,r){var n=Ua(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(et(n,2057,uw(e,5,r)),r.bookType=="xla"&&et(n,135),et(n,225,o?Ni(1200):null),et(n,193,h9(2)),l&&et(n,191),l&&et(n,192),et(n,226),et(n,92,D9("SheetJS",r)),et(n,66,Ni(o?1200:1252)),o&&et(n,353,Ni(0)),o&&et(n,448),et(n,317,WM(e.SheetNames.length)),o&&e.vbaraw&&et(n,211),o&&e.vbaraw){var c=s.CodeName||"ThisWorkbook";et(n,442,dN(c))}et(n,156,Ni(17)),et(n,25,xa(!1)),et(n,18,xa(!1)),et(n,19,Ni(0)),o&&et(n,431,xa(!1)),o&&et(n,444,Ni(0)),et(n,61,q9()),et(n,64,xa(!1)),et(n,141,Ni(0)),et(n,34,xa($$(e)=="true")),et(n,14,xa(!0)),o&&et(n,439,xa(!1)),et(n,218,Ni(0)),aq(n,e,r),iq(n,e.SSF,r),oq(n,r),o&&et(n,352,xa(!1));var u=n.end(),f=Ua();o&&et(f,140,DM()),o&&r.Strings&&ZV(f,252,U9(r.Strings)),et(f,10);var d=f.end(),h=Ua(),v=0,m=0;for(m=0;m<e.SheetNames.length;++m)v+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var y=u.length+v+d.length;for(m=0;m<e.SheetNames.length;++m){var x=i[m]||{};et(h,133,M9({pos:y,hs:x.Hidden||0,dt:0,name:e.SheetNames[m]},r)),y+=t[m].length}var b=h.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var w=[];return u.length&&w.push(u),b.length&&w.push(b),d.length&&w.push(d),Fn(w)}function hq(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Ir(Et)),e&&e.SSF&&(P0(),Lg(e.SSF),r.revssf=Ig(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kw(r),r.cellXfs=[],Ul(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=fq(a,r,e);return n.unshift(dq(e,n,r)),Fn(n)}function iA(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=za(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return hq(e,t);case 4:case 3:case 2:return nq(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function B4(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=ZO(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<l.length;++s){var m=l[s].trim(),y=m.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var b=x[o].trim();if(b.match(/<t[dh]/i)){for(var w=b,S=0;w.charAt(0)=="<"&&(S=w.indexOf(">"))>-1;)w=w.slice(S+1);for(var L=0;L<v.length;++L){var j=v[L];j.s.c==u&&j.s.r<c&&c<=j.e.r&&(u=j.e.c+1,L=-1)}var N=Ct(b.slice(0,b.indexOf(">")));d=N.colspan?+N.colspan:1,((f=+N.rowspan)>1||d>1)&&v.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+d-1}});var E=N.t||N["data-t"]||"";if(!w.length){u+=d;continue}if(w=T6(w),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!w.length){u+=d;continue}var P={t:"s",v:w};r.raw||!w.trim().length||E=="s"||(w==="TRUE"?P={t:"b",v:!0}:w==="FALSE"?P={t:"b",v:!1}:isNaN(as(w))?isNaN(v0(w).getDate())||(P={t:"d",v:jr(w)},r.cellDates||(P={t:"n",v:Sn(P.v)}),P.z=r.dateNF||Et[14]):P={t:"n",v:as(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=P):n[At({r:c,c:u})]=P,u+=d}}}}return n["!ref"]=Bt(h),v.length&&(n["!merges"]=v),n}function pq(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=At({r,c:s}),f=n.dense?(e[r]||[])[s]:e[u],d=f&&f.v!=null&&(f.h||Jy(f.w||(xo(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+u,i.push(Ze("td",d,h))}}var v="<tr>";return v+i.join("")+"</tr>"}var gq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mq="</body></html>";function vq(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Bl(B4(r[0],t),t);var n=Nw();return r.forEach(function(a,i){Aw(n,B4(a,t),"Sheet"+(i+1))}),n}function xq(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sA(e,t){var r=t||{},n=r.header!=null?r.header:gq,a=r.footer!=null?r.footer:mq,i=[n],s=za(e["!ref"]);r.dense=Array.isArray(e),i.push(xq(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(pq(e,s,o,r));return i.push("</table>"+a),i.join("")}function oA(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Br(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=za(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],d=0,h=e["!rows"]||(e["!rows"]=[]),v=0,m=0,y=0,x=0,b=0,w=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&m<l;++v){var S=o[v];if(U4(S)){if(n.display)continue;h[m]={hidden:!0}}var L=S.children;for(y=x=0;y<L.length;++y){var j=L[y];if(!(n.display&&U4(j))){var N=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):T6(j.innerHTML),E=j.getAttribute("data-z")||j.getAttribute("z");for(d=0;d<f.length;++d){var P=f[d];P.s.c==x+i&&P.s.r<m+a&&m+a<=P.e.r&&(x=P.e.c+1-i,d=-1)}w=+j.getAttribute("colspan")||1,((b=+j.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:m+a,c:x+i},e:{r:m+a+(b||1)-1,c:x+i+(w||1)-1}});var M={t:"s",v:N},F=j.getAttribute("data-t")||j.getAttribute("t")||"";N!=null&&(N.length==0?M.t=F||"z":n.raw||N.trim().length==0||F=="s"||(N==="TRUE"?M={t:"b",v:!0}:N==="FALSE"?M={t:"b",v:!1}:isNaN(as(N))?isNaN(v0(N).getDate())||(M={t:"d",v:jr(N)},n.cellDates||(M={t:"n",v:Sn(M.v)}),M.z=n.dateNF||Et[14]):M={t:"n",v:as(N)})),M.z===void 0&&E!=null&&(M.z=E);var T="",H=j.getElementsByTagName("A");if(H&&H.length)for(var W=0;W<H.length&&!(H[W].hasAttribute("href")&&(T=H[W].getAttribute("href"),T.charAt(0)!="#"));++W);T&&T.charAt(0)!="#"&&(M.l={Target:T}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][x+i]=M):e[At({c:x+i,r:m+a})]=M,c.e.c<x+i&&(c.e.c=x+i),x+=w}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Bt(c),m>=l&&(e["!fullref"]=Bt((c.e.r=o.length-v+m-1+a,c))),e}function lA(e,t){var r=t||{},n=r.dense?[]:{};return oA(n,e,t)}function yq(e,t){return Bl(lA(e,t),t)}function U4(e){var t="",r=wq(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function wq(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function bq(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=er(t.replace(/<[^>]*>/g,""));return[r]}var z4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function cA(e,t){var r=t||{},n=Zy(e),a=[],i,s,o={name:""},l="",c=0,u,f,d={},h=[],v=r.dense?[]:{},m,y,x={value:""},b="",w=0,S=[],L=-1,j=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,P={},M=[],F={},T=0,H=0,W=[],Q=1,V=1,z=[],X={Names:[]},D={},ne=["",""],ge=[],C={},R="",B=0,U=!1,Y=!1,ue=0;for(jd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=jd.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?v["!ref"]=Bt(N):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(v["!fullref"]=v["!ref"],N.e.r=r.sheetRows-1,v["!ref"]=Bt(N)),M.length&&(v["!merges"]=M),W.length&&(v["!rows"]=W),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),d[u.name]=v,Y=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=Ct(m[0],!1),L=j=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,v=r.dense?[]:{},M=[],W=[],Y=!0);break;case"table-row-group":m[1]==="/"?--E:++E;break;case"table-row":case"":if(m[1]==="/"){L+=Q,Q=1;break}if(f=Ct(m[0],!1),f.?L=f.-1:L==-1&&(L=0),Q=+f["number-rows-repeated"]||1,Q<10)for(ue=0;ue<Q;++ue)E>0&&(W[L+ue]={level:E});j=-1;break;case"covered-table-cell":m[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(v[L]||(v[L]=[]),v[L][j]={t:"z"}):v[At({r:L,c:j})]={t:"z"}),b="",S=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++j,x=Ct(m[0],!1),V=parseInt(x["number-columns-repeated"]||"1",10),y={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(y.f=O4(er(x.formula))),(x.||x["value-type"])=="string"&&(y.t="s",y.v=er(x["string-value"]||""),r.dense?(v[L]||(v[L]=[]),v[L][j]=y):v[At({r:L,c:j})]=y),j+=V-1;else if(m[1]!=="/"){++j,b="",w=0,S=[],V=1;var pe=Q?L+Q-1:L;if(j>N.e.c&&(N.e.c=j),j<N.s.c&&(N.s.c=j),L<N.s.r&&(N.s.r=L),pe>N.e.r&&(N.e.r=pe),x=Ct(m[0],!1),ge=[],C={},y={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=er(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(T=parseInt(x["number-matrix-rows-spanned"],10)||0,H=parseInt(x["number-matrix-columns-spanned"],10)||0,F={s:{r:L,c:j},e:{r:L+T-1,c:j+H-1}},y.F=Bt(F),z.push([F,y.F])),x.formula)y.f=O4(x.formula);else for(ue=0;ue<z.length;++ue)L>=z[ue][0].s.r&&L<=z[ue][0].e.r&&j>=z[ue][0].s.c&&j<=z[ue][0].e.c&&(y.F=z[ue][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(T=parseInt(x["number-rows-spanned"],10)||0,H=parseInt(x["number-columns-spanned"],10)||0,F={s:{r:L,c:j},e:{r:L+T-1,c:j+H-1}},M.push(F)),x["number-columns-repeated"]&&(V=parseInt(x["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Pr(x["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(x.value);break;case"percentage":y.t="n",y.v=parseFloat(x.value);break;case"currency":y.t="n",y.v=parseFloat(x.value);break;case"date":y.t="d",y.v=jr(x["date-value"]),r.cellDates||(y.t="n",y.v=Sn(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=KO(x["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Dg(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(x.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",x["string-value"]!=null&&(b=er(x["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(U=!1,y.t==="s"&&(y.v=b||"",S.length&&(y.R=S),U=w==0),D.Target&&(y.l=D),ge.length>0&&(y.c=ge,ge=[]),b&&r.cellText!==!1&&(y.w=b),U&&(y.t="z",delete y.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=L))for(var he=0;he<Q;++he){if(V=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(v[L+he]||(v[L+he]=[]),v[L+he][j]=he==0?y:Ir(y);--V>0;)v[L+he][j+V]=Ir(y);else for(v[At({r:L+he,c:j})]=y;--V>0;)v[At({r:L+he,c:j+V})]=Ir(y);N.e.c<=j&&(N.e.c=j)}V=parseInt(x["number-columns-repeated"]||"1",10),j+=V-1,V=0,y={},b="",S=[]}D={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i;C.t=b,S.length&&(C.R=S),C.a=R,ge.push(C)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);R="",B=0,b="",w=0,S=[];break;case"creator":m[1]==="/"?R=n.slice(B,m.index):B=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);b="",w=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(P[o.name]=l,(i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Ct(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ct(m[0],!1),l+=z4[m[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Ct(m[0],!1),l+=z4[m[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":s=Ct(m[0],!1),ne=jv(s["cell-range-address"]);var ye={Name:s.name,Ref:ne[0]+"!"+ne[1]};Y&&(ye.Sheet=h.length),X.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var Pe=bq(n.slice(w,m.index));b=(b.length>0?b+`
`:"")+Pe[0]}else Ct(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ne=jv(Ct(m[0])["target-range-address"]),d[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(D=Ct(m[0],!1),!D.href)break;D.Target=er(D.href),delete D.href,D.Target.charAt(0)=="#"&&D.Target.indexOf(".")>-1?(ne=jv(D.Target.slice(1)),D.Target="#"+ne[0]+"!"+ne[1]):D.Target.match(/^\.\.[\\\/]/)&&(D.Target=D.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var re={Sheets:d,SheetNames:h,Workbook:X};return r.bookSheets&&delete re.Sheets,re}function W4(e,t){t=t||{},Ei(e,"META-INF/manifest.xml")&&XR(hn(e,"META-INF/manifest.xml"),t);var r=ri(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=cA(vr(r),t);return Ei(e,"meta.xml")&&(n.Props=Q6(hn(e,"meta.xml"))),n}function H4(e,t){return cA(e,t)}var _q=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ld({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return on+t}}(),$4=function(){var e=function(i){return hr(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var l=[];l.push('      <table:table table:name="'+hr(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,f=za(i["!ref"]||"A1"),d=i["!merges"]||[],h=0,v=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",y=i["!rows"]||[];for(c=0;c<f.s.r;++c)m=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=f.e.r;++c){for(m=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var x=!1,b={},w="";for(h=0;h!=d.length;++h)if(!(d[h].s.c>u)&&!(d[h].s.r>c)&&!(d[h].e.c<u)&&!(d[h].e.r<c)){(d[h].s.c!=u||d[h].s.r!=c)&&(x=!0),b["table:number-columns-spanned"]=d[h].e.c-d[h].s.c+1,b["table:number-rows-spanned"]=d[h].e.r-d[h].s.r+1;break}if(x){l.push(r);continue}var S=At({r:c,c:u}),L=v?(i[c]||[])[u]:i[S];if(L&&L.f&&(b["table:formula"]=hr(WW(L.f)),L.F&&L.F.slice(0,S.length)==S)){var j=za(L.F);b["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,b["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!L){l.push(t);continue}switch(L.t){case"b":w=L.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=L.v?"true":"false";break;case"n":w=L.w||String(L.v||0),b["office:value-type"]="float",b["office:value"]=L.v||0;break;case"s":case"str":w=L.v==null?"":L.v,b["office:value-type"]="string";break;case"d":w=L.w||jr(L.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=jr(L.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(t);continue}var N=e(w);if(L.l&&L.l.Target){var E=L.l.Target;E=E.charAt(0)=="#"?"#"+HW(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),N=Ze("text:a",N,{"xlink:href":E.replace(/&/g,"&amp;")})}l.push("          "+Ze("table:table-cell",Ze("text:p",N,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var f=c["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;El(f),f.ods=o;var d=c["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var f=c["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var l=[on],c=Ld({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ld({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(Z6().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),a(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)l.push(n(s.Sheets[s.SheetNames[f]],s,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function uA(e,t){if(t.bookType=="fods")return $4(e,t);var r=Xy(),n="",a=[],i=[];return n="mimetype",Wt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Wt(r,n,$4(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Wt(r,n,_q(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Wt(r,n,on+Z6()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Wt(r,n,JR(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Wt(r,n,KR(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Fc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function E2(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):vr(Ml(e))}function kq(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ti(Cs(e))}function Sq(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Al(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function V4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Eq(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Nq(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Ud(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ur(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Xr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function nr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Ud(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Ud(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:i};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Mn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(ur(n*8+a.type)),a.type==2&&t.push(ur(a.data.length)),t.push(a.data))})}),Al(t)}function bw(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ki(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Ud(e,n),i=nr(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Xr(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=nr(o.data),c=Xr(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(s.merge=Xr(i[3][0].data)>>>0>0),r.push(s)}return r}function Su(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ur(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ur(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:ur(s.data.length)}],n[2].push({data:Mn(s.meta),type:2})});var i=Mn(n);t.push(ur(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Al(t)}function Aq(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ud(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Al(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=Al(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Si(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Aq(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Al(t)}function Eu(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=ur(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Al(t)}function Cq(e,t,r,n){var a=Fc(e),i=a.getUint32(4,!0),s=(n>1?12:8)+V4(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=V4(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(s,!0),s+=4),i&32&&(c=a.getFloat64(s,!0),s+=8),i&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Tq(e,t,r){var n=Fc(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=Eq(e,i),i+=16),a&2&&(c=n.getFloat64(i,!0),i+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function Dv(e,t){var r=new Uint8Array(32),n=Fc(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Nq(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Ov(e,t){var r=new Uint8Array(32),n=Fc(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Pq(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Cq(e,t,r,e[0]);case 5:return Tq(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ta(e){var t=nr(e);return Ud(t[1][0].data)}function q4(e,t){var r=nr(t.data),n=Xr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=nr(s.data),l=Xr(o[1][0].data)>>>0;switch(n){case 1:i[l]=E2(o[3][0].data);break;case 8:{var c=e[ta(o[9][0].data)][0],u=nr(c.data),f=e[ta(u[1][0].data)][0],d=Xr(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=nr(f.data);i[l]=h[3].map(function(v){return E2(v.data)}).join("")}break}}),i}function Fq(e,t){var r,n,a,i,s,o,l,c,u,f,d,h,v,m,y=nr(e),x=Xr(y[1][0].data)>>>0,b=Xr(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Xr(y[8][0].data)>0||!1,S,L;if((i=(a=y[7])==null?void 0:a[0])!=null&&i.data&&t!=0)S=(o=(s=y[7])==null?void 0:s[0])==null?void 0:o.data,L=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=y[4])==null?void 0:u[0])!=null&&f.data&&t!=1)S=(h=(d=y[4])==null?void 0:d[0])==null?void 0:h.data,L=(m=(v=y[3])==null?void 0:v[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=w?4:1,N=Fc(S),E=[],P=0;P<S.length/2;++P){var M=N.getUint16(P*2,!0);M<65535&&E.push([P,M])}if(E.length!=b)throw"Expected ".concat(b," cells, found ").concat(E.length);var F=[];for(P=0;P<E.length-1;++P)F[E[P][0]]=L.subarray(E[P][1]*j,E[P+1][1]*j);return E.length>=1&&(F[E[E.length-1][0]]=L.subarray(E[E.length-1][1]*j)),{R:x,cells:F}}function Lq(e,t){var r,n=nr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Xr(n[7][0].data)>>>0>0?1:0:-1,i=bw(n[5],function(s){return Fq(s,a)});return{nrows:Xr(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function jq(e,t,r){var n,a=nr(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Xr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Xr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Bt(i);var s=nr(a[4][0].data),o=q4(e,e[ta(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?q4(e,e[ta(s[17][0].data)][0]):[],c=nr(s[3][0].data),u=0;c[1].forEach(function(f){var d=nr(f.data),h=e[ta(d[2][0].data)][0],v=Xr(h.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var m=Lq(e,h);m.data.forEach(function(y,x){y.forEach(function(b,w){var S=At({r:u+x,c:w}),L=Pq(b,o,l);L&&(r[S]=L)})}),u+=m.nrows})}function Iq(e,t){var r=nr(t.data),n={"!ref":"A1"},a=e[ta(r[2][0].data)],i=Xr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return jq(e,a[0],n),n}function Dq(e,t){var r,n=nr(t.data),a={name:(r=n[1])!=null&&r[0]?E2(n[1][0].data):"",sheets:[]},i=bw(n[2],ta);return i.forEach(function(s){e[s].forEach(function(o){var l=Xr(o.meta[1][0].data);l==6e3&&a.sheets.push(Iq(e,o))})}),a}function Oq(e,t){var r=Nw(),n=nr(t.data),a=bw(n[1],ta);if(a.forEach(function(i){e[i].forEach(function(s){var o=Xr(s.meta[1][0].data);if(o==2){var l=Dq(e,s);l.sheets.forEach(function(c,u){Aw(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Rv(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Si(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=ki(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Xr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(l){i[l].forEach(function(c){var u=Xr(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Oq(i,o)}function Rq(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Xr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Fc(e[7][0].data),u=0,f=[],d=Fc(e[4][0].data),h=0,v=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}c.setUint16(m*2,u,!0),d.setUint16(m*2,h,!0);var y,x;switch(typeof t[m]){case"string":y=Dv({t:"s",v:t[m]},r),x=Ov({t:"s",v:t[m]},r);break;case"number":y=Dv({t:"n",v:t[m]},r),x=Ov({t:"n",v:t[m]},r);break;case"boolean":y=Dv({t:"b",v:t[m]},r),x=Ov({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}f.push(y),u+=y.length,v.push(x),h+=x.length,++l}for(e[2][0].data=ur(l);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return e[6][0].data=Al(f),e[3][0].data=Al(v),l}function Mq(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=za(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Bt(n)));var i=qp(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(B){typeof B=="string"&&s.push(B)})});var o={},l=[],c=yt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(R,B){return[R,c.FullPaths[B]]}).forEach(function(R){var B=R[0],U=R[1];if(B.type==2&&B.name.match(/\.iwa/)){var Y=B.content,ue=Si(Y),pe=ki(ue);pe.forEach(function(he){l.push(he.id),o[he.id]={deps:[],location:U,type:Xr(he.messages[0].meta[1][0].data)}})}}),l.sort(function(R,B){return R-B});var u=l.filter(function(R){return R>1}).map(function(R){return[R,ur(R)]});c.FileIndex.map(function(R,B){return[R,c.FullPaths[B]]}).forEach(function(R){var B=R[0];if(R[1],!!B.name.match(/\.iwa/)){var U=ki(Si(B.content));U.forEach(function(Y){Y.messages.forEach(function(ue){u.forEach(function(pe){Y.messages.some(function(he){return Xr(he.meta[1][0].data)!=11006&&Sq(he.data,pe[1])})&&o[pe[0]].deps.push(Y.id)})})})}});for(var f=yt.find(c,o[1].location),d=ki(Si(f.content)),h,v=0;v<d.length;++v){var m=d[v];m.id==1&&(h=m)}var y=ta(nr(h.messages[0].data)[1][0].data);for(f=yt.find(c,o[y].location),d=ki(Si(f.content)),v=0;v<d.length;++v)m=d[v],m.id==y&&(h=m);for(y=ta(nr(h.messages[0].data)[2][0].data),f=yt.find(c,o[y].location),d=ki(Si(f.content)),v=0;v<d.length;++v)m=d[v],m.id==y&&(h=m);for(y=ta(nr(h.messages[0].data)[2][0].data),f=yt.find(c,o[y].location),d=ki(Si(f.content)),v=0;v<d.length;++v)m=d[v],m.id==y&&(h=m);var x=nr(h.messages[0].data);{x[6][0].data=ur(n.e.r+1),x[7][0].data=ur(n.e.c+1);var b=ta(x[46][0].data),w=yt.find(c,o[b].location),S=ki(Si(w.content));{for(var L=0;L<S.length&&S[L].id!=b;++L);if(S[L].id!=b)throw"Bad ColumnRowUIDMapArchive";var j=nr(S[L].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var N=0;N<=n.e.c;++N){var E=[];E[1]=E[2]=[{type:0,data:ur(N+420690)}],j[1].push({type:2,data:Mn(E)}),j[2].push({type:0,data:ur(N)}),j[3].push({type:0,data:ur(N)})}j[4]=[],j[5]=[],j[6]=[];for(var P=0;P<=n.e.r;++P)E=[],E[1]=E[2]=[{type:0,data:ur(P+726270)}],j[4].push({type:2,data:Mn(E)}),j[5].push({type:0,data:ur(P)}),j[6].push({type:0,data:ur(P)});S[L].messages[0].data=Mn(j)}w.content=Eu(Su(S)),w.size=w.content.length,delete x[46];var M=nr(x[4][0].data);{M[7][0].data=ur(n.e.r+1);var F=nr(M[1][0].data),T=ta(F[2][0].data);w=yt.find(c,o[T].location),S=ki(Si(w.content));{if(S[0].id!=T)throw"Bad HeaderStorageBucket";var H=nr(S[0].messages[0].data);for(P=0;P<i.length;++P){var W=nr(H[2][0].data);W[1][0].data=ur(P),W[4][0].data=ur(i[P].length),H[2][P]={type:H[2][0].type,data:Mn(W)}}S[0].messages[0].data=Mn(H)}w.content=Eu(Su(S)),w.size=w.content.length;var Q=ta(M[2][0].data);w=yt.find(c,o[Q].location),S=ki(Si(w.content));{if(S[0].id!=Q)throw"Bad HeaderStorageBucket";for(H=nr(S[0].messages[0].data),N=0;N<=n.e.c;++N)W=nr(H[2][0].data),W[1][0].data=ur(N),W[4][0].data=ur(n.e.r+1),H[2][N]={type:H[2][0].type,data:Mn(W)};S[0].messages[0].data=Mn(H)}w.content=Eu(Su(S)),w.size=w.content.length;var V=ta(M[4][0].data);(function(){for(var R=yt.find(c,o[V].location),B=ki(Si(R.content)),U,Y=0;Y<B.length;++Y){var ue=B[Y];ue.id==V&&(U=ue)}var pe=nr(U.messages[0].data);{pe[3]=[];var he=[];s.forEach(function(re,Ue){he[1]=[{type:0,data:ur(Ue)}],he[2]=[{type:0,data:ur(1)}],he[3]=[{type:2,data:kq(re)}],pe[3].push({type:2,data:Mn(he)})})}U.messages[0].data=Mn(pe);var ye=Su(B),Pe=Eu(ye);R.content=Pe,R.size=R.content.length})();var z=nr(M[3][0].data);{var X=z[1][0];delete z[2];var D=nr(X.data);{var ne=ta(D[2][0].data);(function(){for(var R=yt.find(c,o[ne].location),B=ki(Si(R.content)),U,Y=0;Y<B.length;++Y){var ue=B[Y];ue.id==ne&&(U=ue)}var pe=nr(U.messages[0].data);{delete pe[6],delete z[7];var he=new Uint8Array(pe[5][0].data);pe[5]=[];for(var ye=0,Pe=0;Pe<=n.e.r;++Pe){var re=nr(he);ye+=Rq(re,i[Pe],s),re[1][0].data=ur(Pe),pe[5].push({data:Mn(re),type:2})}pe[1]=[{type:0,data:ur(n.e.c+1)}],pe[2]=[{type:0,data:ur(n.e.r+1)}],pe[3]=[{type:0,data:ur(ye)}],pe[4]=[{type:0,data:ur(n.e.r+1)}]}U.messages[0].data=Mn(pe);var Ue=Su(B),Ye=Eu(Ue);R.content=Ye,R.size=R.content.length})()}X.data=Mn(D)}M[3][0].data=Mn(z)}x[4][0].data=Mn(M)}h.messages[0].data=Mn(x);var ge=Su(d),C=Eu(ge);return f.content=C,f.size=f.content.length,c}function fA(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function _w(e){fA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function kw(e){fA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Bq(e){return qt.WS.indexOf(e)>-1?"sheet":e==qt.CS?"chart":e==qt.DS?"dialog":e==qt.MS?"macro":e&&e.length?e:"sheet"}function Uq(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Bq(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function zq(e,t,r,n,a,i,s,o,l,c,u,f){try{i[n]=td(ri(e,r,!0),t);var d=hn(e,t),h;switch(o){case"sheet":h=cV(d,t,a,l,i[n],c,u,f);break;case"chart":if(h=uV(d,t,a,l,i[n],c,u,f),!h||!h["!drawel"])break;var v=jf(h["!drawel"].Target,t),m=Id(v),y=YU(ri(e,v,!0),td(ri(e,m,!0),v)),x=jf(y,v),b=Id(x);h=R$(ri(e,x,!0),x,l,td(ri(e,b,!0),x),c,h);break;case"macro":h=fV(d,t,a,l,i[n],c,u,f);break;case"dialog":h=dV(d,t,a,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=h;var w=[];i&&i[n]&&Kr(i[n]).forEach(function(S){var L="";if(i[n][S].Type==qt.CMNT){L=jf(i[n][S].Target,t);var j=mV(hn(e,L,!0),L,l);if(!j||!j.length)return;F4(h,j,!1)}i[n][S].Type==qt.TCMNT&&(L=jf(i[n][S].Target,t),w=w.concat(ZU(hn(e,L,!0),l)))}),w&&w.length&&F4(h,w,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function bi(e){return e.charAt(0)=="/"?e.slice(1):e}function Wq(e,t){if(P0(),t=t||{},_w(t),Ei(e,"META-INF/manifest.xml")||Ei(e,"objectdata.xml"))return W4(e,t);if(Ei(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Rv<"u"){if(e.FileIndex)return Rv(e);var r=yt.utils.cfb_new();return Z_(e).forEach(function(W){Wt(r,W,E6(e,W))}),Rv(r)}throw new Error("Unsupported NUMBERS file")}if(!Ei(e,"[Content_Types].xml"))throw Ei(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ei(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Z_(e),a=qR(ri(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",hn(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!hn(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(rd=[],a.sst)try{rd=gV(hn(e,bi(a.sst)),a.sst,t)}catch(W){if(t.WTF)throw W}t.cellStyles&&a.themes.length&&(l=pV(ri(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=hV(hn(e,bi(a.style)),a.style,l,t))}a.links.map(function(W){try{var Q=td(ri(e,Id(bi(W))),W);return xV(hn(e,bi(W)),Q,W,t)}catch{}});var u=lV(hn(e,bi(a.workbooks[0])),a.workbooks[0],t),f={},d="";a.coreprops.length&&(d=hn(e,bi(a.coreprops[0]),!0),d&&(f=Q6(d)),a.extprops.length!==0&&(d=hn(e,bi(a.extprops[0]),!0),d&&QR(d,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(d=ri(e,bi(a.custprops[0]),!0),d&&(h=t9(d,t)));var v={};if((t.bookSheets||t.bookProps)&&(u.Sheets?s=u.Sheets.map(function(Q){return Q.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(v.Props=f,v.Custprops=h),t.bookSheets&&typeof s<"u"&&(v.SheetNames=s),t.bookSheets?v.SheetNames:t.bookProps))return v;s={};var m={};t.bookDeps&&a.calcchain&&(m=vV(hn(e,bi(a.calcchain)),a.calcchain));var y=0,x={},b,w;{var S=u.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var L=0;L!=S.length;++L)f.SheetNames[L]=S[L].name}var j=i?"bin":"xml",N=a.workbooks[0].lastIndexOf("/"),E=(a.workbooks[0].slice(0,N+1)+"_rels/"+a.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Ei(e,E)||(E="xl/_rels/workbook."+j+".rels");var P=td(ri(e,E,!0),E.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=yV(hn(e,bi(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=ez(hn(e,bi(a.people[0])),t)),P&&(P=Uq(P,u.Sheets));var M=hn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var F="sheet";if(P&&P[y]?(b="xl/"+P[y][1].replace(/[\/]?xl\//,""),Ei(e,b)||(b=P[y][1]),Ei(e,b)||(b=E.replace(/_rels\/.*$/,"")+P[y][1]),F=P[y][2]):(b="xl/worksheets/sheet"+(y+1-M)+"."+j,b=b.replace(/sheet0\./,"sheet.")),w=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,H=0;H!=t.sheets.length;++H)typeof t.sheets[H]=="number"&&t.sheets[H]==y&&(T=1),typeof t.sheets[H]=="string"&&t.sheets[H].toLowerCase()==f.SheetNames[y].toLowerCase()&&(T=1);if(!T)continue e}}zq(e,b,w,f.SheetNames[y],y,x,s,F,t,u,l,c)}return v={Directory:a,Workbook:u,Props:f,Custprops:h,Deps:m,Sheets:s,SheetNames:f.SheetNames,Strings:rd,Styles:c,Themes:l,SSF:Ir(Et)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(W,Q){W=W.replace(/^Root Entry[\/]/,""),v.keys.push(W),v.files[W]=e.FileIndex[Q]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=hn(e,bi(a.vba[0]),!0):a.defaults&&a.defaults.bin===lz&&(v.vbaraw=hn(e,"xl/vbaProject.bin",!0))),v}function Hq(e,t){var r=t||{},n="Workbook",a=yt.find(e,n);try{if(n="/!DataSpaces/Version",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(yB(a.content),n="/!DataSpaces/DataSpaceMap",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=bB(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=_B(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);SB(a.content)}catch{}if(n="/EncryptionInfo",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=EB(a.content);if(n="/EncryptedPackage",a=yt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function $q(e,t){return t.bookType=="ods"?uA(e,t):t.bookType=="numbers"?Mq(e,t):t.bookType=="xlsb"?Vq(e,t):qq(e,t)}function Vq(e,t){Gu=1024,e&&!e.SSF&&(e.SSF=Ir(Et)),e&&e.SSF&&(P0(),Lg(e.SSF),t.revssf=Ig(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,nd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=MN.indexOf(t.bookType)>-1,a=lw();kw(t=t||{});var i=Xy(),s="",o=0;if(t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Wt(i,s,eN(e.Props,t)),a.coreprops.push(s),fr(t.rels,2,s,qt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Wt(i,s,nN(e.Props)),a.extprops.push(s),fr(t.rels,3,s,qt.EXT_PROPS),e.Custprops!==e.Props&&Kr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Wt(i,s,aN(e.Custprops)),a.custprops.push(s),fr(t.rels,4,s,qt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Wt(i,s,bV(o-1,s,t,e,u)),a.sheets.push(s),fr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,qt.WS[0])}if(f){var h=f["!comments"],v=!1,m="";h&&h.length>0&&(m="xl/comments"+o+"."+r,Wt(i,m,SV(h,m)),a.comments.push(m),fr(u,-1,"../comments"+o+"."+r,qt.CMNT),v=!0),f["!legacy"]&&v&&Wt(i,"xl/drawings/vmlDrawing"+o+".vml",ON(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Wt(i,Id(s),n0(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Wt(i,s,kV(t.Strings,s,t)),a.strs.push(s),fr(t.wbrels,-1,"sharedStrings."+r,qt.SST)),s="xl/workbook."+r,Wt(i,s,wV(e,s)),a.workbooks.push(s),fr(t.rels,1,s,qt.WB),s="xl/theme/theme1.xml",Wt(i,s,pw(e.Themes,t)),a.themes.push(s),fr(t.wbrels,-1,"theme/theme1.xml",qt.THEME),s="xl/styles."+r,Wt(i,s,_V(e,s,t)),a.styles.push(s),fr(t.wbrels,-1,"styles."+r,qt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Wt(i,s,e.vbaraw),a.vba.push(s),fr(t.wbrels,-1,"vbaProject.bin",qt.VBA)),s="xl/metadata."+r,Wt(i,s,EV(s)),a.metadata.push(s),fr(t.wbrels,-1,"metadata."+r,qt.XLMETA),Wt(i,"[Content_Types].xml",J6(a,t)),Wt(i,"_rels/.rels",n0(t.rels)),Wt(i,"xl/_rels/workbook."+r+".rels",n0(t.wbrels)),delete t.revssf,delete t.ssf,i}function qq(e,t){Gu=1024,e&&!e.SSF&&(e.SSF=Ir(Et)),e&&e.SSF&&(P0(),Lg(e.SSF),t.revssf=Ig(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,nd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=MN.indexOf(t.bookType)>-1,a=lw();kw(t=t||{});var i=Xy(),s="",o=0;if(t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Wt(i,s,eN(e.Props,t)),a.coreprops.push(s),fr(t.rels,2,s,qt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Wt(i,s,nN(e.Props)),a.extprops.push(s),fr(t.rels,3,s,qt.EXT_PROPS),e.Custprops!==e.Props&&Kr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Wt(i,s,aN(e.Custprops)),a.custprops.push(s),fr(t.rels,4,s,qt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Wt(i,s,KN(o-1,t,e,f)),a.sheets.push(s),fr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,qt.WS[0])}if(d){var v=d["!comments"],m=!1,y="";if(v&&v.length>0){var x=!1;v.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(x=!0)})}),x&&(y="xl/threadedComments/threadedComment"+o+"."+r,Wt(i,y,QU(v,u,t)),a.threadedcomments.push(y),fr(f,-1,"../threadedComments/threadedComment"+o+"."+r,qt.TCMNT)),y="xl/comments"+o+"."+r,Wt(i,y,RN(v)),a.comments.push(y),fr(f,-1,"../comments"+o+"."+r,qt.CMNT),m=!0}d["!legacy"]&&m&&Wt(i,"xl/drawings/vmlDrawing"+o+".vml",ON(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Wt(i,Id(s),n0(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Wt(i,s,SN(t.Strings,t)),a.strs.push(s),fr(t.wbrels,-1,"sharedStrings."+r,qt.SST)),s="xl/workbook."+r,Wt(i,s,eA(e)),a.workbooks.push(s),fr(t.rels,1,s,qt.WB),s="xl/theme/theme1.xml",Wt(i,s,pw(e.Themes,t)),a.themes.push(s),fr(t.wbrels,-1,"theme/theme1.xml",qt.THEME),s="xl/styles."+r,Wt(i,s,LN(e,t)),a.styles.push(s),fr(t.wbrels,-1,"styles."+r,qt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Wt(i,s,e.vbaraw),a.vba.push(s),fr(t.wbrels,-1,"vbaProject.bin",qt.VBA)),s="xl/metadata."+r,Wt(i,s,DN()),a.metadata.push(s),fr(t.wbrels,-1,"metadata."+r,qt.XLMETA),u.length>1&&(s="xl/persons/person.xml",Wt(i,s,tz(u)),a.people.push(s),fr(t.wbrels,-1,"persons/person.xml",qt.PEOPLE)),Wt(i,"[Content_Types].xml",J6(a,t)),Wt(i,"_rels/.rels",n0(t.rels)),Wt(i,"xl/_rels/workbook."+r+".rels",n0(t.wbrels)),delete t.revssf,delete t.ssf,i}function Sw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=li(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Gq(e,t){return yt.find(e,"EncryptedPackage")?Hq(e,t):aA(e,t)}function Xq(e,t){var r,n=e,a=t||{};return a.type||(a.type=$t&&Buffer.isBuffer(e)?"buffer":"base64"),r=N6(n,a),Wq(r,a)}function dA(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return k2(e.slice(r),t);default:break e}return x0.to_workbook(e,t)}function Kq(e,t){var r="",n=Sw(e,t);switch(t.type){case"base64":r=li(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ac(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=vr(r)),t.type="binary",dA(r,t)}function Yq(e,t){var r=e;return t.type=="base64"&&(r=li(r)),r=nl.utils.decode(1200,r.slice(2),"str"),t.type="binary",dA(r,t)}function Jq(e){return e.match(/[^\x00-\x7F]/)?Cs(e):e}function Mv(e,t,r,n){return n?(r.type="string",x0.to_workbook(e,r)):x0.to_workbook(t,r)}function Vp(e,t){Hy();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Vp(new Uint8Array(e),(r=Ir(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),i0={},r.dateNF&&(i0.dateNF=r.dateNF),r.type||(r.type=$t&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=$t?"buffer":"binary",n=qO(e),typeof Uint8Array<"u"&&!$t&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Jq(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Ir(r),r.type="array",Vp($y(n),r)}switch((a=Sw(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Gq(yt.read(n,r),r);break;case 9:if(a[1]<=8)return aA(n,r);break;case 60:return k2(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return rB(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _N.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Xq(n,r):Mv(e,n,r,i);case 239:return a[3]===60?k2(n,r):Mv(e,n,r,i);case 255:if(a[1]===254)return Yq(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return yc.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return yc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return _2.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return TN.to_workbook(n,r);break;case 10:case 13:case 32:return Kq(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tB.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?_2.to_workbook(n,r):Mv(e,n,r,i)}function hA(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return nh(t.file,yt.write(e,{type:$t?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return yt.write(e,t)}function Zq(e,t){var r=Ir(t||{}),n=$q(e,r);return Qq(n,r)}function Qq(e,t){var r={},n=$t?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?yt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Fg(a))}return t.password&&typeof encrypt_agile<"u"?hA(encrypt_agile(a,t.password),t):t.type==="file"?nh(t.file,a):t.type=="string"?vr(a):a}function eG(e,t){var r=t||{},n=JV(e,r);return hA(n,r)}function ks(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Td(Cs(n));case"binary":return Cs(n);case"string":return e;case"file":return nh(t.file,n,"utf8");case"buffer":return $t?So(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ks(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function tG(e,t){switch(t.type){case"base64":return Td(e);case"binary":return e;case"string":return e;case"file":return nh(t.file,e,"binary");case"buffer":return $t?So(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function M1(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Td(r):t.type=="string"?vr(r):r;case"file":return nh(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function pA(e,t){Hy(),G$(e);var r=Ir(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=pA(e,r);return r.type="array",Fg(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ks($V(e,r),r);case"slk":case"sylk":return ks(bN.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return ks(sA(e.Sheets[e.SheetNames[a]],r),r);case"txt":return tG(gA(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ks(Ew(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ks(_N.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return M1(_2.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ks(x0.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ks(TN.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return ks(kN.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ks(uA(e,r),r);case"wk1":return M1(yc.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return M1(yc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),M1(iA(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),eG(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Zq(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function rG(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function nG(e,t,r){var n=r||{};return n.type="file",n.file=t,rG(n),pA(e,n)}function aG(e,t,r,n,a,i,s,o){var l=sn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!s||e[r])for(var h=t.s.c;h<=t.e.c;++h){var v=s?e[r][h]:e[n[h]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;i[h]!=null&&(d[i[h]]=c);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[h]!=null){if(m==null)if(v.t=="e"&&m===null)d[i[h]]=null;else if(c!==void 0)d[i[h]]=c;else if(u&&m===null)d[i[h]]=null;else continue;else d[i[h]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:xo(v,m,o);m!=null&&(f=!1)}}return{row:d,isempty:f}}function qp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=tr(u);break;case"number":l=tr(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=sn(l.s.r),d=[],h=[],v=0,m=0,y=Array.isArray(e),x=l.s.r,b=0,w={};y&&!e[x]&&(e[x]=[]);var S=c.skipHidden&&e["!cols"]||[],L=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(S[b]||{}).hidden)switch(d[b]=Mr(b),r=y?e[x][b]:e[d[b]+f],n){case 1:i[b]=b-l.s.c;break;case 2:i[b]=d[b];break;case 3:i[b]=c.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=xo(r,null,c),m=w[s]||0,!m)w[s]=1;else{do o=s+"_"+m++;while(w[o]);w[s]=m,w[o]=1}i[b]=o}for(x=l.s.r+a;x<=l.e.r;++x)if(!(L[x]||{}).hidden){var j=aG(e,l,x,d,n,i,y,c);(j.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(h[v++]=j.row)}return h.length=v,h}var G4=/"/g;function iG(e,t,r,n,a,i,s,o){for(var l=!0,c=[],u="",f=sn(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var h=o.dense?(e[r]||[])[d]:e[n[d]+f];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(o.rawNumbers&&h.t=="n"?h.v:xo(h,null,o));for(var v=0,m=0;v!==u.length;++v)if((m=u.charCodeAt(v))===a||m===i||m===34||o.forceQuotes){u='"'+u.replace(G4,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(G4,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function Ew(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=tr(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(d[v]||{}).hidden||(f[v]=Mr(v));for(var m=0,y=a.s.r;y<=a.e.r;++y)(h[y]||{}).hidden||(u=iG(e,a,y,f,s,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function gA(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ew(e,t);return r}function sG(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=tr(e["!ref"]),i="",s=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=Mr(o);for(var u=a.s.r;u<=a.e.r;++u)for(i=sn(u),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function mA(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Br(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var f=tr(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(s=f.e.r+1,u.e.r=s+t.length-1+a)}else s==-1&&(s=0,u.e.r=t.length-1+a);var d=n.header||[],h=0;t.forEach(function(m,y){Kr(m).forEach(function(x){(h=d.indexOf(x))==-1&&(d[h=d.length]=x);var b=m[x],w="z",S="",L=At({c:o+h,r:s+y+a});c=zd(i,L),b&&typeof b=="object"&&!(b instanceof Date)?i[L]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",n.cellDates||(w="n",b=Sn(b)),S=n.dateNF||Et[14]):b===null&&n.nullError&&(w="e",b=0),c?(c.t=w,c.v=b,delete c.w,delete c.R,S&&(c.z=S)):i[L]=c={t:w,v:b},S&&(c.z=S))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var v=sn(s);if(a)for(h=0;h<d.length;++h)i[Mr(h+o)+v]={t:"s",v:d[h]};return i["!ref"]=Bt(u),i}function oG(e,t){return mA(null,e,t)}function zd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Br(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?zd(e,At(t)):zd(e,At({r:t,c:r||0}))}function lG(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Nw(){return{SheetNames:[],Sheets:{}}}function Aw(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(QN(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function cG(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=lG(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function uG(e,t){return e.z=t,e}function vA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function fG(e,t,r){return vA(e,"#"+t,r)}function dG(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function hG(e,t,r,n){for(var a=typeof t!="string"?t:tr(t),i=typeof t=="string"?t:Bt(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=zd(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var sd={encode_col:Mr,encode_row:sn,encode_cell:At,encode_range:Bt,decode_col:rw,decode_row:tw,split_cell:kR,decode_cell:Br,decode_range:za,format_cell:xo,sheet_add_aoa:$6,sheet_add_json:mA,sheet_add_dom:oA,aoa_to_sheet:F0,json_to_sheet:oG,table_to_sheet:lA,table_to_book:yq,sheet_to_csv:Ew,sheet_to_txt:gA,sheet_to_json:qp,sheet_to_html:sA,sheet_to_formulae:sG,sheet_to_row_object_array:qp,sheet_get_cell:zd,book_new:Nw,book_append_sheet:Aw,book_set_sheet_visibility:cG,cell_set_number_format:uG,cell_set_hyperlink:vA,cell_set_internal_link:fG,cell_add_comment:dG,sheet_set_array_formula:hG,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const pG=()=>{const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,i]=O.useState(null);O.useState(new Set);const{sortedItems:s,sortConfig:o,requestSort:l}=Rl(e,{key:"transaction_date",direction:"desc"}),c=async()=>{try{n(!0),i(null);const{data:d,error:h}=await He.from("Transaction").select(`
          *,
          Account (account_name)
        `).order("transaction_date",{ascending:!1});if(h)throw h;const v=d==null?void 0:d.map(m=>{var y;return{...m,account_name:((y=m.Account)==null?void 0:y.account_name)||"Unknown Account"}});t(v||[])}catch(d){console.error("Error fetching transactions:",d),i(d instanceof Error?d.message:"Failed to fetch transactions")}finally{n(!1)}},u=()=>{const d=new kt;d.setFontSize(16),d.text("Journal Entries",14,15),d.setFontSize(10),d.text(`Generated on ${new Date().toLocaleDateString()}`,14,22);const h=s.map(v=>[`#${v.id}`,new Date(v.transaction_date).toLocaleDateString(),v.account_name,v.description,v.debit_amount?`$${v.debit_amount.toFixed(2)}`:"-",v.credit_amount?`$${v.credit_amount.toFixed(2)}`:"-",v.invoice_id?`#${v.invoice_id}`:"-",v.row_num||"-"]);hO(d,{head:[["ID","Date","Account","Description","Debit","Credit","Invoice #","Row #"]],body:h,startY:25,styles:{fontSize:8},headStyles:{fillColor:[66,139,202]}}),d.save("journal-entries.pdf")},f=()=>{const d=s.map(m=>({ID:`#${m.id}`,Date:new Date(m.transaction_date).toLocaleDateString(),Account:m.account_name,Description:m.description,Debit:m.debit_amount||"",Credit:m.credit_amount||"","Invoice #":m.invoice_id?`#${m.invoice_id}`:"","Row #":m.row_num||""})),h=sd.json_to_sheet(d),v=sd.book_new();sd.book_append_sheet(v,h,"Journal Entries"),nG(v,"journal-entries.xlsx")};return O.useEffect(()=>{c()},[]),p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Journals"}),p.jsx("button",{onClick:c,className:"p-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800",disabled:r,title:"Refresh",children:p.jsx(ko,{className:`w-5 h-5 ${r?"animate-spin":""}`})})]}),p.jsxs("div",{className:"flex items-center space-x-3",children:[p.jsx("button",{onClick:u,className:"p-2 text-red-500 dark:text-red-400 hover:text-red-600 dark:hover:text-red-500 transition-colors rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20",title:"Export to PDF",children:p.jsx(Ng,{className:"w-5 h-5"})}),p.jsx("button",{onClick:f,className:"p-2 text-green-500 dark:text-green-400 hover:text-green-600 dark:hover:text-green-500 transition-colors rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20",title:"Export to Excel",children:p.jsx(SE,{className:"w-5 h-5"})})]})]}),a&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:a}),p.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(vt,{onClick:()=>l("id"),className:"cursor-pointer",children:"ID"}),p.jsx(vt,{onClick:()=>l("transaction_date"),className:"cursor-pointer",children:"Date"}),p.jsx(vt,{onClick:()=>l("account_name"),className:"cursor-pointer",children:"Account"}),p.jsx(vt,{onClick:()=>l("description"),className:"cursor-pointer",children:"Description"}),p.jsx(vt,{onClick:()=>l("Status"),className:"cursor-pointer",children:"Status"}),p.jsx(vt,{onClick:()=>l("debit_amount"),className:"cursor-pointer text-right",children:"Debit"}),p.jsx(vt,{onClick:()=>l("credit_amount"),className:"cursor-pointer text-right",children:"Credit"}),p.jsx(vt,{children:"Invoice #"}),p.jsx(vt,{children:"Row #"})]})}),p.jsxs(Os,{children:[s.map(d=>p.jsxs(br,{children:[p.jsxs(ct,{children:["#",d.id]}),p.jsx(ct,{children:new Date(d.transaction_date).toLocaleDateString()}),p.jsx(ct,{children:d.account_name}),p.jsx(ct,{children:d.description}),p.jsx(ct,{children:p.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d.Status==="Paid"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":d.Status==="Overdue"?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400":d.Status==="Cancelled"?"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400":d.Status==="Partially Paid"?"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"}`,children:d.Status||"Pending"})}),p.jsx(ct,{className:"text-right",children:d.debit_amount?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d.debit_amount):"-"}),p.jsx(ct,{className:"text-right",children:d.credit_amount?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d.credit_amount):"-"}),p.jsx(ct,{children:d.invoice_id?`#${d.invoice_id}`:"-"}),p.jsx(ct,{children:d.row_num||"-"})]},d.id)),e.length===0&&!r&&p.jsx(br,{children:p.jsx(ct,{colSpan:8,className:"text-center",children:"No transactions found"})})]})]})})})]})},gG=({isOpen:e,onClose:t,item:r,onSave:n})=>{const[a,i]=O.useState({name:"",description:"",number:"",price:""}),[s,o]=O.useState({}),[l,c]=O.useState(!1);O.useEffect(()=>{var d;i(r?{name:r.Item_Name,description:r.Item_Desc||"",number:r.Item_Number||"",price:((d=r.Item_Price)==null?void 0:d.toString())||""}:{name:"",description:"",number:"",price:""})},[r]);const u=async()=>{const d={};if(!a.name.trim())d.name="Name is required";else{let h=He.from("SaleItems").select("Item_Name").eq("Item_Name",a.name.trim());r!=null&&r.id&&(h=h.neq("id",parseInt(r.id)));const{data:v,error:m}=await h.maybeSingle();m?(console.error("Error checking item name:",m),d.name="Error validating item name"):v&&(d.name="Same name exists. Please change the name.")}return!a.price||!a.price.trim()?d.price="Price is required":a.price&&isNaN(Number(a.price))&&(d.price="Price must be a valid number"),o(d),Object.keys(d).length===0},f=async d=>{d.preventDefault();try{if(c(!0),await u()){const v={Item_Name:a.name.trim(),Item_Desc:a.description.trim()||null,Item_Number:a.number.trim()||null,Item_Price:a.price.trim()?Number(a.price.trim()):null},{error:m}=r?await He.from("SaleItems").update(v).eq("id",r.id):await He.from("SaleItems").insert([v]);if(m)throw m;n(),t()}}catch(h){console.error("Error saving item:",h),o({...s,name:"Failed to save item. Please try again."})}finally{c(!1)}};return e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r?"Edit Sales Item":"Add Sales Item"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("form",{onSubmit:f,className:"p-6",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name *"}),p.jsx("input",{type:"text",value:a.name,onChange:d=>i({...a,name:d.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.name?"border-red-500":"border-gray-300"}`}),s.name&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.name})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),p.jsx("textarea",{value:a.description,onChange:d=>i({...a,description:d.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Number"}),p.jsx("input",{type:"text",value:a.number,onChange:d=>i({...a,number:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Price *"}),p.jsx("input",{type:"text",value:a.price,onChange:d=>i({...a,price:d.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.price?"border-red-500":"border-gray-300"}`,required:!0}),s.price&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.price})]})]}),p.jsxs("div",{className:"mt-6 flex space-x-3",children:[p.jsx(pt,{type:"submit",variant:"primary",className:"flex-1",disabled:l,children:l?"Saving...":r?"Save Changes":"Save Item"}),p.jsx(pt,{type:"button",variant:"outline",className:"flex-1",onClick:t,disabled:l,children:"Cancel"})]})]})]})}):null},mG=()=>{const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,i]=O.useState([]),[s,o]=O.useState(null),[l,c]=O.useState(!1),[u,f]=O.useState(null),[d,h]=O.useState(!1),[v,m]=O.useState(!1),{sortedItems:y,sortConfig:x,requestSort:b}=Rl(e,{key:"Item_Name",direction:"asc"}),w=async()=>{try{n(!0),o(null);const{data:E,error:P}=await He.from("SaleItems").select("*").order("Item_Name");if(P)throw P;t(E||[])}catch(E){console.error("Error fetching items:",E),o(E instanceof Error?E.message:"Failed to fetch items")}finally{n(!1)}};O.useEffect(()=>{w()},[]);const S=E=>{i(P=>P.includes(E)?P.filter(M=>M!==E):[...P,E])},L=()=>{i(a.length===e.length?[]:e.map(E=>E.id))},j=E=>{f(E),c(!0)},N=async()=>{try{m(!0),o(null);const{error:E}=await He.from("SaleItems").delete().in("id",a);if(E)throw E;i([]),h(!1),await w()}catch(E){console.error("Error deleting items:",E),o(E instanceof Error?E.message:"Failed to delete items"),h(!1)}finally{m(!1)}};return p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Sales Items"}),p.jsx("button",{onClick:w,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",disabled:r,children:p.jsx(ko,{className:`w-5 h-5 ${r?"animate-spin":""}`})}),a.length>0&&p.jsx("button",{onClick:()=>h(!0),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors",title:"Delete selected items",children:p.jsx(Mc,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[a.length," selected"]}),p.jsx(pt,{variant:"default",className:"bg-black hover:bg-black/90 text-white",icon:p.jsx(Rc,{className:"w-4 h-4"}),onClick:()=>{f(null),c(!0)},children:"Add Sales Item"})]})]}),s&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:s}),p.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(vt,{className:"w-12",children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:a.length===e.length&&e.length>0,onChange:L})}),p.jsx(vt,{onClick:()=>b("Item_Name"),className:"cursor-pointer hover:text-gray-900 dark:hover:text-gray-100",children:"Name"}),p.jsx(vt,{onClick:()=>b("Item_Desc"),className:"cursor-pointer hover:text-gray-900 dark:hover:text-gray-100",children:"Description"}),p.jsx(vt,{onClick:()=>b("Item_Number"),className:"cursor-pointer hover:text-gray-900 dark:hover:text-gray-100",children:"Number"}),p.jsx(vt,{onClick:()=>b("Item_Price"),className:"cursor-pointer hover:text-gray-900 dark:hover:text-gray-100",children:"Price"}),p.jsx(vt,{children:"Actions"})]})}),p.jsxs(Os,{children:[y.map(E=>p.jsxs(br,{className:`hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${a.includes(E.id)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[p.jsx(ct,{children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:a.includes(E.id),onChange:()=>S(E.id)})}),p.jsx(ct,{className:"font-medium",children:E.Item_Name}),p.jsx(ct,{children:E.Item_Desc||"-"}),p.jsx(ct,{children:E.Item_Number||"-"}),p.jsx(ct,{children:E.Item_Price?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E.Item_Price):"-"}),p.jsx(ct,{children:p.jsx("button",{onClick:()=>j(E),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"Edit item",children:p.jsx(Ol,{className:"w-4 h-4"})})})]},E.id)),e.length===0&&!r&&p.jsx(br,{children:p.jsx(ct,{colSpan:6,className:"text-center",children:"No items found"})})]})]})})}),p.jsx(gG,{isOpen:l,onClose:()=>{c(!1),f(null)},item:u,onSave:w}),d&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirm Deletion"}),p.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Are you sure you want to delete ",a.length," selected item",a.length>1?"s":"","? This action cannot be undone."]}),p.jsxs("div",{className:"flex space-x-4",children:[p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>h(!1),children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:N,disabled:v,children:v?"Deleting...":"Delete"})]})]})})]})},vG=[{value:"0",label:"0 days"},{value:"7",label:"7 days"},{value:"10",label:"10 days"},{value:"15",label:"15 days"},{value:"30",label:"30 days"},{value:"45",label:"45 days"}],xG=({isOpen:e,onClose:t,customer:r,onSave:n})=>{const[a,i]=O.useState({name:"",email:"",phone:"",taxId:"",address:"",paymentTerms:""}),[s,o]=O.useState({}),[l,c]=O.useState(!1);O.useEffect(()=>{var d,h;if(r){const v=r.Customer_PaymentTerms!==null&&r.Customer_PaymentTerms!==void 0?r.Customer_PaymentTerms.toString():"";i({name:r.Customer_name,email:r.Customer_Email,phone:((d=r.Customer_Phone)==null?void 0:d.toString())||"",taxId:((h=r.Customer_TaxID)==null?void 0:h.toString())||"",address:r.Customer_address||"",paymentTerms:v})}else i({name:"",email:"",phone:"",taxId:"",address:"",paymentTerms:""})},[r]);const u=async()=>{const d={};if(!a.name.trim())d.name="Name is required";else{const{data:h,error:v}=await He.from("Customer").select("Customer_name").eq("Customer_name",a.name.trim()).neq("id",(r==null?void 0:r.id)||0).maybeSingle();v?(console.error("Error checking customer name:",v),d.name="Error validating customer name"):h&&(d.name="Customer with the same name exists. Please change the name.")}return a.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)||(d.email="Invalid email format"):d.email="Email is required",a.paymentTerms||(d.paymentTerms="Payment terms are required"),o(d),Object.keys(d).length===0},f=async d=>{d.preventDefault();try{if(c(!0),await u()){const v={Customer_name:a.name,Customer_Email:a.email,Customer_Phone:a.phone?Number(a.phone):null,Customer_TaxID:a.taxId?Number(a.taxId):null,Customer_address:a.address,Customer_PaymentTerms:a.paymentTerms?Number(a.paymentTerms):null},{error:m}=r?await He.from("Customer").update(v).eq("id",r.id):await He.from("Customer").insert([v]);if(m)throw m;n(),t()}}catch(h){console.error("Error saving customer:",h),o({...s,name:"Failed to save customer. Please try again."})}finally{c(!1)}};return e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r?"Edit Customer":"Add Customer"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("form",{onSubmit:f,className:"p-6",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name *"}),p.jsx("input",{type:"text",value:a.name,onChange:d=>i({...a,name:d.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.name?"border-red-500":"border-gray-300"}`}),s.name&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.name})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email *"}),p.jsx("input",{type:"email",value:a.email,onChange:d=>i({...a,email:d.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.email?"border-red-500":"border-gray-300"}`}),s.email&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.email})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone"}),p.jsx("input",{type:"tel",value:a.phone,onChange:d=>i({...a,phone:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tax ID"}),p.jsx("input",{type:"text",value:a.taxId,onChange:d=>i({...a,taxId:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Billing Address"}),p.jsx("textarea",{value:a.address,onChange:d=>i({...a,address:d.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Payment Terms *"}),p.jsxs("select",{value:a.paymentTerms,onChange:d=>i({...a,paymentTerms:d.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.paymentTerms?"border-red-500":"border-gray-300"}`,children:[p.jsx("option",{value:"",children:"Select payment terms"}),vG.map(d=>p.jsx("option",{value:d.value,children:d.label},d.value))]}),s.paymentTerms&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.paymentTerms})]})]}),p.jsxs("div",{className:"mt-6 flex space-x-3",children:[p.jsx(pt,{type:"submit",variant:"primary",className:"flex-1",disabled:l,children:l?"Saving...":"Save"}),p.jsx(pt,{type:"button",variant:"outline",className:"flex-1",onClick:t,disabled:l,children:"Cancel"})]})]})]})}):null},yG=()=>{const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,i]=O.useState([]),[s,o]=O.useState(null),[l,c]=O.useState(!1),[u,f]=O.useState(null),[d,h]=O.useState(!1),[v,m]=O.useState(!1),{sortedItems:y,sortConfig:x,requestSort:b}=Rl(e,{key:"Customer_name",direction:"asc"}),w=async()=>{try{n(!0),o(null);const{data:P,error:M}=await He.from("Customer").select(`
          id,
          Customer_name,
          Customer_Email,
          Customer_address,
          Customer_Phone,
          Customer_TaxID
        `);if(M)throw M;const{data:F,error:T}=await He.from("SalesInvoice").select("Customer_name, OutstandingAmount");if(T)throw T;const H=P.map(W=>{const V=F.filter(z=>z.Customer_name===W.Customer_name).reduce((z,X)=>z+(X.OutstandingAmount||0),0);return{...W,OutstandingAmount:V}});t(H)}catch(P){console.error("Error fetching customers:",P),o(P instanceof Error?P.message:"Failed to fetch customers")}finally{n(!1)}};O.useEffect(()=>{w()},[]);const S=P=>{i(M=>M.includes(P)?M.filter(F=>F!==P):[...M,P])},L=()=>{i(a.length===e.length?[]:e.map(P=>P.id))},j=P=>{f(P),c(!0)},N=async()=>{try{if(m(!0),o(null),e.filter(T=>a.includes(T.id)).some(T=>(T.OutstandingAmount||0)>0))throw new Error("Cannot delete customers with outstanding balances");const{error:F}=await He.from("Customer").delete().in("id",a);if(F)throw F;i([]),h(!1),await w()}catch(P){console.error("Error deleting customers:",P),o(P instanceof Error?P.message:"Failed to delete customers"),h(!1)}finally{m(!1)}},E=P=>{w(),f(null)};return p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Customers"}),p.jsx("button",{onClick:w,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",disabled:r||d,children:p.jsx(ko,{className:`w-5 h-5 ${r?"animate-spin":""}`})}),a.length>0&&p.jsx("button",{onClick:()=>h(!0),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors",title:"Delete selected customers",children:p.jsx(Mc,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[a.length," selected"]}),p.jsx(pt,{variant:"default",className:"bg-black hover:bg-black/90 text-white",icon:p.jsx(Rc,{className:"w-4 h-4"}),onClick:()=>c(!0),children:"Add Customer"})]})]}),s&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:s}),p.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(vt,{className:"w-12",children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:a.length===e.length&&e.length>0,onChange:L})}),p.jsx(vt,{onClick:()=>b("Customer_name"),className:"cursor-pointer",children:"Name"}),p.jsx(vt,{onClick:()=>b("Customer_Email"),className:"cursor-pointer",children:"Email"}),p.jsx(vt,{onClick:()=>b("Customer_address"),className:"cursor-pointer",children:"Address"}),p.jsx(vt,{onClick:()=>b("Customer_Phone"),className:"cursor-pointer",children:"Phone"}),p.jsx(vt,{onClick:()=>b("Customer_TaxID"),className:"cursor-pointer",children:"Tax ID"}),p.jsx(vt,{onClick:()=>b("OutstandingAmount"),className:"cursor-pointer",children:"Receivable"}),p.jsx(vt,{children:"Actions"})]})}),p.jsxs(Os,{children:[y.map(P=>p.jsxs(br,{className:`hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${a.includes(P.id)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[p.jsx(ct,{children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:a.includes(P.id),onChange:()=>S(P.id)})}),p.jsx(ct,{className:"font-medium",children:P.Customer_name}),p.jsx(ct,{children:P.Customer_Email}),p.jsx(ct,{children:P.Customer_address}),p.jsx(ct,{children:P.Customer_Phone}),p.jsx(ct,{children:P.Customer_TaxID||"-"}),p.jsx(ct,{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(P.OutstandingAmount||0)}),p.jsx(ct,{children:p.jsx("button",{onClick:()=>j(P),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"Edit customer",children:p.jsx(Ol,{className:"w-4 h-4"})})})]},P.id)),e.length===0&&!r&&p.jsx(br,{children:p.jsx(ct,{colSpan:8,className:"text-center",children:"No customers found"})})]})]})})}),p.jsx(xG,{isOpen:l,onClose:()=>c(!1),customer:u,onSave:E}),d&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirm Deletion"}),p.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Are you sure you want to delete ",a.length," selected customer",a.length>1?"s":"","? This action cannot be undone."]}),p.jsxs("div",{className:"flex space-x-4",children:[p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>h(!1),children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:N,disabled:v,children:v?"Deleting...":"Delete"})]})]})})]})};function Vt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function j0(e,t=[]){let r=[];function n(i,s){const o=O.createContext(s),l=r.length;r=[...r,s];const c=f=>{var x;const{scope:d,children:h,...v}=f,m=((x=d==null?void 0:d[e])==null?void 0:x[l])||o,y=O.useMemo(()=>v,Object.values(v));return p.jsx(m.Provider,{value:y,children:h})};c.displayName=i+"Provider";function u(f,d){var m;const h=((m=d==null?void 0:d[e])==null?void 0:m[l])||o,v=O.useContext(h);if(v)return v;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[c,u]}const a=()=>{const i=r.map(s=>O.createContext(s));return function(o){const l=(o==null?void 0:o[e])||i;return O.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return a.scopeName=e,[n,wG(a,...t)]}function wG(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const s=n.reduce((o,{useScope:l,scopeName:c})=>{const f=l(i)[`__scope${c}`];return{...o,...f}},{});return O.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}var bG=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$n=bG.reduce((e,t)=>{const r=m0(`Primitive.${t}`),n=O.forwardRef((a,i)=>{const{asChild:s,...o}=a,l=s?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...o,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function xA(e,t){e&&vg.flushSync(()=>e.dispatchEvent(t))}function yo(e){const t=O.useRef(e);return O.useEffect(()=>{t.current=e}),O.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function _G(e,t=globalThis==null?void 0:globalThis.document){const r=yo(e);O.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var kG="DismissableLayer",N2="dismissableLayer.update",SG="dismissableLayer.pointerDownOutside",EG="dismissableLayer.focusOutside",X4,yA=O.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Cw=O.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:s,onDismiss:o,...l}=e,c=O.useContext(yA),[u,f]=O.useState(null),d=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=O.useState({}),v=ca(t,N=>f(N)),m=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=m.indexOf(y),b=u?m.indexOf(u):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,S=b>=x,L=CG(N=>{const E=N.target,P=[...c.branches].some(M=>M.contains(E));!S||P||(a==null||a(N),s==null||s(N),N.defaultPrevented||o==null||o())},d),j=TG(N=>{const E=N.target;[...c.branches].some(M=>M.contains(E))||(i==null||i(N),s==null||s(N),N.defaultPrevented||o==null||o())},d);return _G(N=>{b===c.layers.size-1&&(n==null||n(N),!N.defaultPrevented&&o&&(N.preventDefault(),o()))},d),O.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(X4=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),K4(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=X4)}},[u,d,r,c]),O.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),K4())},[u,c]),O.useEffect(()=>{const N=()=>h({});return document.addEventListener(N2,N),()=>document.removeEventListener(N2,N)},[]),p.jsx($n.div,{...l,ref:v,style:{pointerEvents:w?S?"auto":"none":void 0,...e.style},onFocusCapture:Vt(e.onFocusCapture,j.onFocusCapture),onBlurCapture:Vt(e.onBlurCapture,j.onBlurCapture),onPointerDownCapture:Vt(e.onPointerDownCapture,L.onPointerDownCapture)})});Cw.displayName=kG;var NG="DismissableLayerBranch",AG=O.forwardRef((e,t)=>{const r=O.useContext(yA),n=O.useRef(null),a=ca(t,n);return O.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),p.jsx($n.div,{...e,ref:a})});AG.displayName=NG;function CG(e,t=globalThis==null?void 0:globalThis.document){const r=yo(e),n=O.useRef(!1),a=O.useRef(()=>{});return O.useEffect(()=>{const i=o=>{if(o.target&&!n.current){let l=function(){wA(SG,r,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=l,t.addEventListener("click",a.current,{once:!0})):l()}else t.removeEventListener("click",a.current);n.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function TG(e,t=globalThis==null?void 0:globalThis.document){const r=yo(e),n=O.useRef(!1);return O.useEffect(()=>{const a=i=>{i.target&&!n.current&&wA(EG,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function K4(){const e=new CustomEvent(N2);document.dispatchEvent(e)}function wA(e,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?xA(a,i):a.dispatchEvent(i)}var Bv=0;function bA(){O.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Y4()),document.body.insertAdjacentElement("beforeend",e[1]??Y4()),Bv++,()=>{Bv===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Bv--}},[])}function Y4(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Uv="focusScope.autoFocusOnMount",zv="focusScope.autoFocusOnUnmount",J4={bubbles:!1,cancelable:!0},PG="FocusScope",Tw=O.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...s}=e,[o,l]=O.useState(null),c=yo(a),u=yo(i),f=O.useRef(null),d=ca(t,m=>l(m)),h=O.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;O.useEffect(()=>{if(n){let m=function(w){if(h.paused||!o)return;const S=w.target;o.contains(S)?f.current=S:Ko(f.current,{select:!0})},y=function(w){if(h.paused||!o)return;const S=w.relatedTarget;S!==null&&(o.contains(S)||Ko(f.current,{select:!0}))},x=function(w){if(document.activeElement===document.body)for(const L of w)L.removedNodes.length>0&&Ko(o)};document.addEventListener("focusin",m),document.addEventListener("focusout",y);const b=new MutationObserver(x);return o&&b.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",y),b.disconnect()}}},[n,o,h.paused]),O.useEffect(()=>{if(o){Q4.add(h);const m=document.activeElement;if(!o.contains(m)){const x=new CustomEvent(Uv,J4);o.addEventListener(Uv,c),o.dispatchEvent(x),x.defaultPrevented||(FG(OG(_A(o)),{select:!0}),document.activeElement===m&&Ko(o))}return()=>{o.removeEventListener(Uv,c),setTimeout(()=>{const x=new CustomEvent(zv,J4);o.addEventListener(zv,u),o.dispatchEvent(x),x.defaultPrevented||Ko(m??document.body,{select:!0}),o.removeEventListener(zv,u),Q4.remove(h)},0)}}},[o,c,u,h]);const v=O.useCallback(m=>{if(!r&&!n||h.paused)return;const y=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,x=document.activeElement;if(y&&x){const b=m.currentTarget,[w,S]=LG(b);w&&S?!m.shiftKey&&x===S?(m.preventDefault(),r&&Ko(w,{select:!0})):m.shiftKey&&x===w&&(m.preventDefault(),r&&Ko(S,{select:!0})):x===b&&m.preventDefault()}},[r,n,h.paused]);return p.jsx($n.div,{tabIndex:-1,...s,ref:d,onKeyDown:v})});Tw.displayName=PG;function FG(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Ko(n,{select:t}),document.activeElement!==r)return}function LG(e){const t=_A(e),r=Z4(t,e),n=Z4(t.reverse(),e);return[r,n]}function _A(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Z4(e,t){for(const r of e)if(!jG(r,{upTo:t}))return r}function jG(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function IG(e){return e instanceof HTMLInputElement&&"select"in e}function Ko(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&IG(e)&&t&&e.select()}}var Q4=DG();function DG(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=ek(e,t),e.unshift(t)},remove(t){var r;e=ek(e,t),(r=e[0])==null||r.resume()}}}function ek(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function OG(e){return e.filter(t=>t.tagName!=="A")}var Cl=globalThis!=null&&globalThis.document?O.useLayoutEffect:()=>{},RG=R2[" useId ".trim().toString()]||(()=>{}),MG=0;function Gp(e){const[t,r]=O.useState(RG());return Cl(()=>{e||r(n=>n??String(MG++))},[e]),e||(t?`radix-${t}`:"")}const BG=["top","right","bottom","left"],Tl=Math.min,ei=Math.max,Xp=Math.round,B1=Math.floor,Ls=e=>({x:e,y:e}),UG={left:"right",right:"left",bottom:"top",top:"bottom"},zG={start:"end",end:"start"};function A2(e,t,r){return ei(e,Tl(t,r))}function wo(e,t){return typeof e=="function"?e(t):e}function bo(e){return e.split("-")[0]}function I0(e){return e.split("-")[1]}function Pw(e){return e==="x"?"y":"x"}function Fw(e){return e==="y"?"height":"width"}function fo(e){return["top","bottom"].includes(bo(e))?"y":"x"}function Lw(e){return Pw(fo(e))}function WG(e,t,r){r===void 0&&(r=!1);const n=I0(e),a=Lw(e),i=Fw(a);let s=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=Kp(s)),[s,Kp(s)]}function HG(e){const t=Kp(e);return[C2(e),t,C2(t)]}function C2(e){return e.replace(/start|end/g,t=>zG[t])}function $G(e,t,r){const n=["left","right"],a=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:n:t?n:a;case"left":case"right":return t?i:s;default:return[]}}function VG(e,t,r,n){const a=I0(e);let i=$G(bo(e),r==="start",n);return a&&(i=i.map(s=>s+"-"+a),t&&(i=i.concat(i.map(C2)))),i}function Kp(e){return e.replace(/left|right|bottom|top/g,t=>UG[t])}function qG(e){return{top:0,right:0,bottom:0,left:0,...e}}function kA(e){return typeof e!="number"?qG(e):{top:e,right:e,bottom:e,left:e}}function Yp(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function tk(e,t,r){let{reference:n,floating:a}=e;const i=fo(t),s=Lw(t),o=Fw(s),l=bo(t),c=i==="y",u=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,d=n[o]/2-a[o]/2;let h;switch(l){case"top":h={x:u,y:n.y-a.height};break;case"bottom":h={x:u,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:f};break;case"left":h={x:n.x-a.width,y:f};break;default:h={x:n.x,y:n.y}}switch(I0(t)){case"start":h[s]-=d*(r&&c?-1:1);break;case"end":h[s]+=d*(r&&c?-1:1);break}return h}const GG=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:s}=r,o=i.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(t));let c=await s.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:f}=tk(c,n,l),d=n,h={},v=0;for(let m=0;m<o.length;m++){const{name:y,fn:x}=o[m],{x:b,y:w,data:S,reset:L}=await x({x:u,y:f,initialPlacement:n,placement:d,strategy:a,middlewareData:h,rects:c,platform:s,elements:{reference:e,floating:t}});u=b??u,f=w??f,h={...h,[y]:{...h[y],...S}},L&&v<=50&&(v++,typeof L=="object"&&(L.placement&&(d=L.placement),L.rects&&(c=L.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:a}):L.rects),{x:u,y:f}=tk(c,d,l)),m=-1)}return{x:u,y:f,placement:d,strategy:a,middlewareData:h}};async function Wd(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:s,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:d=!1,padding:h=0}=wo(t,e),v=kA(h),y=o[d?f==="floating"?"reference":"floating":f],x=Yp(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(y)))==null||r?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),b=f==="floating"?{x:n,y:a,width:s.floating.width,height:s.floating.height}:s.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),S=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},L=Yp(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:b,offsetParent:w,strategy:l}):b);return{top:(x.top-L.top+v.top)/S.y,bottom:(L.bottom-x.bottom+v.bottom)/S.y,left:(x.left-L.left+v.left)/S.x,right:(L.right-x.right+v.right)/S.x}}const XG=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:i,platform:s,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=wo(e,t)||{};if(c==null)return{};const f=kA(u),d={x:r,y:n},h=Lw(a),v=Fw(h),m=await s.getDimensions(c),y=h==="y",x=y?"top":"left",b=y?"bottom":"right",w=y?"clientHeight":"clientWidth",S=i.reference[v]+i.reference[h]-d[h]-i.floating[v],L=d[h]-i.reference[h],j=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let N=j?j[w]:0;(!N||!await(s.isElement==null?void 0:s.isElement(j)))&&(N=o.floating[w]||i.floating[v]);const E=S/2-L/2,P=N/2-m[v]/2-1,M=Tl(f[x],P),F=Tl(f[b],P),T=M,H=N-m[v]-F,W=N/2-m[v]/2+E,Q=A2(T,W,H),V=!l.arrow&&I0(a)!=null&&W!==Q&&i.reference[v]/2-(W<T?M:F)-m[v]/2<0,z=V?W<T?W-T:W-H:0;return{[h]:d[h]+z,data:{[h]:Q,centerOffset:W-Q-z,...V&&{alignmentOffset:z}},reset:V}}}),KG=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:i,rects:s,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:m=!0,...y}=wo(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const x=bo(a),b=fo(o),w=bo(o)===o,S=await(l.isRTL==null?void 0:l.isRTL(c.floating)),L=d||(w||!m?[Kp(o)]:HG(o)),j=v!=="none";!d&&j&&L.push(...VG(o,m,v,S));const N=[o,...L],E=await Wd(t,y),P=[];let M=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&P.push(E[x]),f){const Q=WG(a,s,S);P.push(E[Q[0]],E[Q[1]])}if(M=[...M,{placement:a,overflows:P}],!P.every(Q=>Q<=0)){var F,T;const Q=(((F=i.flip)==null?void 0:F.index)||0)+1,V=N[Q];if(V){var H;const X=f==="alignment"?b!==fo(V):!1,D=((H=M[0])==null?void 0:H.overflows[0])>0;if(!X||D)return{data:{index:Q,overflows:M},reset:{placement:V}}}let z=(T=M.filter(X=>X.overflows[0]<=0).sort((X,D)=>X.overflows[1]-D.overflows[1])[0])==null?void 0:T.placement;if(!z)switch(h){case"bestFit":{var W;const X=(W=M.filter(D=>{if(j){const ne=fo(D.placement);return ne===b||ne==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(ne=>ne>0).reduce((ne,ge)=>ne+ge,0)]).sort((D,ne)=>D[1]-ne[1])[0])==null?void 0:W[0];X&&(z=X);break}case"initialPlacement":z=o;break}if(a!==z)return{reset:{placement:z}}}return{}}}};function rk(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function nk(e){return BG.some(t=>e[t]>=0)}const YG=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=wo(e,t);switch(n){case"referenceHidden":{const i=await Wd(t,{...a,elementContext:"reference"}),s=rk(i,r.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:nk(s)}}}case"escaped":{const i=await Wd(t,{...a,altBoundary:!0}),s=rk(i,r.floating);return{data:{escapedOffsets:s,escaped:nk(s)}}}default:return{}}}}};async function JG(e,t){const{placement:r,platform:n,elements:a}=e,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),s=bo(r),o=I0(r),l=fo(r)==="y",c=["left","top"].includes(s)?-1:1,u=i&&l?-1:1,f=wo(t,e);let{mainAxis:d,crossAxis:h,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof v=="number"&&(h=o==="end"?v*-1:v),l?{x:h*u,y:d*c}:{x:d*c,y:h*u}}const ZG=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:i,placement:s,middlewareData:o}=t,l=await JG(t,e);return s===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:a+l.x,y:i+l.y,data:{...l,placement:s}}}}},QG=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:i=!0,crossAxis:s=!1,limiter:o={fn:y=>{let{x,y:b}=y;return{x,y:b}}},...l}=wo(e,t),c={x:r,y:n},u=await Wd(t,l),f=fo(bo(a)),d=Pw(f);let h=c[d],v=c[f];if(i){const y=d==="y"?"top":"left",x=d==="y"?"bottom":"right",b=h+u[y],w=h-u[x];h=A2(b,h,w)}if(s){const y=f==="y"?"top":"left",x=f==="y"?"bottom":"right",b=v+u[y],w=v-u[x];v=A2(b,v,w)}const m=o.fn({...t,[d]:h,[f]:v});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[d]:i,[f]:s}}}}}},eX=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:s}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=wo(e,t),u={x:r,y:n},f=fo(a),d=Pw(f);let h=u[d],v=u[f];const m=wo(o,t),y=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const w=d==="y"?"height":"width",S=i.reference[d]-i.floating[w]+y.mainAxis,L=i.reference[d]+i.reference[w]-y.mainAxis;h<S?h=S:h>L&&(h=L)}if(c){var x,b;const w=d==="y"?"width":"height",S=["top","left"].includes(bo(a)),L=i.reference[f]-i.floating[w]+(S&&((x=s.offset)==null?void 0:x[f])||0)+(S?0:y.crossAxis),j=i.reference[f]+i.reference[w]+(S?0:((b=s.offset)==null?void 0:b[f])||0)-(S?y.crossAxis:0);v<L?v=L:v>j&&(v=j)}return{[d]:h,[f]:v}}}},tX=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:i,platform:s,elements:o}=t,{apply:l=()=>{},...c}=wo(e,t),u=await Wd(t,c),f=bo(a),d=I0(a),h=fo(a)==="y",{width:v,height:m}=i.floating;let y,x;f==="top"||f==="bottom"?(y=f,x=d===(await(s.isRTL==null?void 0:s.isRTL(o.floating))?"start":"end")?"left":"right"):(x=f,y=d==="end"?"top":"bottom");const b=m-u.top-u.bottom,w=v-u.left-u.right,S=Tl(m-u[y],b),L=Tl(v-u[x],w),j=!t.middlewareData.shift;let N=S,E=L;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(E=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(N=b),j&&!d){const M=ei(u.left,0),F=ei(u.right,0),T=ei(u.top,0),H=ei(u.bottom,0);h?E=v-2*(M!==0||F!==0?M+F:ei(u.left,u.right)):N=m-2*(T!==0||H!==0?T+H:ei(u.top,u.bottom))}await l({...t,availableWidth:E,availableHeight:N});const P=await s.getDimensions(o.floating);return v!==P.width||m!==P.height?{reset:{rects:!0}}:{}}}};function Ug(){return typeof window<"u"}function D0(e){return SA(e)?(e.nodeName||"").toLowerCase():"#document"}function si(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Us(e){var t;return(t=(SA(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function SA(e){return Ug()?e instanceof Node||e instanceof si(e).Node:!1}function os(e){return Ug()?e instanceof Element||e instanceof si(e).Element:!1}function js(e){return Ug()?e instanceof HTMLElement||e instanceof si(e).HTMLElement:!1}function ak(e){return!Ug()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof si(e).ShadowRoot}function fh(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=ls(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function rX(e){return["table","td","th"].includes(D0(e))}function zg(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function jw(e){const t=Iw(),r=os(e)?ls(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function nX(e){let t=Pl(e);for(;js(t)&&!w0(t);){if(jw(t))return t;if(zg(t))return null;t=Pl(t)}return null}function Iw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function w0(e){return["html","body","#document"].includes(D0(e))}function ls(e){return si(e).getComputedStyle(e)}function Wg(e){return os(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Pl(e){if(D0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||ak(e)&&e.host||Us(e);return ak(t)?t.host:t}function EA(e){const t=Pl(e);return w0(t)?e.ownerDocument?e.ownerDocument.body:e.body:js(t)&&fh(t)?t:EA(t)}function Hd(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=EA(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),s=si(a);if(i){const o=T2(s);return t.concat(s,s.visualViewport||[],fh(a)?a:[],o&&r?Hd(o):[])}return t.concat(a,Hd(a,[],r))}function T2(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function NA(e){const t=ls(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=js(e),i=a?e.offsetWidth:r,s=a?e.offsetHeight:n,o=Xp(r)!==i||Xp(n)!==s;return o&&(r=i,n=s),{width:r,height:n,$:o}}function Dw(e){return os(e)?e:e.contextElement}function s0(e){const t=Dw(e);if(!js(t))return Ls(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=NA(t);let s=(i?Xp(r.width):r.width)/n,o=(i?Xp(r.height):r.height)/a;return(!s||!Number.isFinite(s))&&(s=1),(!o||!Number.isFinite(o))&&(o=1),{x:s,y:o}}const aX=Ls(0);function AA(e){const t=si(e);return!Iw()||!t.visualViewport?aX:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function iX(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==si(e)?!1:t}function Lc(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=Dw(e);let s=Ls(1);t&&(n?os(n)&&(s=s0(n)):s=s0(e));const o=iX(i,r,n)?AA(i):Ls(0);let l=(a.left+o.x)/s.x,c=(a.top+o.y)/s.y,u=a.width/s.x,f=a.height/s.y;if(i){const d=si(i),h=n&&os(n)?si(n):n;let v=d,m=T2(v);for(;m&&n&&h!==v;){const y=s0(m),x=m.getBoundingClientRect(),b=ls(m),w=x.left+(m.clientLeft+parseFloat(b.paddingLeft))*y.x,S=x.top+(m.clientTop+parseFloat(b.paddingTop))*y.y;l*=y.x,c*=y.y,u*=y.x,f*=y.y,l+=w,c+=S,v=si(m),m=T2(v)}}return Yp({width:u,height:f,x:l,y:c})}function Ow(e,t){const r=Wg(e).scrollLeft;return t?t.left+r:Lc(Us(e)).left+r}function CA(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:Ow(e,n)),i=n.top+t.scrollTop;return{x:a,y:i}}function sX(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const i=a==="fixed",s=Us(n),o=t?zg(t.floating):!1;if(n===s||o&&i)return r;let l={scrollLeft:0,scrollTop:0},c=Ls(1);const u=Ls(0),f=js(n);if((f||!f&&!i)&&((D0(n)!=="body"||fh(s))&&(l=Wg(n)),js(n))){const h=Lc(n);c=s0(n),u.x=h.x+n.clientLeft,u.y=h.y+n.clientTop}const d=s&&!f&&!i?CA(s,l,!0):Ls(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:r.y*c.y-l.scrollTop*c.y+u.y+d.y}}function oX(e){return Array.from(e.getClientRects())}function lX(e){const t=Us(e),r=Wg(e),n=e.ownerDocument.body,a=ei(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=ei(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+Ow(e);const o=-r.scrollTop;return ls(n).direction==="rtl"&&(s+=ei(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:s,y:o}}function cX(e,t){const r=si(e),n=Us(e),a=r.visualViewport;let i=n.clientWidth,s=n.clientHeight,o=0,l=0;if(a){i=a.width,s=a.height;const c=Iw();(!c||c&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}return{width:i,height:s,x:o,y:l}}function uX(e,t){const r=Lc(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,i=js(e)?s0(e):Ls(1),s=e.clientWidth*i.x,o=e.clientHeight*i.y,l=a*i.x,c=n*i.y;return{width:s,height:o,x:l,y:c}}function ik(e,t,r){let n;if(t==="viewport")n=cX(e,r);else if(t==="document")n=lX(Us(e));else if(os(t))n=uX(t,r);else{const a=AA(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Yp(n)}function TA(e,t){const r=Pl(e);return r===t||!os(r)||w0(r)?!1:ls(r).position==="fixed"||TA(r,t)}function fX(e,t){const r=t.get(e);if(r)return r;let n=Hd(e,[],!1).filter(o=>os(o)&&D0(o)!=="body"),a=null;const i=ls(e).position==="fixed";let s=i?Pl(e):e;for(;os(s)&&!w0(s);){const o=ls(s),l=jw(s);!l&&o.position==="fixed"&&(a=null),(i?!l&&!a:!l&&o.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||fh(s)&&!l&&TA(e,s))?n=n.filter(u=>u!==s):a=o,s=Pl(s)}return t.set(e,n),n}function dX(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const s=[...r==="clippingAncestors"?zg(t)?[]:fX(t,this._c):[].concat(r),n],o=s[0],l=s.reduce((c,u)=>{const f=ik(t,u,a);return c.top=ei(f.top,c.top),c.right=Tl(f.right,c.right),c.bottom=Tl(f.bottom,c.bottom),c.left=ei(f.left,c.left),c},ik(t,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function hX(e){const{width:t,height:r}=NA(e);return{width:t,height:r}}function pX(e,t,r){const n=js(t),a=Us(t),i=r==="fixed",s=Lc(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=Ls(0);function c(){l.x=Ow(a)}if(n||!n&&!i)if((D0(t)!=="body"||fh(a))&&(o=Wg(t)),n){const h=Lc(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else a&&c();i&&!n&&a&&c();const u=a&&!n&&!i?CA(a,o):Ls(0),f=s.left+o.scrollLeft-l.x-u.x,d=s.top+o.scrollTop-l.y-u.y;return{x:f,y:d,width:s.width,height:s.height}}function Wv(e){return ls(e).position==="static"}function sk(e,t){if(!js(e)||ls(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Us(e)===r&&(r=r.ownerDocument.body),r}function PA(e,t){const r=si(e);if(zg(e))return r;if(!js(e)){let a=Pl(e);for(;a&&!w0(a);){if(os(a)&&!Wv(a))return a;a=Pl(a)}return r}let n=sk(e,t);for(;n&&rX(n)&&Wv(n);)n=sk(n,t);return n&&w0(n)&&Wv(n)&&!jw(n)?r:n||nX(e)||r}const gX=async function(e){const t=this.getOffsetParent||PA,r=this.getDimensions,n=await r(e.floating);return{reference:pX(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function mX(e){return ls(e).direction==="rtl"}const vX={convertOffsetParentRelativeRectToViewportRelativeRect:sX,getDocumentElement:Us,getClippingRect:dX,getOffsetParent:PA,getElementRects:gX,getClientRects:oX,getDimensions:hX,getScale:s0,isElement:os,isRTL:mX};function FA(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function xX(e,t){let r=null,n;const a=Us(e);function i(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function s(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:f,width:d,height:h}=c;if(o||t(),!d||!h)return;const v=B1(f),m=B1(a.clientWidth-(u+d)),y=B1(a.clientHeight-(f+h)),x=B1(u),w={rootMargin:-v+"px "+-m+"px "+-y+"px "+-x+"px",threshold:ei(0,Tl(1,l))||1};let S=!0;function L(j){const N=j[0].intersectionRatio;if(N!==l){if(!S)return s();N?s(!1,N):n=setTimeout(()=>{s(!1,1e-7)},1e3)}N===1&&!FA(c,e.getBoundingClientRect())&&s(),S=!1}try{r=new IntersectionObserver(L,{...w,root:a.ownerDocument})}catch{r=new IntersectionObserver(L,w)}r.observe(e)}return s(!0),i}function yX(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=Dw(e),u=a||i?[...c?Hd(c):[],...Hd(t)]:[];u.forEach(x=>{a&&x.addEventListener("scroll",r,{passive:!0}),i&&x.addEventListener("resize",r)});const f=c&&o?xX(c,r):null;let d=-1,h=null;s&&(h=new ResizeObserver(x=>{let[b]=x;b&&b.target===c&&h&&(h.unobserve(t),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),r()}),c&&!l&&h.observe(c),h.observe(t));let v,m=l?Lc(e):null;l&&y();function y(){const x=Lc(e);m&&!FA(m,x)&&r(),m=x,v=requestAnimationFrame(y)}return r(),()=>{var x;u.forEach(b=>{a&&b.removeEventListener("scroll",r),i&&b.removeEventListener("resize",r)}),f==null||f(),(x=h)==null||x.disconnect(),h=null,l&&cancelAnimationFrame(v)}}const wX=ZG,bX=QG,_X=KG,kX=tX,SX=YG,ok=XG,EX=eX,NX=(e,t,r)=>{const n=new Map,a={platform:vX,...r},i={...a.platform,_c:n};return GG(e,t,{...a,platform:i})};var np=typeof document<"u"?O.useLayoutEffect:O.useEffect;function Jp(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Jp(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i==="_owner"&&e.$$typeof)&&!Jp(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function LA(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function lk(e,t){const r=LA(e);return Math.round(t*r)/r}function Hv(e){const t=O.useRef(e);return np(()=>{t.current=e}),t}function AX(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:s}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,f]=O.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[d,h]=O.useState(n);Jp(d,n)||h(n);const[v,m]=O.useState(null),[y,x]=O.useState(null),b=O.useCallback(X=>{X!==j.current&&(j.current=X,m(X))},[]),w=O.useCallback(X=>{X!==N.current&&(N.current=X,x(X))},[]),S=i||v,L=s||y,j=O.useRef(null),N=O.useRef(null),E=O.useRef(u),P=l!=null,M=Hv(l),F=Hv(a),T=Hv(c),H=O.useCallback(()=>{if(!j.current||!N.current)return;const X={placement:t,strategy:r,middleware:d};F.current&&(X.platform=F.current),NX(j.current,N.current,X).then(D=>{const ne={...D,isPositioned:T.current!==!1};W.current&&!Jp(E.current,ne)&&(E.current=ne,vg.flushSync(()=>{f(ne)}))})},[d,t,r,F,T]);np(()=>{c===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,f(X=>({...X,isPositioned:!1})))},[c]);const W=O.useRef(!1);np(()=>(W.current=!0,()=>{W.current=!1}),[]),np(()=>{if(S&&(j.current=S),L&&(N.current=L),S&&L){if(M.current)return M.current(S,L,H);H()}},[S,L,H,M,P]);const Q=O.useMemo(()=>({reference:j,floating:N,setReference:b,setFloating:w}),[b,w]),V=O.useMemo(()=>({reference:S,floating:L}),[S,L]),z=O.useMemo(()=>{const X={position:r,left:0,top:0};if(!V.floating)return X;const D=lk(V.floating,u.x),ne=lk(V.floating,u.y);return o?{...X,transform:"translate("+D+"px, "+ne+"px)",...LA(V.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:D,top:ne}},[r,o,V.floating,u.x,u.y]);return O.useMemo(()=>({...u,update:H,refs:Q,elements:V,floatingStyles:z}),[u,H,Q,V,z])}const CX=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?ok({element:n.current,padding:a}).fn(r):{}:n?ok({element:n,padding:a}).fn(r):{}}}},TX=(e,t)=>({...wX(e),options:[e,t]}),PX=(e,t)=>({...bX(e),options:[e,t]}),FX=(e,t)=>({...EX(e),options:[e,t]}),LX=(e,t)=>({..._X(e),options:[e,t]}),jX=(e,t)=>({...kX(e),options:[e,t]}),IX=(e,t)=>({...SX(e),options:[e,t]}),DX=(e,t)=>({...CX(e),options:[e,t]});var OX="Arrow",jA=O.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...i}=e;return p.jsx($n.svg,{...i,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});jA.displayName=OX;var RX=jA;function MX(e){const[t,r]=O.useState(void 0);return Cl(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let s,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,o=c.blockSize}else s=e.offsetWidth,o=e.offsetHeight;r({width:s,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var Rw="Popper",[IA,Hg]=j0(Rw),[BX,DA]=IA(Rw),OA=e=>{const{__scopePopper:t,children:r}=e,[n,a]=O.useState(null);return p.jsx(BX,{scope:t,anchor:n,onAnchorChange:a,children:r})};OA.displayName=Rw;var RA="PopperAnchor",MA=O.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,i=DA(RA,r),s=O.useRef(null),o=ca(t,s);return O.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||s.current)}),n?null:p.jsx($n.div,{...a,ref:o})});MA.displayName=RA;var Mw="PopperContent",[UX,zX]=IA(Mw),BA=O.forwardRef((e,t)=>{var ue,pe,he,ye,Pe,re;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:s=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:d=!1,updatePositionStrategy:h="optimized",onPlaced:v,...m}=e,y=DA(Mw,r),[x,b]=O.useState(null),w=ca(t,Ue=>b(Ue)),[S,L]=O.useState(null),j=MX(S),N=(j==null?void 0:j.width)??0,E=(j==null?void 0:j.height)??0,P=n+(i!=="center"?"-"+i:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},F=Array.isArray(c)?c:[c],T=F.length>0,H={padding:M,boundary:F.filter(HX),altBoundary:T},{refs:W,floatingStyles:Q,placement:V,isPositioned:z,middlewareData:X}=AX({strategy:"fixed",placement:P,whileElementsMounted:(...Ue)=>yX(...Ue,{animationFrame:h==="always"}),elements:{reference:y.anchor},middleware:[TX({mainAxis:a+E,alignmentAxis:s}),l&&PX({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?FX():void 0,...H}),l&&LX({...H}),jX({...H,apply:({elements:Ue,rects:Ye,availableWidth:Ce,availableHeight:oe})=>{const{width:De,height:Qe}=Ye.reference,Be=Ue.floating.style;Be.setProperty("--radix-popper-available-width",`${Ce}px`),Be.setProperty("--radix-popper-available-height",`${oe}px`),Be.setProperty("--radix-popper-anchor-width",`${De}px`),Be.setProperty("--radix-popper-anchor-height",`${Qe}px`)}}),S&&DX({element:S,padding:o}),$X({arrowWidth:N,arrowHeight:E}),d&&IX({strategy:"referenceHidden",...H})]}),[D,ne]=WA(V),ge=yo(v);Cl(()=>{z&&(ge==null||ge())},[z,ge]);const C=(ue=X.arrow)==null?void 0:ue.x,R=(pe=X.arrow)==null?void 0:pe.y,B=((he=X.arrow)==null?void 0:he.centerOffset)!==0,[U,Y]=O.useState();return Cl(()=>{x&&Y(window.getComputedStyle(x).zIndex)},[x]),p.jsx("div",{ref:W.setFloating,"data-radix-popper-content-wrapper":"",style:{...Q,transform:z?Q.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:U,"--radix-popper-transform-origin":[(ye=X.transformOrigin)==null?void 0:ye.x,(Pe=X.transformOrigin)==null?void 0:Pe.y].join(" "),...((re=X.hide)==null?void 0:re.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:p.jsx(UX,{scope:r,placedSide:D,onArrowChange:L,arrowX:C,arrowY:R,shouldHideArrow:B,children:p.jsx($n.div,{"data-side":D,"data-align":ne,...m,ref:w,style:{...m.style,animation:z?void 0:"none"}})})})});BA.displayName=Mw;var UA="PopperArrow",WX={top:"bottom",right:"left",bottom:"top",left:"right"},zA=O.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,i=zX(UA,n),s=WX[i.placedSide];return p.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:p.jsx(RX,{...a,ref:r,style:{...a.style,display:"block"}})})});zA.displayName=UA;function HX(e){return e!==null}var $X=e=>({name:"transformOrigin",options:e,fn(t){var y,x,b;const{placement:r,rects:n,middlewareData:a}=t,s=((y=a.arrow)==null?void 0:y.centerOffset)!==0,o=s?0:e.arrowWidth,l=s?0:e.arrowHeight,[c,u]=WA(r),f={start:"0%",center:"50%",end:"100%"}[u],d=(((x=a.arrow)==null?void 0:x.x)??0)+o/2,h=(((b=a.arrow)==null?void 0:b.y)??0)+l/2;let v="",m="";return c==="bottom"?(v=s?f:`${d}px`,m=`${-l}px`):c==="top"?(v=s?f:`${d}px`,m=`${n.floating.height+l}px`):c==="right"?(v=`${-l}px`,m=s?f:`${h}px`):c==="left"&&(v=`${n.floating.width+l}px`,m=s?f:`${h}px`),{data:{x:v,y:m}}}});function WA(e){const[t,r="center"]=e.split("-");return[t,r]}var HA=OA,Bw=MA,$A=BA,VA=zA,VX="Portal",Uw=O.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[a,i]=O.useState(!1);Cl(()=>i(!0),[]);const s=r||a&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return s?o7.createPortal(p.jsx($n.div,{...n,ref:t}),s):null});Uw.displayName=VX;function qX(e,t){return O.useReducer((r,n)=>t[r][n]??r,e)}var qc=e=>{const{present:t,children:r}=e,n=GX(t),a=typeof r=="function"?r({present:n.isPresent}):O.Children.only(r),i=ca(n.ref,XX(a));return typeof r=="function"||n.isPresent?O.cloneElement(a,{ref:i}):null};qc.displayName="Presence";function GX(e){const[t,r]=O.useState(),n=O.useRef(null),a=O.useRef(e),i=O.useRef("none"),s=e?"mounted":"unmounted",[o,l]=qX(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return O.useEffect(()=>{const c=U1(n.current);i.current=o==="mounted"?c:"none"},[o]),Cl(()=>{const c=n.current,u=a.current;if(u!==e){const d=i.current,h=U1(c);e?l("MOUNT"):h==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&d!==h?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,l]),Cl(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,f=h=>{const m=U1(n.current).includes(h.animationName);if(h.target===t&&m&&(l("ANIMATION_END"),!a.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},d=h=>{h.target===t&&(i.current=U1(n.current))};return t.addEventListener("animationstart",d),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",d),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:O.useCallback(c=>{n.current=c?getComputedStyle(c):null,r(c)},[])}}function U1(e){return(e==null?void 0:e.animationName)||"none"}function XX(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var KX=R2[" useInsertionEffect ".trim().toString()]||Cl;function zw({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,i,s]=YX({defaultProp:t,onChange:r}),o=e!==void 0,l=o?e:a;{const u=O.useRef(e!==void 0);O.useEffect(()=>{const f=u.current;f!==o&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,n])}const c=O.useCallback(u=>{var f;if(o){const d=JX(u)?u(e):u;d!==e&&((f=s.current)==null||f.call(s,d))}else i(u)},[o,e,i,s]);return[l,c]}function YX({defaultProp:e,onChange:t}){const[r,n]=O.useState(e),a=O.useRef(r),i=O.useRef(t);return KX(()=>{i.current=t},[t]),O.useEffect(()=>{var s;a.current!==r&&((s=i.current)==null||s.call(i,r),a.current=r)},[r,a]),[r,n,i]}function JX(e){return typeof e=="function"}var ZX=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Nu=new WeakMap,z1=new WeakMap,W1={},$v=0,qA=function(e){return e&&(e.host||qA(e.parentNode))},QX=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=qA(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},eK=function(e,t,r,n){var a=QX(t,Array.isArray(e)?e:[e]);W1[r]||(W1[r]=new WeakMap);var i=W1[r],s=[],o=new Set,l=new Set(a),c=function(f){!f||o.has(f)||(o.add(f),c(f.parentNode))};a.forEach(c);var u=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(d){if(o.has(d))u(d);else try{var h=d.getAttribute(n),v=h!==null&&h!=="false",m=(Nu.get(d)||0)+1,y=(i.get(d)||0)+1;Nu.set(d,m),i.set(d,y),s.push(d),m===1&&v&&z1.set(d,!0),y===1&&d.setAttribute(r,"true"),v||d.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",d,x)}})};return u(t),o.clear(),$v++,function(){s.forEach(function(f){var d=Nu.get(f)-1,h=i.get(f)-1;Nu.set(f,d),i.set(f,h),d||(z1.has(f)||f.removeAttribute(n),z1.delete(f)),h||f.removeAttribute(r)}),$v--,$v||(Nu=new WeakMap,Nu=new WeakMap,z1=new WeakMap,W1={})}},GA=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=t||ZX(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),eK(n,a,r,"aria-hidden")):function(){return null}},al=function(){return al=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},al.apply(this,arguments)};function tK(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function rK(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var ap="right-scroll-bar-position",ip="width-before-scroll-bar",nK="with-scroll-bars-hidden",aK="--removed-body-scroll-bar-size";function Vv(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function iK(e,t){var r=O.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var sK=typeof window<"u"?O.useLayoutEffect:O.useEffect,ck=new WeakMap;function oK(e,t){var r=iK(t||null,function(n){return e.forEach(function(a){return Vv(a,n)})});return sK(function(){var n=ck.get(r);if(n){var a=new Set(n),i=new Set(e),s=r.current;a.forEach(function(o){i.has(o)||Vv(o,null)}),i.forEach(function(o){a.has(o)||Vv(o,s)})}ck.set(r,e)},[e]),r}var Zp=function(){return Zp=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Zp.apply(this,arguments)};function lK(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function cK(e){return e}function uK(e,t){t===void 0&&(t=cK);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var s=t(i,n);return r.push(s),function(){r=r.filter(function(o){return o!==s})}},assignSyncMedium:function(i){for(n=!0;r.length;){var s=r;r=[],s.forEach(i)}r={push:function(o){return i(o)},filter:function(){return r}}},assignMedium:function(i){n=!0;var s=[];if(r.length){var o=r;r=[],o.forEach(i),s=r}var l=function(){var u=s;s=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){s.push(u),c()},filter:function(u){return s=s.filter(u),r}}}};return a}function fK(e){e===void 0&&(e={});var t=uK(null);return t.options=Zp({async:!0,ssr:!1},e),t}var XA=function(e){var t=e.sideCar,r=lK(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return O.createElement(n,Zp({},r))};XA.isSideCarExport=!0;function dK(e,t){return e.useMedium(t),XA}var KA=fK(),qv=function(){},$g=O.forwardRef(function(e,t){var r=O.useRef(null),n=O.useState({onScrollCapture:qv,onWheelCapture:qv,onTouchMoveCapture:qv}),a=n[0],i=n[1],s=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,f=e.shards,d=e.sideCar,h=e.noRelative,v=e.noIsolation,m=e.inert,y=e.allowPinchZoom,x=e.as,b=x===void 0?"div":x,w=e.gapMode,S=tK(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),L=d,j=oK([r,t]),N=al(al({},S),a);return O.createElement(O.Fragment,null,u&&O.createElement(L,{sideCar:KA,removeScrollBar:c,shards:f,noRelative:h,noIsolation:v,inert:m,setCallbacks:i,allowPinchZoom:!!y,lockRef:r,gapMode:w}),s?O.cloneElement(O.Children.only(o),al(al({},N),{ref:j})):O.createElement(b,al({},N,{className:l,ref:j}),o))});$g.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};$g.classNames={fullWidth:ip,zeroRight:ap};var uk,hK=function(){if(uk)return uk;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function pK(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=hK();return t&&e.setAttribute("nonce",t),e}function gK(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function mK(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var vK=function(){var e=0,t=null;return{add:function(r){e==0&&(t=pK())&&(gK(t,r),mK(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},xK=function(){var e=vK();return function(t,r){O.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},YA=function(){var e=xK(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},yK={left:0,top:0,right:0,gap:0},Gv=function(e){return parseInt(e||"",10)||0},wK=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[Gv(r),Gv(n),Gv(a)]},bK=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return yK;var t=wK(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},_K=YA(),o0="data-scroll-locked",kK=function(e,t,r,n){var a=e.left,i=e.top,s=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(nK,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(o0,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ap,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(ip,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(ap," .").concat(ap,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(ip," .").concat(ip,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(o0,`] {
    `).concat(aK,": ").concat(o,`px;
  }
`)},fk=function(){var e=parseInt(document.body.getAttribute(o0)||"0",10);return isFinite(e)?e:0},SK=function(){O.useEffect(function(){return document.body.setAttribute(o0,(fk()+1).toString()),function(){var e=fk()-1;e<=0?document.body.removeAttribute(o0):document.body.setAttribute(o0,e.toString())}},[])},EK=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;SK();var i=O.useMemo(function(){return bK(a)},[a]);return O.createElement(_K,{styles:kK(i,!t,a,r?"":"!important")})},P2=!1;if(typeof window<"u")try{var H1=Object.defineProperty({},"passive",{get:function(){return P2=!0,!0}});window.addEventListener("test",H1,H1),window.removeEventListener("test",H1,H1)}catch{P2=!1}var Au=P2?{passive:!1}:!1,NK=function(e){return e.tagName==="TEXTAREA"},JA=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!NK(e)&&r[t]==="visible")},AK=function(e){return JA(e,"overflowY")},CK=function(e){return JA(e,"overflowX")},dk=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=ZA(e,n);if(a){var i=QA(e,n),s=i[1],o=i[2];if(s>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},TK=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},PK=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},ZA=function(e,t){return e==="v"?AK(t):CK(t)},QA=function(e,t){return e==="v"?TK(t):PK(t)},FK=function(e,t){return e==="h"&&t==="rtl"?-1:1},LK=function(e,t,r,n,a){var i=FK(e,window.getComputedStyle(t).direction),s=i*n,o=r.target,l=t.contains(o),c=!1,u=s>0,f=0,d=0;do{var h=QA(e,o),v=h[0],m=h[1],y=h[2],x=m-y-i*v;(v||x)&&ZA(e,o)&&(f+=x,d+=v),o=o.parentNode.host||o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&(a&&Math.abs(f)<1||!a&&s>f)||!u&&(a&&Math.abs(d)<1||!a&&-s>d))&&(c=!0),c},$1=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},hk=function(e){return[e.deltaX,e.deltaY]},pk=function(e){return e&&"current"in e?e.current:e},jK=function(e,t){return e[0]===t[0]&&e[1]===t[1]},IK=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},DK=0,Cu=[];function OK(e){var t=O.useRef([]),r=O.useRef([0,0]),n=O.useRef(),a=O.useState(DK++)[0],i=O.useState(YA)[0],s=O.useRef(e);O.useEffect(function(){s.current=e},[e]),O.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=rK([e.lockRef.current],(e.shards||[]).map(pk),!0).filter(Boolean);return m.forEach(function(y){return y.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=O.useCallback(function(m,y){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!s.current.allowPinchZoom;var x=$1(m),b=r.current,w="deltaX"in m?m.deltaX:b[0]-x[0],S="deltaY"in m?m.deltaY:b[1]-x[1],L,j=m.target,N=Math.abs(w)>Math.abs(S)?"h":"v";if("touches"in m&&N==="h"&&j.type==="range")return!1;var E=dk(N,j);if(!E)return!0;if(E?L=N:(L=N==="v"?"h":"v",E=dk(N,j)),!E)return!1;if(!n.current&&"changedTouches"in m&&(w||S)&&(n.current=L),!L)return!0;var P=n.current||L;return LK(P,y,m,P==="h"?w:S,!0)},[]),l=O.useCallback(function(m){var y=m;if(!(!Cu.length||Cu[Cu.length-1]!==i)){var x="deltaY"in y?hk(y):$1(y),b=t.current.filter(function(L){return L.name===y.type&&(L.target===y.target||y.target===L.shadowParent)&&jK(L.delta,x)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(s.current.shards||[]).map(pk).filter(Boolean).filter(function(L){return L.contains(y.target)}),S=w.length>0?o(y,w[0]):!s.current.noIsolation;S&&y.cancelable&&y.preventDefault()}}},[]),c=O.useCallback(function(m,y,x,b){var w={name:m,delta:y,target:x,should:b,shadowParent:RK(x)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(S){return S!==w})},1)},[]),u=O.useCallback(function(m){r.current=$1(m),n.current=void 0},[]),f=O.useCallback(function(m){c(m.type,hk(m),m.target,o(m,e.lockRef.current))},[]),d=O.useCallback(function(m){c(m.type,$1(m),m.target,o(m,e.lockRef.current))},[]);O.useEffect(function(){return Cu.push(i),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:d}),document.addEventListener("wheel",l,Au),document.addEventListener("touchmove",l,Au),document.addEventListener("touchstart",u,Au),function(){Cu=Cu.filter(function(m){return m!==i}),document.removeEventListener("wheel",l,Au),document.removeEventListener("touchmove",l,Au),document.removeEventListener("touchstart",u,Au)}},[]);var h=e.removeScrollBar,v=e.inert;return O.createElement(O.Fragment,null,v?O.createElement(i,{styles:IK(a)}):null,h?O.createElement(EK,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function RK(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const MK=dK(KA,OK);var eC=O.forwardRef(function(e,t){return O.createElement($g,al({},e,{ref:t,sideCar:MK}))});eC.classNames=$g.classNames;const tC=eC;var Vg="Popover",[rC,dZ]=j0(Vg,[Hg]),dh=Hg(),[BK,zl]=rC(Vg),nC=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:s=!1}=e,o=dh(t),l=O.useRef(null),[c,u]=O.useState(!1),[f,d]=zw({prop:n,defaultProp:a??!1,onChange:i,caller:Vg});return p.jsx(HA,{...o,children:p.jsx(BK,{scope:t,contentId:Gp(),triggerRef:l,open:f,onOpenChange:d,onOpenToggle:O.useCallback(()=>d(h=>!h),[d]),hasCustomAnchor:c,onCustomAnchorAdd:O.useCallback(()=>u(!0),[]),onCustomAnchorRemove:O.useCallback(()=>u(!1),[]),modal:s,children:r})})};nC.displayName=Vg;var aC="PopoverAnchor",UK=O.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=zl(aC,r),i=dh(r),{onCustomAnchorAdd:s,onCustomAnchorRemove:o}=a;return O.useEffect(()=>(s(),()=>o()),[s,o]),p.jsx(Bw,{...i,...n,ref:t})});UK.displayName=aC;var iC="PopoverTrigger",sC=O.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=zl(iC,r),i=dh(r),s=ca(t,a.triggerRef),o=p.jsx($n.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":fC(a.open),...n,ref:s,onClick:Vt(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?o:p.jsx(Bw,{asChild:!0,...i,children:o})});sC.displayName=iC;var Ww="PopoverPortal",[zK,WK]=rC(Ww,{forceMount:void 0}),oC=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,i=zl(Ww,t);return p.jsx(zK,{scope:t,forceMount:r,children:p.jsx(qc,{present:r||i.open,children:p.jsx(Uw,{asChild:!0,container:a,children:n})})})};oC.displayName=Ww;var b0="PopoverContent",lC=O.forwardRef((e,t)=>{const r=WK(b0,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,i=zl(b0,e.__scopePopover);return p.jsx(qc,{present:n||i.open,children:i.modal?p.jsx($K,{...a,ref:t}):p.jsx(VK,{...a,ref:t})})});lC.displayName=b0;var HK=m0("PopoverContent.RemoveScroll"),$K=O.forwardRef((e,t)=>{const r=zl(b0,e.__scopePopover),n=O.useRef(null),a=ca(t,n),i=O.useRef(!1);return O.useEffect(()=>{const s=n.current;if(s)return GA(s)},[]),p.jsx(tC,{as:HK,allowPinchZoom:!0,children:p.jsx(cC,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Vt(e.onCloseAutoFocus,s=>{var o;s.preventDefault(),i.current||(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Vt(e.onPointerDownOutside,s=>{const o=s.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Vt(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),VK=O.forwardRef((e,t)=>{const r=zl(b0,e.__scopePopover),n=O.useRef(!1),a=O.useRef(!1);return p.jsx(cC,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var s,o;(s=e.onCloseAutoFocus)==null||s.call(e,i),i.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=i.target;((c=r.triggerRef.current)==null?void 0:c.contains(s))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),cC=O.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...f}=e,d=zl(b0,r),h=dh(r);return bA(),p.jsx(Tw,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:p.jsx(Cw,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>d.onOpenChange(!1),children:p.jsx($A,{"data-state":fC(d.open),role:"dialog",id:d.contentId,...h,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),uC="PopoverClose",qK=O.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=zl(uC,r);return p.jsx($n.button,{type:"button",...n,ref:t,onClick:Vt(e.onClick,()=>a.onOpenChange(!1))})});qK.displayName=uC;var GK="PopoverArrow",XK=O.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=dh(r);return p.jsx(VA,{...a,...n,ref:t})});XK.displayName=GK;function fC(e){return e?"open":"closed"}var KK=nC,YK=sC,JK=oC,ZK=lC;const Tu=({label:e,sortKey:t,filterKey:r,filterValue:n,filterType:a="text",onFilterChange:i,onSort:s,sortDirection:o,selectOptions:l})=>{const[c,u]=O.useState(!1),f=v=>{i(r,v)},d=()=>{s&&t&&s(t)},h=()=>{switch(a){case"date":return p.jsx("input",{type:"date",value:n,onChange:v=>f(v.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-800 dark:text-white"});case"number":return p.jsx("input",{type:"number",value:n,onChange:v=>f(v.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-800 dark:text-white",placeholder:`Filter by ${e.toLowerCase()}`});case"select":return p.jsxs("select",{value:n,onChange:v=>f(v.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-800 dark:text-white",children:[p.jsx("option",{value:"",children:"All"}),l==null?void 0:l.map(v=>p.jsx("option",{value:v.value,children:v.label},v.value))]});default:return p.jsx("input",{type:"text",value:n,onChange:v=>f(v.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-800 dark:text-white",placeholder:`Filter by ${e.toLowerCase()}`})}};return p.jsx("th",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 text-left",children:p.jsxs(KK,{open:c,onOpenChange:u,children:[p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsxs("button",{onClick:d,className:Ln("text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-300 transition-colors",o&&"text-blue-600 dark:text-blue-400"),children:[e,o&&p.jsx("span",{className:"ml-1",children:o==="asc"?"":""})]}),p.jsx(YK,{asChild:!0,children:p.jsx("button",{className:Ln("p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",n&&"text-blue-600 dark:text-blue-400",!n&&"text-gray-400 dark:text-gray-600"),children:p.jsx(qu,{className:"w-4 h-4"})})})]}),p.jsx(JK,{children:p.jsx(ZK,{className:"w-64 bg-white dark:bg-gray-900 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-4 z-50",align:"start",children:p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Filter by ",e]}),n&&p.jsx("button",{onClick:()=>f(""),className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:p.jsx(fa,{className:"w-4 h-4"})})]}),h()]})})})]})})},QK=({isOpen:e,onClose:t,onSuccess:r,onAlert:n})=>{const[a,i]=O.useState(null),[s,o]=O.useState(!1),[l,c]=O.useState(null),[u,f]=O.useState([]),d={date:["date","Date"],amount:["amount","Amount"],account_number:["account_number","Account Number"],bank_name:["bank_name","Bank Name"],description:["description","Description"],credit_debit:["credit_debit_indicator","Credit/Debit"]},h=(x,b)=>{for(const w of b)if(x[w]!==void 0)return x[w];return null},v=x=>{const b=[];return Object.values(d).forEach(w=>{w.some(L=>x.includes(L))||b.push(w.join(" or "))}),b},m=async x=>{var w;const b=(w=x.target.files)==null?void 0:w[0];if(b)try{c(null),i(b);const S=await b.arrayBuffer(),L=Vp(S),j=L.Sheets[L.SheetNames[0]],N=sd.sheet_to_json(j);if(N.length===0)throw new Error("The file appears to be empty. Please check the file contents.");const E=Object.keys(N[0]||{}),P=v(E);if(P.length>0)throw new Error(`Missing required columns: ${P.join(", ")}

Found columns: ${E.join(", ")}

Please ensure your file has all the required columns.`);f(N.slice(0,5))}catch(S){console.error("Error reading file:",S),c(S instanceof Error?S.message:"Failed to read file"),i(null),f([])}},y=async()=>{if(a)try{o(!0),c(null);const x=await a.arrayBuffer(),b=Vp(x),w=b.Sheets[b.SheetNames[0]],S=sd.sheet_to_json(w),{data:{user:L}}=await He.auth.getUser();if(!L)throw new Error("User not authenticated");const j=S.map(E=>({date:new Date(h(E,d.date)).toISOString().split("T")[0],amount:Math.abs(Number(h(E,d.amount))),account_number:Number(h(E,d.account_number)),bank_name:h(E,d.bank_name),description:h(E,d.description),credit_debit_indicator:h(E,d.credit_debit).toLowerCase()==="credit"?"credit":"debit",user_id:L.id})),{error:N}=await He.from("bank_transactions").insert(j);if(N)throw N;r(),n==null||n("Bank transactions uploaded successfully","success"),t()}catch(x){console.error("Error uploading transactions:",x),c(x instanceof Error?x.message:"Failed to upload transactions")}finally{o(!1)}};return e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-2xl",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Upload Bank Transactions"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"p-6",children:[l&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400 whitespace-pre-line",children:l}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload CSV or Excel File"}),p.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-lg",children:p.jsxs("div",{className:"space-y-1 text-center",children:[p.jsx(SE,{className:"mx-auto h-12 w-12 text-gray-400"}),p.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[p.jsxs("label",{className:"relative cursor-pointer rounded-md font-medium text-blue-600 dark:text-blue-400 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[p.jsx("span",{children:"Upload a file"}),p.jsx("input",{type:"file",className:"sr-only",accept:".csv,.xlsx,.xls",onChange:m})]}),p.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),p.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"CSV or Excel files only"}),p.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Required columns: Date, Amount, Account Number, Bank Name, Description, Credit/Debit"})]})})]}),u.length>0&&p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Preview (first 5 rows)"}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[p.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:p.jsx("tr",{children:Object.keys(u[0]).map(x=>p.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:x},x))})}),p.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:u.map((x,b)=>p.jsx("tr",{children:Object.values(x).map((w,S)=>p.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300",children:w==null?void 0:w.toString()},S))},b))})]})})]}),p.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[p.jsx(pt,{variant:"outline",onClick:t,disabled:s,children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"bg-black hover:bg-black/90 text-white",onClick:y,disabled:!a||s,icon:p.jsx(Oy,{className:"w-4 h-4"}),children:s?"Uploading...":"Upload"})]})]})]})}):null},eY=({isOpen:e,onClose:t,transaction:r})=>!e||!r?null:p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Transaction Details"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:new Date(r.date).toLocaleDateString()})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bank Name"}),p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:r.bank_name})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:r.description})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount"}),p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(r.amount)})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Account Number"}),p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:r.account_number})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type"}),p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:r.credit_debit_indicator==="credit"?"Credit":"Debit"})]})]}),p.jsx("div",{className:"mt-6 flex justify-end",children:p.jsx(pt,{variant:"outline",onClick:t,children:"Close"})})]})]})}),tY=({isOpen:e,onClose:t,onSave:r})=>{const[n,a]=O.useState({date:new Date().toISOString().split("T")[0],bank_name:"",description:"",amount:"",account_number:"",credit_debit_indicator:"credit"}),[i,s]=O.useState(!1),[o,l]=O.useState(null),c=async u=>{u.preventDefault();try{s(!0),l(null);const{data:{user:f}}=await He.auth.getUser();if(!f)throw new Error("User not authenticated");const{error:d}=await He.from("bank_transactions").insert([{...n,amount:parseFloat(n.amount),account_number:parseInt(n.account_number),user_id:f.id}]);if(d)throw d;r(),t()}catch(f){console.error("Error adding transaction:",f),l(f instanceof Error?f.message:"Failed to add transaction")}finally{s(!1)}};return e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add Transaction"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("form",{onSubmit:c,className:"p-6",children:[o&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:o}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date *"}),p.jsx("input",{type:"date",value:n.date,onChange:u=>a({...n,date:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bank Name *"}),p.jsx("input",{type:"text",value:n.bank_name,onChange:u=>a({...n,bank_name:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description *"}),p.jsx("input",{type:"text",value:n.description,onChange:u=>a({...n,description:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount *"}),p.jsx("input",{type:"number",step:"0.01",min:"0",value:n.amount,onChange:u=>a({...n,amount:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Account Number *"}),p.jsx("input",{type:"number",value:n.account_number,onChange:u=>a({...n,account_number:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Type *"}),p.jsxs("select",{value:n.credit_debit_indicator,onChange:u=>a({...n,credit_debit_indicator:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0,children:[p.jsx("option",{value:"credit",children:"Credit"}),p.jsx("option",{value:"debit",children:"Debit"})]})]})]}),p.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[p.jsx(pt,{variant:"outline",onClick:t,disabled:i,children:"Cancel"}),p.jsx(pt,{type:"submit",variant:"primary",className:"bg-black hover:bg-black/90 text-white",disabled:i,children:i?"Adding...":"Add Transaction"})]})]})]})}):null},rY=({onAlert:e})=>{const[t,r]=O.useState([]),[n,a]=O.useState(!0),[i,s]=O.useState(0),[o,l]=O.useState(1),[c]=O.useState(100),[u,f]=O.useState(null),[d,h]=O.useState(!1),[v,m]=O.useState(!1),[y,x]=O.useState(!1),[b,w]=O.useState(null),[S,L]=O.useState(!1),[j,N]=O.useState(!1),[E,P]=O.useState({dateFrom:"",bankName:"",description:"",amountMin:"",accountNumber:"",type:""}),M=async()=>{try{a(!0),f(null);let V=He.from("bank_transactions").select("*",{count:"exact",head:!0});E.dateFrom&&(V=V.gte("date",E.dateFrom)),E.bankName&&(V=V.ilike("bank_name",`%${E.bankName}%`)),E.description&&(V=V.ilike("description",`%${E.description}%`)),E.amountMin&&(V=V.gte("amount",parseFloat(E.amountMin))),E.accountNumber&&(V=V.eq("account_number",E.accountNumber)),E.type&&(V=V.eq("credit_debit_indicator",E.type));const{count:z,error:X}=await V;if(X)throw X;s(z||0);let D=He.from("bank_transactions").select("*");E.dateFrom&&(D=D.gte("date",E.dateFrom)),E.bankName&&(D=D.ilike("bank_name",`%${E.bankName}%`)),E.description&&(D=D.ilike("description",`%${E.description}%`)),E.amountMin&&(D=D.gte("amount",parseFloat(E.amountMin))),E.accountNumber&&(D=D.eq("account_number",E.accountNumber)),E.type&&(D=D.eq("credit_debit_indicator",E.type)),D=D.order("date",{ascending:!1}).range((o-1)*c,o*c-1);const{data:ne,error:ge}=await D;if(ge)throw ge;r(ne||[])}catch(V){console.error("Error fetching transactions:",V),f(V instanceof Error?V.message:"Failed to fetch transactions")}finally{a(!1)}},F=(V,z)=>{P(X=>({...X,[V]:z}))},T=V=>{w(V),setShowEditModal(!0)},H=async()=>{var V;if(b!=null&&b.id)try{N(!0),f(null);const{data:z,error:X}=await He.from("bank_transactions").delete().eq("id",b.id).eq("user_id",(V=(await He.auth.getUser()).data.user)==null?void 0:V.id);if(X)throw X;L(!1),e==null||e("Transaction deleted successfully","success"),await M(),w(null)}catch(z){console.error("Error deleting transaction:",z),f(z instanceof Error?z.message:"Failed to delete transaction"),L(!1)}finally{N(!1)}};O.useEffect(()=>{M()},[E,o,c]);const W=Math.ceil(i/c),Q=V=>{l(V)};return p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Bank Transactions"}),p.jsx("button",{onClick:M,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",disabled:n,title:"Refresh",children:p.jsx(ko,{className:`w-5 h-5 ${n?"animate-spin":""}`})}),p.jsx("button",{onClick:()=>x(!0),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",title:"Add transaction",children:p.jsx(iI,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",t.length," of ",i," transactions"]}),p.jsx(pt,{variant:"default",className:"bg-black hover:bg-black/90 text-white",icon:p.jsx(Oy,{className:"w-4 h-4"}),onClick:()=>h(!0),children:"Upload Transactions"})]})]}),u&&p.jsx("div",{className:"bg-red-50 border border-red-200 rounded p-4 mb-6 text-red-700",children:u}),p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:[p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(Tu,{label:"Date",filterKey:"dateFrom",filterValue:E.dateFrom,filterType:"date",onFilterChange:F}),p.jsx(Tu,{label:"Bank Name",filterKey:"bankName",filterValue:E.bankName,onFilterChange:F}),p.jsx(Tu,{label:"Description",filterKey:"description",filterValue:E.description,onFilterChange:F}),p.jsx(Tu,{label:"Amount",filterKey:"amountMin",filterValue:E.amountMin,filterType:"number",onFilterChange:F}),p.jsx(Tu,{label:"Account Number",filterKey:"accountNumber",filterValue:E.accountNumber,onFilterChange:F}),p.jsx(Tu,{label:"Type",filterKey:"type",filterValue:E.type,filterType:"select",selectOptions:[{value:"credit",label:"Credit"},{value:"debit",label:"Debit"}],onFilterChange:F}),p.jsx("th",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 text-left",children:p.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})})]})}),p.jsx(Os,{children:t.map(V=>p.jsxs(br,{children:[p.jsx(ct,{children:new Date(V.date).toLocaleDateString()}),p.jsx(ct,{children:V.bank_name}),p.jsx(ct,{children:V.description}),p.jsx(ct,{children:p.jsx("span",{className:V.credit_debit_indicator==="credit"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(V.amount)})}),p.jsx(ct,{children:V.account_number}),p.jsx(ct,{children:p.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${V.credit_debit_indicator==="credit"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"}`,children:V.credit_debit_indicator})}),p.jsx(ct,{children:p.jsxs("div",{className:"flex space-x-2",children:[p.jsx("button",{onClick:()=>T(V),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"Edit transaction",children:p.jsx(Ol,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>{w(V),L(!0)},className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 transition-colors",title:"Delete transaction",children:p.jsx(Mc,{className:"w-4 h-4"})})]})})]},V.id))})]}),p.jsx("div",{className:"px-4 py-3 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:["Page ",o," of ",W]}),p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx(pt,{variant:"outline",onClick:()=>Q(1),disabled:o===1,className:"px-3 py-1 text-sm",children:"First"}),p.jsx(pt,{variant:"outline",onClick:()=>Q(o-1),disabled:o===1,className:"px-3 py-1 text-sm",children:"Previous"}),p.jsxs("span",{className:"px-3 py-1 text-sm text-gray-600 dark:text-gray-300",children:[o," / ",W]}),p.jsx(pt,{variant:"outline",onClick:()=>Q(o+1),disabled:o===W,className:"px-3 py-1 text-sm",children:"Next"}),p.jsx(pt,{variant:"outline",onClick:()=>Q(W),disabled:o===W,className:"px-3 py-1 text-sm",children:"Last"})]})]})})]}),p.jsx(QK,{isOpen:d,onClose:()=>h(!1),onAlert:e,onSuccess:M}),p.jsx(tY,{isOpen:y,onClose:()=>x(!1),onAlert:e,onSave:M}),p.jsx(eY,{isOpen:v,onClose:()=>{m(!1),w(null)},transaction:b}),S&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirm Deletion"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Are you sure you want to delete this transaction? This action cannot be undone."}),p.jsxs("div",{className:"flex justify-end space-x-3",children:[p.jsx(pt,{variant:"outline",onClick:()=>{L(!1),w(null)},disabled:j,children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"!bg-red-500 hover:!bg-red-600",onClick:H,disabled:j,children:j?"Deleting...":"Delete"})]})]})})]})},nY=[{value:"USD",label:"US Dollar (USD)"},{value:"CAD",label:"Canadian Dollar (CAD)"},{value:"GBP",label:"British Pound (GBP)"},{value:"EUR",label:"Euro (EUR)"}],aY=[{value:"Cash",label:"Cash Basis"},{value:"Accrual",label:"Accrual Basis"}],iY=[{value:"US/Eastern",label:"US Eastern Time"},{value:"US/Central",label:"US Central Time"},{value:"US/Mountain",label:"US Mountain Time"},{value:"US/Pacific",label:"US Pacific Time"},{value:"Canada/Eastern",label:"Canada Eastern Time"},{value:"Canada/Central",label:"Canada Central Time"},{value:"Europe/London",label:"Europe/London"},{value:"Europe/Paris",label:"Europe/Paris"}],gk={id:null,base_currency:"USD",company_legal_name:"",accounting_method:"Accrual",time_zone:"US/Eastern",sales_revenue_account:null,purchases_account:null,discounts_account:null,accounts_receivable_account:null,accounts_payable_account:null,taxes_payable_account:null,retained_earnings_account:null,bank_name:"",branch_name:"",account_number:"",is_default_bank:!1},mk=3,sY=1e3,oY=()=>{var w,S,L,j,N,E;const e=Il(),[t,r]=O.useState(gk),[n,a]=O.useState([]),[i,s]=O.useState(!0),[o,l]=O.useState(!1),[c,u]=O.useState(null),[f,d]=O.useState(null),[h,v]=O.useState({Revenue:[],Expense:[],Asset:[],Liability:[],Equity:[]});O.useEffect(()=>{(async()=>{const{data:{session:M}}=await He.auth.getSession();M||e("/auth")})()},[e]);const m=async(P=0)=>{try{u(null);const{data:{session:M}}=await He.auth.getSession();if(!M)throw new Error("Please sign in to access settings");const{data:F,error:T}=await He.from("Account").select("id, account_name, account_type").order("account_name");if(T)throw T;if(F){a(F);const V=F.reduce((z,X)=>(z[X.account_type]||(z[X.account_type]=[]),z[X.account_type].push(X),z),{});v(V)}const{data:{user:H}}=await He.auth.getUser();if(!H)throw new Error("No authenticated user");const{data:W,error:Q}=await He.from("accounting_settings").select("*").eq("user_id",H.id).maybeSingle();if(Q)throw Q;r(W||{...gk})}catch(M){if(console.error("Error fetching data:",M),P<mk&&M instanceof Error&&M.message.includes("fetch"))return console.log(`Retrying fetch attempt ${P+1} of ${mk}...`),await new Promise(F=>setTimeout(F,sY)),m(P+1);if(M instanceof Error&&(M.message.includes("auth")||M.message.includes("sign in")||M.message.includes("authenticated"))){e("/auth");return}u(M instanceof Error?M.message:"Failed to fetch data")}finally{s(!1)}};O.useEffect(()=>{m()},[e]);const y=()=>{const P=[],M={sales_revenue_account:"Sales Revenue Account",purchases_account:"Purchases Account",accounts_receivable_account:"Accounts Receivable Account",accounts_payable_account:"Accounts Payable Account",taxes_payable_account:"Taxes Payable Account",retained_earnings_account:"Retained Earnings Account"};for(const[F,T]of Object.entries(M))t[F]?n.some(H=>H.id===t[F])||P.push(`Selected ${T} is invalid or no longer exists`):P.push(`${T} is required`);if(P.length>0)throw new Error(P.join(`
`));return!0},x=async P=>{P.preventDefault();try{l(!0),u(null),d(null);const{data:{session:M}}=await He.auth.getSession();if(!M){e("/auth");return}y();const{data:{user:F}}=await He.auth.getUser();if(!F)throw new Error("No authenticated user");const T={...t,user_id:F.id,sales_revenue_account:t.sales_revenue_account||null,purchases_account:t.purchases_account||null,discounts_account:t.discounts_account||null,accounts_receivable_account:t.accounts_receivable_account||null,accounts_payable_account:t.accounts_payable_account||null,taxes_payable_account:t.taxes_payable_account||null,retained_earnings_account:t.retained_earnings_account||null};T.id||delete T.id;let H;if(t.id){const{data:W,error:Q}=await He.from("accounting_settings").update(T).eq("id",t.id).select().single();if(Q)throw Q;H=W}else{const{data:W,error:Q}=await He.from("accounting_settings").insert([T]).select().single();if(Q)throw Q;H=W}r(H),d("Settings saved successfully")}catch(M){if(console.error("Error saving settings:",M),M instanceof Error&&(M.message.includes("auth")||M.message.includes("sign in")||M.message.includes("authenticated"))){e("/auth");return}u(M instanceof Error?M.message:"Failed to save settings")}finally{l(!1)}},b=(P,M)=>{r(F=>({...F,[P]:M===""?null:Number(M)}))};return i?p.jsx("div",{className:"p-6 flex justify-center",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p.jsxs("div",{className:"p-6",children:[p.jsx("div",{className:"flex items-center justify-between mb-6",children:p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Settings"})}),c&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:c}),f&&p.jsx("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/50 border border-green-200 dark:border-green-700 rounded-lg text-green-700 dark:text-green-400",children:f}),p.jsxs("form",{onSubmit:x,className:"space-y-6",children:[p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[p.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:p.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"General Accounting Settings"})}),p.jsxs("div",{className:"p-4 space-y-4",children:[p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company Legal Name"}),p.jsx("input",{type:"text",value:t.company_legal_name,onChange:P=>r({...t,company_legal_name:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",placeholder:"Enter name"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Base Currency"}),p.jsx("select",{value:t.base_currency,onChange:P=>r({...t,base_currency:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:nY.map(P=>p.jsx("option",{value:P.value,children:P.label},P.value))})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Time Zone"}),p.jsx("select",{value:t.time_zone,onChange:P=>r({...t,time_zone:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:iY.map(P=>p.jsx("option",{value:P.value,children:P.label},P.value))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Accounting Method"}),p.jsx("select",{value:t.accounting_method,onChange:P=>r({...t,accounting_method:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:aY.map(P=>p.jsx("option",{value:P.value,children:P.label},P.value))})]})]})]})]}),p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[p.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:p.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Chart of Accounts"})}),p.jsxs("div",{className:"p-4 space-y-4",children:[p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sales Revenue Account *"}),p.jsxs("select",{value:t.sales_revenue_account||"",onChange:P=>b("sales_revenue_account",P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:[p.jsx("option",{value:"",children:"Select account"}),(w=h.Revenue)==null?void 0:w.map(P=>p.jsx("option",{value:P.id,children:P.account_name},P.id))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Purchases Account *"}),p.jsxs("select",{value:t.purchases_account||"",onChange:P=>b("purchases_account",P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:[p.jsx("option",{value:"",children:"Select account"}),(S=h.Expense)==null?void 0:S.map(P=>p.jsx("option",{value:P.id,children:P.account_name},P.id))]})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Accounts Receivable *"}),p.jsxs("select",{value:t.accounts_receivable_account||"",onChange:P=>b("accounts_receivable_account",P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:[p.jsx("option",{value:"",children:"Select account"}),(L=h.Asset)==null?void 0:L.map(P=>p.jsx("option",{value:P.id,children:P.account_name},P.id))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Accounts Payable *"}),p.jsxs("select",{value:t.accounts_payable_account||"",onChange:P=>b("accounts_payable_account",P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:[p.jsx("option",{value:"",children:"Select account"}),(j=h.Liability)==null?void 0:j.map(P=>p.jsx("option",{value:P.id,children:P.account_name},P.id))]})]})]})]})]}),p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[p.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:p.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Default Bank Account"})}),p.jsxs("div",{className:"p-4 space-y-4",children:[p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bank Name"}),p.jsx("input",{type:"text",value:t.bank_name,onChange:P=>r({...t,bank_name:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",placeholder:"Enter bank name"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Branch Name"}),p.jsx("input",{type:"text",value:t.branch_name,onChange:P=>r({...t,branch_name:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",placeholder:"Enter branch name"})]})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Account Number"}),p.jsx("input",{type:"text",value:t.account_number,onChange:P=>r({...t,account_number:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",placeholder:"Enter account number"})]}),p.jsx("div",{className:"flex items-center",children:p.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:t.is_default_bank,onChange:P=>r({...t,is_default_bank:P.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),p.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Default Bank Account"})]})})]})]})]}),p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[p.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:p.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Additional Accounts"})}),p.jsx("div",{className:"p-4 space-y-4",children:p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Taxes Payable *"}),p.jsxs("select",{value:t.taxes_payable_account||"",onChange:P=>b("taxes_payable_account",P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:[p.jsx("option",{value:"",children:"Select account"}),(N=h.Liability)==null?void 0:N.map(P=>p.jsx("option",{value:P.id,children:P.account_name},P.id))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Retained Earnings *"}),p.jsxs("select",{value:t.retained_earnings_account||"",onChange:P=>b("retained_earnings_account",P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",children:[p.jsx("option",{value:"",children:"Select account"}),(E=h.Equity)==null?void 0:E.map(P=>p.jsx("option",{value:P.id,children:P.account_name},P.id))]})]})]})})]})]}),p.jsx("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700",children:p.jsxs("div",{className:"flex justify-end space-x-3",children:[p.jsx(pt,{type:"button",variant:"outline",className:"w-24",onClick:()=>e("/dashboard"),disabled:o,children:"Cancel"}),p.jsx(pt,{type:"submit",variant:"primary",className:"w-32 bg-black hover:bg-black/90 text-white",icon:p.jsx(CE,{className:"w-4 h-4"}),disabled:o,children:o?"Saving...":"Save"})]})})]})]})},lY=({isOpen:e,onClose:t,item:r,onSave:n})=>{const[a,i]=O.useState({name:"",description:"",number:"",price:""}),[s,o]=O.useState({}),[l,c]=O.useState(!1);O.useEffect(()=>{var d,h;i(r?{name:r.Item_name||"",description:r.Item_desc||"",number:((d=r.item_num)==null?void 0:d.toString())||"",price:((h=r.Item_price)==null?void 0:h.toString())||""}:{name:"",description:"",number:"",price:""})},[r]);const u=async()=>{const d={};return a.name.trim()||(d.name="Item name is required"),a.description.trim()||(d.description="Description is required"),a.price.trim()?(isNaN(Number(a.price))||Number(a.price)<0)&&(d.price="Price must be a valid positive number"):d.price="Price is required",o(d),Object.keys(d).length===0},f=async d=>{d.preventDefault();try{if(c(!0),await u()){const v={Item_name:a.name.trim(),Item_desc:a.description.trim(),item_num:a.number?Number(a.number):null,Item_price:a.price.trim()?Number(a.price.trim()):null},{error:m}=r?await He.from("PurchaseItems").update(v).eq("id",r.id):await He.from("PurchaseItems").insert([v]);if(m)throw m;n(),t()}}catch(h){console.error("Error saving item:",h),o({...s,name:"Failed to save item. Please try again."})}finally{c(!1)}};return e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r?"Edit Purchase Item":"Add Purchase Item"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("form",{onSubmit:f,className:"p-6",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Item Name *"}),p.jsx("input",{type:"text",value:a.name,onChange:d=>i({...a,name:d.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.name?"border-red-500":"border-gray-300"}`}),s.name&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.name})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description *"}),p.jsx("textarea",{value:a.description,onChange:d=>i({...a,description:d.target.value}),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.description?"border-red-500":"border-gray-300"}`}),s.description&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.description})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Item Number"}),p.jsx("input",{type:"number",value:a.number,onChange:d=>i({...a,number:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white",placeholder:"Optional"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Price *"}),p.jsx("input",{type:"number",step:"0.01",min:"0",value:a.price,onChange:d=>i({...a,price:d.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.price?"border-red-500":"border-gray-300"}`}),s.price&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.price})]})]}),p.jsxs("div",{className:"mt-6 flex space-x-3",children:[p.jsx(pt,{type:"submit",variant:"primary",className:"flex-1",disabled:l,children:l?"Saving...":r?"Save Changes":"Save Item"}),p.jsx(pt,{type:"button",variant:"outline",className:"flex-1",onClick:t,disabled:l,children:"Cancel"})]})]})]})}):null},cY=()=>{const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,i]=O.useState([]),[s,o]=O.useState(null),[l,c]=O.useState(!1),[u,f]=O.useState(null),[d,h]=O.useState(!1),[v,m]=O.useState(!1),{sortedItems:y,sortConfig:x,requestSort:b}=Rl(e,{key:"Item_name",direction:"asc"}),w=async()=>{try{n(!0),o(null);const{data:E,error:P}=await He.from("PurchaseItems").select("*").order("Item_name");if(P)throw P;t(E||[])}catch(E){console.error("Error fetching items:",E),o(E instanceof Error?E.message:"Failed to fetch items")}finally{n(!1)}};O.useEffect(()=>{w()},[]);const S=E=>{i(P=>P.includes(E)?P.filter(M=>M!==E):[...P,E])},L=()=>{i(a.length===e.length?[]:e.map(E=>E.id))},j=E=>{f(E),c(!0)},N=async()=>{try{m(!0),o(null);const{error:E}=await He.from("PurchaseItems").delete().in("id",a);if(E)throw E;i([]),h(!1),await w()}catch(E){console.error("Error deleting items:",E),o(E instanceof Error?E.message:"Failed to delete items"),h(!1)}finally{m(!1)}};return p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Purchase Items"}),p.jsx("button",{onClick:w,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",disabled:r,children:p.jsx(ko,{className:`w-5 h-5 ${r?"animate-spin":""}`})}),a.length>0&&p.jsx("button",{onClick:()=>h(!0),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors",title:"Delete selected items",children:p.jsx(Mc,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[a.length," selected"]}),p.jsx(pt,{variant:"default",className:"bg-black hover:bg-black/90 text-white",icon:p.jsx(Rc,{className:"w-4 h-4"}),onClick:()=>{f(null),c(!0)},children:"Add Purchase Item"})]})]}),s&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:s}),p.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(vt,{className:"w-12",children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:a.length===e.length&&e.length>0,onChange:L})}),p.jsx(vt,{onClick:()=>b("Item_name"),className:"cursor-pointer hover:text-gray-900 dark:hover:text-gray-100",children:"Item Name"}),p.jsx(vt,{onClick:()=>b("Item_desc"),className:"cursor-pointer hover:text-gray-900 dark:hover:text-gray-100",children:"Description"}),p.jsx(vt,{onClick:()=>b("Item_price"),className:"cursor-pointer hover:text-gray-900 dark:hover:text-gray-100",children:"Price"}),p.jsx(vt,{onClick:()=>b("item_num"),className:"cursor-pointer hover:text-gray-900 dark:hover:text-gray-100",children:"Item Number"}),p.jsx(vt,{children:"Actions"})]})}),p.jsxs(Os,{children:[y.map(E=>p.jsxs(br,{className:`hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${a.includes(E.id)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[p.jsx(ct,{children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:a.includes(E.id),onChange:()=>S(E.id)})}),p.jsx(ct,{className:"font-medium",children:E.Item_name}),p.jsx(ct,{children:E.Item_desc}),p.jsx(ct,{children:E.Item_price?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E.Item_price):"-"}),p.jsx(ct,{children:E.item_num||"-"}),p.jsx(ct,{children:p.jsx("button",{onClick:()=>j(E),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"Edit item",children:p.jsx(Ol,{className:"w-4 h-4"})})})]},E.id)),e.length===0&&!r&&p.jsx(br,{children:p.jsx(ct,{colSpan:6,className:"text-center",children:"No items found"})})]})]})})}),p.jsx(lY,{isOpen:l,onClose:()=>{c(!1),f(null)},item:u,onSave:w}),d&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirm Deletion"}),p.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Are you sure you want to delete ",a.length," selected item",a.length>1?"s":"","? This action cannot be undone."]}),p.jsxs("div",{className:"flex space-x-4",children:[p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>h(!1),children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:N,disabled:v,children:v?"Deleting...":"Delete"})]})]})})]})},uY=({isOpen:e,onClose:t,vendor:r,onSave:n})=>{const[a,i]=O.useState({name:"",description:"",taxId:"",phone:"",address:""}),[s,o]=O.useState({}),[l,c]=O.useState(!1);O.useEffect(()=>{var d;i(r?{name:r.vendor_name||"",description:r.vendor_desc||"",taxId:r.vendor_taxid||"",phone:((d=r.vendor_phone)==null?void 0:d.toString())||"",address:r.vendor_address||""}:{name:"",description:"",taxId:"",phone:"",address:""})},[r]);const u=async()=>{const d={};return a.name.trim()||(d.name="Name is required"),a.description.trim()||(d.description="Description is required"),a.address.trim()||(d.address="Address is required"),o(d),Object.keys(d).length===0},f=async d=>{d.preventDefault();try{if(c(!0),await u()){const v={vendor_name:a.name.trim(),vendor_desc:a.description.trim(),vendor_taxid:a.taxId.trim()||null,vendor_phone:a.phone.trim()||null,vendor_address:a.address.trim()},{error:m}=r?await He.from("Vendor").update(v).eq("id",r.id):await He.from("Vendor").insert([v]);if(m)throw m;n(),t()}}catch(h){console.error("Error saving vendor:",h),o({...s,name:"Failed to save vendor. Please try again."})}finally{c(!1)}};return e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r?"Edit Vendor":"Add Vendor"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("form",{onSubmit:f,className:"p-6",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Name *"}),p.jsx("input",{type:"text",value:a.name,onChange:d=>i({...a,name:d.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.name?"border-red-500":"border-gray-300"}`}),s.name&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.name})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description *"}),p.jsx("textarea",{value:a.description,onChange:d=>i({...a,description:d.target.value}),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.description?"border-red-500":"border-gray-300"}`}),s.description&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.description})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tax ID"}),p.jsx("input",{type:"text",value:a.taxId,onChange:d=>i({...a,taxId:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone"}),p.jsx("input",{type:"tel",value:a.phone,onChange:d=>i({...a,phone:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Address *"}),p.jsx("textarea",{value:a.address,onChange:d=>i({...a,address:d.target.value}),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white ${s.address?"border-red-500":"border-gray-300"}`}),s.address&&p.jsx("p",{className:"mt-1 text-sm text-red-500",children:s.address})]})]}),p.jsxs("div",{className:"mt-6 flex space-x-3",children:[p.jsx(pt,{type:"submit",variant:"primary",className:"flex-1",disabled:l,children:l?"Saving...":r?"Save Changes":"Save Vendor"}),p.jsx(pt,{type:"button",variant:"outline",className:"flex-1",onClick:t,disabled:l,children:"Cancel"})]})]})]})}):null},fY=()=>{const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,i]=O.useState([]),[s,o]=O.useState(null),[l,c]=O.useState(!1),[u,f]=O.useState(null),[d,h]=O.useState(!1),[v,m]=O.useState(!1),{sortedItems:y,sortConfig:x,requestSort:b}=Rl(e,{key:"vendor_name",direction:"asc"}),w=async()=>{try{n(!0),o(null);const{data:E,error:P}=await He.from("Vendor").select("*").order("vendor_name");if(P)throw P;t(E||[])}catch(E){console.error("Error fetching vendors:",E),o(E instanceof Error?E.message:"Failed to fetch vendors")}finally{n(!1)}};O.useEffect(()=>{w()},[]);const S=E=>{i(P=>P.includes(E)?P.filter(M=>M!==E):[...P,E])},L=()=>{i(a.length===e.length?[]:e.map(E=>E.id))},j=E=>{f(E),c(!0)},N=async()=>{try{m(!0),o(null);const{error:E}=await He.from("Vendor").delete().in("id",a);if(E)throw E;i([]),h(!1),await w()}catch(E){console.error("Error deleting vendors:",E),o(E instanceof Error?E.message:"Failed to delete vendors"),h(!1)}finally{m(!1)}};return p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Vendors"}),p.jsx("button",{onClick:w,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",disabled:r,children:p.jsx(ko,{className:`w-5 h-5 ${r?"animate-spin":""}`})}),a.length>0&&p.jsx("button",{onClick:()=>h(!0),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors",title:"Delete selected vendors",children:p.jsx(Mc,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[a.length," selected"]}),p.jsx(pt,{variant:"default",className:"bg-black hover:bg-black/90 text-white",icon:p.jsx(Rc,{className:"w-4 h-4"}),onClick:()=>{f(null),c(!0)},children:"Add Vendor"})]})]}),s&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:s}),p.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(vt,{className:"w-12",children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:a.length===e.length&&e.length>0,onChange:L})}),p.jsx(vt,{onClick:()=>b("vendor_name"),className:"cursor-pointer",children:"Name"}),p.jsx(vt,{onClick:()=>b("vendor_desc"),className:"cursor-pointer",children:"Description"}),p.jsx(vt,{onClick:()=>b("vendor_taxid"),className:"cursor-pointer",children:"Tax ID"}),p.jsx(vt,{onClick:()=>b("vendor_phone"),className:"cursor-pointer",children:"Phone"}),p.jsx(vt,{onClick:()=>b("vendor_address"),className:"cursor-pointer",children:"Address"}),p.jsx(vt,{children:"Actions"})]})}),p.jsxs(Os,{children:[y.map(E=>p.jsxs(br,{className:`hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${a.includes(E.id)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[p.jsx(ct,{children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:a.includes(E.id),onChange:()=>S(E.id)})}),p.jsx(ct,{className:"font-medium",children:E.vendor_name}),p.jsx(ct,{children:E.vendor_desc}),p.jsx(ct,{children:E.vendor_taxid||"-"}),p.jsx(ct,{children:E.vendor_phone||"-"}),p.jsx(ct,{children:E.vendor_address}),p.jsx(ct,{children:p.jsx("button",{onClick:()=>j(E),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"Edit vendor",children:p.jsx(Ol,{className:"w-4 h-4"})})})]},E.id)),e.length===0&&!r&&p.jsx(br,{children:p.jsx(ct,{colSpan:7,className:"text-center",children:"No vendors found"})})]})]})})}),p.jsx(uY,{isOpen:l,onClose:()=>{c(!1),f(null)},vendor:u,onSave:w}),d&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirm Deletion"}),p.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Are you sure you want to delete ",a.length," selected vendor",a.length>1?"s":"","? This action cannot be undone."]}),p.jsxs("div",{className:"flex space-x-4",children:[p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>h(!1),children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:N,disabled:v,children:v?"Deleting...":"Delete"})]})]})})]})},dY=["Pending","Paid","Cancelled","Overdue"],hY=({isOpen:e,onClose:t,bill:r,onSave:n,onAlert:a})=>{const[i,s]=O.useState([]),[o,l]=O.useState(!1),[c,u]=O.useState(null),[f,d]=O.useState({billDate:new Date().toISOString().split("T")[0],vendorName:"",description:"",amount:"",status:"Pending",attachment:void 0,attachmentPath:""});O.useEffect(()=>{e&&(async()=>{try{const{data:m,error:y}=await He.from("Vendor").select("vendor_name").order("vendor_name");if(y)throw y;s(m||[])}catch(m){console.error("Error fetching vendors:",m),u(m instanceof Error?m.message:"Failed to fetch vendors")}})()},[e]),O.useEffect(()=>{d(r?{billDate:r.Date,vendorName:r.Vendor_name,description:r.Description||"",amount:r.Amount.toString(),status:r.Status,attachment:void 0,attachmentPath:r.attachment_path||""}:{billDate:new Date().toISOString().split("T")[0],vendorName:"",description:"",amount:"",status:"Pending",attachment:void 0,attachmentPath:""})},[r]);const h=async v=>{if(v.preventDefault(),u(null),r&&!f.status){u("Please select a status");return}if(!r&&(!f.billDate||!f.vendorName||!f.amount)){u("Please fill in all required fields");return}try{l(!0);let m=null;if(!r&&f.attachment){if(f.attachment.size>1024*1024)throw new Error("File size must not exceed 1 MB");if(!["application/pdf","image/jpeg","image/jpg"].includes(f.attachment.type))throw new Error("Only PDF, JPEG, and JPG files are allowed");const x=f.attachment.name.split(".").pop(),w=`${`${Date.now()}.${x}`}`,{error:S}=await He.storage.from("vendorbills").upload(w,f.attachment);if(S)throw S;m=w}if(r){const{error:y}=await He.from("VendorInvoice").update({Status:f.status}).eq("id",r.id);if(y)throw y}else{const{data:y,error:x}=await He.from("VendorInvoice").select("id").order("id",{ascending:!1}).limit(1);if(x)throw x;const w={id:y&&y.length>0?y[0].id+1:1,Date:f.billDate,Vendor_name:f.vendorName,Description:f.description||null,Amount:parseFloat(f.amount),Status:f.status,attachment_path:m},{error:S}=await He.from("VendorInvoice").insert([w]);if(S)throw S}n(),a&&a("Bill saved successfully","success"),t()}catch(m){console.error("Error saving bill:",m),u(m instanceof Error?m.message:"Failed to save bill"),a&&a("Failed to save bill","error")}finally{l(!1)}};return e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r?"Edit Vendor Bill":"Add Vendor Bill"}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsxs("form",{onSubmit:h,className:"p-6",children:[c&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:c}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bill Date *"}),r?p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:new Date(f.billDate).toLocaleDateString()}):p.jsx("input",{type:"date",value:f.billDate,onChange:v=>d({...f,billDate:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Vendor *"}),r?p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:f.vendorName}):p.jsxs("select",{value:f.vendorName,onChange:v=>d({...f,vendorName:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0,children:[p.jsx("option",{value:"",children:"Select vendor"}),i.map(v=>p.jsx("option",{value:v.vendor_name,children:v.vendor_name},v.vendor_name))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),r?p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 min-h-[80px]",children:f.description||"-"}):p.jsx("textarea",{value:f.description,onChange:v=>d({...f,description:v.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount *"}),r?p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(parseFloat(f.amount))}):p.jsx("input",{type:"number",step:"0.01",value:f.amount,onChange:v=>d({...f,amount:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0})]}),r&&r.attachment_path&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Current Attachment"}),p.jsx("div",{className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 font-mono text-sm",children:r.attachment_path.split("/").pop()})]}),!r&&p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Attachment (PDF, JPEG, JPG only, max 1MB)"}),p.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg",onChange:v=>{var y;const m=(y=v.target.files)==null?void 0:y[0];d({...f,attachment:m})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status *"}),p.jsx("select",{value:f.status,onChange:v=>d({...f,status:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",required:!0,children:dY.map(v=>p.jsx("option",{value:v,children:v},v))})]})]}),p.jsxs("div",{className:"mt-6 flex space-x-3",children:[p.jsx(pt,{type:"submit",variant:"primary",className:"flex-1",disabled:o,children:o?"Saving...":r?"Update Status":"Save Bill"}),p.jsx(pt,{type:"button",variant:"outline",className:"flex-1",onClick:t,disabled:o,children:"Cancel"})]})]})]})}):null},pY=({isOpen:e,onClose:t,bill:r})=>{const[n,a]=O.useState(null),[i,s]=O.useState(null),[o,l]=O.useState(!0);return O.useEffect(()=>{const c=async()=>{if(r.attachment_path)try{l(!0);const{data:u,error:f}=await He.storage.from("vendorbills").createSignedUrl(r.attachment_path,3600);if(f)throw f;a(u.signedUrl)}catch(u){console.error("Error fetching file:",u),s("Failed to load file")}finally{l(!1)}};return e&&r.attachment_path&&c(),()=>{a(null),s(null),l(!1)}},[e,r.attachment_path]),e?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-3xl",children:[p.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[p.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["Bill #",r.id," Attachment"]}),p.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",children:p.jsx(fa,{className:"w-5 h-5"})})]}),p.jsx("div",{className:"p-6",children:i?p.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-100 dark:bg-gray-800 rounded-lg",children:p.jsx("p",{className:"text-red-500 dark:text-red-400",children:i})}):r.attachment_path?o?p.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-100 dark:bg-gray-800 rounded-lg",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):n&&p.jsx("div",{className:"space-y-4",children:p.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-100 dark:bg-gray-800 rounded-lg",children:p.jsxs("div",{className:"text-center",children:[p.jsx(Ng,{className:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-600 mb-4"}),p.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"File ready for viewing"}),p.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[p.jsx(kE,{className:"w-4 h-4 mr-2"}),"Open File"]})]})})}):p.jsx("div",{className:"flex items-center justify-center h-96 bg-gray-100 dark:bg-gray-800 rounded-lg",children:p.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No attachment available"})})}),p.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700",children:p.jsx(pt,{variant:"outline",onClick:t,children:"Close"})})]})}):null},gY=[{value:"Pending",color:"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-400"},{value:"Paid",color:"bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-400"},{value:"Overdue",color:"bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-400"},{value:"Cancelled",color:"bg-gray-100 dark:bg-gray-900/50 text-gray-800 dark:text-gray-400"}],mY=({onAlert:e})=>{const[t,r]=O.useState([]),[n,a]=O.useState(!0),[i,s]=O.useState([]),[o,l]=O.useState(null),[c,u]=O.useState(!1),[f,d]=O.useState(null),[h,v]=O.useState(!1),[m,y]=O.useState(!1),[x,b]=O.useState("Pending"),[w,S]=O.useState(!1),[L,j]=O.useState(null),{sortedItems:N,sortConfig:E,requestSort:P}=Rl(t.filter(Q=>Q.Status===x),{key:"Date",direction:"desc"}),M=async()=>{try{a(!0),l(null);const{data:Q,error:V}=await He.from("VendorInvoice").select("*").order("Date",{ascending:!1});if(V)throw V;r(Q||[])}catch(Q){console.error("Error fetching bills:",Q),l(Q instanceof Error?Q.message:"Failed to fetch bills")}finally{a(!1)}};O.useEffect(()=>{M()},[]);const F=Q=>{s(V=>V.includes(Q)?V.filter(z=>z!==Q):[...V,Q])},T=()=>{s(i.length===t.length?[]:t.map(Q=>Q.id))},H=Q=>{d(Q),u(!0)},W=async()=>{try{y(!0),l(null);const{error:Q}=await He.from("VendorInvoice").delete().in("id",i);if(Q)throw Q;s([]),v(!1),await M()}catch(Q){console.error("Error deleting bills:",Q),l(Q instanceof Error?Q.message:"Failed to delete bills"),v(!1)}finally{y(!1)}};return p.jsxs("div",{className:"p-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Vendor Bills"}),p.jsx("button",{onClick:M,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",disabled:n,children:p.jsx(ko,{className:`w-5 h-5 ${n?"animate-spin":""}`})}),i.length>0&&p.jsx("button",{onClick:()=>v(!0),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors",title:"Delete selected bills",children:p.jsx(Mc,{className:"w-5 h-5"})})]}),p.jsxs("div",{className:"flex items-center space-x-4",children:[p.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[i.length," selected"]}),p.jsx(pt,{variant:"default",className:"bg-black hover:bg-black/90 text-white",icon:p.jsx(Rc,{className:"w-4 h-4"}),onClick:()=>{d(null),u(!0)},children:"Add Vendor Bill"})]})]}),p.jsx("div",{className:"mb-6 flex space-x-2",children:gY.map(Q=>p.jsx("button",{onClick:()=>b(Q.value),className:`px-4 py-2 rounded-lg font-medium transition-colors ${x===Q.value?Q.color:"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:Q.value},Q.value))}),o&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:o}),p.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs(Is,{children:[p.jsx(Ds,{children:p.jsxs(br,{children:[p.jsx(vt,{className:"w-12",children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:i.length===t.length&&t.length>0,onChange:T})}),p.jsx(vt,{onClick:()=>P("id"),className:"cursor-pointer",children:"Bill No."}),p.jsx(vt,{onClick:()=>P("Date"),className:"cursor-pointer",children:"Date"}),p.jsx(vt,{onClick:()=>P("Vendor_name"),className:"cursor-pointer",children:"Vendor"}),p.jsx(vt,{onClick:()=>P("Description"),className:"cursor-pointer",children:"Description"}),p.jsx(vt,{onClick:()=>P("Amount"),className:"cursor-pointer",children:"Amount"}),p.jsx(vt,{onClick:()=>P("Status"),className:"cursor-pointer",children:"Status"}),p.jsx(vt,{children:"Actions"})]})}),p.jsxs(Os,{children:[N.map(Q=>p.jsxs(br,{className:`hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${i.includes(Q.id)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[p.jsx(ct,{children:p.jsx("input",{type:"checkbox",className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500",checked:i.includes(Q.id),onChange:()=>F(Q.id)})}),p.jsxs(ct,{className:"font-medium",children:["#",Q.id]}),p.jsx(ct,{children:new Date(Q.Date).toLocaleDateString()}),p.jsx(ct,{children:Q.Vendor_name}),p.jsx(ct,{children:Q.Description||"-"}),p.jsx(ct,{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Q.Amount)}),p.jsx(ct,{children:p.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Q.Status==="Paid"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":Q.Status==="Overdue"?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400":Q.Status==="Cancelled"?"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"}`,children:Q.Status})}),p.jsx(ct,{children:p.jsx("div",{className:"flex items-center space-x-3",children:p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsx("button",{onClick:()=>H(Q),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",title:"Edit bill",children:p.jsx(Ol,{className:"w-4 h-4"})}),Q.attachment_path&&p.jsx("button",{onClick:()=>{j(Q),S(!0)},className:"text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300 transition-colors",title:"View attachment",children:p.jsx(AE,{className:"w-4 h-4"})})]})})})]},Q.id)),t.length===0&&!n&&p.jsx(br,{children:p.jsx(ct,{colSpan:8,className:"text-center",children:"No bills found"})})]})]})})}),p.jsx(hY,{isOpen:c,onClose:()=>{u(!1),d(null)},bill:f,onSave:M,onAlert:e}),L&&p.jsx(pY,{isOpen:w,onClose:()=>{S(!1),j(null)},bill:L}),h&&p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl w-full max-w-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Confirm Deletion"}),p.jsxs("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:["Are you sure you want to delete ",i.length," selected bill",i.length>1?"s":"","? This action cannot be undone."]}),p.jsxs("div",{className:"flex space-x-4",children:[p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>v(!1),children:"Cancel"}),p.jsx(pt,{variant:"primary",className:"flex-1 !bg-red-500 hover:!bg-red-600",onClick:W,disabled:m,children:m?"Deleting...":"Delete"})]})]})})]})},vY=({onAlert:e})=>{const[t,r]=O.useState(!1),[n,a]=O.useState(!1),[i,s]=O.useState(null),[o,l]=O.useState({fullName:"",address:"",email:"",phone:""});O.useEffect(()=>{c()},[]);const c=async()=>{try{const{data:{user:f},error:d}=await He.auth.getUser();if(d)throw d;if(!f)throw new Error("No user found");const{data:h,error:v}=await He.from("users").select("*").eq("auth_id",f.id).single();if(v)throw v;l({id:h.id,fullName:h.full_name||"",address:h.address||"",email:h.email||"",phone:h.phone||""})}catch(f){console.error("Error fetching profile:",f),s(f instanceof Error?f.message:"Failed to fetch profile")}},u=async()=>{try{a(!0),s(null);const{data:{user:f},error:d}=await He.auth.getUser();if(d)throw d;if(!f)throw new Error("No user found");const{error:h}=await He.auth.updateUser({email:o.email,data:{...f.user_metadata,full_name:o.fullName,address:o.address,phone:o.phone}});if(h)throw h;const{error:v}=await He.from("users").update({full_name:o.fullName,email:o.email,phone:o.phone,address:o.address}).eq("auth_id",f.id);if(v)throw v;o.phone.trim()||e==null||e("Please add your phone number to complete your profile","warning"),r(!1),await c()}catch(f){console.error("Error updating profile:",f),s(f instanceof Error?f.message:"Failed to update profile")}finally{a(!1)}};return p.jsxs("div",{className:"p-6",children:[p.jsx("div",{className:"flex items-center justify-between mb-6",children:p.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Profile"})}),i&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-400",children:i}),p.jsxs("div",{className:"max-w-2xl bg-white dark:bg-gray-900 rounded-lg shadow-sm",children:[p.jsxs("div",{className:"p-6 space-y-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Full Name"}),t?p.jsx("input",{type:"text",value:o.fullName,onChange:f=>l({...o,fullName:f.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:text-white"}):p.jsx("div",{className:"mt-2 text-gray-900 dark:text-white font-medium",children:o.fullName})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Address"}),t?p.jsx("input",{type:"text",value:o.address,onChange:f=>l({...o,address:f.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:text-white"}):p.jsx("div",{className:"mt-2 text-gray-900 dark:text-white",children:o.address||"Not provided"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email"}),t?p.jsx("input",{type:"email",value:o.email,onChange:f=>l({...o,email:f.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:text-white"}):p.jsx("div",{className:"mt-2 text-gray-900 dark:text-white",children:o.email})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Phone Number"}),t?p.jsx("input",{type:"tel",value:o.phone,onChange:f=>l({...o,phone:f.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",placeholder:"Enter phone number"}):p.jsx("div",{className:"mt-2 text-gray-900 dark:text-white",children:o.phone||"Not provided"})]})]}),p.jsx("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 rounded-b-lg",children:t?p.jsxs("div",{className:"flex space-x-4",children:[p.jsx(pt,{variant:"primary",className:"flex-1",onClick:u,disabled:n,icon:p.jsx(CE,{className:"w-4 h-4"}),children:n?"Saving...":"Save Changes"}),p.jsx(pt,{variant:"outline",className:"flex-1",onClick:()=>{r(!1),c()},icon:p.jsx(fa,{className:"w-4 h-4"}),children:"Cancel"})]}):p.jsx(pt,{variant:"primary",className:"w-full",onClick:()=>r(!0),children:"Edit Profile"})})]})]})},xY=()=>{const[e,t]=O.useState(!1),[r,n]=O.useState(""),[a,i]=O.useState(""),[s,o]=O.useState(""),[l,c]=O.useState(""),[u,f]=O.useState(!1),[d,h]=O.useState(null),[v,m]=O.useState(null),y=Il(),x=async b=>{b.preventDefault(),h(null),m(null),f(!0);try{if(e){if(!s.trim())throw new Error("Name is required");const{data:w,error:S}=await He.auth.signUp({email:r,password:a,options:{data:{full_name:s,phone:l||null,email_verified:!1,admin_approved:!1}}});if(S)throw S;await He.functions.invoke("auth-notifications",{body:{event:"SIGNED_UP",user:w.user}}),m("Please check your email to verify your account.")}else{const{data:{user:w},error:S}=await He.auth.signInWithPassword({email:r,password:a});if(S)throw S;if(!(w!=null&&w.user_metadata.email_verified))throw new Error("Please verify your email before logging in.");if(!(w!=null&&w.user_metadata.admin_approved))throw new Error("Your account is pending admin approval.");y("/")}}catch(w){h(w instanceof Error?w.message:"An error occurred")}finally{f(!1)}};return p.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center p-4",children:p.jsx("div",{className:"w-full max-w-md",children:p.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e?"Create Account":"Welcome Back"}),p.jsx("p",{className:"text-gray-600 mt-2",children:e?"Sign up to get started":"Please sign in to your account"})]}),d&&p.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:d}),v&&p.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm",children:v}),p.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e&&p.jsxs(p.Fragment,{children:[p.jsx("div",{children:p.jsxs("div",{className:"relative",children:[p.jsx(r2,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),p.jsx("input",{type:"text",value:s,onChange:b=>o(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Full name",required:!0})]})}),p.jsx("div",{children:p.jsxs("div",{className:"relative",children:[p.jsx(aI,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),p.jsx("input",{type:"tel",value:l,onChange:b=>c(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Phone number (optional)"})]})})]}),p.jsx("div",{children:p.jsxs("div",{className:"relative",children:[p.jsx(tI,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),p.jsx("input",{type:"email",value:r,onChange:b=>n(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Email address",required:!0})]})}),p.jsx("div",{children:p.jsxs("div",{className:"relative",children:[p.jsx(eI,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),p.jsx("input",{type:"password",value:a,onChange:b=>i(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Password",required:!0})]})}),p.jsx(pt,{type:"submit",variant:"primary",className:"w-full",disabled:u,children:u?"Please wait...":e?"Sign Up":"Sign In"})]}),p.jsx("div",{className:"mt-6 text-center",children:p.jsx("button",{onClick:()=>{t(!e),h(null),m(null),o(""),c("")},className:"text-blue-600 hover:text-blue-700 font-medium",children:e?"Already have an account? Sign in":"Don't have an account? Sign up"})})]})})})},yY=()=>{const[e]=eF(),[t,r]=O.useState(!0),[n,a]=O.useState(null),i=Il();return O.useEffect(()=>{(async()=>{try{const o=e.get("token");if(!o)throw new Error("Verification token is missing");const{error:l}=await He.auth.verifyOtp({token_hash:o,type:"email"});if(l)throw l;const{data:{user:c},error:u}=await He.auth.getUser();if(u)throw u;c&&await He.auth.updateUser({data:{email_verified:!0}}),setTimeout(()=>{i("/auth")},5e3)}catch(o){a(o instanceof Error?o.message:"Failed to verify email")}finally{r(!1)}})()},[e,i]),p.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center p-4",children:p.jsx("div",{className:"w-full max-w-md",children:p.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:t?p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),p.jsx("p",{className:"text-gray-600",children:"Verifying your email..."})]}):n?p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{className:"text-red-500 text-xl",children:""}),p.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Verification Failed"}),p.jsx("p",{className:"text-gray-600",children:n})]}):p.jsxs("div",{className:"space-y-4",children:[p.jsx("div",{className:"text-green-500 text-xl",children:""}),p.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Email Verified!"}),p.jsx("p",{className:"text-gray-600",children:"Your email has been verified. Please wait for admin approval to access your account. You will be redirected to the login page in 5 seconds."})]})})})})},wY=()=>p.jsxs("div",{className:"flex items-center space-x-2",children:[p.jsxs("div",{className:"relative w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:[p.jsx("div",{className:"absolute w-2 h-2 bg-blue-500 rounded-full top-1 right-2"}),p.jsx("div",{className:"absolute w-2 h-2 bg-blue-500 rounded-full bottom-1 left-2"}),p.jsx("div",{className:"absolute w-2 h-2 bg-blue-500 rounded-full bottom-1 right-2"}),p.jsx("div",{className:"absolute transform -rotate-45",children:p.jsxs("div",{className:"w-4 h-6",children:[p.jsx("div",{className:"w-1.5 h-3 bg-gray-800 dark:bg-gray-200 absolute left-0 transform -rotate-12"}),p.jsx("div",{className:"w-1.5 h-3 bg-gray-800 dark:bg-gray-200 absolute right-0 transform rotate-12"})]})})]}),p.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Junyper"})]}),bY=()=>{const[e,t]=O.useState(()=>{const n=localStorage.getItem("theme");return n==="dark"||!n&&window.matchMedia("(prefers-color-scheme: dark)").matches});return O.useEffect(()=>{e?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[e]),{isDark:e,toggle:()=>t(!e)}},_Y=()=>{const{isDark:e,toggle:t}=bY();return p.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:e?"Switch to light mode":"Switch to dark mode",children:e?p.jsx(cI,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"}):p.jsx(nI,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"})})},kY=({alert:e,onDismiss:t,onMarkAsRead:r})=>{const n=()=>{switch(e.type){case"info":return"bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 border-blue-200 dark:border-blue-800 text-blue-700 dark:text-blue-300";case"warning":return"bg-yellow-50 hover:bg-yellow-100 dark:bg-yellow-900/20 dark:hover:bg-yellow-900/30 border-yellow-200 dark:border-yellow-800 text-yellow-700 dark:text-yellow-300";case"error":return"bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/30 border-red-200 dark:border-red-800 text-red-700 dark:text-red-300";case"success":return"bg-green-50 hover:bg-green-100 dark:bg-green-900/20 dark:hover:bg-green-900/30 border-green-200 dark:border-green-800 text-green-700 dark:text-green-300";default:return"bg-gray-50 dark:bg-gray-900/20 border-gray-200 dark:border-gray-800 text-gray-700 dark:text-gray-300"}},a=()=>{switch(e.type){case"info":return p.jsx(h_,{className:"w-5 h-5"});case"warning":return p.jsx(Vj,{className:"w-5 h-5"});case"error":return p.jsx($j,{className:"w-5 h-5"});case"success":return p.jsx(Jj,{className:"w-5 h-5"});default:return p.jsx(h_,{className:"w-5 h-5"})}};return p.jsx("div",{className:`p-4 rounded-lg border ${n()} relative transition-all duration-200 ${e.read?"opacity-75":""}`,role:"alert",children:p.jsxs("div",{className:"flex items-start",children:[p.jsx("div",{className:"flex-shrink-0",children:a()}),p.jsxs("div",{className:"ml-3 flex-1",children:[p.jsx("p",{className:"text-sm font-medium",children:e.message}),p.jsx("p",{className:"mt-1 text-xs opacity-75",children:new Date(e.createdAt).toLocaleTimeString()})]}),p.jsxs("div",{className:"ml-4 flex-shrink-0 flex",children:[!e.read&&r&&p.jsx("button",{onClick:()=>r(e.id),className:"mr-2 text-current opacity-70 hover:opacity-100 transition-opacity",title:"Mark as read",children:p.jsx(_E,{className:"w-4 h-4"})}),p.jsx("button",{onClick:()=>t(e.id),className:"text-current opacity-70 hover:opacity-100 transition-opacity",title:"Dismiss",children:p.jsx(fa,{className:"w-4 h-4"})})]})]})})},SY=({alerts:e,onDismiss:t,onMarkAllAsRead:r})=>{const n=e.filter(a=>!a.read);return e.length===0?p.jsx("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:"No notifications"}):p.jsxs(p.Fragment,{children:[n.length>0&&r&&p.jsx("div",{className:"px-4 py-2 border-b border-gray-200 dark:border-gray-700",children:p.jsx(pt,{variant:"outline",className:"w-full text-sm",onClick:r,icon:p.jsx(_E,{className:"w-4 h-4"}),children:"Mark all as read"})}),p.jsx("div",{className:"space-y-2 max-h-[400px] overflow-y-auto p-2",children:e.map(a=>p.jsx(kY,{alert:a,onDismiss:t,onMarkAsRead:r},a.id))})]})},EY=({alerts:e,onDismiss:t})=>{const[r,n]=O.useState(!1),[a,i]=O.useState(!1),[s,o]=O.useState(new Set),l=Il(),c=e.filter(d=>!s.has(d.id)).length,u=()=>{const d=new Set(s);e.forEach(h=>d.add(h.id)),o(d)};O.useEffect(()=>{e.filter(h=>h.type==="success").forEach(h=>{const v=setTimeout(()=>{t(h.id)},5e3);return()=>clearTimeout(v)})},[e,t]);const f=async()=>{try{const{error:d}=await He.auth.signOut();if(d)throw d;l("/auth")}catch(d){console.error("Error logging out:",d)}n(!1)};return p.jsxs("nav",{className:"w-full h-16 py-4 px-6 flex items-center justify-between bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"block md:hidden mr-4",children:p.jsx(rI,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"})}),p.jsx(wY,{})]}),p.jsxs("div",{className:"flex items-center space-x-6",children:[p.jsx(_Y,{}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>i(!a),className:"relative p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Notifications",children:[p.jsx(qj,{className:"w-5 h-5 text-gray-700 dark:text-gray-200"}),c>0&&p.jsx("span",{className:"absolute -top-1 -right-1 flex items-center justify-center min-w-[18px] h-[18px] text-xs font-medium text-white bg-red-500 rounded-full px-1",children:c})]}),a&&p.jsxs("div",{className:"absolute top-full right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:[p.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:p.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Notifications"})}),p.jsx(SY,{alerts:e.map(d=>({...d,read:s.has(d.id)})),onDismiss:t,onMarkAllAsRead:u})]})]}),p.jsxs("div",{className:"relative",children:[p.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer",onClick:()=>n(!r),title:"Account menu",children:[p.jsx("div",{className:"w-8 h-8 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:p.jsx(r2,{className:"w-4 h-4 text-gray-700 dark:text-gray-200"})}),p.jsx(qu,{className:"w-4 h-4 text-gray-700 dark:text-gray-200"})]}),r&&p.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg py-1 z-50",children:[p.jsxs("button",{onClick:()=>{l("/profile"),n(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center",children:[p.jsx(r2,{className:"w-4 h-4 mr-2"}),"Profile"]}),p.jsxs("button",{onClick:f,className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center",children:[p.jsx(EE,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})]})]})};function dC(e){const t=e+"CollectionProvider",[r,n]=j0(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),s=m=>{const{scope:y,children:x}=m,b=Es.useRef(null),w=Es.useRef(new Map).current;return p.jsx(a,{scope:y,itemMap:w,collectionRef:b,children:x})};s.displayName=t;const o=e+"CollectionSlot",l=m0(o),c=Es.forwardRef((m,y)=>{const{scope:x,children:b}=m,w=i(o,x),S=ca(y,w.collectionRef);return p.jsx(l,{ref:S,children:b})});c.displayName=o;const u=e+"CollectionItemSlot",f="data-radix-collection-item",d=m0(u),h=Es.forwardRef((m,y)=>{const{scope:x,children:b,...w}=m,S=Es.useRef(null),L=ca(y,S),j=i(u,x);return Es.useEffect(()=>(j.itemMap.set(S,{ref:S,...w}),()=>void j.itemMap.delete(S))),p.jsx(d,{[f]:"",ref:L,children:b})});h.displayName=u;function v(m){const y=i(e+"CollectionConsumer",m);return Es.useCallback(()=>{const b=y.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${f}]`));return Array.from(y.itemMap.values()).sort((j,N)=>w.indexOf(j.ref.current)-w.indexOf(N.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:s,Slot:c,ItemSlot:h},v,n]}var NY=O.createContext(void 0);function hC(e){const t=O.useContext(NY);return e||t||"ltr"}var Xv="rovingFocusGroup.onEntryFocus",AY={bubbles:!1,cancelable:!0},hh="RovingFocusGroup",[F2,pC,CY]=dC(hh),[TY,gC]=j0(hh,[CY]),[PY,FY]=TY(hh),mC=O.forwardRef((e,t)=>p.jsx(F2.Provider,{scope:e.__scopeRovingFocusGroup,children:p.jsx(F2.Slot,{scope:e.__scopeRovingFocusGroup,children:p.jsx(LY,{...e,ref:t})})}));mC.displayName=hh;var LY=O.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:i,currentTabStopId:s,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...f}=e,d=O.useRef(null),h=ca(t,d),v=hC(i),[m,y]=zw({prop:s,defaultProp:o??null,onChange:l,caller:hh}),[x,b]=O.useState(!1),w=yo(c),S=pC(r),L=O.useRef(!1),[j,N]=O.useState(0);return O.useEffect(()=>{const E=d.current;if(E)return E.addEventListener(Xv,w),()=>E.removeEventListener(Xv,w)},[w]),p.jsx(PY,{scope:r,orientation:n,dir:v,loop:a,currentTabStopId:m,onItemFocus:O.useCallback(E=>y(E),[y]),onItemShiftTab:O.useCallback(()=>b(!0),[]),onFocusableItemAdd:O.useCallback(()=>N(E=>E+1),[]),onFocusableItemRemove:O.useCallback(()=>N(E=>E-1),[]),children:p.jsx($n.div,{tabIndex:x||j===0?-1:0,"data-orientation":n,...f,ref:h,style:{outline:"none",...e.style},onMouseDown:Vt(e.onMouseDown,()=>{L.current=!0}),onFocus:Vt(e.onFocus,E=>{const P=!L.current;if(E.target===E.currentTarget&&P&&!x){const M=new CustomEvent(Xv,AY);if(E.currentTarget.dispatchEvent(M),!M.defaultPrevented){const F=S().filter(V=>V.focusable),T=F.find(V=>V.active),H=F.find(V=>V.id===m),Q=[T,H,...F].filter(Boolean).map(V=>V.ref.current);yC(Q,u)}}L.current=!1}),onBlur:Vt(e.onBlur,()=>b(!1))})})}),vC="RovingFocusGroupItem",xC=O.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:i,children:s,...o}=e,l=Gp(),c=i||l,u=FY(vC,r),f=u.currentTabStopId===c,d=pC(r),{onFocusableItemAdd:h,onFocusableItemRemove:v,currentTabStopId:m}=u;return O.useEffect(()=>{if(n)return h(),()=>v()},[n,h,v]),p.jsx(F2.ItemSlot,{scope:r,id:c,focusable:n,active:a,children:p.jsx($n.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Vt(e.onMouseDown,y=>{n?u.onItemFocus(c):y.preventDefault()}),onFocus:Vt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Vt(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const x=DY(y,u.orientation,u.dir);if(x!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=d().filter(S=>S.focusable).map(S=>S.ref.current);if(x==="last")w.reverse();else if(x==="prev"||x==="next"){x==="prev"&&w.reverse();const S=w.indexOf(y.currentTarget);w=u.loop?OY(w,S+1):w.slice(S+1)}setTimeout(()=>yC(w))}}),children:typeof s=="function"?s({isCurrentTabStop:f,hasTabStop:m!=null}):s})})});xC.displayName=vC;var jY={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function IY(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function DY(e,t,r){const n=IY(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return jY[n]}function yC(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function OY(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var RY=mC,MY=xC,L2=["Enter"," "],BY=["ArrowDown","PageUp","Home"],wC=["ArrowUp","PageDown","End"],UY=[...BY,...wC],zY={ltr:[...L2,"ArrowRight"],rtl:[...L2,"ArrowLeft"]},WY={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ph="Menu",[$d,HY,$Y]=dC(ph),[Gc,bC]=j0(ph,[$Y,Hg,gC]),qg=Hg(),_C=gC(),[VY,Xc]=Gc(ph),[qY,gh]=Gc(ph),kC=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:i,modal:s=!0}=e,o=qg(t),[l,c]=O.useState(null),u=O.useRef(!1),f=yo(i),d=hC(a);return O.useEffect(()=>{const h=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),p.jsx(HA,{...o,children:p.jsx(VY,{scope:t,open:r,onOpenChange:f,content:l,onContentChange:c,children:p.jsx(qY,{scope:t,onClose:O.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:d,modal:s,children:n})})})};kC.displayName=ph;var GY="MenuAnchor",Hw=O.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=qg(r);return p.jsx(Bw,{...a,...n,ref:t})});Hw.displayName=GY;var $w="MenuPortal",[XY,SC]=Gc($w,{forceMount:void 0}),EC=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,i=Xc($w,t);return p.jsx(XY,{scope:t,forceMount:r,children:p.jsx(qc,{present:r||i.open,children:p.jsx(Uw,{asChild:!0,container:a,children:n})})})};EC.displayName=$w;var Li="MenuContent",[KY,Vw]=Gc(Li),NC=O.forwardRef((e,t)=>{const r=SC(Li,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=Xc(Li,e.__scopeMenu),s=gh(Li,e.__scopeMenu);return p.jsx($d.Provider,{scope:e.__scopeMenu,children:p.jsx(qc,{present:n||i.open,children:p.jsx($d.Slot,{scope:e.__scopeMenu,children:s.modal?p.jsx(YY,{...a,ref:t}):p.jsx(JY,{...a,ref:t})})})})}),YY=O.forwardRef((e,t)=>{const r=Xc(Li,e.__scopeMenu),n=O.useRef(null),a=ca(t,n);return O.useEffect(()=>{const i=n.current;if(i)return GA(i)},[]),p.jsx(qw,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Vt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),JY=O.forwardRef((e,t)=>{const r=Xc(Li,e.__scopeMenu);return p.jsx(qw,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),ZY=m0("MenuContent.ScrollLock"),qw=O.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:d,onDismiss:h,disableOutsideScroll:v,...m}=e,y=Xc(Li,r),x=gh(Li,r),b=qg(r),w=_C(r),S=HY(r),[L,j]=O.useState(null),N=O.useRef(null),E=ca(t,N,y.onContentChange),P=O.useRef(0),M=O.useRef(""),F=O.useRef(0),T=O.useRef(null),H=O.useRef("right"),W=O.useRef(0),Q=v?tC:O.Fragment,V=v?{as:ZY,allowPinchZoom:!0}:void 0,z=D=>{var ue,pe;const ne=M.current+D,ge=S().filter(he=>!he.disabled),C=document.activeElement,R=(ue=ge.find(he=>he.ref.current===C))==null?void 0:ue.textValue,B=ge.map(he=>he.textValue),U=uJ(B,ne,R),Y=(pe=ge.find(he=>he.textValue===U))==null?void 0:pe.ref.current;(function he(ye){M.current=ye,window.clearTimeout(P.current),ye!==""&&(P.current=window.setTimeout(()=>he(""),1e3))})(ne),Y&&setTimeout(()=>Y.focus())};O.useEffect(()=>()=>window.clearTimeout(P.current),[]),bA();const X=O.useCallback(D=>{var ge,C;return H.current===((ge=T.current)==null?void 0:ge.side)&&dJ(D,(C=T.current)==null?void 0:C.area)},[]);return p.jsx(KY,{scope:r,searchRef:M,onItemEnter:O.useCallback(D=>{X(D)&&D.preventDefault()},[X]),onItemLeave:O.useCallback(D=>{var ne;X(D)||((ne=N.current)==null||ne.focus(),j(null))},[X]),onTriggerLeave:O.useCallback(D=>{X(D)&&D.preventDefault()},[X]),pointerGraceTimerRef:F,onPointerGraceIntentChange:O.useCallback(D=>{T.current=D},[]),children:p.jsx(Q,{...V,children:p.jsx(Tw,{asChild:!0,trapped:a,onMountAutoFocus:Vt(i,D=>{var ne;D.preventDefault(),(ne=N.current)==null||ne.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:p.jsx(Cw,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:d,onDismiss:h,children:p.jsx(RY,{asChild:!0,...w,dir:x.dir,orientation:"vertical",loop:n,currentTabStopId:L,onCurrentTabStopIdChange:j,onEntryFocus:Vt(l,D=>{x.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:p.jsx($A,{role:"menu","aria-orientation":"vertical","data-state":WC(y.open),"data-radix-menu-content":"",dir:x.dir,...b,...m,ref:E,style:{outline:"none",...m.style},onKeyDown:Vt(m.onKeyDown,D=>{const ge=D.target.closest("[data-radix-menu-content]")===D.currentTarget,C=D.ctrlKey||D.altKey||D.metaKey,R=D.key.length===1;ge&&(D.key==="Tab"&&D.preventDefault(),!C&&R&&z(D.key));const B=N.current;if(D.target!==B||!UY.includes(D.key))return;D.preventDefault();const Y=S().filter(ue=>!ue.disabled).map(ue=>ue.ref.current);wC.includes(D.key)&&Y.reverse(),lJ(Y)}),onBlur:Vt(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(P.current),M.current="")}),onPointerMove:Vt(e.onPointerMove,Vd(D=>{const ne=D.target,ge=W.current!==D.clientX;if(D.currentTarget.contains(ne)&&ge){const C=D.clientX>W.current?"right":"left";H.current=C,W.current=D.clientX}}))})})})})})})});NC.displayName=Li;var QY="MenuGroup",Gw=O.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return p.jsx($n.div,{role:"group",...n,ref:t})});Gw.displayName=QY;var eJ="MenuLabel",AC=O.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return p.jsx($n.div,{...n,ref:t})});AC.displayName=eJ;var Qp="MenuItem",vk="menu.itemSelect",Gg=O.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,i=O.useRef(null),s=gh(Qp,e.__scopeMenu),o=Vw(Qp,e.__scopeMenu),l=ca(t,i),c=O.useRef(!1),u=()=>{const f=i.current;if(!r&&f){const d=new CustomEvent(vk,{bubbles:!0,cancelable:!0});f.addEventListener(vk,h=>n==null?void 0:n(h),{once:!0}),xA(f,d),d.defaultPrevented?c.current=!1:s.onClose()}};return p.jsx(CC,{...a,ref:l,disabled:r,onClick:Vt(e.onClick,u),onPointerDown:f=>{var d;(d=e.onPointerDown)==null||d.call(e,f),c.current=!0},onPointerUp:Vt(e.onPointerUp,f=>{var d;c.current||(d=f.currentTarget)==null||d.click()}),onKeyDown:Vt(e.onKeyDown,f=>{const d=o.searchRef.current!=="";r||d&&f.key===" "||L2.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});Gg.displayName=Qp;var CC=O.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...i}=e,s=Vw(Qp,r),o=_C(r),l=O.useRef(null),c=ca(t,l),[u,f]=O.useState(!1),[d,h]=O.useState("");return O.useEffect(()=>{const v=l.current;v&&h((v.textContent??"").trim())},[i.children]),p.jsx($d.ItemSlot,{scope:r,disabled:n,textValue:a??d,children:p.jsx(MY,{asChild:!0,...o,focusable:!n,children:p.jsx($n.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:c,onPointerMove:Vt(e.onPointerMove,Vd(v=>{n?s.onItemLeave(v):(s.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Vt(e.onPointerLeave,Vd(v=>s.onItemLeave(v))),onFocus:Vt(e.onFocus,()=>f(!0)),onBlur:Vt(e.onBlur,()=>f(!1))})})})}),tJ="MenuCheckboxItem",TC=O.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return p.jsx(IC,{scope:e.__scopeMenu,checked:r,children:p.jsx(Gg,{role:"menuitemcheckbox","aria-checked":eg(r)?"mixed":r,...a,ref:t,"data-state":Kw(r),onSelect:Vt(a.onSelect,()=>n==null?void 0:n(eg(r)?!0:!r),{checkForDefaultPrevented:!1})})})});TC.displayName=tJ;var PC="MenuRadioGroup",[rJ,nJ]=Gc(PC,{value:void 0,onValueChange:()=>{}}),FC=O.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,i=yo(n);return p.jsx(rJ,{scope:e.__scopeMenu,value:r,onValueChange:i,children:p.jsx(Gw,{...a,ref:t})})});FC.displayName=PC;var LC="MenuRadioItem",jC=O.forwardRef((e,t)=>{const{value:r,...n}=e,a=nJ(LC,e.__scopeMenu),i=r===a.value;return p.jsx(IC,{scope:e.__scopeMenu,checked:i,children:p.jsx(Gg,{role:"menuitemradio","aria-checked":i,...n,ref:t,"data-state":Kw(i),onSelect:Vt(n.onSelect,()=>{var s;return(s=a.onValueChange)==null?void 0:s.call(a,r)},{checkForDefaultPrevented:!1})})})});jC.displayName=LC;var Xw="MenuItemIndicator",[IC,aJ]=Gc(Xw,{checked:!1}),DC=O.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,i=aJ(Xw,r);return p.jsx(qc,{present:n||eg(i.checked)||i.checked===!0,children:p.jsx($n.span,{...a,ref:t,"data-state":Kw(i.checked)})})});DC.displayName=Xw;var iJ="MenuSeparator",OC=O.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return p.jsx($n.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});OC.displayName=iJ;var sJ="MenuArrow",RC=O.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=qg(r);return p.jsx(VA,{...a,...n,ref:t})});RC.displayName=sJ;var oJ="MenuSub",[hZ,MC]=Gc(oJ),If="MenuSubTrigger",BC=O.forwardRef((e,t)=>{const r=Xc(If,e.__scopeMenu),n=gh(If,e.__scopeMenu),a=MC(If,e.__scopeMenu),i=Vw(If,e.__scopeMenu),s=O.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=O.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return O.useEffect(()=>u,[u]),O.useEffect(()=>{const f=o.current;return()=>{window.clearTimeout(f),l(null)}},[o,l]),p.jsx(Hw,{asChild:!0,...c,children:p.jsx(CC,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":WC(r.open),...e,ref:Ag(t,a.onTriggerChange),onClick:f=>{var d;(d=e.onClick)==null||d.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Vt(e.onPointerMove,Vd(f=>{i.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!s.current&&(i.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:Vt(e.onPointerLeave,Vd(f=>{var h,v;u();const d=(h=r.content)==null?void 0:h.getBoundingClientRect();if(d){const m=(v=r.content)==null?void 0:v.dataset.side,y=m==="right",x=y?-5:5,b=d[y?"left":"right"],w=d[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+x,y:f.clientY},{x:b,y:d.top},{x:w,y:d.top},{x:w,y:d.bottom},{x:b,y:d.bottom}],side:m}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Vt(e.onKeyDown,f=>{var h;const d=i.searchRef.current!=="";e.disabled||d&&f.key===" "||zY[n.dir].includes(f.key)&&(r.onOpenChange(!0),(h=r.content)==null||h.focus(),f.preventDefault())})})})});BC.displayName=If;var UC="MenuSubContent",zC=O.forwardRef((e,t)=>{const r=SC(Li,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=Xc(Li,e.__scopeMenu),s=gh(Li,e.__scopeMenu),o=MC(UC,e.__scopeMenu),l=O.useRef(null),c=ca(t,l);return p.jsx($d.Provider,{scope:e.__scopeMenu,children:p.jsx(qc,{present:n||i.open,children:p.jsx($d.Slot,{scope:e.__scopeMenu,children:p.jsx(qw,{id:o.contentId,"aria-labelledby":o.triggerId,...a,ref:c,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var f;s.isUsingKeyboardRef.current&&((f=l.current)==null||f.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Vt(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Vt(e.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:Vt(e.onKeyDown,u=>{var h;const f=u.currentTarget.contains(u.target),d=WY[s.dir].includes(u.key);f&&d&&(i.onOpenChange(!1),(h=o.trigger)==null||h.focus(),u.preventDefault())})})})})})});zC.displayName=UC;function WC(e){return e?"open":"closed"}function eg(e){return e==="indeterminate"}function Kw(e){return eg(e)?"indeterminate":e?"checked":"unchecked"}function lJ(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function cJ(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function uJ(e,t,r){const a=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let s=cJ(e,Math.max(i,0));a.length===1&&(s=s.filter(c=>c!==r));const l=s.find(c=>c.toLowerCase().startsWith(a.toLowerCase()));return l!==r?l:void 0}function fJ(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const o=t[i],l=t[s],c=o.x,u=o.y,f=l.x,d=l.y;u>n!=d>n&&r<(f-c)*(n-u)/(d-u)+c&&(a=!a)}return a}function dJ(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return fJ(r,t)}function Vd(e){return t=>t.pointerType==="mouse"?e(t):void 0}var hJ=kC,pJ=Hw,gJ=EC,mJ=NC,vJ=Gw,xJ=AC,yJ=Gg,wJ=TC,bJ=FC,_J=jC,kJ=DC,SJ=OC,EJ=RC,NJ=BC,AJ=zC,Xg="DropdownMenu",[CJ,pZ]=j0(Xg,[bC]),Ea=bC(),[TJ,HC]=CJ(Xg),$C=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:i,onOpenChange:s,modal:o=!0}=e,l=Ea(t),c=O.useRef(null),[u,f]=zw({prop:a,defaultProp:i??!1,onChange:s,caller:Xg});return p.jsx(TJ,{scope:t,triggerId:Gp(),triggerRef:c,contentId:Gp(),open:u,onOpenChange:f,onOpenToggle:O.useCallback(()=>f(d=>!d),[f]),modal:o,children:p.jsx(hJ,{...l,open:u,onOpenChange:f,dir:n,modal:o,children:r})})};$C.displayName=Xg;var VC="DropdownMenuTrigger",qC=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,i=HC(VC,r),s=Ea(r);return p.jsx(pJ,{asChild:!0,...s,children:p.jsx($n.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:Ag(t,i.triggerRef),onPointerDown:Vt(e.onPointerDown,o=>{!n&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Vt(e.onKeyDown,o=>{n||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});qC.displayName=VC;var PJ="DropdownMenuPortal",GC=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Ea(t);return p.jsx(gJ,{...n,...r})};GC.displayName=PJ;var XC="DropdownMenuContent",KC=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=HC(XC,r),i=Ea(r),s=O.useRef(!1);return p.jsx(mJ,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...n,ref:t,onCloseAutoFocus:Vt(e.onCloseAutoFocus,o=>{var l;s.current||(l=a.triggerRef.current)==null||l.focus(),s.current=!1,o.preventDefault()}),onInteractOutside:Vt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!a.modal||u)&&(s.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});KC.displayName=XC;var FJ="DropdownMenuGroup",LJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(vJ,{...a,...n,ref:t})});LJ.displayName=FJ;var jJ="DropdownMenuLabel",IJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(xJ,{...a,...n,ref:t})});IJ.displayName=jJ;var DJ="DropdownMenuItem",YC=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(yJ,{...a,...n,ref:t})});YC.displayName=DJ;var OJ="DropdownMenuCheckboxItem",RJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(wJ,{...a,...n,ref:t})});RJ.displayName=OJ;var MJ="DropdownMenuRadioGroup",BJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(bJ,{...a,...n,ref:t})});BJ.displayName=MJ;var UJ="DropdownMenuRadioItem",zJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(_J,{...a,...n,ref:t})});zJ.displayName=UJ;var WJ="DropdownMenuItemIndicator",HJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(kJ,{...a,...n,ref:t})});HJ.displayName=WJ;var $J="DropdownMenuSeparator",JC=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(SJ,{...a,...n,ref:t})});JC.displayName=$J;var VJ="DropdownMenuArrow",qJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(EJ,{...a,...n,ref:t})});qJ.displayName=VJ;var GJ="DropdownMenuSubTrigger",XJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(NJ,{...a,...n,ref:t})});XJ.displayName=GJ;var KJ="DropdownMenuSubContent",YJ=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Ea(r);return p.jsx(AJ,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});YJ.displayName=KJ;var xk=$C,yk=qC,wk=GC,bk=KC,Kv=YC,JJ=JC;const eo=({icon:e,label:t,active:r,onClick:n,rightIcon:a,children:i,className:s="",collapsed:o,isDashboard:l})=>{const c=u=>{u.preventDefault(),u.stopPropagation(),(l||!n)&&u.currentTarget.blur(),n==null||n()};return p.jsxs("div",{children:[p.jsxs("button",{className:`
        w-full flex items-center justify-between px-3 py-2 rounded-lg
        ${r?"bg-green-50 dark:bg-green-900/50 text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}
        transition-colors duration-150
        ${s}
      `,onClick:c,title:typeof t=="string"?t:"I'm Sydneyask me anything about your books!",children:[p.jsxs("div",{className:`flex items-center ${o?"justify-center w-8 h-8":"space-x-3"}`,children:[e,!o&&p.jsx("span",{className:"font-medium",children:t})]}),a]}),i]})},ZJ=({onToggleShortcuts:e,showShortcuts:t,collapsed:r,onToggleCollapse:n})=>{const a=Il(),i=eh(),[s,o]=O.useState(!1),[l,c]=O.useState(!1),[u,f]=O.useState(""),[d,h]=O.useState("");return O.useEffect(()=>{(async()=>{try{const{data:{user:m}}=await He.auth.getUser();if(!m)return;const{data:y,error:x}=await He.from("accounting_settings").select("company_legal_name").eq("user_id",m.id).single();if(x)throw x;y&&f(y.company_legal_name||"My Company")}catch(m){console.error("Error fetching company name:",m)}})()},[]),O.useEffect(()=>{(async()=>{try{const{data:{user:m}}=await He.auth.getUser();if(!m)return;const{data:y,error:x}=await He.from("users").select("full_name").eq("auth_id",m.id).single();if(x)throw x;y&&h(y.full_name||"User")}catch(m){console.error("Error fetching user profile:",m)}})()},[]),p.jsxs("aside",{className:`hidden md:flex flex-col ${r?"w-16":"w-56"} bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 h-[calc(100vh-4rem)]`,children:[!r&&p.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:p.jsxs(xk,{children:[p.jsx(yk,{asChild:!0,children:p.jsxs("button",{className:"w-full px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center justify-between",children:[p.jsx("span",{className:"truncate",children:u}),p.jsx(qu,{className:"w-4 h-4 ml-2"})]})}),p.jsx(wk,{children:p.jsx(bk,{className:"w-[var(--radix-dropdown-menu-trigger-width)] bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 animate-in fade-in-0 zoom-in-95 min-w-[200px]",align:"start",sideOffset:5,children:p.jsxs(Kv,{className:Ln("relative flex items-center px-3 py-2 text-sm text-gray-700 dark:text-gray-200 outline-none cursor-pointer","hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","focus:bg-gray-100 dark:focus:bg-gray-700"),onClick:()=>a("/settings"),children:[p.jsx(TE,{className:"w-4 h-4 mr-2"}),p.jsx("span",{children:"Company Settings"})]})})})]})}),p.jsx("div",{className:"flex flex-col h-full overflow-hidden",children:p.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:p.jsxs("div",{className:"space-y-1",children:[p.jsx("div",{className:"mb-1",children:p.jsx(eo,{icon:p.jsx(lI,{className:`w-5 h-5 transition-colors duration-150 ${t?"text-green-600 dark:text-green-400":""}`}),label:r?"":"Shortcuts",active:!1,onClick:e,className:"w-full",collapsed:r})}),p.jsx(eo,{icon:p.jsx(Qj,{className:"w-5 h-5"}),label:r?"":"Dashboard",active:i.pathname==="/dashboard",onClick:()=>{i.pathname==="/dashboard"?n():a("/dashboard")},className:"cursor-pointer",collapsed:r,isDashboard:!0}),p.jsx(eo,{icon:p.jsx(Xj,{className:"w-5 h-5"}),label:r?"":"Accounts",active:i.pathname==="/accounts",onClick:()=>a("/accounts"),collapsed:r}),p.jsx(eo,{icon:p.jsx(PE,{className:"w-5 h-5"}),label:r?"":"Sales",active:i.pathname.startsWith("/sales"),onClick:()=>o(!s),rightIcon:!r&&p.jsx(qu,{className:`w-4 h-4 transition-transform ${s?"transform rotate-180":""}`}),collapsed:r,children:s&&!r&&p.jsxs("div",{className:"ml-6 space-y-1 mt-1",children:[p.jsxs("button",{className:`
                      w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-sm
                      ${i.pathname==="/sales/customers"?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}
                    `,onClick:v=>{v.stopPropagation(),a("/sales/customers")},children:[p.jsx(FE,{className:"w-4 h-4"}),p.jsx("span",{children:"Customers"})]}),p.jsxs("button",{className:`
                      w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-sm
                      ${i.pathname==="/sales/invoices"?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}
                    `,onClick:v=>{v.stopPropagation(),a("/sales/invoices")},children:[p.jsx(Ng,{className:"w-4 h-4"}),p.jsx("span",{children:"Invoices"})]}),p.jsxs("button",{className:`
                      w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-sm
                      ${i.pathname==="/sales/items"?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}
                    `,onClick:v=>{v.stopPropagation(),a("/sales/items")},children:[p.jsx(NE,{className:"w-4 h-4"}),p.jsx("span",{children:"Sale Items"})]})]})}),p.jsx(eo,{icon:p.jsx(sI,{className:"w-5 h-5"}),label:r?"":"Purchases",active:i.pathname.startsWith("/purchases"),onClick:()=>c(!l),rightIcon:!r&&p.jsx(qu,{className:`w-4 h-4 transition-transform ${l?"transform rotate-180":""}`}),collapsed:r,children:l&&!r&&p.jsxs("div",{className:"ml-6 space-y-1 mt-1",children:[p.jsxs("button",{className:`
                      w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-sm
                      ${i.pathname==="/purchases/vendors"?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}
                    `,onClick:v=>{v.stopPropagation(),a("/purchases/vendors")},children:[p.jsx(bE,{className:"w-4 h-4"}),p.jsx("span",{children:"Vendors"})]}),p.jsxs("button",{className:`
                      w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-sm
                      ${i.pathname==="/purchases/bills"?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}
                    `,onClick:v=>{v.stopPropagation(),a("/purchases/bills")},children:[p.jsx(oI,{className:"w-4 h-4"}),p.jsx("span",{children:"Bills"})]}),p.jsxs("button",{className:`
                      w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-sm
                      ${i.pathname==="/purchases/items"?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}
                    `,onClick:v=>{v.stopPropagation(),a("/purchases/items")},children:[p.jsx(Yj,{className:"w-4 h-4"}),p.jsx("span",{children:"Purchase Items"})]})]})}),p.jsx(eo,{icon:p.jsx(Kj,{className:"w-5 h-5"}),label:r?"":p.jsxs("div",{className:"flex items-center",children:[p.jsx("span",{className:"font-medium italic font-bold text-teal-600 dark:text-teal-400",children:"Sydney AI"}),p.jsx("span",{className:"ml-2 px-1.5 py-0.5 text-xs bg-teal-100 dark:bg-teal-900 text-teal-800 dark:text-teal-200 rounded-full",children:"New"})]}),active:i.pathname==="/sydney-ai",onClick:()=>a("/sydney-ai"),className:"group hover:scale-105 transition-transform [&>button>div>*:first-child]:text-teal-600 dark:[&>button>div>*:first-child]:text-teal-400",collapsed:r}),p.jsx(eo,{icon:p.jsx(Gj,{className:"w-5 h-5"}),label:r?"":"Journals",active:i.pathname==="/journals",onClick:()=>a("/journals"),collapsed:r}),p.jsx(eo,{icon:p.jsx(LE,{className:"w-5 h-5"}),label:r?"":"Banking",active:i.pathname==="/bank-transactions",onClick:()=>a("/bank-transactions"),collapsed:r}),p.jsx(eo,{icon:p.jsx(EE,{className:"w-5 h-5"}),label:r?"":"Logout",onClick:async()=>{await He.auth.signOut(),a("/auth")},className:"mt-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",collapsed:r})]})})}),!r&&p.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900",children:p.jsxs(xk,{children:[p.jsx(yk,{asChild:!0,children:p.jsxs("button",{className:"w-full px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors flex items-center",children:[p.jsx(fI,{className:"w-4 h-4 mr-2"}),p.jsx("span",{className:"truncate",children:d}),p.jsx(qu,{className:"w-4 h-4 ml-auto"})]})}),p.jsx(wk,{children:p.jsxs(bk,{className:"w-[var(--radix-dropdown-menu-trigger-width)] bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-1 animate-in fade-in-0 zoom-in-95",align:"end",side:"top",sideOffset:5,children:[p.jsx(Kv,{className:Ln("relative flex items-center px-3 py-2 text-sm text-gray-700 dark:text-gray-200 outline-none cursor-pointer","hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","focus:bg-gray-100 dark:focus:bg-gray-700"),onClick:()=>a("/profile"),children:p.jsx("span",{children:"Account"})}),p.jsx(JJ,{className:"h-px my-1 bg-gray-200 dark:bg-gray-700"}),p.jsx(Kv,{className:Ln("relative flex items-center px-3 py-2 text-sm text-red-600 dark:text-red-400 outline-none cursor-pointer","hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors","focus:bg-red-50 dark:focus:bg-red-900/20"),onClick:async()=>{await He.auth.signOut(),a("/auth")},children:p.jsx("span",{children:"Sign out"})})]})})]})})]})},QJ=({icon:e,title:t,color:r,onClick:n})=>p.jsxs("button",{onClick:n,className:`${r} p-4 rounded-lg text-white transition-transform hover:scale-105 flex flex-col items-center text-center space-y-3 w-full`,children:[p.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:e}),p.jsx("span",{className:"font-medium text-sm",children:t})]}),eZ=()=>{const e=Il(),t=n=>{e(n),window.dispatchEvent(new CustomEvent("shortcutSelected"))},r=[{icon:p.jsx(FE,{className:"w-6 h-6"}),title:"Add/Manage Customer",color:"bg-purple-500 hover:bg-purple-600",onClick:()=>t("/sales/customers")},{icon:p.jsx(uI,{className:"w-6 h-6"}),title:"Add/Manage Supplier",color:"bg-blue-500 hover:bg-blue-600",onClick:()=>t("/purchases/vendors")},{icon:p.jsx(Oy,{className:"w-6 h-6"}),title:"Upload Invoice",color:"bg-green-500 hover:bg-green-600",onClick:()=>t("/sales/invoices")},{icon:p.jsx(NE,{className:"w-6 h-6"}),title:"Manage Sales Items",color:"bg-yellow-500 hover:bg-yellow-600",onClick:()=>t("/sales/items")},{icon:p.jsx(TE,{className:"w-6 h-6"}),title:"Account Set-up",color:"bg-red-500 hover:bg-red-600",onClick:()=>t("/accounts")},{icon:p.jsx(PE,{className:"w-6 h-6"}),title:"Manage Purchase Items",color:"bg-indigo-500 hover:bg-indigo-600",onClick:()=>t("/purchases/items")}];return p.jsxs("div",{className:"w-64 bg-white dark:bg-gray-900 border-l border-gray-200 dark:border-gray-700 p-4 transform transition-all duration-300 ease-in-out animate-slide-in",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Shortcuts"}),p.jsx("div",{className:"grid grid-cols-1 gap-4",children:r.map((n,a)=>p.jsx(QJ,{...n},a))})]})};function tZ(){const e=Es.useRef(null),[t,r]=O.useState(!1),[n,a]=O.useState(!1),[i,s]=O.useState(!0),[o,l]=O.useState(!1),[c,u]=O.useState([]),f=(h,v="info")=>{const m={id:Math.random().toString(36).substr(2,9),message:h,type:v,createdAt:new Date};u(y=>[m,...y])};O.useEffect(()=>{const h=()=>l(!1);return window.addEventListener("shortcutSelected",h),()=>window.removeEventListener("shortcutSelected",h)},[]);const d=h=>{var v;o&&((v=e.current)!=null&&v.contains(h.target))&&l(!1)};return O.useEffect(()=>{He.auth.getSession().then(({data:{session:v}})=>{a(!!v),s(!1)});const{data:{subscription:h}}=He.auth.onAuthStateChange((v,m)=>{a(!!m)});return()=>h.unsubscribe()},[]),i?p.jsx("div",{className:"min-h-screen flex items-center justify-center dark:bg-gray-900",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):p.jsx(Q7,{children:n?p.jsxs("div",{className:"min-h-screen flex flex-col bg-white dark:bg-gray-900",children:[p.jsx(EY,{alerts:c,onDismiss:h=>u(v=>v.filter(m=>m.id!==h))}),p.jsxs("div",{className:"flex flex-1",children:[p.jsx(ZJ,{onToggleShortcuts:()=>l(!o),showShortcuts:o,collapsed:t,onToggleCollapse:()=>r(!t)}),p.jsx("main",{ref:e,className:"flex-1 overflow-y-auto bg-gray-50 dark:bg-gray-800",onClick:d,children:p.jsxs(Ub,{children:[p.jsx(Rn,{path:"/dashboard",element:p.jsx(hI,{})}),p.jsx(Rn,{path:"/accounts",element:p.jsx(aD,{})}),p.jsx(Rn,{path:"/journals",element:p.jsx(pG,{})}),p.jsx(Rn,{path:"/sales/customers",element:p.jsx(yG,{})}),p.jsx(Rn,{path:"/sales/invoices",element:p.jsx(fD,{onAlert:f})}),p.jsx(Rn,{path:"/sales/items",element:p.jsx(mG,{})}),p.jsx(Rn,{path:"/purchases/vendors",element:p.jsx(fY,{})}),p.jsx(Rn,{path:"/purchases/bills",element:p.jsx(mY,{})}),p.jsx(Rn,{path:"/bank-transactions",element:p.jsx(rY,{onAlert:f})}),p.jsx(Rn,{path:"/purchases/items",element:p.jsx(cY,{})}),p.jsx(Rn,{path:"/settings",element:p.jsx(oY,{})}),p.jsx(Rn,{path:"/profile",element:p.jsx(vY,{onAlert:f})}),p.jsx(Rn,{path:"*",element:p.jsx(Bb,{to:"/dashboard",replace:!0})})]})}),o&&p.jsx(eZ,{})]})]}):p.jsxs(Ub,{children:[p.jsx(Rn,{path:"/auth",element:p.jsx(xY,{})}),p.jsx(Rn,{path:"/verify",element:p.jsx(yY,{})}),p.jsx(Rn,{path:"*",element:p.jsx(Bb,{to:"/auth",replace:!0})})]})})}DS(document.getElementById("root")).render(p.jsx(O.StrictMode,{children:p.jsx(tZ,{})}));export{dr as _,wa as c,qd as g};
